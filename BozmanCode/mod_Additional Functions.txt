Attribute VB_Name = "Additional Functions"
Option Compare Database   'Use database order for string comparisons

Public Function RecordFileLog(vfilenum As Double)

Dim objFSO As Object
Dim objFolder As Object
Dim objFile As Object

Dim argCPU As Double
Dim currentUser As String
Dim filenum As Double
Dim filesize As Double
Dim currentTimeDate As String

On Error GoTo handler

Dim taber As String: taber = vbTab & vbTab

'https://msdn.microsoft.com/en-us/library/aa262402(v=vs.60).aspx
'setting parameters
argCPU = getFCFileUsage
currentUser = username
filenum = vfilenum
filesize = FileLen(CurrentDb.name) / 1000
currentTimeDate = Now

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFolder = objFSO.GetFolder(pathuser)

If objFSO.FileExists(pathuser & "fclog.txt") = False Then
    Set objFile = objFolder.CreateTextFile("fclog.txt", True)
    objFile.WriteLine "BWW" & taber & "UserName" & taber & "FileSize" & taber & "DateTime" & taber & vbTab & "CPU_Usage" & taber & "DB_Version"
Else
    Set objFile = objFSO.OpenTextFile(objFolder & "\" & "fclog.txt", 8)
End If

objFile.WriteLine filenum & taber & currentUser & taber & filesize & taber & currentTimeDate & taber & argCPU & taber & GetVersion
objFile.Close
Set objFile = Nothing
Set objFolder = Nothing
Set objFSO = Nothing

handler:

Exit Function

End Function

Public Function getFCFileUsage() As Variant
    Dim strComputer As String
    Dim objServices As Object, objProcessSet As Object, Process As Object
    Dim CPUStr As String

    Set oDic = CreateObject("Scripting.Dictionary")

    strComputer = "."

    Set objServices = GetObject("winmgmts:\\" _
        & strComputer & "\root\CIMV2")
    Set objProcessSet = objServices.ExecQuery _
        ("SELECT * FROM Win32_Process", , 48)

    For Each Process In objProcessSet
       'If Not oDic.Exists(Process.name) Then oDic.ADD Process.name, Process.name
       If Process.commandline Like "*msaccess.exe*" & "*" & CurrentProject.name & "*" Then
        'Debug.Print Process.description & Process.name & " " & Process.pagefileusage
        CPUStr = CPUStr & Process.pagefileusage
        getFCFileUsage = CPUStr
        Exit Function
        End If
    Next

    Set objProcessSet = Nothing
    Set oDic = Nothing

   
End Function

Public Function RemoveCrashedDBs()

On Error GoTo handler

Dim objFSO As Object
Dim objFolder As Object
Dim objFile As Object

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFolder = objFSO.GetFolder(pathuser)

For Each objFile In objFolder.Files
If objFile.name Like "db*.mdb" Then
    Kill (objFile.path)
End If

Next objFile

Set objFolder = Nothing
Set objFolder = objFSO.GetFolder(CurrentProject.path)

For Each objFile In objFolder.Files
If objFile.name Like "db*.mdb" Then
    Kill (objFile.path)
End If
Next objFile

handler:

Exit Function

End Function

Public Function MailAddBFormatted() As String

Dim mailaddb As String: mailaddb = Nz(Forms![foreclosure database screen]![Mailing AddressB], "")
Dim mailadd2b As String: mailadd2b = Nz(Forms![foreclosure database screen]![Mailing Address2B], "")
Dim mailcityb As String: mailcityb = Nz(Forms![foreclosure database screen]![Mailing CityB], "")
Dim mailstateb As String: mailstateb = Nz(Forms![foreclosure database screen]![Mailing StateB], "")
Dim mailzipb As String: mailzipb = Nz(Forms![foreclosure database screen]![Mailing ZipB], "")

MailAddBFormatted = mailaddb & IIf(Len(mailadd2b) > 0, ", Unit/Apt #" & mailadd2b, "")
MailAddBFormatted = MailAddBFormatted & vbCrLf & mailcityb & ", " & mailstateb & " " & mailzipb

End Function

Public Function MailAdd1Formatted() As String

Dim mailadd As String: mailadd = Nz(Forms![foreclosure database screen]![Mailing Address], "")
Dim mailadd2 As String: mailadd2 = Nz(Forms![foreclosure database screen]![Mailing Address2], "")
Dim mailcity As String: mailcity = Nz(Forms![foreclosure database screen]![Mailing City], "")
Dim mailstate As String: mailstate = Nz(Forms![foreclosure database screen]![Mailing State], "")
Dim mailzip As String: mailzip = Nz(Forms![foreclosure database screen]![Mailing Zip], "")

MailAdd1Formatted = mailadd & IIf(Len(mailadd2) > 0, ", Unit/Apt #" & mailadd2, "")
MailAdd1Formatted = MailAdd1Formatted & vbCrLf & mailcity & ", " & mailstate & " " & mailzip

End Function

Public Function PROPFormatted() As String

If IsNull(Forms![foreclosure database screen]![propaddress2]) Then
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
PROPFormatted = Forms![foreclosure database screen]![PropAddress] & vbCrLf & Forms![foreclosure database screen]![PropertyCity] & _
    ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
Else
PROPFormatted = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & _
    Forms![foreclosure database screen]![unit_no] & vbCrLf & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If

Else
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
PROPFormatted = Forms![foreclosure database screen]![PropAddress] & vbCrLf & Forms![foreclosure database screen]![propaddress2] & _
vbCrLf & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
Else
PROPFormatted = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no] & _
    vbCrLf & Forms![foreclosure database screen]![propaddress2] & vbCrLf & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If
End If

End Function

Public Function previousBusinessDay(dater As Date, days As Double) As Variant

Dim i As Double
Dim daysExtra As Double
Dim nextDay As Date
nextDay = dater

Do While i < days

    nextDay = nextDay - 1
        
        If Weekday(nextDay) = 7 Or Weekday(nextDay) = 1 Then
            daysExtra = daysExtra + 1
        Else
            i = i + 1
        End If
Loop

previousBusinessDay = dater - (days + daysExtra)
                      
End Function

Public Function nextBusinessDay(dater As Date, days As Double) As Variant

Dim i As Double
Dim daysExtra As Double
Dim nextDay As Date
nextDay = dater

Do While i < days

    nextDay = nextDay + 1
        
        If Weekday(nextDay) = 7 Or Weekday(nextDay) = 1 Then
            daysExtra = daysExtra + 1
        Else
            i = i + 1
        End If
Loop

nextBusinessDay = dater + days + daysExtra
                      
End Function


Public Function Workdays(ByRef startdate As Date, _
     ByRef EndDate As Date, _
     Optional ByRef strHolidays As String = "Holidays" _
     ) As Integer
    ' Returns the number of workdays between startDate
    ' and endDate inclusive.  Workdays excludes weekends and
    ' holidays. Optionally, pass this function the name of a table
    ' or query as the third argument. If you don't the default
    ' is "Holidays".
    On Error GoTo Workdays_Error
    Dim nWeekdays As Integer
    Dim nHolidays As Integer
    Dim strWhere As String
    
    ' DateValue returns the date part only.
    startdate = DateValue(startdate)
    EndDate = DateValue(EndDate)
    
    nWeekdays = Weekdays(startdate, EndDate)
    If nWeekdays = -1 Then
        Workdays = -1
        GoTo Workdays_Exit
    End If
    
    strWhere = "[Holiday] >= #" & startdate _
        & "# AND [Holiday] <= #" & EndDate & "#"
    
    ' Count the number of holidays.
    nHolidays = DCount(Expr:="[Holiday]", _
        Domain:=strHolidays, _
        Criteria:=strWhere)
    
    Workdays = nWeekdays - nHolidays
    
Workdays_Exit:
    Exit Function
    
Workdays_Error:
    Workdays = -1
    MsgBox "Error " & Err.Number & ": " & Err.description, _
        vbCritical, "Workdays"
    Resume Workdays_Exit
    
End Function

Public Function Weekdays(ByRef startdate As Date, _
    ByRef EndDate As Date _
    ) As Integer
    ' Returns the number of weekdays in the period from startDate
    ' to endDate inclusive. Returns -1 if an error occurs.
    ' If your weekend days do not include Saturday and Sunday and
    ' do not total two per week in number, this function will
    ' require modification.
    On Error GoTo Weekdays_Error
    
    ' The number of weekend days per week.
    Const ncNumberOfWeekendDays As Integer = 2
    
    ' The number of days inclusive.
    Dim varDays As Variant
    
    ' The number of weekend days.
    Dim varWeekendDays As Variant
    
    ' Temporary storage for datetime.
    Dim dtmX As Date
    
    ' If the end date is earlier, swap the dates.
    If EndDate < startdate Then
        dtmX = startdate
        startdate = EndDate
        EndDate = dtmX
    End If
    
    ' Calculate the number of days inclusive (+ 1 is to add back startDate).
    varDays = DateDiff(Interval:="d", _
        date1:=startdate, _
        date2:=EndDate) + 1
    
    ' Calculate the number of weekend days.
    varWeekendDays = (DateDiff(Interval:="ww", _
        date1:=startdate, _
        date2:=EndDate) _
        * ncNumberOfWeekendDays) _
        + IIf(DatePart(Interval:="w", _
        Date:=startdate) = vbSunday, 1, 0) _
        + IIf(DatePart(Interval:="w", _
        Date:=EndDate) = vbSaturday, 1, 0)
    
    ' Calculate the number of weekdays.
    Weekdays = (varDays - varWeekendDays)
    
Weekdays_Exit:
    Exit Function
    
Weekdays_Error:
    Weekdays = -1
    MsgBox "Error " & Err.Number & ": " & Err.description, _
        vbCritical, "Weekdays"
    Resume Weekdays_Exit
End Function




Public Function getCurrentInvoice() As Double
    getCurrentInvoice = CDbl(VINv)
End Function


Public Sub FilesOpenedReport()

Dim BegDate As Date
Dim EndDate As Date
Dim vClient As String
Dim Cdb As Database
Dim CasesT As RecordSet
Dim ForeT As RecordSet
Dim Cstrsql As String
Dim Fstrsql As String
Dim NCRpt As RecordSet
Dim VStatus As String

 

BegDate = InputBox("Enter Beginning Date")
EndDate = InputBox("Enter Ending Date")
vClient = InputBox("Enter Client")


Set Cdb = CurrentDb()
CurrentDb.Execute "Delete * from NewCasesRpt;", dbFailOnError

If IsNull(vClient) Then
Cstrsql = ("Select * from Cases where [date recieved] >= #" & BegDate & "# and [date recieved] <=#" & EndDate & "#")
Else
Cstrsql = ("Select * from Cases where [date recieved] >= #" & BegDate & "# and [date recieved] <=#" & EndDate & "# and [client] like " & """" & vClient & "*""" & ";")

End If

Set CasesT = Cdb.OpenRecordset(Cstrsql, dbOpenSnapshot)

Set NCRpt = Cdb.OpenRecordset("NewCasesRpt", dbOpenDynaset, dbSeeChanges)
CasesT.MoveFirst

While Not CasesT.EOF
With NCRpt
.AddNew
!filenum = CasesT!filenum
!ClientRefNumber = CasesT![ClientRefNumber]
!LastNameDebtor1 = CasesT![LastNameDebtor1]
!PropAddress = CasesT![PropAddress]
!PropertyState = CasesT![PropertyState]
!LastNameDebtor1 = CasesT!LastNameDebtor1
!FirstNameDebtor1 = CasesT!FirstNameDebtor1
!LastNameDebtor2 = CasesT!LastNameDebtor2
!FirstNameDebtor2 = CasesT!FirstNameDebtor2
![Date Recieved] = CasesT![Date Recieved]
![Client] = CasesT!Client
!BegDate = BegDate
!EndDate = EndDate
.Update
End With
CasesT.MoveNext
Wend

DoCmd.OpenQuery "NCUpdate"
CurrentDb.Execute ("UPDATE Clients INNER JOIN NewCasesRpt ON Clients.OrganizationName = NewCasesRpt.Client SET NewCasesRpt.Client = [clients.customerid]")
DoCmd.OpenQuery "NCUpdate"
CurrentDb.Execute ("UPDATE Clients INNER JOIN NewCasesRpt ON Clients.OrganizationName = NewCasesRpt.Client SET NewCasesRpt.Client = [clients.customerid]")

'CurrentDb.Execute "Delete * from NewCasesRpt;", dbFailOnError

End Sub


Sub RemoveBillEmails()

Dim objFSO As Object
Dim objFolder As Object
Dim objFile As Object

Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFolder = objFSO.GetFolder(pathuser)


For Each objFile In objFolder.Files
If InStr(1, objFile.name, "bill-email") > 0 Then
    Kill (objFile.path)
End If
Next objFile

End Sub


Public Function DocketClientOcwen(Client As String, prime_nonprime As Variant, AffMailing_recd As Variant) As Boolean

If Client Like "ocwen*" Then
    
    If IsNull(AffMailing_recd) = False And prime_nonprime = 1 Then
        DocketClientOcwen = True
    End If
    
    If IsNull(prime_nonprime) Or prime_nonprime = 0 Or prime_nonprime = 2 Then
        DocketClientOcwen = True
    End If
    
End If

End Function

Public Function DocketClientCiti(Client As String, MilAff_From_Client As Variant) As Boolean

If Client Like "citi*" Then
    If IsNull(MilAff_From_Client) = False Then
        DocketClientCiti = True
    End If
End If

End Function

Public Function getQueryDescription(query As String) As String

Dim p As Parameter
Dim paramlist As String

getQueryParams = CurrentDb.QueryDefs(query).Properties("description")

End Function


Sub WriteStringToFile(pFileName As String, pString As String)

    Dim IntFilenum As Integer
    
    IntFilenum = FreeFile
                ' change Output to Append if you want to add to an existing file
                ' rather than creating a new file each time
    Open pFileName For Output As IntFilenum
    Print #IntFilenum, pString
    Close IntFilenum

End Sub

Public Function Hagerstown()
If Forms![foreclosure database screen]!PropertyCity Like "Hagerstow*" Or _
Forms![foreclosure database screen]!propzip Like "21740*" Or _
Forms![foreclosure database screen]!propzip Like "21741*" Or _
Forms![foreclosure database screen]!propzip Like "21742*" Or _
Forms![foreclosure database screen]!propzip Like "21746*" Or _
Forms![foreclosure database screen]!propzip Like "21747*" Or _
Forms![foreclosure database screen]!propzip Like "21748*" Or _
Forms![foreclosure database screen]!propzip Like "21749*" Then
Hagerstown = 1
Else
Hagerstown = 0
End If


End Function
Public Function MaxFileNumValue(NameOfRecordSet As String, filenum As Variant, MaxField As String, Optional filefield As String = "FileNum")

Dim maxValue As Variant

Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("select max([" & MaxField & "]) from " & NameOfRecordSet & " where " & filefield & " = " & filenum)
If Not rs.EOF Then
maxValue = rs.Fields(0).Value
MaxFileNumValue = maxValue
End If
rs.Close
Set rs = Nothing

End Function

Function getMaxDateFieldValue(FieldName As Variant, FieldValue As Variant, Optional FieldName2 As Variant, Optional FieldValue2 As Variant, Optional FieldName3 As Variant, Optional FieldValue3 As Variant _
    , Optional FieldName4 As Variant, Optional FieldValue4 As Variant, Optional FieldName5 As Variant, Optional FieldValue5 As Variant, Optional FieldName6 As Variant, Optional FieldValue6 As Variant _
    , Optional FieldName7 As Variant, Optional FieldValue7 As Variant, Optional FieldName8 As Variant, Optional FieldValue8 As Variant, Optional FieldName9 As Variant, Optional FieldValue9 As Variant _
     , Optional FieldName10 As Variant, Optional FieldValue10 As Variant, Optional FieldName11 As Variant, Optional FieldValue11 As Variant, Optional FieldName12 As Variant, Optional FieldValue12 As Variant _
      , Optional FieldName13 As Variant, Optional FieldValue13 As Variant, Optional FieldName14 As Variant, Optional FieldValue14 As Variant, Optional FieldName15 As Variant, Optional FieldValue15 As Variant _
      , Optional FieldName16 As Variant, Optional FieldValue16 As Variant, Optional FieldName17 As Variant, Optional FieldValue17 As Variant, Optional FieldName18 As Variant, Optional FieldValue18 As Variant _
      , Optional FieldName19 As Variant, Optional FieldValue19 As Variant, Optional FieldName20 As Variant, Optional FieldValue20 As Variant, Optional FieldName21 As Variant, Optional FieldValue21 As Variant _
      , Optional FieldName22 As Variant, Optional FieldValue22 As Variant, Optional FieldName23 As Variant, Optional FieldValue23 As Variant, Optional FieldName24 As Variant, Optional FieldValue24 As Variant _
      , Optional FieldName25 As Variant, Optional FieldValue25 As Variant, Optional FieldName26 As Variant, Optional FieldValue26 As Variant, Optional FieldName27 As Variant, Optional FieldValue27 As Variant _
      , Optional FieldName28 As Variant, Optional FieldValue28 As Variant, Optional FieldName29 As Variant, Optional FieldValue29 As Variant) As Variant

On Error GoTo handler

Dim mfdoom As New MaxField


If IsMissing(FieldName) = False And IsMissing(FieldValue) = False Then mfdoom.AddField FieldName, FieldValue
If IsMissing(FieldName2) = False And IsMissing(FieldValue2) = False Then mfdoom.AddField FieldName2, FieldValue2
If IsMissing(FieldName3) = False And IsMissing(FieldValue3) = False Then mfdoom.AddField FieldName3, FieldValue3
If IsMissing(FieldName4) = False And IsMissing(FieldValue4) = False Then mfdoom.AddField FieldName4, FieldValue4
If IsMissing(FieldName5) = False And IsMissing(FieldValue5) = False Then mfdoom.AddField FieldName5, FieldValue5
If IsMissing(FieldName6) = False And IsMissing(FieldValue6) = False Then mfdoom.AddField FieldName6, FieldValue6
If IsMissing(FieldName7) = False And IsMissing(FieldValue7) = False Then mfdoom.AddField FieldName7, FieldValue7
If IsMissing(FieldName8) = False And IsMissing(FieldValue8) = False Then mfdoom.AddField FieldName8, FieldValue8
If IsMissing(FieldName9) = False And IsMissing(FieldValue9) = False Then mfdoom.AddField FieldName9, FieldValue9
If IsMissing(FieldName10) = False And IsMissing(FieldValue10) = False Then mfdoom.AddField FieldName10, FieldValue10
If IsMissing(FieldName11) = False And IsMissing(FieldValue11) = False Then mfdoom.AddField FieldName11, FieldValue11
If IsMissing(FieldName12) = False And IsMissing(FieldValue12) = False Then mfdoom.AddField FieldName12, FieldValue12
If IsMissing(FieldName13) = False And IsMissing(FieldValue13) = False Then mfdoom.AddField FieldName13, FieldValue13
If IsMissing(FieldName14) = False And IsMissing(FieldValue14) = False Then mfdoom.AddField FieldName14, FieldValue14
If IsMissing(FieldName15) = False And IsMissing(FieldValue15) = False Then mfdoom.AddField FieldName15, FieldValue15

If IsMissing(FieldName16) = False And IsMissing(FieldValue16) = False Then mfdoom.AddField FieldName16, FieldValue16
If IsMissing(FieldName17) = False And IsMissing(FieldValue17) = False Then mfdoom.AddField FieldName17, FieldValue17
If IsMissing(FieldName18) = False And IsMissing(FieldValue18) = False Then mfdoom.AddField FieldName18, FieldValue18
If IsMissing(FieldName19) = False And IsMissing(FieldValue19) = False Then mfdoom.AddField FieldName19, FieldValue19
If IsMissing(FieldName20) = False And IsMissing(FieldValue20) = False Then mfdoom.AddField FieldName20, FieldValue20
If IsMissing(FieldName21) = False And IsMissing(FieldValue21) = False Then mfdoom.AddField FieldName21, FieldValue21
If IsMissing(FieldName22) = False And IsMissing(FieldValue22) = False Then mfdoom.AddField FieldName22, FieldValue22
If IsMissing(FieldName23) = False And IsMissing(FieldValue23) = False Then mfdoom.AddField FieldName23, FieldValue23
If IsMissing(FieldName24) = False And IsMissing(FieldValue24) = False Then mfdoom.AddField FieldName24, FieldValue24
If IsMissing(FieldName25) = False And IsMissing(FieldValue25) = False Then mfdoom.AddField FieldName25, FieldValue25
If IsMissing(FieldName26) = False And IsMissing(FieldValue26) = False Then mfdoom.AddField FieldName26, FieldValue26
If IsMissing(FieldName27) = False And IsMissing(FieldValue27) = False Then mfdoom.AddField FieldName27, FieldValue27
If IsMissing(FieldName28) = False And IsMissing(FieldValue28) = False Then mfdoom.AddField FieldName28, FieldValue28
If IsMissing(FieldName29) = False And IsMissing(FieldValue29) = False Then mfdoom.AddField FieldName29, FieldValue29
If IsMissing(FieldName30) = False And IsMissing(FieldValue30) = False Then mfdoom.AddField FieldName30, FieldValue30

getMaxDateFieldValue = mfdoom.MaxFieldValue 'mfdoom.MaxFieldName & " Max Field Value: " & mfdoom.MaxFieldValue
Exit Function

handler:

getMaxDateFieldValue = Null

End Function

Function getMaxDateFieldName(FieldName As Variant, FieldValue As Variant, Optional FieldName2 As Variant, Optional FieldValue2 As Variant, Optional FieldName3 As Variant, Optional FieldValue3 As Variant _
    , Optional FieldName4 As Variant, Optional FieldValue4 As Variant, Optional FieldName5 As Variant, Optional FieldValue5 As Variant, Optional FieldName6 As Variant, Optional FieldValue6 As Variant _
    , Optional FieldName7 As Variant, Optional FieldValue7 As Variant, Optional FieldName8 As Variant, Optional FieldValue8 As Variant, Optional FieldName9 As Variant, Optional FieldValue9 As Variant _
     , Optional FieldName10 As Variant, Optional FieldValue10 As Variant, Optional FieldName11 As Variant, Optional FieldValue11 As Variant, Optional FieldName12 As Variant, Optional FieldValue12 As Variant _
      , Optional FieldName13 As Variant, Optional FieldValue13 As Variant, Optional FieldName14 As Variant, Optional FieldValue14 As Variant, Optional FieldName15 As Variant, Optional FieldValue15 As Variant) As Variant

On Error GoTo handler

Dim mfdoom As New MaxField

If IsMissing(FieldName) = False And IsMissing(FieldValue) = False Then mfdoom.AddField FieldName, FieldValue
If IsMissing(FieldName2) = False And IsMissing(FieldValue2) = False Then mfdoom.AddField FieldName2, FieldValue2
If IsMissing(FieldName3) = False And IsMissing(FieldValue3) = False Then mfdoom.AddField FieldName3, FieldValue3
If IsMissing(FieldName4) = False And IsMissing(FieldValue4) = False Then mfdoom.AddField FieldName4, FieldValue4
If IsMissing(FieldName5) = False And IsMissing(FieldValue5) = False Then mfdoom.AddField FieldName5, FieldValue5
If IsMissing(FieldName6) = False And IsMissing(FieldValue6) = False Then mfdoom.AddField FieldName6, FieldValue6
If IsMissing(FieldName7) = False And IsMissing(FieldValue7) = False Then mfdoom.AddField FieldName7, FieldValue7
If IsMissing(FieldName8) = False And IsMissing(FieldValue8) = False Then mfdoom.AddField FieldName8, FieldValue8
If IsMissing(FieldName9) = False And IsMissing(FieldValue9) = False Then mfdoom.AddField FieldName9, FieldValue9
If IsMissing(FieldName10) = False And IsMissing(FieldValue10) = False Then mfdoom.AddField FieldName10, FieldValue10
If IsMissing(FieldName11) = False And IsMissing(FieldValue11) = False Then mfdoom.AddField FieldName11, FieldValue11
If IsMissing(FieldName12) = False And IsMissing(FieldValue12) = False Then mfdoom.AddField FieldName12, FieldValue12
If IsMissing(FieldName13) = False And IsMissing(FieldValue13) = False Then mfdoom.AddField FieldName13, FieldValue13
If IsMissing(FieldName14) = False And IsMissing(FieldValue14) = False Then mfdoom.AddField FieldName14, FieldValue14
If IsMissing(FieldName15) = False And IsMissing(FieldValue15) = False Then mfdoom.AddField FieldName15, FieldValue15

If IsMissing(FieldName16) = False And IsMissing(FieldValue16) = False Then mfdoom.AddField FieldName16, FieldValue16
If IsMissing(FieldName17) = False And IsMissing(FieldValue17) = False Then mfdoom.AddField FieldName17, FieldValue17
If IsMissing(FieldName18) = False And IsMissing(FieldValue18) = False Then mfdoom.AddField FieldName18, FieldValue18
If IsMissing(FieldName19) = False And IsMissing(FieldValue19) = False Then mfdoom.AddField FieldName19, FieldValue19
If IsMissing(FieldName20) = False And IsMissing(FieldValue20) = False Then mfdoom.AddField FieldName20, FieldValue20
If IsMissing(FieldName21) = False And IsMissing(FieldValue21) = False Then mfdoom.AddField FieldName21, FieldValue21
If IsMissing(FieldName22) = False And IsMissing(FieldValue22) = False Then mfdoom.AddField FieldName22, FieldValue22
If IsMissing(FieldName23) = False And IsMissing(FieldValue23) = False Then mfdoom.AddField FieldName23, FieldValue23
If IsMissing(FieldName24) = False And IsMissing(FieldValue24) = False Then mfdoom.AddField FieldName24, FieldValue24
If IsMissing(FieldName25) = False And IsMissing(FieldValue25) = False Then mfdoom.AddField FieldName25, FieldValue25
If IsMissing(FieldName26) = False And IsMissing(FieldValue26) = False Then mfdoom.AddField FieldName26, FieldValue26
If IsMissing(FieldName27) = False And IsMissing(FieldValue27) = False Then mfdoom.AddField FieldName27, FieldValue27
If IsMissing(FieldName28) = False And IsMissing(FieldValue28) = False Then mfdoom.AddField FieldName28, FieldValue28
If IsMissing(FieldName29) = False And IsMissing(FieldValue29) = False Then mfdoom.AddField FieldName29, FieldValue29
If IsMissing(FieldName30) = False And IsMissing(FieldValue30) = False Then mfdoom.AddField FieldName30, FieldValue30

getMaxDateFieldName = mfdoom.MaxFieldName 'mfdoom.MaxFieldName & " Max Field Value: " & mfdoom.MaxFieldValue
Exit Function

handler:

getMaxDateFieldName = Null

End Function
Public Function RedactX(Entry As Variant, reptChar As Variant, Optional timerept As Double) As Variant

On Error GoTo handler

Dim orgstr As String: orgstr = CStr(Entry)

    RedactX = String(Len(orgstr) - timerept, CStr(reptChar)) & Right(orgstr, timerept)

Exit Function

handler:

RedactX = Null
Exit Function

End Function
Public Function IsFarAwayCounty(ByVal County As String, ByVal State As String) As Boolean

Dim rs As DAO.RecordSet
Dim sqlstr As String: sqlstr = "tblFarAwayCounties"

Set rs = CurrentDb.OpenRecordset(sqlstr, dbOpenSnapshot)

On Error GoTo handler


With rs
   .FindFirst "PropertyCounty = """ & County & """ and propertystate=""" & State & """"
If Not .NoMatch Then
    IsFarAwayCounty = True
Else
    IsFarAwayCounty = False
End If
End With

rs.Close
Set rs = Nothing
Exit Function

handler:

Set rs = Nothing
IsFarAwayCounty = False

Exit Function

End Function

Public Function IsHandFileCounty(ByVal County As String, ByVal State As String) As Boolean

Dim rs As DAO.RecordSet
Dim sqlstr As String: sqlstr = "tblHandFileCounties"

Set rs = CurrentDb.OpenRecordset(sqlstr, dbOpenSnapshot)

On Error GoTo handler


With rs
    .FindFirst "PropertyCounty = """ & County & """ and propertystate=""" & State & """"
If Not .NoMatch Then
    IsHandFileCounty = True
Else
    IsHandFileCounty = False
End If
End With

rs.Close
Set rs = Nothing
Exit Function

handler:

Set rs = Nothing
IsHandFileCounty = False

Exit Function

End Function
Public Function getRecentDocDate(ByVal filenum As Double, ByVal doctypeid As Double) As Variant

'Dim docrs As RecordSet
'Dim sqlstr As String: sqlstr = "select stamp from doclist where caseno = " & filenum &

On Error GoTo handler

getRecentDocDate = DMax("[Stamp]", "Doclist", "[caseno]=" & filenum & " and " & "[doctypeid]=" & doctypeid)

Exit Function

handler:

getRecentDocDate = Null

Exit Function

End Function

Public Function exportPDF(dir As String, basename As String)

On Error GoTo handler

Const HKEY_CURRENT_USER = &H80000001
Dim fso, app, exlWkbk

strComputer = "."

Set oReg = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" _
& strComputer & "\root\default:StdRegProv")
strKeyPath = "SOFTWARE\Adobe\Acrobat Distiller\PrinterJobControl"

' Just in case, create the PrinterJobControl registry key -
' it should already exist
oReg.CreateKey HKEY_CURRENT_USER, strKeyPath

Set app = CreateObject("Access.Application")

strValueName = "C:\Program Files\Microsoft Office\OFFICE11\msaccess.exe"
strValue = dir & "\" & basename & ".pdf"
oReg.SetStringValue HKEY_CURRENT_USER, strKeyPath, strValueName, strValue


DoCmd.PrintOut printrange:=acPrintAll

Exit Function

handler:

MsgBox "Report not converted." & vbCrLf & "Please print manually or contact support."

Exit Function

End Function

Public Function getMaxDate(RecordSet As String, datefield As String, filenum As Double) As Variant

Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("select max([" & datefield & "] ) from [" & RecordSet & "] where filenum = " & filenum)

On Error GoTo handler

If Not rs.EOF Then getMaxDate = DateValue(rs.Fields(0).Value)

Exit Function

handler:

 getMaxDate = Null

Exit Function

End Function

Public Function WeekGrouping(rsname As String, datefieldname As String, sdate As Date) As Variant

Dim rs As RecordSet
Dim mindate As Date
Dim firstdate, seconddate As Date

On Error GoTo handler

Set rs = CurrentDb.OpenRecordset("select min([" & datefieldname & "]) from " & rsname)
'MsgBox rs.Fields(datefieldname)
mindate = rs.Fields(0).Value

rs.Close
Set rs = Nothing

firstdate = mindate + (IIf(RoundUP((sdate - mindate) / 7) < 1, 1, RoundUP((sdate - mindate) / 7)) - 1) * 7
seconddate = mindate + (IIf(RoundUP((sdate - mindate) / 7) < 1, 1, RoundUP((sdate - mindate) / 7))) * 7 - 1

WeekGrouping = Format(firstdate, "mm/dd/yyyy") & " thru " & Format(seconddate, "mm/dd/yyyy")

Exit Function

handler:

WeekGrouping = Null

Exit Function

End Function


Public Function SOTReviewVAOPEN()
    stLinkCriteria = "[filenum]=" & Forms![foreclosure database screen]![filenum]
    DoCmd.Close acForm, ("Foreclosure Database screen")
    DoCmd.OpenForm "SOTReviewVA", , , stLinkCriteria
End Function

Public Function chkSOTRvd(filenum As Double) As String

Dim rs As RecordSet
Dim sotrevisestr As String

Set rs = CurrentDb.OpenRecordset("select taxid_ok, grantor_ok,assign_ok,mortnames_ok,dotdate_ok,dotrecord_loc_ok,dotrecord_info_ok,orglender_ok,orgtrust_ok,orgprincipal_amt_ok,sigline_ok,notclause_ok,legaldesc_ok,covsht_ok, other1_ok, " & _
    "taxid_notes,grantor_notes,assign_notes,mortnames_notes,dotdate_notes,dotrecord_loc_notes,dotrecord_info_notes,orglender_notes,orgtrust_notes,orgprincipal_amt_notes, " & _
    "sigline_notes,notclause_notes,legaldesc_notes,covsht_notes,other1_notes from tblSOTReviewed where filenum = " & filenum, dbOpenForwardOnly)

If Nz(rs("taxid_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Tax ID:" & vbTab & rs("taxid_notes").Value & vbCrLf

If Nz(rs("grantor_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Grantor/Secured Party:" & vbTab & rs("grantor_notes").Value & vbCrLf

If Nz(rs("assign_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Assignment:" & vbTab & rs("assign_notes").Value & vbCrLf

If Nz(rs("mortnames_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Mortgagor Names:" & vbTab & rs("mortnames_notes").Value & vbCrLf

If Nz(rs("dotdate_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "DOT Date:" & vbTab & rs("dotdate_notes").Value & vbCrLf

If Nz(rs("dotrecord_loc_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "DOT Recording Location:" & vbTab & rs("dotrecord_loc_notes").Value & vbCrLf

If Nz(rs("dotrecord_info_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "DOT Recording Info:" & vbTab & rs("dotrecord_info_notes").Value & vbCrLf

If Nz(rs("orglender_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Original Lender:" & vbTab & rs("orglender_notes").Value & vbCrLf

If Nz(rs("orgtrust_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Original Trustee:" & vbTab & rs("orgtrust_notes").Value & vbCrLf

If Nz(rs("sigline_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Signature Line:" & vbTab & rs("sigline_notes").Value & vbCrLf

If Nz(rs("notclause_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Notary Clause:" & vbTab & rs("notclause_notes").Value & vbCrLf

If Nz(rs("orgprincipal_amt_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Original Principal Amount:" & vbTab & rs("orgprincipal_amt_notes").Value & vbCrLf

If Nz(rs("legaldesc_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Legal Description:" & vbTab & rs("legaldesc_notes").Value & vbCrLf

If Nz(rs("covsht_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Cover Sheet:" & vbTab & rs("covsht_notes").Value & vbCrLf

If Nz(rs("other1_ok").Value, 0) = -1 Then sotrevisestr = sotrevisestr & "Other:" & vbTab & rs("other1_notes").Value
 
rs.Close
Set rs = Nothing
 
 chkSOTRvd = sotrevisestr

End Function

Public Function RecCostInvoicedMax(filenum As Double) As Variant

Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("select max(billingdate) from billing where filenum = " & filenum & " and (reccostsinv=1 or reccostsinv=-1)")

On Error GoTo handler

If Not rs.EOF Then RecCostInvoicedMax = DateValue(rs.Fields(0).Value)

Exit Function

handler:

 RecCostInvoicedMax = Null

Exit Function

End Function

Public Function TotalTBLAcDc()
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("tblacdc", dbOpenSnapshot)

If Not rs.EOF Then
rs.MoveFirst

Do While Not rs.EOF
If rs!Rpt = "AC_MD" Then
Vtotal = Vtotal + rs!TOTAL
End If

rs.MoveNext
Loop
End If

MsgBox (Vtotal)

End Function
Public Function FeesCostsClose()

GblFilenum = Forms![FeesCosts]![filenum]
Forms![FeesCosts].Refresh
    stLinkCriteria = "[filenum]=" & GblFilenum
    DoCmd.Close acForm, ("Feescosts")
    'DoCmd.OpenForm "Foreclosure Database screen", , , stLinkCriteria

End Function
Public Function FeesCostsOPEN()
    stLinkCriteria = "[filenum]=" & Forms![foreclosure database screen]![filenum]
    'DoCmd.Close acForm, ("Foreclosure Database screen")
    DoCmd.OpenForm "feescosts", , , stLinkCriteria
End Function
Public Function WeekdaysAdd(ByVal startdate As Date, Weekdays As Long) As Date
    ' This function returns a date that is Weekdays weekdays (ie Mon-Fri) from StartDate; eg.:
    ' - WeekdaysAdd(Friday 11 May 2007, 2) returns Tuesday 15 May 2007.
    'NOTES:
    ' - If StartDate is a Saturday or Sunday, it is treated as the following Monday.
    
    Dim EndDate As Date
    
    If Weekday(startdate, 2) > 5 Then startdate = startdate + 8 - Weekday(startdate, 2)
    EndDate = startdate + 7 * Int(Weekdays / 5) + (Weekdays - 5 * Int(Weekdays / 5))
    If Weekday(EndDate, 7) < Weekday(startdate, 7) Then EndDate = EndDate + 2
    
    WeekdaysAdd = EndDate
     
End Function


Public Function TotalRecordsScreen()
Set Records = Forms![AffServiceRecdCLIENTNotified].RecordsetClone
Records.MoveLast
TotalRecordsScreen = Records.RecordCount
End Function
Public Function TotalRecordsScreenCS()
Set Records = Forms![CourtStamped-CLIENTNotified].RecordsetClone
Records.MoveLast
TotalRecordsScreenCS = Records.RecordCount
End Function


'MsgBox (totalrecords)
Public Function RepCounsel()
Dim VConf

If Forms![foreclosure database screen]!Bwrw_Counsel = -1 Or _
Forms![foreclosure database screen]!Bwrw_Counsel = 1 Or _
Forms![foreclosure database screen]!att1 = -1 Or _
Forms![foreclosure database screen]!att1 = 1 Or _
Forms![foreclosure database screen]!att2 = -1 Or _
Forms![foreclosure database screen]!att2 = 1 Or _
Forms![foreclosure database screen]!att3 = -1 Or _
Forms![foreclosure database screen]!att3 = 1 Or _
Forms![foreclosure database screen]!att4 = -1 Or _
Forms![foreclosure database screen]!att4 = 1 Or _
Forms![foreclosure database screen]!att5 = -1 Or _
Forms![foreclosure database screen]!att5 = 1 Then
VConf = InputBox("Our records indicate that borrower or mortgagor may have an attorney. If the intended recipient of this letter has an attorney you should NOT be sending any correspondence directly to him/her, including any payoff or reinstatement quote. " & vbCr & _
"Instead, the correspondence must be sent to the recipients attorney, as follows: " & vbCr & vbCr & _
"[Borrower], c/o [Borrower’s Attorney], Esq." & vbCr & _
"[Attorney’s Address]" & vbCr & _
"[Attorney’s City/State/Zip]" & vbCr & _
"Dear Sir Or Madam:" & vbCr & vbCr & _
"Please use the letter preview button/function to double check and confirm that you are not sending any correspondence to a represented party. If you have confirmed that no letters will be sent to a represented party, you may proceed with sending the letter by typing “Confirmed” in the field below. This letter cannot be generated without this confirmation. Please escalate to your supervisor if you have any questions.")
If VConf <> "Confirmed" Then
Exit Function
End If



End If

End Function
Sub changecontrols()

For Each f In Forms("Ocwen Checklist").Controls("TabCtl157").pages("sot").Controls
    For Each p In f.Properties
    

   
    If InStr(1, p.name, "controlsource") > 0 Then
      '  MsgBox f.name
         p.Value = Replace(p.Value, "aco_", "sot_")
        f.name = p
       ' MsgBox "The property control source is now: " & p & vbCrLf & _
            "The control is now named: " & f.name
    End If
    Next p
Next f

End Sub


Public Function SPVar()
If (Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1) Or _
(Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1) Or _
(Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1) Then
SPVar = 1
Else
SPVar = 0
End If


End Function
Public Function ComplianceCert()

If Forms![foreclosure database screen]!Client Like "Select Por*" Then
MsgBox ("SPS has a Word merge for their Compliance Cert, will generate now")
Call SPSCompliance
ElseIf Forms![foreclosure database screen]!Client Like "PNC*" Then
DoCmd.OpenReport "ComplianceCert-PNC", acViewPreview

Else

DoCmd.OpenReport "ComplianceCert-Chase", acViewPreview
End If

End Function
Public Function taxidCode()
Dim strsql
Dim rs As RecordSet

If Forms![foreclosure database screen]!PropertyState = "VA" Then

strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)

If Not rs.EOF Then

If rs!VA_TaxID = 1 Or rs!VA_TaxID = 0 Or IsNull(rs![VA_TaxID]) Then
taxidCode = "Tax I.D.#: "
ElseIf rs!VA_TaxID = 2 Then
taxidCode = "GPIN: "
ElseIf rs!VA_TaxID = 3 Then
taxidCode = "Tax Map: "
End If

rs.Close
End If

ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
taxidCode = "Tax Parcel ID Number: "
Else
taxidCode = "Tax I.D.#: "
End If


End Function
Public Function CountCalls() As Integer
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function
CountCalls = 0

Dim rs As RecordSet
Dim strsql As String
strsql = "select * from phonecalls where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
Do While Not rs.EOF
CountCalls = CountCalls + 1
rs.MoveNext
Loop
End If



End Function
Public Function OpenSTReqAff()

Dim rs As RecordSet
Dim strsql As String

strsql = "select * from AffSOTRequirements where filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("AffSOTRequirements", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

DoCmd.OpenForm "Suntrust-Aff-Requirements"

End Function
Public Function OpenSTReqSOT()

Dim rs As RecordSet
Dim strsql As String

strsql = "select * from AffSOTRequirements where filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("AffSOTRequirements", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

DoCmd.OpenForm "Suntrust-SOT-Requirements"

End Function

Public Function ChaseNotarySig()

If (Forms![foreclosure database screen]![SPsigns] = 0 Or IsNull(Forms![foreclosure database screen]![SPsigns])) And _
(Forms![foreclosure database screen]![SPsameasCl] = 0 Or IsNull(Forms![foreclosure database screen]![SPsameasCl])) And _
(IsNull(Forms![foreclosure database screen]![aitno_client]) Or Forms![foreclosure database screen]![aitno_client] = 0) Then

ChaseNotarySig = "Vice President of JPMorgan Chase Bank, National Association."

ElseIf Forms![foreclosure database screen]![SPsigns] = 1 Or Forms![foreclosure database screen]![SPsigns] = -1 Then

ChaseNotarySig = "authorized signatory for " & LSecured() & ".  "

ElseIf Forms![foreclosure database screen]![aitno_client] = 1 Or Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Or Forms![foreclosure database screen]![SPsameasCl] = -1 Then

ChaseNotarySig = "Vice President of JPMorgan Chase Bank, National Association, as attorney in fact for " & LSecured() & "."

End If

'MsgBox (ChaseNotarySig)

End Function
Public Function ClearCurrentStatus()

Dim VClear

VClear = InputBox("Do you want to Clear the Current Status and Date?  (This will copy to the Memo Section then delete from the screen.) TYPE in password.")

If VClear = "clear" Then

Dim rstjournal As RecordSet


Set rstjournal = CurrentDb.OpenRecordset("Journal", dbOpenDynaset, dbSeeChanges)

With rstjournal
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!EntryBy = "Auto"
!EntryDate = Now()
!Entry = "Current Status Date: " & Forms![foreclosure database screen]!Current_Status_date & "/Current Status: " & Forms![foreclosure database screen]!Current_Status
.Update
End With



Forms![foreclosure database screen]!Current_Status = Null
Forms![foreclosure database screen]!Current_Status_date = Null

Forms![foreclosure database screen].Refresh

Else
MsgBox ("Incorrect password!")


End If


End Function

Public Function ClearComments()

Dim VClear

VClear = InputBox("Do you want to Clear the Comments?  (This will copy to the Memo Section then delete from the screen.) TYPE in password.")

If VClear = "clear" Then

Dim rstjournal As RecordSet


Set rstjournal = CurrentDb.OpenRecordset("Journal", dbOpenDynaset, dbSeeChanges)

With rstjournal
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!EntryBy = "Auto"
!EntryDate = Now()
!Entry = "Comments Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!comment_date & "/Comments: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!Info
.Update
End With



Forms![foreclosure database screen]!ForeclosureSubForm.Form!Info = Null
Forms![foreclosure database screen]!ForeclosureSubForm.Form!comment_date = Null

Forms![foreclosure database screen].Refresh

Else
MsgBox ("Incorrect password!")


End If


End Function


Public Function ClearCommentsPS()

Dim VClear

VClear = InputBox("Do you want to Clear the Comments?  (This will copy to the Memo Section then delete from the screen.) TYPE in password.")

If VClear = "clear" Then

Dim rstjournal As RecordSet


Set rstjournal = CurrentDb.OpenRecordset("Journal", dbOpenDynaset, dbSeeChanges)

With rstjournal
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!EntryBy = "Auto"
!EntryDate = Now()
!Entry = "Comments Date: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!Comments_date & "/Comments: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!Info
.Update
.Close

End With
Set rstjournal = Nothing




Forms![foreclosure database screen]!PostsaleSubForm.Form!Info = Null
Forms![foreclosure database screen]!PostsaleSubForm.Form!Comments_date = Null

'Forms![foreclosure database screen].Refresh
mySendKeys ("{F9}"), True ': DoEvents

Else
MsgBox ("Incorrect password!")


End If


End Function
Public Function SetPGReg()
Dim rs As RecordSet
Dim strsql As String

strsql = "select * from foreclosure where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
With rs
.Edit
!PGRegSent = Date
.Update
.Close
End With

End Function
Public Function AttorneyRecPS1()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE creditors.att_for = " & """" & "Purchaser" & """" & " and (creditors.[ta-do] = -1 or Creditors.[ta-do] = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ""
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
AttorneyRecPS1 = ""
Else
If Not IsNull(rsLienHolders!att_for) Then
AttorneyRecPS1 = rsLienHolders!OrganizationName & ", attorney for " & rsLienHolders!att_for
Else
AttorneyRecPS1 = rsLienHolders!OrganizationName
End If

End If
rsLienHolders.Close


End Function
Public Function AttorneyRecPS2()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE creditors.att_for = " & """" & "Purchaser" & """" & " and (creditors.[ta-do] = -1 or Creditors.[ta-do] = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
AttorneyRecPS2 = ""
Else
If Not IsNull(rsLienHolders!Address2) Then
AttorneyRecPS2 = rsLienHolders!Address & ", " & rsLienHolders!Address2
Else
AttorneyRecPS2 = rsLienHolders!Address
End If

End If
rsLienHolders.Close

End Function
Public Function attorneyrecPS3()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE creditors.att_for = " & """" & "Purchaser" & """" & " and Creditors.[ta-do] = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
attorneyrecPS3 = ""
Else
attorneyrecPS3 = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
End If

rsLienHolders.Close

End Function
Public Function AttorneyRec1()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE Creditors.[ta-do] = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
AttorneyRec1 = ""
Else
If Not IsNull(rsLienHolders!att_for) Then
AttorneyRec1 = rsLienHolders!OrganizationName & ", attorney for " & rsLienHolders!att_for
Else
AttorneyRec1 = rsLienHolders!OrganizationName
End If

End If
rsLienHolders.Close

End Function
Public Function AttorneyRec2()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE Creditors.[ta-do] = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
AttorneyRec2 = ""
Else
If Not IsNull(rsLienHolders!Address2) Then
AttorneyRec2 = rsLienHolders!Address & ", " & rsLienHolders!Address2
Else
AttorneyRec2 = rsLienHolders!Address
End If

End If
rsLienHolders.Close

End Function

Public Function AttorneyRec3()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE Creditors.[ta-do] = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
AttorneyRec3 = ""
Else
AttorneyRec3 = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
End If

rsLienHolders.Close

End Function
Public Function DOASecParty()

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1 Then
DOASecParty = UCase(Client())
ElseIf Not IsNull(Forms![foreclosure database screen]!servicer) And _
(Forms![foreclosure database screen]![aitno_servicer] = 1 Or _
Forms![foreclosure database screen]![aitno_servicer] = -1) Then
DOASecParty = UCase(Forms![foreclosure database screen]!servicer)
Else


DOASecParty = UCase(LSecured())
End If


Else

If Client() Like "Seteru*" Then

DOASecParty = "Federal National Mortgage Association"


ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then

DOASecParty = Client() & ", authorized by " & LoanInvestor() & " to be the holder of the Note for purposes of foreclosure, "

Else


If Forms![foreclosure database screen]![Fmortgage] = -1 Or _
[Forms]![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]!SPsameasCl = -1 Then
D1 = Trim(UCase(LSecured()))
D2 = " (" & """" & Trim(UCase(Forms![foreclosure database screen]![SecuredParty])) & """" & "),"
ElseIf Forms![foreclosure database screen]![SecuredParty] = "" Or _
IsNull(Forms![foreclosure database screen]![SecuredParty]) Then
D1 = Trim(UCase(Client()))
D2 = ""
Else
D1 = Trim(UCase(Client())) & ", servicer for "
D2 = LSecured() & " (" & """" & Trim(UCase(Forms![foreclosure database screen]![SecuredParty])) & """" & "),"
End If

DOASecParty = D1 + D2
End If

End If

End Function

Public Function FHAWeekly()
CurrentDb.Execute "Delete * from FHATable;", dbFailOnError
DoCmd.OpenQuery ("FHAWeeklyAppend")

End Function
Public Function DSNewRef()

CurrentDb.Execute "Delete * from WellsVol;", dbFailOnError

DoCmd.OpenQuery ("WellsVolume")
DoCmd.OpenQuery ("WellsVolume2")
DoCmd.OpenQuery ("WellsVolume3")
DoCmd.OpenQuery ("WellsVolume6")

DoCmd.OpenReport "DS New Referrals", acViewPreview

End Function
Public Function WellsVol()
CurrentDb.Execute "Delete * from WellsVol;", dbFailOnError
 

DoCmd.OpenQuery ("WellsVolume")
DoCmd.OpenQuery ("WellsVolume2")
DoCmd.OpenQuery ("WellsVolume3")
DoCmd.OpenQuery ("WellsVolume6")
DoCmd.OpenQuery ("WellsVolume7")

DoCmd.OpenReport "Wells Volume", acViewPreview


End Function
Public Function WellsVolumeALL()
CurrentDb.Execute "Delete * from WellsVol;", dbFailOnError

DoCmd.OpenQuery ("WellsVolume")
DoCmd.OpenQuery ("WellsVolume2")
DoCmd.OpenQuery ("WellsVolume3")
DoCmd.OpenQuery ("WellsVolume4")
DoCmd.OpenQuery ("WellsVolume5")

Vname = (Format$(Now(), "mmddyyyyhhnnss"))
ExcelSaveAsQRY ("WellsVolumeALLQRY")
ExcelSaveAsQRY ("WellsVolumeQRYEvic")
End Function
Public Function IntakeTran()
Dim VarSel
VarSel = InputBox("1. Secured Party" & vbCr & "2. Client/Servicer" & vbCr & "3. Other: type in name")
If VarSel = 1 Then
IntakeTran = LSecured()
ElseIf VarSel = 2 Then
IntakeTran = Client()
ElseIf VarSel = 3 Then
IntakeTran = InputBox("Type in Grantee(s)")
End If
'MsgBox (IntakeTran)

End Function
Public Function IntakeSRT()
Dim VarRup
Dim vartax
vartax = Rtax / 1000

VarRup = Format(RoundUP((Reports![intakesheet-presale]!MotPrinbal - Reports![intakesheet-presale]!PreModUPB) / 500) * 500, "$###,##0.00")
IntakeSRT = Format(VarRup * vartax, "$###,##0.00")


End Function
Public Function IntakeSRTPrint()
Dim VarRup

VarRup = Format(RoundUP((Reports![intakesheet-presale]!MotPrinbal - Reports![intakesheet-presale]!PreModUPB) / 500) * 500, "$###,##0.00")

IntakeSRTPrint = Format(Reports![intakesheet-presale]!MotPrinbal, "$###,##0.00") & " - " & Format(Reports![intakesheet-presale]!PreModUPB, "$###,##0.00") & " = " & Format((Reports![intakesheet-presale]!MotPrinbal - Reports![intakesheet-presale]!PreModUPB), "$###,##0.00") & " round to the nearest 500: " & VarRup & " X " & Rtax() / 1000 & " (" & County() & ") = " & Format(VarRup * (Rtax() / 1000), "$###,##0.00")

End Function

Public Function EmployeeScreen()

Dim Psswd
Psswd = InputBox("Enter Password to open Employee Screen")
If Psswd = "newhire" Then
DoCmd.OpenForm ("Employee Info")
Else
MsgBox ("Incorrect Password")
End If


End Function
Public Function EmployeeCheck()

Do While Vini = ""
Vini = Environ("username")

strsql = "select * from employees where login = " & """" & Vini & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsEmp.EOF Then
MsgBox ("Login not in Foreclosure employee table")
Vini = ""
Else
If Not IsNull(rsEmp!MiddleName) Then
EmployeeCheck = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
EmployCheck = rsEmp!FirstName & " " & rsEmp!LastName
End If
End If
Loop
rsEmp.Close

End Function
Public Function HoldersDES()
If Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1 Or _
Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Then
MsgBox ("This is a 3rd Party File. Holder's Designation will not print out!")
Else
DoCmd.OpenReport "Rule14-HoldersDesignation", acViewPreview
End If


End Function
Public Function SecondCircuit()

If Forms![foreclosure database screen]!Propertycounty = "Talbot" _
Or Forms![foreclosure database screen]!Propertycounty = "Queen Anne's" _
Or Forms![foreclosure database screen]!Propertycounty = "Caroline" _
Or Forms![foreclosure database screen]!Propertycounty = "Kent" _
Or Forms![foreclosure database screen]!Propertycounty = "Cecil" Then
SecondCircuit = 1
Else
SecondCircuit = 0
End If

End Function
Public Function ChaseFileDIL()
Dim strsql As String
Dim rs As RecordSet
Dim Vname

strsql = "SELECT Clients.OrganizationName, Cases.FileNum FROM Cases INNER JOIN Clients ON Cases.Client = Clients.OrganizationName WHERE Cases.FileNum = " & [Forms]![DILForm]![filenum]
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
Vname = rs!OrganizationName
rs.Close


If Vname Like "EMC*" Or _
Vname Like "JPM*" Or _
Vname Like "JP M*" Or _
Vname Like "Washington M*" Or _
Vname Like "Chase*" Then
ChaseFileDIL = 1
Else
ChaseFileDIL = 0
End If
End Function
Public Function ChaseFile()
If Forms![foreclosure database screen]!Client Like "EMC*" Or _
Forms![foreclosure database screen]!Client Like "JPM*" Or _
Forms![foreclosure database screen]!Client Like "JP M*" Or _
Forms![foreclosure database screen]!Client Like "Washington M*" Or _
Forms![foreclosure database screen]!Client Like "Chase*" Then
ChaseFile = 1
Else
ChaseFile = 0
End If

End Function

Public Function ReqStay()
DoCmd.OpenReport "RequestToStay", acViewPreview
DoCmd.OpenReport "OrderToStay", acViewPreview
DoCmd.OpenReport "CertRequest", acViewPreview

End Function
Public Function MotionDismiss()
If Forms![foreclosure database screen]!Propertycounty = "Prince George's" Then
DoCmd.OpenReport "Motion_DismissPG", acViewPreview

Else
DoCmd.OpenReport "Motion_Dismiss", acViewPreview
DoCmd.OpenReport "Motion_Dismiss_Order", acViewPreview
End If

End Function

Public Function AssTest()
Dim VPss
VPss = InputBox("password protected input password please")
If VPss = "3016511982" Then
DoCmd.OpenReport "AssignmentDOT", acViewPreview
End If

End Function
Public Function Part2Cert()
Dim VDoc
VDoc = InputBox("Name of Document or Return for Default (REPORT OF SALE AND ALL ACCOMPANYING DOCUMENT)")
If VDoc <> "" Then
Part2Cert = VDoc
Else
Part2Cert = "REPORT OF SALE AND ALL ACCOMPANYING DOCUMENTS"
End If

End Function
Public Function OnHold()

MsgBox ("This Function is on hold temporarily.")
Exit Function



End Function
Public Function AffDebtSelection()
Dim VSel As Integer

If Forms![foreclosure database screen]!Client Like "JPM*" Then
DoCmd.OpenReport "StatementofDebtMd-Blank-JPM", acViewPreview

ElseIf Forms![foreclosure database screen]!Client Like "HSBC*" Then
DoCmd.OpenReport "StatementofDebtMD-HSBC", acViewPreview

ElseIf Forms![foreclosure database screen]!Client Like "Nations Def*" And _
Forms![foreclosure database screen]!servicer Like "Fifth Thir*" Then
DoCmd.OpenReport "AffDebtBLANK-FifthThird", acViewPreview

ElseIf Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
DoCmd.OpenReport "AffDebtClient-BAC-BLANK", acViewPreview

ElseIf (Forms![foreclosure database screen]!Client Like "OneWest*" And (Forms![foreclosure database screen]!FF = -1 Or _
Forms![foreclosure database screen]!FF = 1)) Then
DoCmd.OpenReport "AffDebtClient-OWB-BLANK", acViewPreview

Else

VSel = InputBox("1. Executing In House" & vbCr & "2. Client Signs" & vbCr & vbCr & "input 1 or 2")
If VSel = 1 Then
DoCmd.OpenReport "StatementofDebtMDOLD", acViewPreview

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" And (Forms![foreclosure database screen]!prime_nonprime = 2 Or Forms![foreclosure database screen]!prime_nonprime = 1) Then
DoCmd.OpenReport "StatementofDebtMD-OcwenHomeward", acViewPreview
DoCmd.OpenReport "Ocwen_Maryland_Transition_Aff", acViewPreview

Else
DoCmd.OpenReport "StatementofDebtMD", acViewPreview
End If


End If



End Function
Public Function LoanMask2()
LoanMask2 = "xxx-xx-xx" & Right(Forms![foreclosure database screen]!ClientRefNumber, 2)
End Function
Public Function DCPostponeSale()
Dim VOldSale As Date
Dim VNewSale As Date
Dim Vreason As String
Dim Vini As String
Dim Vname As String

Dim rstjournal As RecordSet
Dim rsEmp As RecordSet

VOldSale = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
VNewSale = InputBox("Enter New Sale Date")
Vreason = InputBox("Enter Reason for Postponement")

Do While (VNewSale >= Format(VOldSale + 30, "mm/dd/yy"))
MsgBox ("New Sale Date Can NOT be over 30 days from previous Sale Date.  Please Reenter")
VNewSale = InputBox("Enter New Sale Date")
Loop

Do While Vini = ""
Vini = Environ("username")

strsql = "select * from employees where login = " & """" & Vini & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsEmp.EOF Then
MsgBox ("Login not in Foreclosure employee table")
Vini = ""
Else
If Not IsNull(rsEmp!MiddleName) Then
Vname = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
Vname = rsEmp!FirstName & " " & rsEmp!LastName
End If
End If
Loop
rsEmp.Close

Dim VPsswd
VPsswd = InputBox("If you are ready to update screen/memo section and send email please type in password")
If VPsswd = "stef" Then
Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate = VNewSale
Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad] = VNewSale - 10
Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime = Null

Set rstjournal = CurrentDb.OpenRecordset("Journal", dbOpenDynaset, dbSeeChanges)
With rstjournal
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!EntryBy = Environ("username")
!EntryDate = Now()
!Entry = "Sale Date Postponed from : " & VOldSale & " TO " & VNewSale & " New Ad: " & VNewSale - 10 & " By:" & Vname & " Reason: " & Vreason
.Update
End With
rstjournal.Close



Dim VBody
VBody = "Today's Date: " & Now() & vbCr & vbCr & _
"LOAN NUMBER: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & vbCr & _
"PROPERTY ADDRESS: " & PROP() & vbCr & vbCr & _
"POSTPONED BY: " & Vname & vbCr & vbCr & _
"POSTPONE FROM: " & VOldSale & "TO: " & VNewSale & vbCr & vbCr & _
"(not to exceed 30 days from original sale date)"

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim varemailto, varemailcc As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "dccancellations@alexcooper.com; CancelSaleDC@bww-law.com; brad.dragoon@bww-law.com"
MyMail.body = VBody & SigEmail()
MyMail.Subject = "Sale Postponed for: " & PROP() & "/BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

If Forms![foreclosure database screen].Dirty = True Then
DoCmd.RunCommand acCmdRefresh
End If

Else
MsgBox ("Incorrect Password will exit")

End If


End Function
Public Function NewspaperMD()
If Forms![foreclosure database screen]![Propertycounty] = "Frederick" And Forms![foreclosure database screen]![PropertyState] = "MD" Then
NewspaperMD = "THE WASHINGTON POST"
ElseIf Forms![foreclosure database screen]![Propertycounty] = "Montgomery" And _
Forms![foreclosure database screen]!ForeclosureSubForm.Form![SaleDate] < #9/22/2010# Then
NewspaperMD = "WASHINGTON TIMES"
Else
Dim strsql
Dim rs As RecordSet

strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)

NewspaperMD = rs!Newspaper
rs.Close

End If


End Function
Public Function DateENG(VDayDue)

If VDayDue = 1 Then
DateENG = "first"
ElseIf VDayDue = 2 Then
DateENG = "second"
ElseIf VDayDue = 3 Then
DateENG = "third"
ElseIf VDayDue = 4 Then
DateENG = "fourth"
ElseIf VDayDue = 5 Then
DateENG = "fifth"
ElseIf VDayDue = 6 Then
DateENG = "sixth"
ElseIf VDayDue = 7 Then
DateENG = "seventh"
ElseIf VDayDue = 8 Then
DateENG = "eighth"
ElseIf VDayDue = 9 Then
DateENG = "ninth"
ElseIf VDayDue = 10 Then
DateENG = "tenth"
ElseIf VDayDue = 11 Then
DateENG = "eleventh"
ElseIf VDayDue = 12 Then
DateENG = "twelfth"
ElseIf VDayDue = 13 Then
DateENG = "thirteenth"
ElseIf VDayDue = 14 Then
DateENG = "fourteenth"
ElseIf VDayDue = 15 Then
DateENG = "fifteenth"
ElseIf VDayDue = 16 Then
DateENG = "sixteenth"
ElseIf VDayDue = 17 Then
DateENG = "seventeenth"
ElseIf VDayDue = 18 Then
DateENG = "eighteenth"
ElseIf VDayDue = 19 Then
DateENG = "nineteenth"
ElseIf VDayDue = 20 Then
DateENG = "twentieth"
ElseIf VDayDue = 21 Then
DateENG = "twenty-first"
ElseIf VDayDue = 22 Then
DateENG = "twenty-second"
ElseIf VDayDue = 23 Then
DateENG = "twenty-third"
ElseIf VDayDue = 24 Then
DateENG = "twenty-fourth"
ElseIf VDayDue = 25 Then
DateENG = "twenty-fifth"
ElseIf VDayDue = 26 Then
DateENG = "twenty-sixth"
ElseIf VDayDue = 27 Then
DateENG = "twenty-seventh"
ElseIf VDayDue = 28 Then
DateENG = "twenty-eighth"
ElseIf VDayDue = 29 Then
DateENG = "twenty-ninth"
ElseIf VDayDue = 30 Then
DateENG = "thirtieth"
ElseIf VDayDue = 31 Then
DateENG = "thirty-first"
End If


End Function

Public Function PerDiemCalc()
Call Shell("excel.exe \\rvdv-fs01\datatransfer\PerDiemCalc.xls")
End Function
Public Function SBL()
SBL = "NO DEBT COLLECTION ATTEMPT WILL BE MADE IN VIOLATION OF THE AUTOMATIC STAY OF 11 U.S.C. SECTION 362(a), OR OF ANY BANKRUPTCY DISCHARGE OR BANKRUPTCY COURT ORDER"
End Function
Public Function AffPkg()
Call AddToFCTracking

If Client() Like "Bank of A*" _
Or Client() Like "JP*" Or Client() Like "Resident*" Then
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\ChaseLMAAttachment.PDF")

DoCmd.OpenReport "AffPackage-NoCaption", acViewPreview
VConvRpt = "Affpackage-NoCaption"
Else
DoCmd.OpenReport "AffPackage", acViewPreview
VConvRpt = "Affpackage"

End If

'VConvRpt = "Affpackage"
Call ConvertPDFALL


End Function
Public Function FinalLossMitAff()

Call AddToFCTracking

If Client() Like "Bank of A*" _
Or Client() Like "JP*" Or Client() Like "Resident*" Then
'Attachment for JPMorgan: \\rvdv-fs01\Attachments\ChaseLMA-Attachment.pdf
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\ChaseLMAAttachment.PDF")

DoCmd.OpenReport "Final Loss Mit Aff-NoCaption", acViewPreview
Else
DoCmd.OpenReport "Final Loss Mit Aff", acViewPreview
End If

vsent = MsgBox("The Database will NOW update the Final Aff Sent date, continue?", vbYesNo)

If vsent = vbYes Then
DoCmd.OpenQuery "Faffsent"
Else
Exit Function
End If

End Function
Public Function PreLossMitAff()

Call AddToFCTracking

If Client() Like "Bank of A*" Or Client() Like "Resident*" Then


DoCmd.OpenReport "Preliminary Loss Mit Aff-NoCaption", acViewPreview
ElseIf Client() Like "JPM*" Then
Call RunLMA
Else
DoCmd.OpenReport "Preliminary Loss Mit Aff", acViewPreview
End If

vsent = MsgBox("The Database will NOW update the Preliminary Aff Sent date, continue?", vbYesNo)

If vsent = vbYes Then
DoCmd.OpenQuery "Paffsent"
Else
Exit Function
End If
End Function
Public Function NoticeReviewed()
Dim VPsswd
VPsswd = InputBox("Password Required")
If VPsswd <> "Reese" Then
MsgBox ("Incorrect Password")
Exit Function

Else

DoCmd.OpenReport "NoticesReviewed", acViewPreview
End If

End Function
Public Function NoticesCompleted()

Dim VPsswd
VPsswd = InputBox("Password Required")
If VPsswd <> "Reese" Then
MsgBox ("Incorrect Password")
Exit Function

Else

DoCmd.OpenReport "NoticesCompleted", acViewPreview
End If


End Function
Public Function AffNoticeMail()
If [Forms]![foreclosure database screen]![Propertycounty] = "Prince George's" Or _
[Forms]![foreclosure database screen]![Propertycounty] = "Montgomery" Or _
[Forms]![foreclosure database screen]![Propertycounty] = "Queen Anne's" Or _
[Forms]![foreclosure database screen]![Propertycounty] = "Calvert" Or _
[Forms]![foreclosure database screen]![Propertycounty] = "Caroline" Then
DoCmd.OpenReport "Rule14-206(b)PG", acViewPreview
Else
DoCmd.OpenReport "Rule14-206(b)", acViewPreview
End If
End Function

Public Function SalesPRIOR() As String

Dim rs As RecordSet
Dim strsql As String
Dim VPrior As String
Dim VDate

strsql = "select saledate from resumes where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

VPrior = "Prior Sales: "

Do While Not rs.EOF
If Not IsNull(rs!SaleDate) Then
VDate = Format(rs!SaleDate, "mmmm dd, yyyy")
SalesPRIOR = SalesPRIOR + VDate + " / "
End If

rs.MoveNext
Loop

If SalesPRIOR <> "" Then
SalesPRIOR = VPrior & SalesPRIOR
End If

End Function

Public Function MDSetSalesPRIOR() As String

Dim rs As RecordSet
Dim strsql As String
Dim VPrior As String
Dim VDate

strsql = "select saledate from resumes where filenum = " & Reports![Auct-MDAttachSSS]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

VPrior = "Prior Sales: "

Do While Not rs.EOF
If Not IsNull(rs!SaleDate) Then
VDate = Format(rs!SaleDate, "mmmm dd, yyyy")
MDSetSalesPRIOR = MDSetSalesPRIOR + VDate + " / "
End If

rs.MoveNext
Loop

If MDSetSalesPRIOR <> "" Then
MDSetSalesPRIOR = VPrior & MDSetSalesPRIOR
End If

End Function

Public Function FALenderAttorney()
Dim VSend
VSend = InputBox("Deliver to: " & vbCr & "1. Lender" & vbCr & "2. BWW" & vbCr & "type 1 or 2")
If VSend = 1 Then
FALenderAttorney = "Lender: " & Client() & " with offices located at " & ClientAdd() & " along with the original of this document fully executed and notarized.  "
Else
FALenderAttorney = "Lender's attorneys:  BWW Law Group, LLC with offices located at 6003 Executive Blvd. Suite 101, Rockville, MD 20852 along with the original of this document fully executed and notarized.  "
End If

End Function

Public Function hudoccltrsQUEUE()


    Dim VSend
    VSend = InputBox("Send Hud Occupancy Letters to Walz? type YES to send")
    
    If VSend = "yes" Then
    
    VConvRpt = "Fairdebt-HUD-Queue"
    Call ConvertPDFALL
   ' Call ImageHud

   
        CopyDocToBGWWDocs "Fairdebt-HUD-Queue", "HudOccLtr", "_HudOccLtr.PDF"

strsql = "select * from foreclosure where subfilenum = " & Forms![HOC Queue]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then
    With rs
    .Edit
    !Hoc_Sent = Date
   .Update
   .Close
   End With
End If
      
    Call HudOccQueue
        
    Else
    
        DoCmd.OpenReport "Fairdebt-HUD-Queue", acViewPreview
        Dim VPrtDocs
    VPrtDocs = MsgBox("Hud Occupancy Attachments will print out, continue", vbYesNo)
    If VPrtDocs = vbYes Then
    'PrintDoc ("\\rvdv-fs01\datatransfer\attachments\HUDAttachment1.doc")
    PrtPDF ("\\rvdv-fs01\datatransfer\attachments\HUDAttachment.pdf")
    End If

    End If

End Function

Public Function hudoccltrs()

strsql = "Select * from litigation where subfilenum = " & GblFilenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not IsNull(rs!fdcpa_recd) And (IsNull(rs!fdcpa_sent) And IsNull(rs!NoDebtReq)) Then
MsgBox ("This task cannot be completed at this time because there is an outstanding FDCPA dispute of the debt. Please contact the assigned attorney on the litigation screen?s QWR/FDCPA tab to check the status of the response.")
rs.Close
Set rs = Nothing
Exit Function


Else
rs.Close
Set rs = Nothing
'MsgBox (Forms![foreclosure database screen]!TypeOfLoan)


If (Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or _
(Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1)) Then

If Forms![foreclosure database screen]!Client Like "Champi*" Then
MsgBox ("HUD Occupancy Letter will not generate for " & Forms![foreclosure database screen]!Client & ", please see Allison or Wendy regarding same")
Exit Function
End If

    Dim VSend
    If Forms![foreclosure database screen]!TypeOfLoan = "FHA/REV" Then
    
    Else
    
    VSend = InputBox("Send Hud Occupancy Letters to Walz? type YES to send")
    
    If VSend = "yes" Then
    
If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
    VConvRpt = "Fairdebt-Hud-VA"
     Call ConvertPDFALL
    CopyDocToBGWWDocs "Fairdebt-HUD-VA", "HudOccLtr", "_HudOccLtr.PDF"

    Else
    VConvRpt = "Fairdebt-HUD"
     Call ConvertPDFALL
    CopyDocToBGWWDocs "Fairdebt-HUD", "HudOccLtr", "_HudOccLtr.PDF"

    End If
    
   
strsql = "select * from foreclosure where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then
    With rs
    .Edit
    !Hoc_Sent = Date
   .Update
   .Close
   End With
End If
      
Call HudOcc

mySendKeys ("{F9}")

'Attached is HUD Letter
'Email to Carlene re: Hud Occ Ltr
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim varemailto, varemailcc As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms![foreclosure database screen]!PropertyState = "VA" And Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
MyMail.To = "Rodney.Sandidge@bww-law.com"
Else
MyMail.To = "HUDOccUploads@bww-law.com"
End If

MyMail.body = "Client: " & Client() & vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "FHA#: " & Forms![foreclosure database screen]![HUD/VA Num] & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.Subject = "Attached is HUD Letter"

If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
MyMail.Attachments.ADD pathuser() & "\Fairdebt-HUD-VA.PDF"
Else
MyMail.Attachments.ADD pathuser() & "\Fairdebt-HUD.PDF"
End If

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
        
Else
    
If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
DoCmd.OpenReport "Fairdebt-HUD-VA", acViewPreview
Else
DoCmd.OpenReport "Fairdebt-HUD", acViewPreview
End If

Dim VPrtDocs
VPrtDocs = MsgBox("Hud Occupancy Attachments will print out, continue", vbYesNo)
If VPrtDocs = vbYes Then
'PrintDoc ("\\rvdv-fs01\datatransfer\attachments\HUDAttachment1.doc")
PrtPDF ("\\rvdv-fs01\datatransfer\attachments\HUDAttachment.pdf")
End If
End If
End If
    
Else
    MsgBox ("Not an FHA loan")
End If

End If

End Function

Public Function hudocc1()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudocc1 = "Richmond HUD Field Office"
Else
hudocc1 = "D.C. HUD Field Office"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudocc1 = "D.C. HUD Field Office"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudocc1 = "D.C. HUD Field Office"
Else
hudocc1 = "Baltimore HUD Field Office"

End If

End If

End Function
Public Function hudocc2()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudocc2 = "600 East Broad Street"
Else
hudocc2 = "820 First Street, NE"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudocc2 = "820 First Street, NE"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudocc2 = "820 First Street, NE"
Else
hudocc2 = "Crescent City Building"

End If

End If


End Function

Public Function hudocc3()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudocc3 = "Third Floor"
Else
hudocc3 = "Suite 300"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudocc3 = "Suite 300"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudocc3 = "Suite 300"
Else
hudocc3 = "10 S. Howard St., Fifth Floor"

End If

End If


End Function


Public Function hudocc4()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudocc4 = "Richmond, VA  23219"
Else
hudocc4 = "Washington, DC  20002"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudocc4 = "Washington, DC  20002"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudocc4 = "Washington, DC  20002"
Else
hudocc4 = "Baltimore, MD  21201-2505"

End If

End If


End Function

Public Function hudoccCITY()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudoccCITY = "Richmond"
Else
hudoccCITY = "Washington"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudoccCITY = "Washington"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudoccCITY = "Washington"
Else
hudoccCITY = "Baltimore"

End If

End If


End Function


Public Function hudoccSTATE()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudoccSTATE = "VA"
Else
hudoccSTATE = "DC"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudoccSTATE = "DC"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudoccSTATE = "DC"
Else
hudoccSTATE = "MD"

End If

End If


End Function

Public Function hudoccZIP()

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

If Forms![foreclosure database screen]!Propertycounty <> "City of Alexandria" And _
Forms![foreclosure database screen]!Propertycounty <> "Fairfax" And _
Forms![foreclosure database screen]!Propertycounty <> "Arlington" And _
Forms![foreclosure database screen]!Propertycounty <> "Prince William" And _
Forms![foreclosure database screen]!Propertycounty <> "Loudoun" Then
hudoccZIP = "23219"
Else
hudoccZIP = "20002"
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
hudoccZIP = "20002"

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Prince Georges" Then
hudoccZIP = "20002"
Else
hudoccZIP = "21201-2505"

End If

End If


End Function

Public Function ReferralEV()
 
Dim BegDate As Date
Dim EndDate As Date
Dim vClient As String
Dim Cdb As Database
Dim CasesT As RecordSet
Dim ForeT As RecordSet
Dim Cstrsql As String
Dim Fstrsql As String
Dim NCRpt As RecordSet
Dim VStatus As String

CurrentDb.Execute "Delete * from newcasesrpt;", dbFailOnError

DoCmd.OpenQuery "EvictionReferrals"

CurrentDb.Execute "Delete * from NewRefQry;", dbFailOnError
DoCmd.OpenQuery ("NewRefEVQry")

 

End Function

Public Function ReferralFC()
 
Dim BegDate As Date
Dim EndDate As Date
Dim vClient As String
Dim Cdb As Database
Dim CasesT As RecordSet
Dim ForeT As RecordSet
Dim Cstrsql As String
Dim Fstrsql As String
Dim NCRpt As RecordSet
Dim VStatus As String


BegDate = InputBox("Enter Beginning Date")
EndDate = InputBox("Enter Ending Date")
Dim VRec
VRec = InputBox("1. Referrals Only" & vbCr & "2. Referrals AND Restarts")

Set Cdb = CurrentDb()
CurrentDb.Execute "Delete * from Newcasesrpt;", dbFailOnError

If VRec = 2 Then

Cstrsql = ("Select * from Cases where [date recieved] >= #" & BegDate & "# and [date recieved] <=#" & EndDate & "# or resume_recd >= #" & BegDate & "# and resume_recd <= #" & EndDate & "#")
Else
Cstrsql = ("Select * from Cases where [date recieved] >= #" & BegDate & "# and [date recieved] <=#" & EndDate & "#")
End If

Set CasesT = Cdb.OpenRecordset(Cstrsql, dbOpenSnapshot)

Set NCRpt = Cdb.OpenRecordset("NewCasesRpt", dbOpenDynaset, dbSeeChanges)

While Not CasesT.EOF
With NCRpt
.AddNew
!filenum = CasesT!filenum
!ClientRefNumber = CasesT![ClientRefNumber]
!LastNameDebtor1 = CasesT![LastNameDebtor1]
!PropAddress = CasesT![PropAddress]
!PropertyState = CasesT![PropertyState]
!LastNameDebtor1 = CasesT!LastNameDebtor1
!FirstNameDebtor1 = CasesT!FirstNameDebtor1
!LastNameDebtor2 = CasesT!LastNameDebtor2
!FirstNameDebtor2 = CasesT!FirstNameDebtor2
![Date Recieved] = CasesT![Date Recieved]
!resume_recd = CasesT!resume_recd
![Client] = CasesT!Client
!BegDate = BegDate
!EndDate = EndDate
.Update
End With
CasesT.MoveNext
Wend


CurrentDb.Execute "Delete * from NewRefQry;", dbFailOnError
DoCmd.OpenQuery ("NewRefFCQry")

 

End Function
Public Function AuctMdCT()

'If Forms![foreclosure database screen]!PropertyCounty = "Anne Arundel" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].Form!Corp_Trus = -1 Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].Form!Corp_Trus = 1 Then

If Forms![foreclosure database screen]![ForeclosureSubForm].[Form].[POSCTD] = "POS" Then
AuctMdCT = "Corporate Trustee: Case#: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo & ": Power of Sale - Assignee"
ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].[Form].[POSCTD] = "CTD" Then
AuctMdCT = "Corporate Trustee: Case#: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo & ": Power of Sale - Decree"
Else
AuctMdCT = "Corporate Trustee: Case#: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo & ": Power of Sale"
End If

Else
AuctMdCT = ""
End If

'End If

End Function

Public Function referraldate()

If IsNull(Forms![foreclosure database screen]!resume_recd) Then
referraldate = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd, yyyy")
Else
referraldate = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd, yyyy")


End If


End Function
Public Function LineDismiss()

DoCmd.RunMacro "coverlinemacro"

Dim VSel
VSel = InputBox("Do you want to clear docket fields?  If yes please enter password to proceed")
If VSel = "proceed" Then
Call DelDocket
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim varemailto, varemailcc As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Eddie.Kutz@trioservices.net"
MyMail.body = "Line of dismissal has been filed; please review this case for DOCKET SERVED field and remove fields accordingly."
MyMail.Subject = PROP() & "/BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
Else
MsgBox ("Incorrect password, will not clear fields!")
Exit Function
End If


End Function
Public Function WellsLang()

If Forms![foreclosure database screen]!Asc_wff = 1 And _
(Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl)) And _
(Forms![foreclosure database screen]!SPsigns = 0 Or IsNull(Forms![foreclosure database screen]!SPsigns)) Then

WellsLang = ", by the authorized agent of " & Forms![foreclosure database screen]![signature block]
Else

If (Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl)) And _
(Forms![foreclosure database screen]!SPsigns = 0 Or IsNull(Forms![foreclosure database screen]!SPsigns)) Then
WellsLang = ", by authorized agent of " & Client() & "."
Else
WellsLang = ", by " & LSecured() & "."
End If
End If

End Function
Public Function DOANotaryHomEq()

If Forms![foreclosure database screen]!Client Like "wells*" Then

If Forms![foreclosure database screen]!Asc_wff = 1 And _
(Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl)) And _
(Forms![foreclosure database screen]!SPsigns = 0 Or IsNull(Forms![foreclosure database screen]!SPsigns)) Then

DOANotaryHomEq = "__________________________________________, for " & Forms![foreclosure database screen]![signature block] & " for " & LSecured() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."

Else

If (Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl)) And _
(Forms![foreclosure database screen]!SPsigns = 0 Or IsNull(Forms![foreclosure database screen]!SPsigns)) Then
DOANotaryHomEq = "__________________________________________, authorized agent of " & Client() & " servicing agent for " & LSecured() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
Else
DOANotaryHomEq = "__________________________________________, for " & LSecured() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
End If

End If

Else
DOANotaryHomEq = "__________________________________________, Assistant Secretary for " & Forms![foreclosure database screen]![signature block] & " for " & LSecured() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
End If

End Function
Public Function DOANotaryOcwen() As String

Dim v1, v2, V3a, V3, V4, V5, VSpSigns, VSPSameAsClient

VSpSigns = Forms![foreclosure database screen]![SPsigns]
VSPSameAsClient = Forms![foreclosure database screen]![SPsameasCl]

v1 = "________________________, ___________________"

If (VSpSigns = 0 Or IsNull(VSpSigns)) And (VSPSameAsClient = 0 Or IsNull(VSPSameAsClient)) Then
v2 = " for " & Client() & ", Authorized Servicer of "
Else
v2 = " for "
End If

V3 = LSecured() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."

DOANotaryOcwen = v1 + v2 + V3
'MsgBox (DOANotaryOcwen)

End Function

Public Function DateCalculator()
Dim VentDate As Date

VentDate = InputBox("Enter Date to Calculate From: ")
ventdays = InputBox("Enter Number of Days: ")

DateCalculator = VentDate + ventdays
MsgBox (DateCalculator)

End Function
Public Function MilAffAA()
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

vdebtor1 = firstdebtor()
vdebtor2 = secondDebtor()
vdebtor3 = thirddebtor()
vdebtor4 = fourthdebtor()
vdebtor5 = fifthdebtor()

GblFilenum = Forms![foreclosure database screen]!filenum

'No Military Active DNS is checked
If ([Forms]![foreclosure database screen]![DNS1] = -1 Or [Forms]![foreclosure database screen]![DNS1] = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor1 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
If vdebtor2 <> "" Then
If ([Forms]![foreclosure database screen]!DNS2 = -1 Or [Forms]![foreclosure database screen]!DNS2 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor2 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor3 <> "" Then
If ([Forms]![foreclosure database screen]!DNS3 = -1 Or [Forms]![foreclosure database screen]!DNS3 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor3 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor4 <> "" Then
If ([Forms]![foreclosure database screen]!DNS4 = -1 Or [Forms]![foreclosure database screen]!DNS4 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor4 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor5 <> "" Then
If ([Forms]![foreclosure database screen]!dns5 = -1 Or [Forms]![foreclosure database screen]!dns5 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor5 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If

'No Military Active DNS is UNchecked
If ([Forms]![foreclosure database screen]![DNS1] = 0 Or IsNull([Forms]![foreclosure database screen]![DNS1])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor1 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
If vdebtor2 <> "" Then
If ([Forms]![foreclosure database screen]![DNS2] = 0 Or IsNull([Forms]![foreclosure database screen]![DNS2])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor2 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor3 <> "" Then
If ([Forms]![foreclosure database screen]![DNS3] = 0 Or IsNull([Forms]![foreclosure database screen]![DNS3])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor3 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor4 <> "" Then
If ([Forms]![foreclosure database screen]![DNS4] = 0 Or IsNull([Forms]![foreclosure database screen]![DNS4])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor4 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor5 <> "" Then
If ([Forms]![foreclosure database screen]![dns5] = 0 Or IsNull([Forms]![foreclosure database screen]![dns5])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor5 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If

vowner1 = owner1()
vowner2 = owner2()
vowner3 = owner3()
If vowner1 <> "" Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner1 & """" & ", " & GblFilenum & ", " & 0 & ")"
CurrentDb.Execute sql
End If
If vowner2 <> "" Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner2 & """" & ", " & GblFilenum & ", " & 0 & ")"
CurrentDb.Execute sql
End If
If vowner3 <> "" Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner3 & """" & ", " & GblFilenum & ", " & 0 & ")"
CurrentDb.Execute sql
End If



End Function
Public Function MilAffOLD()
Dim strsql As String
Dim rs As RecordSet
Dim VSel As Integer

If [Forms]![foreclosure database screen]![PropertyState] = "MD" Then

'And ([Forms]![foreclosure database screen]![PropertyCounty] = "Anne Arundel" Or [Forms]![foreclosure database screen]![PropertyCounty] = "Howard") Then

Call MilAffAA

If [Forms]![foreclosure database screen]![ForeclosureSubForm].Form!mil_active = 0 Or _
IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].Form!mil_active) Then

strsql = "select * from notices where extra = " & """" & "1" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
If Forms![foreclosure database screen]!Propertycounty = "Anne Arundel" Then

VSel = InputBox("1. Executing In House" & vbCr & "2. Client Signs" & vbCr & vbCr & "input 1 or 2")

If VSel = 1 Then
DoCmd.OpenReport "MilitaryAff-AA1", acPreview
Else
DoCmd.OpenReport "MilitaryAff-AA1CS", acPreview
End If

Else
VSel = InputBox("1. Executing In House" & vbCr & "2. Client Signs" & vbCr & vbCr & "input 1 or 2")

If VSel = 1 Then
DoCmd.OpenReport "MilitaryAff-1", acPreview
Else
DoCmd.OpenReport "MilitaryAff-1CS", acPreview

End If

End If
rs.Close
End If

strsql = "select * from notices where extra = " & """" & "3" & """" & " OR EXTRA = " & """" & "0" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
rs.Close

'DoCmd.OpenReport "MilitaryAff-AA3", acPreview
End If
Else

DoCmd.OpenForm ("MilAffScrn")
End If

Else

VSel = InputBox("1. Executing In House" & vbCr & "2. Client Signs" & vbCr & vbCr & "input 1 or 2")

If VSel = 1 Then

DoCmd.OpenReport "MilitaryAff", acPreview
Else
DoCmd.OpenReport "MilitaryAffCS", acPreview

End If

End If

End Function
Public Function MilAffDump()
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

vdebtor1 = firstdebtor()
vdebtor2 = secondDebtor()
vdebtor3 = thirddebtor()
vdebtor4 = fourthdebtor()
vdebtor5 = fifthdebtor()

GblFilenum = Forms![foreclosure database screen]!filenum

'No Military Active jfc_ is checked
If ([Forms]![foreclosure database screen]![Jfc_1] = -1 Or [Forms]![foreclosure database screen]![Jfc_1] = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor1 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
If vdebtor2 <> "" Then
If ([Forms]![foreclosure database screen]!Jfc_2 = -1 Or [Forms]![foreclosure database screen]!Jfc_2 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor2 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor3 <> "" Then
If ([Forms]![foreclosure database screen]!Jfc_3 = -1 Or [Forms]![foreclosure database screen]!Jfc_3 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor3 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor4 <> "" Then
If ([Forms]![foreclosure database screen]!Jfc_4 = -1 Or [Forms]![foreclosure database screen]!Jfc_4 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor4 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor5 <> "" Then
If ([Forms]![foreclosure database screen]!Jfc_5 = -1 Or [Forms]![foreclosure database screen]!Jfc_5 = 1) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor5 & """" & ", " & GblFilenum & ", " & 3 & ")"
CurrentDb.Execute sql
End If
End If

'No Military Active jfc_ is UNchecked
If ([Forms]![foreclosure database screen]![Jfc_1] = 0 Or IsNull([Forms]![foreclosure database screen]![Jfc_1])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor1 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
If vdebtor2 <> "" Then
If ([Forms]![foreclosure database screen]![Jfc_2] = 0 Or IsNull([Forms]![foreclosure database screen]![Jfc_2])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor2 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor3 <> "" Then
If ([Forms]![foreclosure database screen]![Jfc_3] = 0 Or IsNull([Forms]![foreclosure database screen]![Jfc_3])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor3 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor4 <> "" Then
If ([Forms]![foreclosure database screen]![Jfc_4] = 0 Or IsNull([Forms]![foreclosure database screen]![Jfc_4])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor4 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If
If vdebtor5 <> "" Then
If ([Forms]![foreclosure database screen]![Jfc_5] = 0 Or IsNull([Forms]![foreclosure database screen]![Jfc_5])) Then
sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vdebtor5 & """" & ", " & GblFilenum & ", " & 1 & ")"
CurrentDb.Execute sql
End If
End If

'vowner1 = owner1()
'vowner2 = owner2()
'vowner3 = owner3()
'If vowner1 <> "" Then
'sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner1 & """" & ", " & gblfilenum & ", " & 0 & ")"
'CurrentDb.Execute sql
'End If
'If vowner2 <> "" Then
'sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner2 & """" & ", " & gblfilenum & ", " & 0 & ")"
'CurrentDb.Execute sql
'End If
'If vowner3 <> "" Then
'sql = "INSERT INTO Notices (NoticeTo, filenum, extra) VALUES (" & """" & vowner3 & """" & ", " & gblfilenum & ", " & 0 & ")"
'CurrentDb.Execute sql
'End If



End Function



Public Function ProcLoc()

Dim rs As RecordSet
Dim strsql As String

strsql = "select * from ViewforFC where Login = " & """" & username() & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs!worksite) Then
ProcLoc = 1
Else
ProcLoc = rs!worksite
End If

rs.Close


End Function
Public Function LoanMask4()
Dim VLen

LoanMask4 = Right(Forms![foreclosure database screen]!ClientRefNumber, 4)

'MsgBox (LoanMask4)


End Function
Public Function LoanMask()
Dim VLen

VLen = Len(Forms![foreclosure database screen]!ClientRefNumber)
VLen = VLen - 4

LoanMask = Right(Forms![foreclosure database screen]!ClientRefNumber, VLen)
'MsgBox (LoanMask)


End Function

Function fncSetOption()
'Use 0 for single-click
'Use 1 for double-click
Application.SetOption "Ignore dde requests", 1
End Function
Public Function IsOpenForm(FrmName As String) As Boolean

If CurrentProject.AllForms(FrmName).IsLoaded Then
If Forms(FrmName).CurrentView > 0 Then IsOpenForm = True
End If

End Function
Public Function VAProcRpt()
VPsd = InputBox("Report is Password Protected.  Please enter")

If VPsd = "mmk" Then
DoCmd.OpenReport "Virginia Accountings PROCESSOR Report", acViewPreview
Else
MsgBox ("incorrect password")
End If

End Function
Public Function AssOLender()

VSel = MsgBox("Include MERS verbiage?", vbYesNo)
If VSel = vbYes Then
AssOLender = "Mortgage Electronic Registration Systems, Inc. acting solely as nominee for "
Else
AssOLender = ""
End If

End Function

Public Function ClosedRpt()
CurrentDb.Execute "Delete * from closedfilerpt;", dbFailOnError

DoCmd.OpenQuery ("closedfilesqry")
DoCmd.OpenQuery ("closedfilesqryCS")
DoCmd.OpenQuery ("closedfilesqryFC")
DoCmd.OpenQuery ("closedfilesqryPS")
DoCmd.OpenReport "Closed FIle Report", acViewPreview

End Function

Public Function ProcEV()
VProcEv = InputBox("Initials of Processor completing Declaration")
End Function


Public Function SaleDatePrep()
CurrentDb.Execute "Delete * from saledateprep;", dbFailOnError
DoCmd.OpenQuery ("SaleDatePrepAppend")
DoCmd.OpenQuery ("SaleDatePrepDOA")

End Function

Public Function IndyMovant()

IndyMovant = "OneWest Bank, FSB."
End Function
Public Function DeedNotRecordedPart2Filed()
 

CurrentDb.Execute "Delete * from DeedNotRecordedPart2Filed;", dbFailOnError
DoCmd.OpenQuery ("Part2TransfeeBilled")
DoCmd.OpenQuery ("Part2TransfeeNotBilled")

VSel = InputBox("1. Preview Table" & Chr((13)) & "2. Excel")
If VSel = 1 Then
DoCmd.OpenTable "DeedNotRecordedPart2Filed", acViewNormal


Else
ExcelSaveAsTBL ("DeedNotRecordedPart2Filed")

End If

End Function
Public Function DoSomething()
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("qryMISInvoiceBGW", dbOpenDynaset, dbseecharges)
Do While Not rs.EOF
With rs
.Edit
!ID = rs!ID + 1000
.Update
End With
rs.MoveNext
Loop

End Function
Public Function SNAPShot()
DoCmd.OutputTo acOutputReport, "EscrowCheckToClients-Complete", acFormatSNP, "C:\4closure\EscrowClientsCheck.snp"
End Function
Public Function FHAMonthlyInv()
MsgBox ("1. Run FNMAQueryFC query and send to Excel" & vbCr & "2. Open Monthly Inventory Excel Spreadsheet on f:\ drive" & vbCr & "3. Copy the excel from FNMAQueryFC into the Monthly Inventory" & vbCr & "4. Run FNMAQueryBK query dump to Excel" & vbCr & "5. Copy to Excel Monthly in BK tab" & vbCr & "6. Save spreadsheet as Monthly Inventory Report-MONTH.xls" & vbCr & "7. Email to Carrie")
End Function
Public Function MDAccountingScreen()
Dim strsql
Dim rsA, rs As RecordSet

strsql = "select * from MDAccounting where Filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Set rsA = CurrentDb.OpenRecordset("MDaccounting", dbOpenDynaset, dbSeeChanges)
With rsA
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!acc_taxes = 0
!acc_misc_amt2 = 0
!acc_misc_amt = 0
!acc_adv_nisi = 0
!acc_statement_amt = 0
!acc_adjust_Taxes = 0
!acc_total_proceeds = 0
!acc_total_expenses = 0
!acc_total_debt = 0
!acc_title = 0
!acc_recording = 0
!auc_sbp = 0
!acc_adv1m = 0
!acc_adv2m = 0
!acc_attorney = 0
!acc_trustee = 0
!nocalc = 0
!acc_misc_amt3 = 0
!acc_misc_amt4 = 0
!acc_misc_amt5 = 0
!acc_misc_amt6 = 0
!acc_attorneyfee = 0

If Forms![foreclosure database screen]!Propertycounty = "Charles" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Then
!acc_auditor_fee = 350
Else
!acc_auditor_fee = 0
End If

!acc_interest_funds = 0
!acc_misc_amt7 = 0
!acc_misc_amt8 = 0
!acc_filing = 0
!acc_servbymail = 0
!acc_auctfee = 0
!acc_adv = 0
!acc_bondprem = 0
!auc_comm = 0
.Update
.Close
End With
rs.Close
End If


'If Forms![foreclosure database screen]!PropertyCounty = "HOWARD" Then
'DoCmd.OpenForm ("AccountingMainHC")
'Else
DoCmd.OpenForm ("AccountingMain")
'End If


End Function
Public Function PurchaserAGENT()
If Forms![foreclosure database screen]!Propertycounty = "Dorchester" Or _
Forms![foreclosure database screen]!Propertycounty = "Worcester" Or _
Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
PurchaserAGENT = "David Simpson"
ElseIf trusteenoncooper Like "Michael Scott *" Then
PurchaserAGENT = "Debra A. Amyot"
Else
PurchaserAGENT = "Rachel Bayard"
End If

End Function
Public Function ComScreen()

Dim rs As RecordSet
Dim strsql As String

strsql = "select * from commitment where subfilenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("Commitment", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!SubFileNum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

DoCmd.OpenForm "Commitment Letter"

End Function

Public Function LossMitSpreadsheet()
DoCmd.OutputTo acOutputQuery, "CitiPilotLetter", acFormatXLS, pathuser() & "\LossMitPilotLetter.xls"
DoCmd.OutputTo acOutputQuery, "CitiPilotLetterUnpaid", acFormatXLS, pathuser() & "\LossMitPilotLetter-UnpaidBills.xls"

Call Shell("excel.exe c:\4closure\LossMitPilotLetter.xls")
DoCmd.OutputTo acOutputReport, "Bill-email-PilotLtr", acFormatSNP, pathuser() & "\LossMitPilotLetterBILLS.snp"

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = ""
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Attachments.ADD pathuser() & "\LossMitPilotLetterBILLS.snp"
MyMail.Attachments.ADD pathuser() & "\LossMitPilotLetter.xls"
MyMail.Attachments.ADD pathuser() & "\LossMitPilotLetter-UnpaidBills.xls"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

vupload = MsgBox("Update bills as sent?", vbYesNo)
If vupload = vbYes Then

DoCmd.OpenQuery ("CitiPilotLetterUPDATE")


End If


End Function

Public Function AttorneyVS()

Dim db As Database
Dim att As RecordSet
Dim AttorneyFull As String, Vattorney As String
Dim VselAtt As Integer

Vattorney = attorneycap()


If Vattorney Like "*Geesing" Then
AttorneyVS = "GEESING"
ElseIf Vattorney Like "*Bierman" Then
AttorneyVS = "BIERMAN"
ElseIf Vattorney Like "*Ward" Then
AttorneyVS = "WARD"
End If



End Function
Public Function attorneyCapLast()

If IsNull(Forms![foreclosure database screen]!AttorneyCAPFIELD) Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD = "" Then
MsgBox ("No caption in Caption First Name drop down box")
Else

If Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Bierman*" Then
attorneyCapLast = "Bierman"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Geesing*" Then
attorneyCapLast = "Geesing"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Ward*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "6*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "12*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "10*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "9*" Then
attorneyCapLast = "Ward"
End If

End If
End Function
Public Function attorneycap() As String

If IsNull(Forms![foreclosure database screen]!AttorneyCAPFIELD) Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD = "" Then
MsgBox ("No caption in Caption First Name drop down box")
Else

If Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Bierman*" Then
attorneycap = "Howard N. Bierman"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Geesing*" Then
attorneycap = "Jacob Geesing"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD Like "*Ward*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "6*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "9*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "12*" Or _
Forms![foreclosure database screen]!AttorneyCAPFIELD Like "10*" Then
attorneycap = "Carrie M. Ward"
End If

End If


End Function


Public Function countyadd1()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs!countyadd1) Then
countyadd1 = ""
Else
countyadd1 = rs!countyadd1
End If
End If '


'MsgBox (COUNTYadd1)

End Function
Public Function countyadd1TE()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![titleform]!Propertycounty & """" & _
" and State = " & """" & Forms![titleform]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs!countyadd1) Then
countyadd1TE = ""
Else
countyadd1TE = rs!countyadd1
End If
End If

'MsgBox (COUNTYadd1)

End Function
Public Function countyadd2TE()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![titleform]!Propertycounty & """" & _
" and State = " & """" & Forms![titleform]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs!countyadd2) Then
countyadd2TE = ""
Else
countyadd2TE = rs!countyadd2
End If
End If

'MsgBox (COUNTYadd1)

End Function
Public Function countyadd2()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)

If Not rs.EOF Then

If IsNull(rs!countyadd2) Or rs!countyadd2 = "" Then
countyadd2 = ""
Else
countyadd2 = rs!countyadd2
End If

End If

'MsgBox (COUNTYadd1)

End Function
Public Function countyadd3TE()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![titleform]!Propertycounty & """" & _
" and State = " & """" & Forms![titleform]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs!countyadd3) Then
countyadd3TE = ""
Else
countyadd3TE = rs!countyadd3
End If
End If

'MsgBox (COUNTYadd3)

End Function
Public Function countyadd4TE()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![titleform]!Propertycounty & """" & _
" and State = " & """" & Forms![titleform]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs!countyadd4) Then
countyadd4TE = ""
Else
countyadd4TE = rs!countyadd4
End If
End If

'MsgBox (COUNTYadd4)

End Function
Public Function countyadd3()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If IsNull(rs!countyadd3) Then
countyadd3 = ""
Else
countyadd3 = rs!countyadd3
End If

'MsgBox (COUNTYadd3)

End Function
Public Function countyadd4()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If IsNull(rs!countyadd4) Then
countyadd4 = ""
Else
countyadd4 = rs!countyadd4
End If

'MsgBox (COUNTYadd4)

End Function
Public Function countyattTE()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![titleform]!Propertycounty & """" & _
" and State = " & """" & Forms![titleform]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then

If IsNull(rs![county att]) Or rs![county att] = "" Then
countyattTE = ""
Else
countyattTE = rs![county att]
End If

Else
MsgBox ("No County Attorney Input for this file")
End If

End Function
Public Function CountyAtt()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from Jurisdiction where County = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & _
" and State = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If Not rs.EOF Then
If IsNull(rs![county att]) Or rs![county att] = "" Then
CountyAtt = ""
Else
CountyAtt = rs![county att]
End If
Else
MsgBox ("County is incorrect.")
End If


End Function
Public Function NOINames()
Dim rs As RecordSet, rsN As RecordSet

Set rs = CurrentDb.OpenRecordset("NOI-BulkNotProcessed")
Set rsN = CurrentDb.OpenRecordset("NOINames", dbOpenDynaset, dbSeeChanges)

Do While Not rs.EOF
With rsN
.AddNew
tempfields = Split(rs!secondDebtor, " ")
Dim A
A = Split(rs!secondDebtor, " ")
If UBound(tempfields) = 3 Then
![FirstName] = StrConv(A(2), vbProperCase)
!middle = StrConv(A(3), vbProperCase)
![LastName] = StrConv(A(0), vbProperCase)
!suffix = StrConv(A(1), vbProperCase)
End If

If UBound(tempfields) = 2 Then
![FirstName] = StrConv(A(1), vbProperCase)
!middle = StrConv(A(2), vbProperCase)
![LastName] = StrConv(A(0), vbProperCase)
End If

If UBound(tempfields) = 1 Then
![FirstName] = StrConv(A(1), vbProperCase)
![LastName] = StrConv(A(0), vbProperCase)
End If
!LoanNo = rs!LoanNo

.Update
End With

rs.MoveNext
Loop




End Function

Public Function LNLHOLDVAsale() As String
Dim strsql As String
Dim rs As RecordSet

If Not IsNull(Forms![VirginiaSales].Form!sbl_sent) And Forms![VirginiaSales].Form!sbl_sent <> "" Then

LNLHOLDVAsale = Forms![VirginiaSales].Form!sbl_sent + 14

Else
LNLHOLDVAsale = ""


End If



End Function
Public Function NOICiti()
'If Forms![foreclosure database screen]!Client = "Citi Residential Lending Inc." Then
Dim VCiti
VCiti = MsgBox("Have c/o " & Client() & " pop in next to Secured Party number", vbYesNo)
If VCiti = vbYes Then
NOICiti = Client()
End If
'End If

End Function
Public Function ReadytoDocketSpreadsheet()

 

DoCmd.OpenQuery "ALL-ReadyToDocket", acViewPreview

End Function
Public Function IndyMacSpreadsheet()

 

DoCmd.OpenQuery "IndyMacBiLLSMKTbl"

DoCmd.OpenQuery "IndyMacBillsUPDATEField"

DoCmd.OpenReport "IndyMac Billing", acViewPreview

End Function
Public Function MailA()

If Not IsNull(Forms![foreclosure database screen]![Mailing Address]) And _
Forms![foreclosure database screen]![Mailing Address] <> "" Then

If Forms![foreclosure database screen]![MailA_To] = "Grantor1" Then
MailA = "Grantor1"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Grantor2" Then
MailA = "Grantor2"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Grantor3" Then
MailA = "Grantor3"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Grantor4" Then
MailA = "Grantor4"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Owner1" Then
MailA = "Owner1"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Owner2" Then
MailA = "Owner2"
ElseIf Forms![foreclosure database screen]![MailA_To] = "Owner3" Then
MailA = "Owner3"
ElseIf Forms![foreclosure database screen]![MailA_To] = "All Owners" Then
MailA = "ALL Owners"
ElseIf Forms![foreclosure database screen]![MailA_To] = "grantors/owners" Or _
IsNull(Forms![foreclosure database screen]!MailA_To) Then
MailA = "ALL"
ElseIf Forms![foreclosure database screen]![MailA_To] = "All Grantors" Then
MailA = "ALL Grantors"
End If

Else
MailA = "NA"
End If

'MsgBox (MailA)

End Function
Public Function MailSDat()

If Not IsNull(Forms![foreclosure database screen]![SDatAddress]) And _
Forms![foreclosure database screen]![SDatAddress] <> "" Then

If Forms![foreclosure database screen]![Mail_sdat] Like "Grantor1*" Then
MailSDat = "Grantor1"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Grantor2*" Then
MailSDat = "Grantor2"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Grantor3*" Then
MailSDat = "Grantor3"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Grantor4*" Then
MailSDat = "Grantor4"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Owner1*" Then
MailSDat = "Owner1"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Owner2*" Then
MailSDat = "Owner2"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "Owner3*" Then
MailSDat = "Owner3"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "All Owners*" Then
MailSDat = "ALL Owners"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "grantors/owners*" Or _
IsNull(Forms![foreclosure database screen]!Mail_sdat) Or Forms![foreclosure database screen]![Mail_sdat] = "" Then
MailSDat = "All"
ElseIf Forms![foreclosure database screen]![Mail_sdat] Like "All Grantors*" Then
MailSDat = "ALL Grantors"
End If

Else
MailSDat = "NA"
End If

'MsgBox (Forms![foreclosure database screen]![Mail_Sdat] & " " & MailSDat)

End Function

Public Function MailB()

If Not IsNull(Forms![foreclosure database screen]![Mailing AddressB]) And Forms![foreclosure database screen]![Mailing AddressB] <> "" Then

If Forms![foreclosure database screen]![MailB_To] = "Grantor1" Then
MailB = "Grantor1"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Grantor2" Then
MailB = "Grantor2"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Grantor3" Then
MailB = "Grantor3"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Grantor4" Then
MailB = "Grantor4"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Owner1" Then
MailB = "Owner1"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Owner2" Then
MailB = "Owner2"
ElseIf Forms![foreclosure database screen]![MailB_To] = "Owner3" Then
MailB = "Owner3"
ElseIf Forms![foreclosure database screen]![MailB_To] = "All Owners" Then
MailB = "ALL Owners"
ElseIf Forms![foreclosure database screen]![MailB_To] = "grantors/owners" Or _
IsNull(Forms![foreclosure database screen]!MailB_To) Then
MailB = "All"
ElseIf Forms![foreclosure database screen]![MailB_To] = "All Grantors" Then
MailB = "ALL Grantors"
End If

Else
MailB = "NA"
End If

End Function




Public Function SendEmails(SendTo As String, ccTo As String, sentfrom As String, Subject As String, body As String, Optional AttachmentFilespec As String)

Set cdomsg = New CDO.message
cdomsg.Configuration.Fields(cdoSMTPServer) = "192.168.1.47"
cdomsg.Configuration.Fields(cdoSMTPConnectionTimeout) = 30
cdomsg.Configuration.Fields(cdoSendUsingMethod) = cdoSendUsingPort
cdomsg.Configuration.Fields.Update

cdomsg.To = SendTo
cdomsg.CC = ccTo
cdomsg.from = sentfrom
cdomsg.Subject = Subject
cdomsg.TextBody = body
If AttachmentFilespec <> "" Then cdomsg.AddAttachment AttachmentFilespec
cdomsg.Send
Set cdomsg = Nothing



End Function
Public Function LinkAccounting()
DoCmd.OpenQuery ("AccountingChecks")

End Function
Public Function TDeed()

Dim VSel

VSel = InputBox("1.  Email Deed" & vbCr & "2.  Print Out Deed")
If VSel = 1 Then
Call EmailDeeds
Else
DoCmd.RunMacro ("deed-va")
End If


End Function
Public Function DeedRecBillPaid()
 
Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing DeedRecBPMD")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRec")
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing DeedRecBPVA")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecVA")
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing DeedRecBPDC")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecDC")
End If


End Function
Public Function TransTitlePrem()

Dim rs As RecordSet, rsbill As RecordSet
Dim strsql As String
strsql = "select * from TempPS order by Filenum"
Set rsbill = CurrentDb.OpenRecordset("TitlePremCHK", dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then
rs.MoveFirst
End If
If Not rsbill.EOF Then
rsbill.MoveFirst
End If

Do While Not rs.EOF

rsbill.MoveFirst

Do While Not rsbill.EOF
'MsgBox ("From TempPS: " & rs!FileNum & " From Billing: " & rsBill!FileNum)

If rs!filenum = rsbill!filenum Then

If rs!TRANSFERFEE = 0 And (rsbill!d_titleins > 0) Then
With rs
.Edit
!TRANSFERFEE = rsbill!d_titleins
!DATE_BILLED = rsbill!billingdate
!Inv_No = rsbill!CustomerID
!bill_paid = rsbill!bill_paid
.Update
End With
End If
End If
rsbill.MoveNext
Loop
rs.MoveNext
Loop
rsbill.Close
rs.Close
End Function
Public Function TransDeedWaterRE()

DoCmd.OpenQuery ("Missing DeedUpdateEviction")
Dim rs As RecordSet, rsbill As RecordSet
Dim strsql As String

strsql = "select * from TempPS order by Filenum"
Set rsbill = CurrentDb.OpenRecordset("TransferfeeCHK", dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then
rs.MoveFirst
End If

If Not rsbill.EOF Then
rsbill.MoveFirst
End If

Do While Not rs.EOF

rsbill.MoveFirst

Do While Not rsbill.EOF

If rs!filenum = rsbill!filenum Then

If rs!TRANSFERFEE = 0 And (rsbill!d_transfee > 0 Or rsbill!re_recording > 0) Then
With rs
.Edit
If (rsbill!TypeOfLoan = "FHLMC" Or rsbill!TypeOfLoan = "FNMA") And rsbill!re_recording > 0 Then
!TRANSFERFEE = rsbill!re_recording
Else
!TRANSFERFEE = rsbill!d_transfee
End If
'd_titleins
!DATE_BILLED = rsbill!billingdate
!RealEstate = rsbill!d_realestatetaxes
!water = rsbill!water
!Inv_No = rsbill!CustomerID
!bill_paid = rsbill!bill_paid
.Update
End With
End If
End If
rsbill.MoveNext
Loop
rs.MoveNext
Loop
rsbill.Close
rs.Close


End Function

Public Function TransDEED()


DoCmd.OpenQuery ("Missing DeedUpdateEviction")
Dim rs As RecordSet, rsbill As RecordSet
Dim strsql As String

strsql = "select * from TempPS order by Filenum"
Set rsbill = CurrentDb.OpenRecordset("TransferfeeCHK", dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then
rs.MoveFirst
End If

If Not rsbill.EOF Then
rsbill.MoveFirst
End If

Do While Not rs.EOF

rsbill.MoveFirst

Do While Not rsbill.EOF

If rs!filenum = rsbill!filenum Then

If rs!TRANSFERFEE = 0 And (rsbill!d_transfee > 0 Or rsbill!re_recording > 0) Then
With rs
.Edit
If (rsbill!TypeOfLoan = "FHLMC" Or rsbill!TypeOfLoan = "FNMA") And rsbill!re_recording > 0 Then
!TRANSFERFEE = rsbill!re_recording
Else
!TRANSFERFEE = rsbill!d_transfee
End If
'd_titleins
!DATE_BILLED = rsbill!billingdate
!Inv_No = rsbill!CustomerID
!bill_paid = rsbill!bill_paid
.Update
End With
End If
End If
rsbill.MoveNext
Loop
rs.MoveNext
Loop
rsbill.Close
rs.Close
End Function
Public Function TitlePremHoldingFunds()
 
Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("TitlePremMD")
Call TransTitlePrem
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("TitlePremVA")
Call TransTitlePrem
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("TitlePremDC")
Call TransTitlePrem

End If

End Function


Public Function DeedRecHoldingFunds()

 
Dim Vselect

Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecNoIndyHSBC")
Call TransDEED
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecVA")
Call TransDEED
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecDC")
Call TransDEED

'DoCmd.RunMacro ("PSFilesDeedRecDC")
End If

End Function
Public Function DeedRecHOLDING()
 
Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRec")
Call TransDEED
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecVA")
Call TransDEED
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecDC")
Call TransDEED

'DoCmd.RunMacro ("PSFilesDeedRecDC")
End If

End Function
Public Function DeedRecHOLDINGSentRec()
 
Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecSR")
Call TransDEED
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecSRVA")
Call TransDEED
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecSRDC")
Call TransDEED
End If

End Function
Public Function DeedRecMDPF()
 
Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecPF")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRec")
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecVAPF")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecVA")
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecDCPF")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecDC")
End If


End Function
Public Function DeedRecMd()
 
 DoCmd.SetWarnings False
CurrentDb.Execute ("alter table TempPS alter column inv_no number;")

Dim Vselect
Vselect = InputBox("1.  Maryland" & vbCr & "2.  Virginia" & vbCr & "3.  DC")
If Vselect = 1 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRec")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRec")
ElseIf Vselect = 2 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecVA")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecVA")
ElseIf Vselect = 3 Then
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecDC")
Call TransDEED
'DoCmd.RunMacro ("PSFilesDeedRecDC")
End If

 

End Function

Public Function UpdateAdd()

Set rs = CurrentDb.OpenRecordset("query1", dbOpenDynaset, dbSeeChanges)
rs.MoveFirst

Dim strUpdate As String
Do While Not rs.EOF
strUpdate = rs!Address2
With rs
.Edit
!Address2 = Replace(strUpdate, ";", ",")
Debug.Print rs!Address2
.Update
End With
rs.MoveNext
Loop


End Function


Public Function FBScreen()
Dim strsql
Dim rsFB

strsql = "select * from fbagreement where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsFB = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsFB.EOF Then
rsFB.Close
Set rsFB = CurrentDb.OpenRecordset("FBAgreement", dbOpenDynaset, dbSeeChanges)
With rsFB
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
.Update
.Close
End With
Else
rsFB.Close
End If

stLinkCriteria = "[filenum]= Forms![foreclosure database screen]!FIleNum"

DoCmd.OpenForm "ForbearanceScrn", , , stLinkCriteria


End Function
Public Function daystosaleMD() As Integer
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


If Forms![foreclosure database screen]![Date Recieved] > #4/1/2008# Then
If Not IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![service_complete]) And _
Not IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
daystosaleMD = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate - [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![service_complete]
End If
Else
daystosaleMD = daystosaleVA()
End If

End Function
Public Function daystosaleVA() As Integer
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function

Dim VSaleD
Dim VResume

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
VSaleD = ""
Else
VSaleD = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]
End If

If IsNull([Forms]![foreclosure database screen]![resume_recd]) Then
VResume = ""
Else
VResume = [Forms]![foreclosure database screen]![resume_recd]
End If

If VSaleD <> "" And VResume <> "" Then
daystosaleVA = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] - [Forms]![foreclosure database screen]![resume_recd]
Else
If VSaleD <> "" Then
daystosaleVA = (VSaleD - Forms![foreclosure database screen]![Date Recieved])
End If
End If

End Function
Public Function interestratePS()

Dim Vinterest

Dim rs As RecordSet
Dim strsql As String
strsql = "select * from affdebt where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)


If IsNull(rs![extra text]) And IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![int_rat]) Then
Vinterest = InputBox("Please fill in Interest Rate")
Else

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_date) Then
VInt = "There is a Modification Date input on the FC Screen"

ElseIf Not IsNull(rs![extra text]) Then
VInt = "The Interest Rate on the Affidavit of Debt Screen is : " & rs![extra text]
Else
VInt = "The Original Interest Rate is: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![int_rat]
End If

Vinterest = InputBox(VInt & _
", please see if the rate has changed.  If it has Enter New Rate:")
End If

If Vinterest <> "" Or IsNull(Vinterest) Then

interestratePS = Vinterest
'MsgBox ("Vinterest: " & Vinterest)

If Not IsNull(rs![extra text]) Then
With rs
.Edit
![extra text] = Vinterest
.Update
.Close
End With
End If

ElseIf IsNull(rs![extra text]) Then
'MsgBox ("Screen: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![int_rat])
interestratePS = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![int_rat]
Else
'MsgBox ("AffDebt: " & rs![extra text])
interestratePS = rs![extra text]
End If


If Vinterest <> "" Then
strsql = "select int_rat from foreclosure where subfilenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
With rs
.Edit
!int_rat = Vinterest
.Update
.Close
End With
End If



End Function


Public Function AssignEff()
Dim EffDate As String

EffDate = InputBox("Enter Effective Date (if not Referral date)")

If EffDate = "" Then
VBlank = MsgBox("Blank?", vbYesNo)
If VBlank = vbNo Then
EffDate = Forms![foreclosure database screen]![Date Recieved]
End If
End If

Dim todayth, dayeff As String
todayth = Format(EffDate, "dd")
If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If

If VBlank = vbYes Then
AssignEff = "but made effective this ______ day of ___________"
Else
AssignEff = "but made effective this " & Format(EffDate, "dd") & dayeff & " day of " & Format(EffDate, "mmmm") & ", " & Format(EffDate, "yyyy")
End If



End Function
Public Function VATaxExemptFHA()

If (Forms![foreclosure database screen]![PropertyState] Like "VA*" And _
(Forms![foreclosure database screen]![TypeOfLoan] Like "FHA*" Or _
Forms![foreclosure database screen]!fha = -1 Or _
Forms![foreclosure database screen]!fha = 1)) Then
VATaxExemptFHA = "TAX EXEMPT PURSUANT TO CODE OF VA § 58.1-811 (A)(3)"

End If


End Function


Public Function VATaxexemptTDeed()

If (Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 0 Or _
IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party])) Then

If (Forms![foreclosure database screen]![TypeOfLoan] Like "VA*") Then
VATaxexemptTDeed = "TAX EXEMPT PURSUANT TO CODE OF VA § 58.1-811 (A)(3)"

ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then
'VATaxexemptTDeed = "Tax exempt pursuant to 12 U.S.C. § 1452(e) and/or 12 U.S.C. § 4617(j)(2)"
VATaxexemptTDeed = "Federal Home Loan Mortgage Corporation (“Freddie Mac”) asserts that this deed is exempt from all transfer taxes pursuant to 12 U.S.C. 1452(e) and/or 12 U.S.C. 4617(j)(2)"


ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
VATaxexemptTDeed = "TAX EXEMPT PURSUANT TO § 12 U.S.C. § 1723a(c)(2) and/or 12 U.S.C. § 4617(j)(2)"
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
VATaxexemptTDeed = "TAX EXEMPT PURSUANT TO § 12 U.S.C. § 1452(e) and/or 12 U.S.C. § 4617(j)(2)"
End If
End If

End Function
Public Function VATaxExempt()


If (Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 0 Or _
IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party])) Then

If Forms![foreclosure database screen]![TypeOfLoan] Like "VA*" Or _
Forms![foreclosure database screen]![TypeOfLoan] Like "FHA*" Or _
Forms![foreclosure database screen]!fha = -1 Or _
Forms![foreclosure database screen]!fha = 1 Then
VATaxExempt = "TAX EXEMPT PURSUANT TO § 58.1-811 (A)(3)"

ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
VATaxExempt = "TAX EXEMPT PURSUANT TO § 12 U.S.C. § 1723a(c)(2) and/or 12 U.S.C. § 4617(j)(2)"

ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
VATaxExempt = "TAX EXEMPT PURSUANT TO § 12 U.S.C. § 1452(e) and/or 12 U.S.C. § 4617(j)(2)"

End If
End If


End Function
Public Function VATitleCo()

'strsql = "select [title company] from Foreclosure where subfilenum = " & Forms![foreclosure database screen]!FIleNum & ";"
'Set rsTitle = CurrentDb.Openrecordset(strsql, dbopensnapshot)

'If IsNull(rsTitle![Title Company]) Or rsTitle![Title Company] = "" Then
'vtco = ""
'Else
'vtco = rsTitle![Title Company]
'End If

'vsel1 = "Use Title Insurance Company: " & vbcr & vtco
'Vsel2 = "Enter Mortgagee's Title Insurance"
'vsel3 = "Unknown Insurance Company"


'If vtco <> "" Then

'Vselect = InputBox("Mortgagee Title Insurance Company is: " & vbcr & vtco & vbcr & vbcr & "1. " & vsel1 & vbcr & vbcr & "2. " & vsel2 & vbcr & vbcr & "3. " & vsel3 & vbcr & vbcr & "Select 1, 2 or 3")

'If Vselect = "2" Then
'VATitleCo = "Title Insurance provided by: " & Vselect & "."
'ElseIf Vselect = "1" Then
'VATitleCo = "Title Insurance provided by: " & rsTitle![Title Company] & "."
'Else
'VATitleCo = "The existence of title insurance is unknown to the preparer."
'End If

'Else
'If Forms![foreclosure database screen]!PostsaleSubForm.Form!Buyer = "REO" Or _
'Forms![foreclosure database screen]!PostsaleSubForm.Form!printclientadd = 1 Then
VATitleCo = "The existence of title insurance is unknown to the preparer."

'Else

'Vselect = InputBox("1. " & Vsel2 & vbCr & "2. " & vsel3 & vbCr & "Select 1 or 2")
'If Vselect = "1" Then
'VTitleCo = InputBox("Enter Mortgagee Title Insurance Company:")
'VATitleCo = "Title Insurance provided by: " & VTitleCo & "."
'Else
'VATitleCo = "The existence of title insurance is unknown to the preparer."
'End If
'End If

'End If


End Function
Public Function PropertyState()
If Forms![foreclosure database screen]!PropertyState = "MD" Then
PropertyState = "Maryland"
ElseIf Forms![foreclosure database screen]!PropertyState = "VA" Then
PropertyState = "Virginia"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
PropertyState = "District of Columbia"
Else
PropertyState = Forms![foreclosure database screen]!PropertyState
End If


End Function
Public Function FDLCreditors()
Dim rs As RecordSet
Dim strsql As String
strsql = "SELECT Creditors.fdl, Cases.FileNum FROM Cases INNER JOIN Creditors ON Cases.FileNum = Creditors.FileNum " & _
" WHERE Creditors.fdl = Yes And Cases.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rs.EOF Then
rs.Close
Exit Function
Else
If Forms![foreclosure database screen]!Client Like "Homeward*" Then
DoCmd.OpenReport ("Fairdebt LetterOOMC-Lienholders"), acViewPreview
rs.Close
End If

End If

End Function
Public Function BGW3rdContact()

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![buyer_abbr]) Then
BGW3rdContact = Forms![foreclosure database screen]!PostsaleSubForm.Form!Buyer
Else
BGW3rdContact = Forms![foreclosure database screen]!PostsaleSubForm.Form![buyer_abbr]
End If


End Function
Public Function NonCooper()
If (Forms![foreclosure database screen]!Propertycounty = "Allegany" _
Or Forms![foreclosure database screen]!Propertycounty = "Dorchester" _
Or Forms![foreclosure database screen]!Propertycounty = "Garrett" _
Or Forms![foreclosure database screen]!Propertycounty = "Somerset" _
Or Forms![foreclosure database screen]!Propertycounty = "Wicomico" _
Or Forms![foreclosure database screen]!Propertycounty = "Worcester") Then
NonCooper = "Yes"
End If

End Function
Public Function SetSale()

If Not IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![DocketSubform].[Form]![pre_docket_filed]) And _
IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![DocketSubform].[Form]![final_LMA_filed]) Then
MsgBox ("The case was filed with a Preliminary Loss Mit Affidavit.  The Final LMA Filed field has not been completed.  You may not schedule a sale date.")
Exit Function
End If



vClient = Forms![foreclosure database screen]!Client

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!dnss = 1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!dnss = 1 Then
MsgBox ("Do Not Set Sale Button is Pressed will NOT Set Sale")
Else

 

If NonCooper() = "Yes" Then
MsgBox ("Non Cooper County can not set sale date")
Exit Function
Else

If Forms![foreclosure database screen]!TypeOfLoan = "VA" Then

If Forms![foreclosure database screen]!Client Like "JPM*" Then

If IsNull(Forms![foreclosure database screen]!resume_recd) Then
DoCmd.OpenQuery ("qrychecksaledaysVA-Chase")
Else
DoCmd.OpenQuery ("qrychecksaledaysVA-Chase-resume")
End If

Else
If IsNull(Forms![foreclosure database screen]!resume_recd) Then
DoCmd.OpenQuery ("qrychecksaledaysVA")
Else
DoCmd.OpenQuery ("qrychecksaledaysVA-RESUME")
End If

End If

Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

ElseIf (IsNull(Forms![foreclosure database screen]!resume_recd) Or _
(Not IsNull(Forms![foreclosure database screen]!resume_recd) _
And Forms![foreclosure database screen]!ForeclosureSubForm.Form!resume_DA <> "Amend")) And _
[Forms]![foreclosure database screen]![TypeOfLoan] <> "FHA" Then


If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!service_complete) And _
(Forms![foreclosure database screen]!ForeclosureSubForm.Form!commercial = 0 Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!commercial)) Then
MsgBox ("Can not set Sale!  Service Complete date must be filled in!")
Exit Function
End If

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!IRSnotice) Then
Forms![foreclosure database screen]!ForeclosureSubForm.Form!IRSnotice = Null
End If

'--------NEW Code

DoCmd.OpenQuery ("qrychecksaledaysAMC")
Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

Else

If (Forms![foreclosure database screen]!Client Like "Citi Res*" Or _
Forms![foreclosure database screen]!Client Like "Ocwen*" Or _
Forms![foreclosure database screen]!Client Like "Bank of Am*") And _
[Forms]![foreclosure database screen]![TypeOfLoan] <> "FHA" Then
DoCmd.OpenQuery ("qrychecksaledaysresumeAMC")
Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

ElseIf [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Or Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Then

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Hoc_Sent]) Then
MsgBox ("HOC Ltr has to be sent.")
Exit Function

Else
'"Sale Can be Set between: " & [hoc_sent]+60 & " And " & [hoc_sent]+90))
DoCmd.OpenQuery ("qrychecksaledaysFHA")
Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

End If

Else


DoCmd.OpenQuery ("qrychecksaledaysresume")
Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)
End If

End If


If rs.EOF Then
MsgBox ("No sale dates for " & Forms![foreclosure database screen]!Propertycounty & ".")
Exit Function
Else

strsqlH = "select * from holidays where holiday = #" & rs!Sale_Date & _
"# and (client is null or client = " & """" & "BWW" & """" & " or client = " & """" & Forms![foreclosure database screen]!Client & """" & ");"
Set RsH = CurrentDb.OpenRecordset(strsqlH, dbOpenSnapshot)

If RsH.EOF Then
RsH.Close


Dim VNSC As String
VNSC = InputBox("Send Notice to County Letter NOW?")
If VNSC = "yes" Then
Call NoticeSaleCounty
End If

Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate = rs!Sale_Date
Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad] = rs![1st_ad]
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![fc_cooper]) Then
Forms![foreclosure database screen]!ForeclosureSubForm.Form![fc_cooper] = Date
Else
MsgBox ("There is a date in the Cooper Sent field.  Please update manually.")
End If

Else


If Forms![foreclosure database screen]!Client Like "Bank of Am*" And (Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or _
Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or _
Forms![foreclosure database screen]!fha = -1 Or _
Forms![foreclosure database screen]!fha = 1 Or _
Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
Exit Function
Else
MsgBox ("The " & RsH!Holiday & " is a Holiday (" & "" & RsH!Holiday_Name & "" & ") for " & """" & Forms![foreclosure database screen]!Client & """" & ".  Please change date.")
RsH.Close
MsgBox ("Can Not Set Sale. " & rs!Sale_Date & " Moratorium is set for " & Forms![foreclosure database screen]!Client & ", set manually")
Dim strsqlSD, VDates
Dim rsSD
strsqlSD = "SELECT saledays.[1st_ad], saledays.Sale_Date from saledays WHERE saledays.County = " & """" & [Forms]![foreclosure database screen]![Propertycounty] & """" & _
" And saledays.State = " & """" & [Forms]![foreclosure database screen]![PropertyState] & """" & " and sale_date > #" & Date & "# order by sale_date;"
Set rsSD = CurrentDb.OpenRecordset(strsqlSD, dbOpenSnapshot)
If Not rsSD.EOF Then
rsSD.MoveFirst
Do While Not rsSD.EOF
VDates = VDates + "Sale Date: " & rsSD!Sale_Date & " / 1st Ad: " & rsSD![1st_ad] & vbCr
rsSD.MoveNext
Loop
MsgBox ("Other Dates for: " & Forms![foreclosure database screen]!Propertycounty & vbCr & vbCr & VDates)
rsSD.Close
End If
End If
End If

rs.Close

End If
End If

End If


Dim rst As RecordSet
Set rst = CurrentDb.OpenRecordset("select top 1 * from Volumes", dbOpenDynaset, dbSeeChanges)
With rst
rst.AddNew
rst!EventDate = Date
rst!BWWnbr = Forms![foreclosure database screen]!filenum
rst!Metric = "Sale Set"
rst!Count = 1
rst!State = Forms![foreclosure database screen]!PropertyState
rst!loantype = Forms![foreclosure database screen]![TypeOfLoan]
rst!Client = Forms![foreclosure database screen]!Client
rst!investor = Forms![foreclosure database screen]![SecuredParty]
rst.Update
End With



End Function
Public Function AllowablePub()

If Not IsNull(Forms![MDSetSales]!filenum) Then

Dim strsql As String
Dim rs As RecordSet


strsql = "select * from fctracking where filenum = " & Forms![MDSetSales]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Dim VAllow
If Not IsNull(rs!final_LMA_filed) Then
AllowablePub = "1st Allowable Pub Date: " & Format(rs!service_complete + 3, "mm/dd/yy")
ElseIf Not IsNull(rs!final_docket_filed) Then
AllowablePub = "1st Allowable Pub Date: " & Format(rs!service_complete + 3, "mm/dd/yy")
Else
AllowablePub = ""
End If

End If

End Function
Public Function SetSaleMD()

 

CurrentDb.Execute "DELETE * FROM tblsaledate", dbFailOnError


'If (Forms![MDSetSales]!PropertyCounty = "Allegany" _
'Or Forms![MDSetSales]!PropertyCounty = "Dorchester" _
'Or Forms![MDSetSales]!PropertyCounty = "Garrett" _
'Or Forms![MDSetSales]!PropertyCounty = "Somerset" _
'Or Forms![MDSetSales]!PropertyCounty = "Wicomico" _
'Or Forms![MDSetSales]!PropertyCounty = "Worcester") Then
'MsgBox ("Non Cooper County can not set sale date")
'Exit Function

'Else

Dim rs, rsCLT As RecordSet
Dim strsql As String


If Forms!MDSetSales!TypeOfLoan = "VA" Or Forms!MDSetSales!NoNOI = 1 Or Forms!MDSetSales!NoNOI = 2 Then
DoCmd.OpenQuery ("QryCheckSaleDaysPLUS45")
ElseIf (Forms![MDSetSales]!fha = 1 Or Forms![MDSetSales]!fha = -1 Or Forms![MDSetSales]!TypeOfLoan Like "FHA*") And (Date > Forms!MDSetSales!Hoc_Sent + 61) Then
DoCmd.OpenQuery ("QryCheckSaleDaysPLUS30")
Else

DoCmd.OpenQuery ("QryCheckSaleDaysPLUS30")
End If


Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

If rs.EOF Then
MsgBox ("No sale dates for " & Forms![MDSetSales]!Propertycounty & ".")
Exit Function
Else

strsqlH = "select * from holidays where holiday = #" & rs!Sale_Date & "# and (client is null or client = " & """" & "BWW" & """" & " or client = " & """" & Forms![MDSetSales]!Client & """" & ");"
Set RsH = CurrentDb.OpenRecordset(strsqlH, dbOpenSnapshot)

If RsH.EOF Then
RsH.Close

Forms![MDSetSales]!SaleDate = rs!Sale_Date
Forms![MDSetSales]![1st_ad] = rs![1st_ad]
Forms!MDSetSales!omit = 1


Else
Dim VNote
If RsH!Note <> "" Or Not IsNull(RsH!Note) Then
VNote = ".  NOTE: " & RsH!Note
Else
VNote = ""
End If

MsgBox ("The " & RsH!Holiday & " is a Holiday (" & "" & RsH!Holiday_Name & "" & ") for " & """" & Forms![MDSetSales]!Client & """" & "" & VNote & ".  Please change date.")
RsH.Close
MsgBox ("Can Not Set Sale. " & rs!Sale_Date & " Moratorium is set for " & Forms![MDSetSales]!Client & ", set manually")

Dim strsqlSD, VDates
Dim rsSD
Dim VSDate
VSDate = Date + 32

strsqlSD = "SELECT saledays.[1st_ad], saledays.Sale_Date from saledays WHERE saledays.County = " & """" & [Forms]![MDSetSales]![Propertycounty] & """" & _
" And saledays.State = " & """" & [Forms]![MDSetSales]![PropertyState] & """" & " and sale_date > #" & VSDate & "# order by sale_date;"
Set rsSD = CurrentDb.OpenRecordset(strsqlSD, dbOpenSnapshot)
If Not rsSD.EOF Then
rsSD.MoveFirst
Do While Not rsSD.EOF
VDates = VDates + "Sale Date: " & rsSD!Sale_Date & " / 1st Ad: " & rsSD![1st_ad] & vbCr
rsSD.MoveNext
Loop
MsgBox ("Other Dates for: " & Forms![MDSetSales]!Propertycounty & vbCr & vbCr & VDates)
rsSD.Close
'End If

Else
Forms![MDSetSales]!SaleDate = rs!Sale_Date
Forms![MDSetSales]![1st_ad] = rs![1st_ad]
Forms!MDSetSales!omit = 1
End If


End If
End If

rs.Close

'End If

End Function

Public Function SetSaleDC()


CurrentDb.Execute "DELETE * FROM tblsaledate", dbFailOnError

Dim rs, rsCLT As RecordSet
Dim strsql As String


DoCmd.OpenQuery ("QryCheckSaleDaysDC")

Set rs = CurrentDb.OpenRecordset("tblsaledate", dbOpenSnapshot)

strsqlH = "select * from holidays where holiday = #" & rs!Sale_Date & "# and (client is null or client = " & """" & "BWW" & """" & " or client = " & """" & Forms![dcsetsales]!Client & """" & ");"
Set RsH = CurrentDb.OpenRecordset(strsqlH, dbOpenSnapshot)

If RsH.EOF Then
RsH.Close

Forms![dcsetsales]!SaleDate = rs!Sale_Date
Forms![dcsetsales]![1st_ad] = rs![1st_ad]
Forms!dcsetsales!setsalescreencheck = 1
Forms!dcsetsales!sale_set = Date

Else

Dim VNote
If RsH!Note <> "" Or Not IsNull(RsH!Note) Then
VNote = ".  NOTE: " & RsH!Note
Else
VNote = ""
End If

MsgBox ("The " & RsH!Holiday & " is a Holiday (" & "" & RsH!Holiday_Name & "" & ") for " & """" & Forms![dcsetsales]!Client & """" & "" & VNote & ".  Please change date.")
RsH.Close
MsgBox ("Can Not Set Sale. " & rs!Sale_Date & " Moratorium is set for " & Forms![dcsetsales]!Client & ", set manually")

Dim strsqlSD, VDates
Dim rsSD
Dim VSDate
VSDate = Date + 32

strsqlSD = "SELECT saledays.[1st_ad], saledays.Sale_Date from saledays WHERE saledays.County = " & """" & [Forms]![dcsetsales]![Propertycounty] & """" & _
" And saledays.State = " & """" & [Forms]![dcsetsales]![PropertyState] & """" & " and sale_date > #" & VSDate & "# order by sale_date;"
Set rsSD = CurrentDb.OpenRecordset(strsqlSD, dbOpenSnapshot)
If Not rsSD.EOF Then
rsSD.MoveFirst
Do While Not rsSD.EOF
VDates = VDates + "Sale Date: " & rsSD!Sale_Date & " / 1st Ad: " & rsSD![1st_ad] & vbCr
rsSD.MoveNext
Loop
MsgBox ("Other Dates for: " & Forms![dcsetsales]!Propertycounty & vbCr & vbCr & VDates)
rsSD.Close
'End If

Else
Forms![dcsetsales]!SaleDate = rs!Sale_Date
Forms![dcsetsales]![1st_ad] = rs![1st_ad]
Forms!dcsetsales!sale_set = Date
Forms!dcsetsales!setsalescreencheck = 1

End If


End If


rs.Close

'End If

End Function
Public Function AffDebtIntThru()
Dim rs As RecordSet
Dim strsql As String

strsql = "SELECT AFFDebt.*, Foreclosure.[Principal Balance] FROM Foreclosure INNER JOIN AFFDebt ON Foreclosure.SubFileNum = AFFDebt.SubFileNum where foreclosure.subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

AffDebtIntThru = rs![interest thru]
End Function
Public Function AffDebtTotal()
Dim rs As RecordSet
Dim strsql As String


strsql = "SELECT AFFDebt.*, Foreclosure.[Principal Balance] FROM Foreclosure INNER JOIN AFFDebt ON Foreclosure.SubFileNum = AFFDebt.SubFileNum where foreclosure.subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
AffDebtTotal = Format(rs![Principal Balance] + rs![interest amt] + rs![Late charge] + rs![lender advance] + rs![interest on advance] + rs![nsf charge] + rs![foreb] + rs![escbal] + rs![miscm1] + rs![miscm2] + rs![Mism3] + rs![Mism4] + rs![mism5] + rs![mism6] + rs![mism7] + rs![mism8] + rs![mism9] + rs![Rec_bal] + rs![mism10] + rs![mism11], "$###,##0.00")
End If

End Function
Public Function interestrate()
Dim rs As RecordSet
Dim strsql, VInt As String

strsql = "select [extra text] from affdebt where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs![extra text] <> "" Or rs![extra text] = 0 Then
If rs![extra text] Like "*%" Then
VInt = ""
Else
VInt = "%"
End If
interestrate = rs![extra text] & VInt
''logcase Forms![foreclosure database screen]!FileNum, "Interest Rate Updated from Aff Debt Screen: Prev Rate: " & [Forms]![foreclosure database screen]!ForeclosureSubForm.Form!int_rat & " New Rate: " & rs![extra text]


[Forms]![foreclosure database screen]!ForeclosureSubForm.Form!int_rat = rs![extra text]
Else
If [Forms]![foreclosure database screen]!ForeclosureSubForm.Form!int_rat Like "*%" Then
VInt = ""
Else
VInt = "%"
End If
interestrate = [Forms]![foreclosure database screen]!ForeclosureSubForm.Form!int_rat & VInt
End If

End Function

Public Function AffDebtScreen()
Dim rsAff, rs As RecordSet
Dim strsqlAff As String
Dim strsqlPS As String
Dim rsPS As RecordSet

strsqlPS = "select * from postsale where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsPS = CurrentDb.OpenRecordset(strsqlPS, dbOpenSnapshot)
If rsPS.EOF Then
rsPS.Close
Set rsPS = CurrentDb.OpenRecordset("postsale", dbOpenDynaset, dbSeeChanges)
With rsPS
.AddNew
!SubFileNum = Forms![foreclosure database screen]!filenum
.Update
.Close
End With
Else
rsPS.Close
End If

strsqlAff = "select * from affdebt where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsAff = CurrentDb.OpenRecordset(strsqlAff, dbOpenSnapshot)

If rsAff.EOF Then

rsAff.Close

Set rs = CurrentDb.OpenRecordset("affdebt", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!SubFileNum = Forms![foreclosure database screen]!filenum
!mism5 = 0#
!mism6 = 0#
!mism7 = 0#
!miscm1 = 0#
!miscm2 = 0#
!Mism3 = 0#
!Mism4 = 0#
!mism8 = 0#
!mism9 = 0#
!mism10 = 0#
!mism11 = 0#
.Update
.Close
End With

Else

rsAff.Close
End If


DoCmd.OpenForm "AffidavitDebtMain"
End Function
Public Function LetterScreen()
Dim rsLtr, rs As RecordSet
Dim strsql As String
strsql = "select * from lettertbl where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsLtr = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsLtr.EOF Then

rsLtr.Close

Set rs = CurrentDb.OpenRecordset("lettertbl", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!ID = GetAutoNumber("NextDemand")
.Update
.Close
End With

Else

rsLtr.Close
End If


DoCmd.OpenForm "letters sent"
End Function


Public Function condo()
Dim VYN  As String
VYN = MsgBox("Condo?", vbYesNo)
condo = "NO"
If VYN = vbYes Then
MsgBox ("Don't Forget to Send Legal Description")
condo = "YES"
End If


End Function
Public Function DDRpt()
Dim VSort As String
VSort = InputBox("Sort Daily Docket Report by: " & vbCr & vbCr & "1.  1st Pub" & vbCr & "2.  Sale Date" & vbCr & "3.  County")
If VSort = "2" Then
DoCmd.OpenReport "Daily Docketing Saledate", acViewPreview
ElseIf VSort = "3" Then
DoCmd.OpenReport "Daily Docketing county", acViewPreview
Else
DoCmd.OpenReport "Daily Docketing ad", acViewPreview

End If

End Function
Public Function AMCPSScreen()
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from bidtable where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Dim strsqlTP As String
Dim rsTP As RecordSet
strsqlTP = "select * from thirdparty where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsTP = CurrentDb.OpenRecordset(strsqlTP, dbOpenDynaset, dbSeeChanges)


If Not rs.EOF Then

If IsNull(rsTP!amc_bid_amt) Then
With rsTP
.Edit
!amc_bid_amt = rs!lender_bid
'!AMCTOTALBid = rs![prep_lna] + rs![prepmotion_lna] + rs![Motion_Accept] + rs![Attorney Fee] + rs![lender_bid] + rs![titlesearch] + rs![prepabstract] + rs![filing] + rs![recording] + rs![auctfee] + rs![adv] + rs![advnisi] + rs![audfee] + rs![re_recording] + rs![servbymail] + rs![otherm1] + rs![otherm2] + rs![bondprem] + rs![realestatetaxes]
!amc_atty_fees = rs![prep_lna] + rs![prepmotion_lna] + rs![motion_accept] + rs![Attorney Fee] + rs![lender_bid] + rs![Titlesearch] + rs![prepabstract] + rs![filing] + rs![recording] + rs![auctfee] + rs![adv] + rs![advnisi] + rs![audfee] + rs![re_recording] + rs![servbymail] + rs![otherm1] + rs![otherm2] + rs![bondprem] + rs![realestatetaxes]

!amc_3rd_final_amt = Forms![foreclosure database screen]!PostsaleSubForm.Form!SalePrice
!amc_amt_recd = rsTP!Escrow_Amt
.Update
.Close
End With
End If
Else
rs.Close
End If

DoCmd.OpenForm ("AMC Postsale Ws")

End Function



Public Function BorrowerPHONE()

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!B_phone) Then
Dim VBPhone
VBPhone = InputBox("There is no phone number input for the borrower, please input here if you have the number.")

If VBPhone = "" Then
BorrowerPHONE = "_____________________"
Else
BorrowerPHONE = VBPhone
Forms![foreclosure database screen]!ForeclosureSubForm.Form!B_phone = VBPhone
End If

Else
BorrowerPHONE = Forms![foreclosure database screen]!ForeclosureSubForm.Form!B_phone
End If

End Function
Public Function OwnerPHONE()

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!O_phone) And _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!makernote <> Forms![foreclosure database screen]!ForeclosureSubForm.Form![owner rec] Then
Dim VBPhone
VBPhone = InputBox("There is no phone number input for the owner, please input here if you have the number.")

If VBPhone = "" Then
OwnerPHONE = "_____________________"
Else
OwnerPHONE = VBPhone
Forms![foreclosure database screen]!ForeclosureSubForm.Form!O_phone = VBPhone
End If

Else
OwnerPHONE = Forms![foreclosure database screen]!ForeclosureSubForm.Form!O_phone
End If

End Function
Public Function isare()
If IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 = "" Then
isare = "is"
Else
isare = "are"
End If

End Function
Public Function BR()
If IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 = "" Then
BR = "Borrower"
Else
BR = "Borrowers"
End If
End Function
Public Function DCCooperAlt()
Dim strsql
Dim rs As RecordSet
Dim Vcnt As Integer
Vcnt = 0

strsql = "SELECT Creditors.* from Creditors WHERE Creditors.prtcoopernotice = Yes And Creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
rs.Close
Exit Function

Else
rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1

If Vcnt = 1 Then
DCCooperAlt = ", " & rs!OrganizationName
Else
DCCooperAlt = DCCooperNotice & "; " & rs!OrganizationName
End If

rs.MoveNext

Loop

rs.Close
End If



End Function

Public Function DCCooperNotice()
Dim strsql
Dim rs As RecordSet
Dim Vcnt As Integer
Vcnt = 0

strsql = "SELECT Creditors.* from Creditors WHERE Creditors.prtcoopernotice = Yes And Creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
rs.Close
Exit Function

Else

rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1
If Vcnt = 1 Then
If rs!Address <> "" Then
If IsNull(rs!Address2) Then
DCCooperNotice = rs!Address & ", " & rs!City & ", " & rs!State & ", " & rs!PostalCode
End If

Else
If rs!Address <> "" Then
DCCooperNotice = rs!Address & ", " & rs!Address2 & ", " & rs!City & ", " & rs!State & ", " & rs!PostalCode
End If
End If

Else
If rs!Address <> "" Then
If IsNull(rs!Address2) Then
DCCooperNotice = DCCooperNotice & "; " & rs!Address & ", " & rs!City & ", " & rs!State & ", " & rs!PostalCode
End If

Else
If rs!Address <> "" Then
DCCooperNotice = DCCooperNotice & "; " & rs!Address & ", " & rs!Address2 & ", " & rs!City & ", " & rs!State & ", " & rs!PostalCode
End If

End If
End If
rs.MoveNext

Loop

rs.Close
End If



End Function

Public Function MDCityAdd1()
strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
MDCityAdd1 = rs!city_add1
rs.Close

End Function
Public Function MDCityAttn()
strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!city_attn) Then
MDCityAttn = ""
Else
MDCityAttn = "Attn: " & rs!city_attn
End If

rs.Close

End Function
Public Function MDCityAdd2()
strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
MDCityAdd2 = rs!city_add2
rs.Close

End Function
Public Function MDCityCSZ()
strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
MDCityCSZ = rs!City & ", " & rs!st & "  " & rs!zip
rs.Close

End Function
Public Function MDCity()
strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
MDCity = rs!City
rs.Close
End Function
Public Function MDZip()

strsql = "select * from zip where zip = " & Left(Forms![foreclosure database screen]!propzip, 5) & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
MDZip = rs!zip
rs.Close
End Function


Public Function OpenSenLienScreen()
Dim strsql As String
Dim rs, rsSL As RecordSet
Dim stDocName As String
    Dim stLinkCriteria As String
    
stDocName = "SLienLtr"

strsql = "select * from SeniorLien where filenum = " & Forms![foreclosure database screen]![filenum] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then

Set rsSL = CurrentDb.OpenRecordset("SeniorLien", dbOpenDynaset, dbSeeChanges)

With rsSL
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
'!bid_recd = 0
!att1 = 0
!att2 = 0
!att3 = 0
!att4 = 0
!att5 = 0
!att6 = 0
!att7 = 0
!att8 = 0
!att9 = 0
!SurplusFunds = 0

.Update
.Close
End With

rs.Close


stLinkCriteria = "[filenum]= Forms![foreclosure database screen]!FIleNum"

DoCmd.OpenForm stDocName, , , stLinkCriteria


Else

    stLinkCriteria = "[filenum]=" & Forms![foreclosure database screen]!filenum
    
    DoCmd.OpenForm stDocName, , , stLinkCriteria
   rs.Close
  
End If

End Function

Public Function PS_3rdparty_Contact()
Dim strsql As String
Dim rs As RecordSet

If Forms![foreclosure database screen]!PropertyState = "MD" Then
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact]) Then
MsgBox ("No initials in BWW Contact drop down")
Exit Function
Else
strsql = "Select * from employees where EmployeeID = " & """" & Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact] & """" & ";"
End If

Else
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![Signs3rdParty]) Then
MsgBox ("No initials in BWW Contact drop down")
Exit Function
Else
strsql = "Select * from employees where EmployeeID = " & """" & Forms![foreclosure database screen]!PostsaleSubForm.Form![Signs3rdParty] & """" & ";"
End If

End If

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
 
If rs.EOF Then
MsgBox ("No employee found")
rs.Close
Exit Function

Else
If IsNull(rs!MiddleName) Then
PS_3rdparty_Contact = rs!FirstName & " " & rs!LastName
Else
PS_3rdparty_Contact = rs!FirstName & " " & rs!MiddleName & " " & rs!LastName
End If
rs.Close
End If




End Function

Public Function PS_3rd_BGWContact()
Dim strsql As String
Dim rs As RecordSet

If Forms![foreclosure database screen]!PropertyState = "MD" Then
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact]) Then
PS_3rd_BGWContact = "our office"
Exit Function
Else
strsql = "Select * from employees where EmployeeID = " & """" & Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact] & """" & ";"
End If

Else
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![Signs3rdParty]) Then
MsgBox ("No initials in BWW Contact drop down")
Exit Function
Else
strsql = "Select * from employees where EmployeeID = " & """" & Forms![foreclosure database screen]!PostsaleSubForm.Form![Signs3rdParty] & """" & ";"
End If

End If

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
 
If IsNull(rs!MiddleName) Then
PS_3rd_BGWContact = rs!FirstName & " " & rs!LastName
Else
PS_3rd_BGWContact = rs!FirstName & " " & rs!MiddleName & " " & rs!LastName
End If

If IsNull(rs!Extension) Or rs!Extension = "" Then
PS_3rd_BGWContact = PS_3rd_BGWContact & " at our office."
Else
PS_3rd_BGWContact = PS_3rd_BGWContact & " at extension " & rs!Extension & " at our office."

End If


rs.Close

End Function


Public Function Open3rdPartyClient()
Dim strsql As String

Dim rs As RecordSet
strsql = "Select * from thirdparty where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then

Set rs = CurrentDb.OpenRecordset("ThirdParty", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
.Update
.Close
End With
End If


DoCmd.OpenForm ("3rdclient")
End Function
Public Function Open3rdPartyProceeds()
Dim strsql As String

Dim rs As RecordSet
strsql = "Select * from thirdparty where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("ThirdParty", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If
rs.Close

DoCmd.OpenForm ("3rdpartyproceedsNew")

End Function
Public Function Escrow3rd()
Dim VClaims As String
If Forms![3rdpartyproceeds]!Amt5 > 0 Then
VClaims = Forms![3rdpartyproceeds]!Claim1 & " (" & Format(Forms![3rdpartyproceeds]!amt1, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim2 & " (" & Format(Forms![3rdpartyproceeds]!amt2, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim3 & " (" & Format(Forms![3rdpartyproceeds]!amt3, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim4 & " (" & Format(Forms![3rdpartyproceeds]!amt4, "$###,##0.00") & ") and " & Forms![3rdpartyproceeds]!Claim5 & " (" & _
Format(Forms![3rdpartyproceeds]!Amt5, "$###,##0.00") & ")"
ElseIf Forms![3rdpartyproceeds]!amt4 > 0 And (Forms![3rdpartyproceeds]!Amt5 = 0 Or IsNull(Forms![3rdpartyproceeds]!Amt5)) Then
VClaims = Forms![3rdpartyproceeds]!Claim1 & " (" & Format(Forms![3rdpartyproceeds]!amt1, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim2 & " (" & Format(Forms![3rdpartyproceeds]!amt2, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim3 & " (" & Format(Forms![3rdpartyproceeds]!amt3, "$###,##0.00") & ") and " & Forms![3rdpartyproceeds]!Claim4 & " (" & Format(Forms![3rdpartyproceeds]!amt4, "$###,##0.00") & ")"
ElseIf Forms![3rdpartyproceeds]!amt3 > 0 And (Forms![3rdpartyproceeds]!amt4 = 0 Or IsNull(Forms![3rdpartyproceeds]!amt4)) Then
VClaims = Forms![3rdpartyproceeds]!Claim1 & " (" & Format(Forms![3rdpartyproceeds]!amt1, "$###,##0.00") & "), " & Forms![3rdpartyproceeds]!Claim2 & " (" & Format(Forms![3rdpartyproceeds]!amt2, "$###,##0.00") & ") and " & Forms![3rdpartyproceeds]!Claim3 & " (" & Format(Forms![3rdpartyproceeds]!amt3, "$###,##0.00") & ")"
ElseIf Forms![3rdpartyproceeds]!amt2 > 0 And (Forms![3rdpartyproceeds]!amt3 = 0 Or IsNull(Forms![3rdpartyproceeds]!amt3)) Then
VClaims = Forms![3rdpartyproceeds]!Claim1 & " (" & Format(Forms![3rdpartyproceeds]!amt1, "$###,##0.00") & ") and " & Forms![3rdpartyproceeds]!Claim2 & " (" & Format(Forms![3rdpartyproceeds]!amt2, "$###,##0.00") & ")"
ElseIf Forms![3rdpartyproceeds]!amt1 > 0 And (Forms![3rdpartyproceeds]!amt2 = 0 Or IsNull(Forms![3rdpartyproceeds]!amt2)) Then
VClaims = Forms![3rdpartyproceeds]!Claim1 & " (" & Format(Forms![3rdpartyproceeds]!amt1, "$###,##0.00") & ")"
End If

Escrow3rd = VClaims


End Function
Public Function Escrow3rdAMC()
Dim VClaims As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from thirdparty where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs!Amt5 > 0 Then
VClaims = rs!Claim1 & " (" & Format(rs!amt1, "$###,##0.00") & "), " & rs!Claim2 & " (" & Format(rs!amt2, "$###,##0.00") & "), " & rs!Claim3 & " (" & Format(rs!amt3, "$###,##0.00") & "), " & rs!Claim4 & " (" & Format(rs!amt4, "$###,##0.00") & ") and " & rs!Claim5 & " (" & _
Format(rs!Amt5, "$###,##0.00") & ")"
ElseIf rs!amt4 > 0 And (rs!Amt5 = 0 Or IsNull(rs!Amt5)) Then
VClaims = rs!Claim1 & " (" & Format(rs!amt1, "$###,##0.00") & "), " & rs!Claim2 & " (" & Format(rs!amt2, "$###,##0.00") & "), " & rs!Claim3 & " (" & Format(rs!amt3, "$###,##0.00") & ") and " & rs!Claim4 & " (" & Format(rs!amt4, "$###,##0.00") & ")"
ElseIf rs!amt3 > 0 And (rs!amt4 = 0 Or IsNull(rs!amt4)) Then
VClaims = rs!Claim1 & " (" & Format(rs!amt1, "$###,##0.00") & "), " & rs!Claim2 & " (" & Format(rs!amt2, "$###,##0.00") & ") and " & rs!Claim3 & " (" & Format(rs!amt3, "$###,##0.00") & ")"
ElseIf rs!amt2 > 0 And (rs!amt3 = 0 Or IsNull(rs!amt3)) Then
VClaims = rs!Claim1 & " (" & Format(rs!amt1, "$###,##0.00") & ") and " & rs!Claim2 & " (" & Format(rs!amt2, "$###,##0.00") & ")"
ElseIf rs!amt1 > 0 And (rs!amt2 = 0 Or IsNull(rs!amt2)) Then
VClaims = rs!Claim1 & " (" & Format(rs!amt1, "$###,##0.00") & ")"
End If

Escrow3rdAMC = VClaims
rs.Close

End Function
Public Function UpdateEMC()
Dim strsql
Dim rs As RecordSet

strsql = "select clientrefnumber, filenum from cases where client = " & """" & "EMC Mortgage Corporation" & """" & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)



rs.MoveFirst

    
Do While Not rs.EOF
If Len(rs!ClientRefNumber) < 10 Then

With rs
.Edit

If Len(rs!ClientRefNumber) = 9 Then
!ClientRefNumber = "0" + rs!ClientRefNumber
End If
If Len(rs!ClientRefNumber) = 8 Then
!ClientRefNumber = "00" + rs!ClientRefNumber
End If
If Len(rs!ClientRefNumber) = 7 Then
!ClientRefNumber = "000" + rs!ClientRefNumber
End If
If Len(rs!ClientRefNumber) = 6 Then
!ClientRefNumber = "0000" + rs!ClientRefNumber
End If
If Len(rs!ClientRefNumber) = 5 Then
!ClientRefNumber = "00000" + rs!ClientRefNumber
End If

.Update
End With
End If
rs.MoveNext
Loop
rs.Close

End Function

Public Function AffCoop()
'If Forms![foreclosure database screen]!ForeclosureSubForm.Form.coop = -1 Or _
'Forms![foreclosure database screen]!ForeclosureSubForm.Form.coop = 1 Then
'AffCoop = Forms![foreclosure database screen]!ForeclosureSubForm.Form.OrgLender
'Else
''AffCoop = Part1Trustees()
AffCoop = [Forms]![foreclosure database screen]![trustees2]
'End If


End Function
Public Function DML()
If Forms![foreclosure database screen]!ForeclosureSubForm.Form.Mortgage = -1 Then
DML = "Mortgage"
ElseIf Forms![foreclosure database screen]!ForeclosureSubForm.Form.land_installment = -1 Then
DML = "Land Installment Contract"
ElseIf Forms![foreclosure database screen]!ForeclosureSubForm.Form.coop = -1 Then
DML = "Security Agreement"
Else
DML = "Deed of Trust"
End If
End Function
Public Function DMLPos()

If Forms![foreclosure database screen]!ForeclosureSubForm.Form.Mortgage = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form.land_installment = -1 Then
If Forms![foreclosure database screen]![ForeclosureSubForm].[Form].[POSCTD] = "POS" Then
DMLPos = "Mortgage Assignees"
Else
DMLPos = "Trustee"
End If
Else
DMLPos = "Substitute Trustee"
End If
End Function

Public Function IsTable(strTableName As String) As Boolean
On Error Resume Next
IsTable = (CurrentDb.TableDefs(strTableName).name = strTableName)
End Function
Public Function linenum(Reset As Boolean)

Static x
If Reset = True Then x = 0
x = x + 1
linenum = x

End Function
Public Function CreateDirectories()
Dim strsql As String
Dim rs As RecordSet

'strsql = "select filenum from cases where status <> " & """" & "Closed" & """" & " and status <> " & """" & "Archived" & """" & ";"
'Set RS = CurrentDb.OpenRecordset(strsql, dbopensnapshot)
'RS.MoveFirst

'Do While Not RS.EOF
GblFilenum = 48998
'gblfilenum = RS!FIleNum
If GblFilenum >= 48000 And GblFilenum <= 48999 Then
VFolder = "48000-48999\"
End If

Dim f, fso
Set fso = CreateObject("Scripting.filesystemobject")

'-----
'VFolder = "\\rvdv-fs01\datatransfer\bgwfiles"

'Set fs = CreateObject("Scripting.filesystemobject")
'Set fldr = fs.GetFolder(VFolder)
 
'For Each f1 In fldr.Files
'    If gblfilenum Like f1.name Then
    
'    End If
'Next
'-----------------

Set f = fso.CreateFolder("\\rvdv-fs01\bgwfiles$\" & VFolder & GblFilenum)
Set fso = Nothing
Set f = Nothing
'RS.MoveNext
'Loop

'RS.Close

End Function

Public Function NoticeDate()
'If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!NoticeSent) Then
'VNoticeDate = InputBox("Notice Sent Date on the Screen is blank.  Please input date for letter.  This will NOT update the Notice Sent date on the Foreclosure Screen will only be used for the Letter.")
NoticeDate = Format(Date, "mmmm dd, yyyy")
'Else
'NoticeDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!NoticeSent, "mmmm dd, yyyy")
'End If

End Function

Public Function modification()
Dim ModDate, ModPrinBal
Dim ModLiber As String, ModFolio, VincDec As String
Dim ModInst As String

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_date) Then
ModDate = ""
Else
ModDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_date, "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal) Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal = 0 Then

ModPrinBal = ""

Else
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal > Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount Then
VincDec = "increase"
Else
VincDec = "decrease"
End If
ModPrinBal = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal, "$###,##0.00")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber) And _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio) Then
If Forms![foreclosure database screen]!PropertyState = "VA" And _
Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_inst) Then
ModInst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_inst
End If
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber) Then
ModLiber = ""
Else
ModLiber = Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber
End If
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio) Then
ModFolio = ""
Else
ModFolio = Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio
End If

If (ModLiber <> "" Or ModFolio <> "") _
And Forms![foreclosure database screen]!PropertyState = "MD" Then
If ModLiber = "" Then
ModLiber = "Liber __________, "
Else
ModLiber = "Liber " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Folio __________, "
Else
ModFolio = "Folio " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio
End If
End If

If ModLiber <> "" _
And Forms![foreclosure database screen]!PropertyState = "DC" Then
ModLiber = "Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber
End If

If (ModLiber <> "" Or ModFolio <> "" Or ModInst <> "") _
And Forms![foreclosure database screen]!PropertyState = "VA" Then

If ModLiber = "" Then
ModLiber = "Deed Book __________, "
Else
ModLiber = "Deed Book " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Page __________, "
Else
ModFolio = "Page " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio
End If
End If

If ModInst <> "" Then
ModLiber = "Instrument No. " & ModInst
End If

If ModLiber = "" And ModFolio = "" Then
If ModPrinBal = "" Then
If ModDate = "" Then
modification = ""
Else
modification = ", and modified on " & ModDate
End If
Else
modification = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal
End If
Else
If ModLiber Like "instrument*" Then
modification = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal & ". This modification agreement was recorded in " & ModLiber
Else
modification = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal & ". This modification agreement was recorded in " & ModLiber & ", " & ModFolio
End If

End If


'MsgBox (ModLiber & ModFolio)



End Function

Public Function modificationVA()
Dim ModDate, ModPrinBal
Dim ModLiber As String, ModFolio, VincDec As String
Dim ModInst As String

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_date) Then
ModDate = ""
Else
ModDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_date, "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal) Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal = 0 Then
ModPrinBal = ""
Else
ModPrinBal = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_prinbal, "$###,##0.00")
End If

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_inst) Then
ModLiber = "Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_inst
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber) Then
ModLiber = "Deed Book " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_liber
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio) Then
ModFolio = "Page " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!mot_folio
End If
Else
ModLiber = ""
End If


If ModLiber = "" And ModFolio = "" And ModPrinBal = "" And ModDate = "" Then
modificationVA = ""
Else
modificationVA = ", and modified on " & ModDate & " by an instrument recorded in " & ModLiber
'Else
'modificationVA = ", and modified on " & ModDate & " was recorded in " & ModLiber & ", " & ModFolio
End If

'MsgBox (modificationVA)


End Function
Public Function Modsales()
Dim ModDate, ModPrinBal
Dim ModLiber As String, ModFolio, VincDec As String
Dim ModInst As String

If IsNull(Forms![VirginiaSales]!mot_date) Then
ModDate = ""
Else
ModDate = Format(Forms![VirginiaSales]!mot_date, "mmmm dd, yyyy")
End If


If IsNull(Forms![VirginiaSales]!mot_prinbal) Or _
Forms![VirginiaSales]!mot_prinbal = 0 Then

ModPrinBal = ""

Else
If Forms![VirginiaSales]!mot_prinbal > Forms![VirginiaSales]!OrgAmount Then
VincDec = "increase"
Else
VincDec = "decrease"
End If
ModPrinBal = Format(Forms![VirginiaSales]!mot_prinbal, "$###,##0.00")
End If

If IsNull(Forms![VirginiaSales]!mot_liber) And _
IsNull(Forms![VirginiaSales]!mot_folio) Then
If Forms![VirginiaSales]!PropertyState = "VA" And _
Not IsNull(Forms![VirginiaSales]!mot_inst) Then
ModInst = Forms![VirginiaSales]!mot_inst
End If
End If

If IsNull(Forms![VirginiaSales]!mot_liber) Then
ModLiber = ""
Else
ModLiber = Forms![VirginiaSales]!mot_liber
End If
If IsNull(Forms![VirginiaSales]!mot_folio) Then
ModFolio = ""
Else
ModFolio = Forms![VirginiaSales]!mot_folio
End If

If (ModLiber <> "" Or ModFolio <> "") _
And Forms![VirginiaSales]!PropertyState = "MD" Then
If ModLiber = "" Then
ModLiber = "Liber __________, "
Else
ModLiber = "Liber " & Forms![VirginiaSales]!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Folio __________, "
Else
ModFolio = "Folio " & Forms![VirginiaSales]!mot_folio
End If
End If

If ModLiber <> "" _
And Forms![VirginiaSales]!PropertyState = "DC" Then
ModLiber = "Instrument No. " & Forms![VirginiaSales]!mot_liber
End If

If (ModLiber <> "" Or ModFolio <> "" Or ModInst <> "") _
And Forms![VirginiaSales]!PropertyState = "VA" Then

If ModLiber = "" Then
ModLiber = "Deed Book __________, "
Else
ModLiber = "Deed Book " & Forms![VirginiaSales]!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Page __________, "
Else
ModFolio = "Page " & Forms![VirginiaSales]!mot_folio
End If
End If

If ModInst <> "" Then
ModLiber = "Instrument No. " & ModInst
End If

If ModLiber = "" And ModFolio = "" Then
If ModPrinBal = "" Then
If ModDate = "" Then
Modsales = ""
Else
Modsales = ", and modified on " & ModDate
End If
Else
Modsales = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal
End If
Else
If ModLiber Like "instrument*" Then
Modsales = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal & ". This modification agreement was recorded in " & ModLiber
Else
Modsales = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal & ". This modification agreement was recorded in " & ModLiber & ", " & ModFolio
End If

End If
End Function
Public Function ModificationSALES()
Dim ModDate, ModPrinBal, ModLiber, ModFolio, VincDec As String

If IsNull(Forms![VirginiaSales]!mot_date) Then
ModDate = ""
Else
ModDate = Format(Forms![VirginiaSales]!mot_date, "mmmm dd, yyyy")
End If

If IsNull(Forms![VirginiaSales]!mot_prinbal) Or Forms![VirginiaSales]!mot_prinbal = 0 Then
ModPrinBal = ""
Else
If Forms![VirginiaSales]!mot_prinbal > Forms![VirginiaSales]!OrgAmount Then
VincDec = "increase"
Else
VincDec = "decrease"
End If

ModPrinBal = Format(Forms![VirginiaSales]!mot_prinbal, "$###,##0.00")
End If

If IsNull(Forms![VirginiaSales]!mot_liber) Then
ModLiber = ""
Else
ModLiber = Forms![VirginiaSales]!mot_liber
End If
If IsNull(Forms![VirginiaSales]!mot_folio) Then
ModFolio = ""
Else
ModFolio = Forms![VirginiaSales]!mot_folio
End If

If (ModLiber <> "" Or ModFolio <> "") _
And Forms![VirginiaSales]!PropertyState = "MD" Then
If ModLiber = "" Then
ModLiber = "Liber __________, "
Else
ModLiber = "Liber " & Forms![VirginiaSales]!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Folio __________, "
Else
ModFolio = "Folio " & Forms![VirginiaSales]!mot_folio
End If
End If

If ModLiber <> "" _
And Forms![VirginiaSales]!PropertyState = "DC" Then
ModLiber = "Instrument No. " & Forms![VirginiaSales]!mot_liber
End If

If (ModLiber <> "" Or ModFolio <> "") _
And Forms![VirginiaSales]!PropertyState = "VA" Then
If ModLiber = "" Then
ModLiber = "Deed Book __________, "
Else
ModLiber = "Deed Book " & Forms![VirginiaSales]!mot_liber
End If
If ModFolio = "" Then
ModFolio = "Page __________, "
Else
ModFolio = "Page " & Forms![VirginiaSales]!mot_folio
End If
End If


If ModLiber = "" And ModFolio = "" Then
If ModPrinBal = "" Then
If ModDate = "" Then
ModificationSALES = ""
Else
ModificationSALES = ", and modified on " & ModDate
End If
Else
ModificationSALES = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal
End If
Else
ModificationSALES = ", and modified on " & ModDate & ", to " & VincDec & " the principal balance to " & ModPrinBal & ". This modification agreement was recorded in " & ModLiber & ", " & ModFolio
End If
'MsgBox (ModLiber & ModFolio)



End Function


Public Function FirstAmer()
Dim Client As String

Client = Forms![foreclosure database screen]![Client]

If (Client = "JPMorgan Chase Bank, National Association" Or _
Client = "Washington Mutual Bank" Or _
Client Like "Litton*" Or Client Like "Homeward*" Or Client Like "Homecoming*" _
Or Client Like "Ocwen*" Or Client Like "EMC*" Or Client Like "select*") Then
FirstAmer = "YES"
Else
FirstAmer = "NO"
End If

End Function
Public Function Fidelity()
Dim Fidbutton As String

If Forms![foreclosure database screen]!Fidelity = -1 Then
Fidelity = "YES"
Else
Fidelity = "NO"
End If
End Function
Public Function Newspaper()
Dim strsql, strsqlfc As String
Dim rs, rsFC As RecordSet

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


strsqlfc = "Select newspaper1, newspaper2 from foreclosure where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)

If rs.EOF Then
Dim vCounty As String
vCounty = InputBox("There is not a Newspaper input for this County in the Jurisdiction Screen.  Please input into Jurisdiction Screen after completing the Accounting.  You can type one in the box now for this Accounting.")
Newspaper = vCounty
ElseIf rsFC!newspaper2 = -1 Then
Newspaper = rs!newspaper2
Else
Newspaper = rs!Newspaper
End If
rs.Close
rsFC.Close

End Function
Public Function newspaper1()

Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from jurisdiction where county = " & """" & Forms![VirginiaSales]!Propertycounty & """" & " and state = " & """" & Forms![VirginiaSales]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Dim vCounty As String
newspaper1 = ""
Else
newspaper1 = rs!Newspaper & ": Pub: " & rs!day_publication
End If
rs.Close
End Function
Public Function newspaper2()

Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from jurisdiction where county = " & """" & Forms![VirginiaSales]!Propertycounty & """" & " and state = " & """" & Forms![VirginiaSales]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Dim vCounty As String
newspaper2 = ""
Else
newspaper2 = rs!newspaper2 & ": Pub: " & rs!day_publication2
End If
rs.Close
End Function

Public Function pubreq() As String
Dim VPub1, VPub2, VPub3, VPub4, VPub5, VPubNo As String

VPub1 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad], "mmmm dd, yyyy")
VPubNo = 1
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub2]) Then
Else
VPubNo = VPubNo + 1
VPub2 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub2], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub3]) Then
Else
VPubNo = VPubNo + 1
VPub3 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub3], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub4]) Then
Else
VPubNo = VPubNo + 1
VPub4 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub4], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub5]) Then

Else
VPubNo = VPubNo + 1
VPub5 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub5], "mmmm dd, yyyy")
End If
If VPubNo = 4 Or VPubNo = 2 Then
pubreq = "once a week for " & VPubNo & " weeks"
Else
pubreq = VPubNo & " times"
End If

End Function
Public Function pubdates() As String

Dim VPub1, VPub2, VPub3, VPub4, VPub5 As String

VPub1 = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad], "mmmm dd, yyyy")
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub2]) Then
Else
VPub2 = ", " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub2], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub3]) Then
Else
VPub3 = ", " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub3], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub4]) Then
Else
VPub4 = ", " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub4], "mmmm dd, yyyy")
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub5]) Then

Else
VPub5 = ", " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![pub5], "mmmm dd, yyyy")
End If

pubdates = VPub1 & VPub2 & VPub3 & VPub4 & VPub5

End Function
Public Function RptSaleWithdraw()
Dim VarYN As String

VarYN = MsgBox("With Consent?", vbYesNo)


If VarYN = vbYes Then
DoCmd.OpenForm "ReportSaleWithdrawForm"
Else
DoCmd.OpenReport "ReportSaleMDLineWithdraw", acViewPreview
End If

End Function
Public Function LitigationNo()
DoCmd.Close acForm, "complaint"
strsql = "Select * from litigation where subfilenum = " & Forms![foreclosure database screen]![filenum]
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rs.EOF Then
With rs
.AddNew
!SubFileNum = Forms![foreclosure database screen]![filenum]
.Update
End With
End If
rs.Close

strsql = "select * from litdeftbl where filenum = " & GblFilenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("litdeftbl", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = GblFilenum
.Update
.Close
End With
Else
rs.Close
End If

strsql = "select * from litexctbl where filenum = " & GblFilenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("litexctbl", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = GblFilenum
.Update
.Close
End With
Else
rs.Close
End If

strsql = "select * from litmotiontbl where filenum = " & GblFilenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("litmotiontbl", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = GblFilenum
.Update
.Close
End With
Else
rs.Close
End If

strsql = "select * from litstatusconftbl where filenum = " & GblFilenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Set rs = CurrentDb.OpenRecordset("litstatusconftbl", dbOpenDynaset, dbSeeChanges)

With rs
.AddNew
!filenum = GblFilenum
.Update
.Close
End With
Else
rs.Close
End If


    Dim stDocName As String
    Dim stLinkCriteria As String
    stDocName = "LitigationForm"
    

DoCmd.OpenForm "complaint"

End Function

Public Function PS3rdAdd1()
strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If (Client() Like "Citi*") And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
PS3rdAdd1 = "605 Munn Road"
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" And _
Forms![foreclosure database screen]!Client Like "Ditech*" And _
(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1) Then
PS3rdAdd1 = "payoff PROCESSING, IASC - 62"
ElseIf Not IsNull(rs![3rd_address1]) Then
PS3rdAdd1 = rs![3rd_address1]
Else
PS3rdAdd1 = rs!Address
End If

rs.Close
End Function
Public Function PS3rdAdd2()

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If (Client() Like "Citi*") And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
PS3rdAdd2 = ""
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" And _
Forms![foreclosure database screen]!Client Like "Ditech*" And _
(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1) Then
PS3rdAdd2 = "1555 W. WALNUT HILL LN, SUITE 100"
ElseIf Not IsNull(rs![3rd_address1]) Then
PS3rdAdd2 = rs![3rd_address2]
Else
If Not IsNull(rs!claddress2) Then
PS3rdAdd2 = rs!claddress2
Else
PS3rdAdd2 = ""
End If

End If
rs.Close

End Function
Public Function PS3rdCSZ()
strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If (Client() Like "Citi*") And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
PS3rdCSZ = "Fort Mill, SC  29715"
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" And _
Forms![foreclosure database screen]!Client Like "Ditech*" And _
(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1) Then
PS3rdCSZ = "IRVING, TX 75038"
ElseIf Not IsNull(rs![3rd_address1]) Then
PS3rdCSZ = rs![3rd_city] & ", " & rs![3rd_State] & "  " & rs![3rd_zip]
Else
PS3rdCSZ = rs!City & ", " & rs!cl_state & "  " & rs!PostalCode
End If
rs.Close
End Function
Public Function PS3rdAttn()

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Client() Like "Citi*" And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
PS3rdAttn = "Attn: April McBryde"

ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" And _
Forms![foreclosure database screen]!Client Like "Ditech*" And _
(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1) Then
PS3rdAttn = ""

Else

If IsNull(rs![3rd_contact]) Then
PS3rdAttn = ""
Else
PS3rdAttn = "Attn: " & rs![3rd_contact]
End If

End If

rs.Close
End Function
Public Function AuctionMD()
Dim vARDate, DocName, Docname2 As String

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!deposit = 0 Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!deposit) Then
MsgBox ("NO DEPOSIT INPUT!!")
Exit Function

Else

DocName = "Auct-MDATTACH"

Dim VPWCo As String
VPWCo = InputBox("(P)aperwork or (C)orrection?")
If VPWCo Like "C*" Then
VPWCo = "Correction"
Else
VPWCo = "PW"
End If

DoCmd.OutputTo acOutputReport, DocName, acFormatSNP, pathuser() & "\AuctionMD.snp"

Dim Vpone
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentCourt) Or Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentCourt = "" Then
Vpone = ""
Else
Vpone = " / Part1 Crt: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentCourt
End If

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application
'MsgBox (prop())

emailsubject = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & " / " & VPWCo & " / " & Forms![foreclosure database screen]!LastNameDebtor1 & " / " & PROP() & Vpone & " / " & Forms![foreclosure database screen]!Client
emailbody = "Attached please find Auction MD report."


Set MyMail = MyOutlook.CreateItem(olMailItem)


MyMail.To = "dmorgan@alexcooper.com; rebecca.delaney@bww-law.com; Eddie.Kutz@trioservices.net"
MyMail.Attachments.ADD pathuser() & "\AuctionMD.snp"
MyMail.Subject = emailsubject
MyMail.body = emailbody & SigEmail()
MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End If




'If Forms![foreclosure database screen]!Client Like "Ocwen*" Or _
'(Forms![foreclosure database screen]![PropertyCounty] = "Allegany" _
'Or Forms![foreclosure database screen]![PropertyCounty] = "Dorchester" _
'Or Forms![foreclosure database screen]![PropertyCounty] = "Garrett" _
'Or Forms![foreclosure database screen]![PropertyCounty] = "Somerset" _
'Or Forms![foreclosure database screen]![PropertyCounty] = "Wicomico" _
'Or Forms![foreclosure database screen]![PropertyCounty] = "Worcester") Then
''docname = "Auct-MD"
''DoCmd.OpenReport docname, acViewPreview
''Docname2 = "Auct-MD-FIdelity"
''DoCmd.OpenReport Docname2, acViewPreview
''Else
'Docname2 = "Auct-MD-FIdelity"
'DoCmd.OpenReport Docname2, acViewPreview
'End If
'end If
Call EmailSale

End Function


Public Function lenderpd()

If [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer] Like "*REO*" _
Or [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]!Purchaser_Last Like "*REO*" _
Or Forms![foreclosure database screen]![PostsaleSubForm].Form![printclientadd] = 1 Then
lenderpd = ""
Else
vpdon = InputBox("Lender Was Paid on?")
lenderpd = "The Lender was paid on " & Format(vpdon, "mmmm dd"", ""yyyy") & "."
End If

End Function

Public Function PrtACCT()
Dim strsql As String
Dim rs As RecordSet

If IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![motion subpurchaser]) And _
Forms![foreclosure database screen]!TypeOfLoan = "VA" And _
(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 0 Or _
IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party])) Then

MsgBox ("Loan type is VA and Subpurchaser Order date is not filled in.  Accounting will not print out....exiting.")
Exit Function
End If

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Call DebtorsPropOnly
Call OwnersOnly


strsql = "Select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If ([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer] Like "*REO*" _
Or [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]!Purchaser_Last Like "*REO*" _
 Or Forms![foreclosure database screen]![PostsaleSubForm].Form![printclientadd] = 1 Or _
Forms![foreclosure database screen]![PostsaleSubForm].Form![3rd_party] = 0) And _
Forms![accountingmain]![accounting].Form![defsurplus] > 0 Then

Dim Psswd As String
Psswd = InputBox("Warning - -this is an REO surplus  DO NOT FILE THE ACCOUNTING, To Override you MUST type in the Correct Password")
If Psswd = "OK" Then

If Forms![foreclosure database screen]!Propertycounty = "Kent" Then
DoCmd.OpenReport ("accountingKent"), acViewPreview
End If

If Forms![foreclosure database screen]!Propertycounty = "Charles" Then
DoCmd.OpenReport ("accountingcc"), acViewPreview
DoCmd.OpenReport ("accaff"), acViewPreview
Else
DoCmd.OpenReport ("accounting"), acViewPreview
End If


If Forms![foreclosure database screen]!Propertycounty = "Caroline" _
Or Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Then
DoCmd.OpenReport ("accaffcaroline"), acViewPreview
ElseIf Forms![foreclosure database screen]!Propertycounty = "Dorchester" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent" Or _
Forms![foreclosure database screen]!Propertycounty = "Queen Anne" Or _
Forms![foreclosure database screen]!Propertycounty = "Cecil" Then
DoCmd.OpenReport ("accaffpg"), acViewPreview

End If


DoCmd.OpenReport ("CourtAuditorLtr"), acViewPreview


If Forms![foreclosure database screen]!Propertycounty = "Allegany" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Garrett" Then
DoCmd.OpenReport ("OrderRatAccounting"), acViewPreview

End If


strsql = "Select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
DoCmd.OpenReport ("accountingcert2"), acViewPreview
Else
DoCmd.OpenReport ("accountingcert"), acViewPreview
End If

If Forms![foreclosure database screen]!Propertycounty = "Carroll" Then
DoCmd.OpenReport ("accountingPetitionTrusCom"), acViewPreview
DoCmd.OpenReport ("accountingOrderPetTrus"), acViewPreview

End If

Else
rs.Close

Exit Function
End If

Else
If Forms![foreclosure database screen]!Propertycounty = "Charles" Then
DoCmd.OpenReport ("accountingcc"), acViewPreview
DoCmd.OpenReport ("accaff"), acViewPreview
Else
DoCmd.OpenReport ("accounting"), acViewPreview
End If

If Forms![foreclosure database screen]!Propertycounty = "Caroline" _
Or Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Then
DoCmd.OpenReport ("accaffcaroline"), acViewPreview

If Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Then
MsgBox ("PLEASE PAY COURT AUDITOR WITH THE ACCOUNTING. Time Record will print out!")
DoCmd.OpenReport ("ACCOUNTINGtimerecord"), acViewPreview
End If

Else
DoCmd.OpenReport ("accaffpg"), acViewPreview
End If
If Forms![foreclosure database screen]!Propertycounty = "Dorchester" Then
MsgBox ("PLEASE PAY COURT AUDITOR WITH THE ACCOUNTING. Time Record will print out!")
DoCmd.OpenReport ("ACCOUNTINGtimerecord"), acViewPreview
End If


If Forms![foreclosure database screen]!Propertycounty Like "Queen*" Then
MsgBox ("Time Record will print out!")
DoCmd.OpenReport ("ACCOUNTINGtimerecordQA"), acViewPreview
End If

DoCmd.OpenReport ("CourtAuditorLtr"), acViewPreview


If Forms![foreclosure database screen]!Propertycounty = "Allegany" Or _
Forms![foreclosure database screen]!Propertycounty = "Garrett" Then
DoCmd.OpenReport ("OrderRatAccounting"), acViewPreview
End If


If rs.EOF Then
DoCmd.OpenReport ("accountingcert2"), acViewPreview, acViewPreview
Else
DoCmd.OpenReport ("accountingcert"), acViewPreview
End If


If Forms![foreclosure database screen]!Propertycounty = "Carroll" Then
DoCmd.OpenReport ("accountingPetitionTrusCom"), acViewPreview
DoCmd.OpenReport ("accountingOrderPetTrus"), acViewPreview

End If

If Forms![foreclosure database screen]!Propertycounty Like "Howar*" Then
MsgBox ("This is a Howard County Audit.  An email will generate with a Spreadsheet for the Auditor")

Call SuggestedAudits

End If
End If

rs.Close

End Function
Public Function CooperCancelPart3()
'MsgBox ("Refreshing Data")
'
Forms![foreclosure database screen]!ForeclosureSubForm.Form!Sale_cancelled_proc = getEmployeeInitials(username())
MsgBox "SALE CANCELLED!" & vbCrLf & "PLEASE MAKE SURE NAME AUTO-POPULATES IN " & """" & "Sale Cancelled By" & """" & " FIELD!", , "SALE CANCELLED BY"
Call AddJournalEntryONLY(GblFilenum, "Cancelled Sale")

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!expense_3rd = -1 Then
Dim vpassword As String
vpassword = InputBox("This is a Resale a Bankruptcy by Borrower will not stop the sale.  Must have Password to continue.  ")

If vpassword <> "defaultpurchasercancel" Then
Forms![foreclosure database screen]!ForeclosureSubForm.Form![sale cancelled] = Null
mySendKeys ("{F9}")
Exit Function
Else
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![sale cancelled]) Then
If Forms![foreclosure database screen]!Propertycounty = "Dorchester" Then
MsgBox ("This is a Dorchester County Sale, please dismiss the case")
End If

If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Or _
Forms![foreclosure database screen]!Propertycounty = "Worcester" Or _
Forms![foreclosure database screen]!Propertycounty = "Dorchester" Then
MsgBox ("Line will Preview for Printing")
DoCmd.OpenReport ("LineCancel"), acViewPreview
End If
End If

End If
End If


If Forms![foreclosure database screen]!Client Like "Wells*" Then
Dim VWells As String

VWells = InputBox("Wells Fargo File:" & vbCr & vbCr & "Is this a (H)old or a (P)ostponement?" & vbCr & "(enter H or P)")
If VWells = "p" Or VWells = "P" Then
Dim VRSDate
VRSDate = InputBox("What is Restart Follow Up Date?")
Forms![foreclosure database screen]!ForeclosureSubForm.Form!restart_fu = VRSDate
End If
End If


End Function
Public Function CooperCancelPart1()
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason) Then
MsgBox ("No Reason input for Sale Cancelled.  Will not complete.  Please input a reason and reinput date.")
Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled = Null
mySendKeys ("{F9}")
DoEvents
Exit Function
End If

If Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
MsgBox ("FC has been canceled and/or placed on hold. Please update ADR accordingly.")
End If

Dim VEnd
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
VEnd = Date + 5

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" And _
(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate >= Date And _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate <= VEnd) Then

Dim VPsswd
VPsswd = InputBox("Unable to cancel sale until client has FNMA approval and we need it in writing.  Do you have approval from FNMA in writing? (Yes/No)")

If VPsswd <> "Yes" Then
MsgBox ("Please obtain FNMA approval before cancelling sale!")
Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled = Null
mySendKeys ("{F9}")
DoEvents
Exit Function
Else
End If

End If
End If

mySendKeys ("{F9}")
DoEvents

End Function

Public Function coopercancel()

Call CooperCancelPart1

Dim db As DAO.Database
Dim MailList As DAO.RecordSet
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Subjectline As String
Dim BodyFile As String
Dim MyBody As TextStream
Dim MyBodyText As String
Dim strsql, vARDate, VarClient, varborrower, VarLoan As String
Dim SEmail, vtitle, emailsubject, emailmessage, E1, E2, E3, e4, e5, e6, e7, e8, e9, e10 As String
Dim rs As RecordSet
Dim VarParaLegal, strPL  As String
Dim rsPL As RecordSet
Dim varsendemail As String
Dim varEmailPrt
Dim varsending As String
Dim vNot As String
Dim BondSent As Date

'Call EmailWalzInvRequest
Dim isBondInfo As Boolean
isBondInfo = False
'Call EmailWalzInvRequest
    

Set rs = CurrentDb.OpenRecordset("select bond_amt,bond_number,bond_sent,Bond_court from postsale where subfilenum = " & Forms![foreclosure database screen]!filenum, dbOpenSnapshot)

'set isBondInfo = True after 10/21/14

If (rs.Fields("bond_amt").Value > 0 Or _
 rs.Fields("bond_number").Value > 0 Or _
 IsNull(rs.Fields("bond_sent").Value) = False Or _
 IsNull(rs.Fields("Bond_court").Value) = False) And rs.Fields("bond_sent").Value > DateSerial(2014, 10, 21) Then
 
 isBondInfo = True
 
 End If

rs.Close
Set rs = Nothing

'additional bond information from the resumes table

Set rs = CurrentDb.OpenRecordset("select bond_number,bond_sent,bond_amt from resumes where filenum = " & Forms![foreclosure database screen]!filenum & " order by bond_sent desc", dbOpenSnapshot)

Do While Not rs.EOF

If (rs.Fields("bond_amt").Value > 0 Or _
 rs.Fields("bond_number").Value > 0 Or _
 IsNull(rs.Fields("bond_sent").Value) = False) And rs.Fields("bond_sent").Value > DateSerial(2014, 10, 21) Then
    
    'MsgBox (rs.Fields("bond_sent").Value)
 
 isBondInfo = True
 
 Exit Do
 End If
 rs.MoveNext
Loop

rs.Close
Set rs = Nothing


'if bondinfo is filled in goto bond info function

If isBondInfo Then
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > _
    Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled Then
    Call BondInfoSaleCancelled
End If
    'GoTo changestatus
End If



If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason) Then
varreason = InputBox("Reason for Cancellation")
Else
varreason = Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason
End If

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled <> Date Then
vNot = "The sale cancelled date input is NOT for " & Date & ".  This file will not be on the Cooper Kills spreadsheet sent in the automatic emails tomorrow a.m."
End If

Dim VCont
    VCont = ""
    
    
    If Forms![foreclosure database screen]!PropertyState = "MD" And _
    Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact] <> "" Then
    
    VCont = Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact]
    
    strPL = "Select * from employees where EmployeeID = " & """" & VCont & """" & ";"
    Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)
    If Not rsPL.EOF Then
    
    If rsPL!EmailName <> "" Then
    VCont = rsPL!EmailName
    End If
    
    Else
    VCont = ""
    End If
    
    rsPL.Close
    End If



If Forms![foreclosure database screen]![PropertyState] = "MD" Then

  If varreason Like "Paid Off*" Or varreason Like "*Reinst*" Or varreason Like "Pay Of*" Then
    If VCont = "" Then
    VCont = " Dismissals@bww-law.com; Janice.Hill@bww-law.com"
    Else
    VCont = VCont & "; Dismissals@bww-law.com"
    End If
    End If
    
   ' MsgBox (VCont)
    

If Forms![foreclosure database screen]![Propertycounty] = "Allegany" _
Or Forms![foreclosure database screen]![Propertycounty] = "Garrett" Then
varsending = MsgBox("Sending Email to DebHidey@atlanticbbn.net, damyot@atlanticbbn.net; diana@alexcooper.com, Jeberly@atlanticbbn.net and MichaelCohen@atlanticbbn.net, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
varsending = MsgBox("Sending Email to diana@alexcooper.com, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
varsending = MsgBox("Sending Email to dccancellations@alexcooper.com, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then
varsending = vbNo
End If

    If varsending = vbYes Then
    
    If Forms![foreclosure database screen]!Client Like "Nationst*" Then
    emailsubject = " **INVOICE MUST BE SUBMITTED WITHIN 24 HOURS** " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    Else
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    End If
    
        

        If Forms![foreclosure database screen]![PropertyState] <> "DC" And _
        Forms![foreclosure database screen]![Propertycounty] <> "Allegany" _
        And Forms![foreclosure database screen]![Propertycounty] <> "Garrett" Then
        varfax = "410/828-9348"
        ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
        varfax = "202/364-0325"
        End If

   'Remove this piece
    VarParaLegal = DLookup("employeeid", "employees", "login='" & Environ("username") & "'")
    strPL = "Select * from employees where EmployeeID = " & """" & VarParaLegal & """" & ";"
    Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)
If rsPL.EOF Then
MsgBox "Your username is not found in the system.  Please submit an IT ticket and email awilson@systemadix.com for assistance", vbCritical
Exit Function
End If
        
        If IsNull(rsPL!MiddleName) Then
        sig1 = rsPL!FirstName & " " & rsPL!LastName
        vtitle = rsPL!Title
        Else
        sig1 = rsPL!FirstName & " " & rsPL!MiddleName & " " & rsPL!LastName
        'vtitle = rsPL!Title
        End If
        rsPL.Close
        

        VFid = ""
  
    
    'If Forms![foreclosure database screen]![PropertyCounty] = "Allegany" _
    'Or Forms![foreclosure database screen]![PropertyCounty] = "Garrett" Then
    'E1 = "BWW Law Group, LLC" & vbCr & vbCr & "(301) 961-6555" & vbCr & vbCr & "SALE CANCELLATION FORM" & vbCr & vbCr
    'Else
    E1 = ""
    'E1 = "BWW Law Group, LLC" & vbCr & vbCr & "(301) 961-6555" & vbCr & vbCr & "ALEX COOPER CANCELLATION FORM" & vbCr & vbCr
    'End If
    
    E2 = ""
    
    'E2 = "Fax: " & VarFax & vbCr & vbCr & "Sent to Court: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentCourt & vbCr & vbCr & "Notice Sent: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent & vbCr & vbCr
    
    E3 = "BWW Case#: " & Forms![foreclosure database screen]![filenum] & "  Client: " & Client() & vbCr & vbCr
    'e4 = "PERSON KILLING SALE: " & sig1 & vbCr & vbCr & "TODAY'S DATE/TIME: " & Date & vbCr & vbCr
    e4 = ""
    e5 = "SALE DATE/TIME: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleTime & vbCr & vbCr
    e6 = "PROPERTY STREET ADDRESS: " & PROP() & vbCr & vbCr & "PROPERTY COUNTY: " & Forms![foreclosure database screen]![Propertycounty] & vbCr & vbCr & "BORROWER NAME: " & debtorsFORE() & vbCr & vbCr
    e7 = "REASON FOR CANCELLATION: " & varreason & vbCr & vbCr
    
    
    'e8 = "DATE/TIME RECEIVED__________" & vbCr & vbCr & "WITHDRAWAL FEE $_________" & vbCr & vbCr & "AD COST  $_________" & vbCr & vbCr & VFid & vbCr & vbCr
    e8 = "DATE/TIME RECEIVED__________" & vbCr & vbCr & "WITHDRAWAL FEE $_________" & vbCr & vbCr & "AD COST  $_________"
    'e9 = "(Please note: We will fax a confirmation back to you within 45 minutes; if you do not receive this back within that time period, please call us.)"
    e9 = ""
    
    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7 + e8 ' + e9

    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
        
    '"3PP Default";"Active Military";"Attorney Transfer";"BK";"BK-Hold";"Charge Off";"FB Plan";"HAMP";"Hazard Claim/Property Damage";"Investor Request";"Litigation";"Loan Mod";"Loss Mit";
    '"Mediation";"Missing Certification";"Moratorium";"No Bid";"Paid Off";"Probate Review";"Reinstatement";"Sale Pub Incorrect";"Servicer Issue";"Servicing Transfer";"Short Sale";"Title Issue"
    
    If Date >= #8/4/2014# And Forms![foreclosure database screen]!Client Like "Suntrust*" Or _
    Forms![foreclosure database screen]!Client Like "Bank of Am*" Or _
      Forms![foreclosure database screen]!Client Like "Champion*" Or _
      Forms![foreclosure database screen]!Client Like "Residential*" Or _
      Forms![foreclosure database screen]!Client Like "*" Or _
    Forms![foreclosure database screen]!Client Like "Wells*" Then
    Dim vFldEmail
    vFldEmail = "SuntrustBills@bww-law.com; "
    Else
    vFldEmail = "MDKills@bww-law.com; "
    End If
    
     
    If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
    MsgBox ("No Sale Date in sale date field!")
    MyMail.To = vFldEmail & "Robert.Johnson@bww-law.com; cancel@trioservices.net; Eddie.Kutz@trioservices.net;" & VCont
    
    If Forms![foreclosure database screen]!Client Like "Nationst*" Then
    MyMail.CC = "Sonya.Moore@bww-law.com; Motylik.Zofajova@bww-law.com"
    ElseIf Forms![foreclosure database screen]!Client Like "Carrington*" Then
    MyMail.CC = "Sonya.Moore@bww-law.com; Motylik.Zofajova@bww-law.com"
    ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then
    MyMail.CC = "billing@bww-law.com"

    ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com"
    End If
    
    ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
    MyMail.To = "dccancellations@alexcooper.com; DCKills@bww-law.com; cancelsaleDC@bww-law.com" & VCont
    Call AddBillToBePrep
    ElseIf Forms![foreclosure database screen]![Propertycounty] = "Allegany" _
    Or Forms![foreclosure database screen]![Propertycounty] = "Garrett" Then
    MyMail.To = vFldEmail & "diana@alexcooper.com; bandrews@atlanticbbn.net; DebHidey@atlanticbbn.net; MichaelCohen@atlanticbbn.net; Robert.Johnson@bww-law.com; " & VCont
    emailmessage = emailmessage & vbCr & vNot
    Call AddBillToBePrep
    Else
    MyMail.To = vFldEmail & "diana@alexcooper.com; Robert.Johnson@bww-law.com; " & VCont
    emailmessage = emailmessage ' & vbCr & vNot
    Call AddBillToBePrep
    
   End If
    
    If VCont <> "" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate = Date Then
     If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com; "
    Else
    MyMail.CC = "Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com; "
    End If
    ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate = Date And VCont = "" Then
    If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com"
    Else
    MyMail.CC = "Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com"
    End If
    ElseIf VCont <> "" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate <> Date Then
    If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; "
    'Else
    'MyMail.CC = VCont
    End If
    End If
    
    MyMail.Subject = "Kill and Bill - " + emailsubject
    'MyMail.body = emailmessage & SEmail
    emailmessage = emailmessage & SEmail
    emailmessage = Replace(Replace(emailmessage, vbCrLf, "<br>"), vbCr, "<br>")
    emailmessage = "<body style=font-size:10.5pt>" & emailmessage & "</body>"
    MyMail.HTMLBody = emailmessage
    MyMail.Display
    
   Else
   Exit Function
   
End If
End If

If Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then
DoCmd.OpenReport "Cooper-Cancel-AttachmentMD", acViewPreview
End If

If Forms![foreclosure database screen]![Propertycounty] = "Somerset" _
Or Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then

If Forms![foreclosure database screen]![Propertycounty] = "Somerset" Then
varsendemail = MsgBox("Sending Email to dwslaw@comcast.net, Continue?", vbYesNo)
End If

If Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then

varsendemail = MsgBox("Sending Email to Swlaw@comcast.net, Continue?", vbYesNo)
End If


'DoCmd.OutputTo acOutputReport, "Cooper-Cancel-AttachmentMD", acFormatRTF, pathuser() & "\SaleCancel.rtf"

    If varsendemail = vbYes Then
    
    If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " /" & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    ElseIf Forms![foreclosure database screen]!Client Like "Nationsta*" Then
    emailsubject = " **INVOICE MUST BE SUBMITTED WITHIN 24 HOURS** " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    Else
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    End If
    
    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
    If Forms![foreclosure database screen]![Propertycounty] = "Somerset" Then
    MyMail.To = "dwslaw@comcast.net; Robert.Johnson@bww-law.com; " & VCont
    Else
    MyMail.To = "Swlaw@comcast.net; dwslaw@comcast.net; Robert.Johnson@bww-law.com; " & VCont
    End If
    
    MyMail.Subject = emailsubject
    Dim vtrustee As String
    
    If IsNull([Forms]![foreclosure database screen]![jurTrustee]) Then
    vtrustee = ""
    'MsgBox ("No Trustee for " & Forms![foreclosure database screen]!PropertyCounty)
    Else
    
    vtrustee = [Forms]![foreclosure database screen]![jurTrustee]
    If [Forms]![foreclosure database screen]![jurtrustee2] <> "" Then
    vtrustee = vtrustee & " and " & [Forms]![foreclosure database screen]![jurtrustee2]
    End If
    End If
    
    
    E1 = "BWW Law Group, LLC" & vbCr & "(301) 961-6555" & vbCr & "TRUSTEE CANCELLATION FORM" & vbCr
    E2 = "Fax: " & varfax & vbCr & vbCr
    E3 = "BWW Case#: " & Forms![foreclosure database screen]![filenum] & "  Client: " & Client() & vbCr & vbCr
'    e4 = "PERSON KILLING SALE: " & sig1 & vbCr & vbCr & vbCr & "TODAY'S DATE/TIME: " & Date & vbCr & vbCr
    e4 = ""
    e5 = "SALE DATE/TIME: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleTime & vbCr & vbCr
    e6 = "PROPERTY STREET ADDRESS: " & PROP() & vbCr & vbCr & "PROPERTY COUNTY: " & Forms![foreclosure database screen]![Propertycounty] & vbCr & vbCr & "BORROWER NAME: " & debtorsFORE() & vbCr & vbCr
    e7 = "REASON FOR CANCELLATION: " & varreason & vbCr & vbCr
    e8 = vtrustee & vbCr & vbCr & "DATE/TIME RECEIVED__________" & vbCr & vbCr & "WITHDRAWAL FEE $_________" & vbCr & vbCr
    e9 = "(Please note: We will fax a confirmation back to you within 45 minutes; if you do not receive this back within that time period, please call us.)"

    'If Vcont <> "" Then
    'emailmessage = e1 + e2 + e3 + Vcont + e4 + e5 + e6 + e7 + e8 + e9
    'Else
    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7 + e8 + e9
    'End If
    
    'MyMail.body = emailmessage & SEmail
    emailmessage = emailmessage & SEmail
    emailmessage = Replace(Replace(emailmessage, vbCrLf, "<br>"), vbCr, "<br>")
    emailmessage = "<body style=font-size:10.5pt>" & emailmessage & "</body>"
    
    'MyMail.Attachments.Add pathuser() & "\SaleCancel.rtf"
    MyMail.Display
    Else
    Exit Function
    End If

Set MyMail = Nothing
Set MyOutlook = Nothing
End If

'changestatus:

Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled = Date

Dim VChgStatus As String
VChgStatus = ""
VChgStatus = MsgBox("Do you want to change the status of this file?", vbYesNo)
If VChgStatus = vbNo Then
Exit Function
Else
VChgStatus = ""
VChgStatus = InputBox("AD = Active Duty" & vbCr & "A = Archived" & vbCr & "B = Bankruptcy" & vbCr & "BH = BK-Hold" & vbCr & "D = DeedInLieu" & vbCr & "ES = Estate" & vbCr & "E = Eviction" & vbCr & "F = Foreclosure" & vbCr & "H = Hold" & vbCr & "L = Litigation" & vbCr & "MED = Mediation" & vbCr & "M = Moratorium" & vbCr & "P = Postsale" & vbCr & "T = title issue" & vbCr)
If VChgStatus = "f" Then
Forms![foreclosure database screen]!Status = "Foreclosure"
ElseIf VChgStatus = "b" Then
Forms![foreclosure database screen]!Status = "Bankruptcy"
ElseIf VChgStatus = "bh" Then
Forms![foreclosure database screen]!Status = "BK-Hold"
ElseIf VChgStatus = "ad" Then
Forms![foreclosure database screen]!Status = "Active Duty"
ElseIf VChgStatus = "d" Then
Forms![foreclosure database screen]!Status = "Deed In Lieu"
ElseIf VChgStatus = "a" Then
Forms![foreclosure database screen]!Status = "Archived"
ElseIf VChgStatus = "p" Then
Forms![foreclosure database screen]!Status = "Postsale"
ElseIf VChgStatus = "h" Then
Forms![foreclosure database screen]!Status = "Hold"
ElseIf VChgStatus = "e" Then
Forms![foreclosure database screen]!Status = "Eviction"
ElseIf VChgStatus = "t" Then
Forms![foreclosure database screen]!Status = "title issue"
ElseIf VChgStatus = "l" Then
Forms![foreclosure database screen]!Status = "Litigation"
ElseIf VChgStatus = "es" Then
Forms![foreclosure database screen]!Status = "Estate"

Dim rsE As RecordSet
Dim strsqlE As String
Dim rsESTATE
Dim vFile
vFile = Forms![foreclosure database screen]!filenum
strsqlE = "select * from Estate where subfilenum = " & vFile & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)
If rsE.EOF Then
Set rsESTATE = CurrentDb.OpenRecordset("Estate")
With rsESTATE
.AddNew
!SubFileNum = Forms![foreclosure database screen]!filenum
.Update
.Close
End With
Else
rsE.Close
Set rsE = Nothing
End If

ElseIf VChgStatus = "m" Then
Forms![foreclosure database screen]!Status = "Moratorium"
ElseIf VChgStatus = "med" Then
Forms![foreclosure database screen]!Status = "Mediation"
End If
End If

mySendKeys ("{F9}")

Call CooperCancelPart3

End Function

Public Function prtRpt() As String
prtRpt = MsgBox("Does the Referral have a copy of the Note?", vbYesNo)
If prtRpt = vbNo Then
DoCmd.OpenReport ("PGMotiontoAccept")
DoCmd.RunMacro ("AffidavitLostNoteFORE-PRINT")
End If

End Function
Public Function varOLDClient()
Dim varoldname As String
varOLDClient = Forms![client information screen]!OrganizationName
End Function
Public Function SetApptype(ByVal strData As String)

    AppType = strData

End Function
Public Function debtdue() As String

Dim strsql, strsqlAff As String
Dim VDebtDue As String

Dim rs, rsAff As RecordSet

VDebtDue = 0

If Forms![foreclosure database screen]![PropertyState] = "DC" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note]) _
Or Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note] = 0 Then
MsgBox "PLEASE Input Statement of Debt Amount on Screen!", vbOKOnly
DoCmd.CancelEvent
Else
debtdue = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note], "$###,##0.00")
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Principal Balance]) Then
Do While VDebtDue = "0" Or VDebtDue = ""
VDebtDue = InputBox("UPB Not Input, Please Type in Debt Due:")
Loop
debtdue = Format(VDebtDue, "$###,#00.00")
Else
debtdue = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Principal Balance], "$###,#00.00")
End If

Else

strsql = "select * from foreclosure where subfilenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
strsqlAff = "select * from affdebt where subfilenum = " & Forms![foreclosure database screen]![filenum] & ";"
Set rsAff = CurrentDb.OpenRecordset(strsqlAff, dbOpenSnapshot)

If IsNull(rs![Principal Balance] + rsAff![interest amt] + rsAff![Late charge] + rsAff![lender advance] + rsAff![interest on advance] + rsAff![nsf charge] + rsAff![foreb] + rsAff![escbal] + rsAff![miscm1] + rsAff![miscm2] + rsAff![Mism3] + rsAff![Mism4] + rsAff![Rec_bal]) Then
Do While VDebtDue = "0" Or VDebtDue = ""
VDebtDue = InputBox("Debt Due Not Input, Please Type in Debt Due:")
Loop
debtdue = Format(VDebtDue, "$###,#00.00")
Else
debtdue = Format(rs![Principal Balance] + rsAff![interest amt] + rsAff![Late charge] + rsAff![lender advance] + rsAff![interest on advance] + rsAff![nsf charge] + rsAff![foreb] + rsAff![escbal] + rsAff![miscm1] + rsAff![miscm2] + rsAff![Mism3] + rsAff![Mism4] + rsAff![Rec_bal], "$###,#00.00")
End If
rsAff.Close
rs.Close
End If

End Function
Public Function totalJMT() As Double

Dim strsql As String
Dim rs As RecordSet
Dim VSurplus As Double

strsql = "Select jmt_amt from creditors where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
rs.MoveFirst
Do While Not rs.EOF
If IsNull(rs!jmt_amt) Then
totalJMT = totalJMT + 0
Else
totalJMT = totalJMT + rs!jmt_amt
End If

rs.MoveNext
Loop
End If
If Not IsNull([Forms]![accountingmain]![accounting].Form!defsurplus) Then
VSurplus = [Forms]![accountingmain]![accounting].Form!defsurplus
If VSurplus > 0 Then
totalJMT = VSurplus - totalJMT
Else
totalJMT = 0
End If
If VSurplus = totalJMT Then
totalJMT = 0
End If
End If


rs.Close

'MsgBox (totalJMT)

End Function
Public Function liberfolioVAAcct()

If Forms![foreclosure database screen]![Propertycounty] Like "*City" Or _
Forms![foreclosure database screen]![Propertycounty] Like "City*" Then
v1 = "the " & Forms![foreclosure database screen]!Propertycounty
Else
v1 = Forms![foreclosure database screen]!Propertycounty & " County"
End If


v2 = ", Virginia in" & liberfolio() & ", on " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![SaleDate], "mmmm dd"", ""yyyy")

V3 = ", in the front of the Circuit Court for " & v1

liberfolioVAAcct = v1 + v2 + V3


End Function




Public Function liberfolioONLY() As String

If Forms![foreclosure database screen]![PropertyState] = "MD" Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then
liberfolioONLY = " Liber _______, Folio _______"
ElseIf (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] <> "") Or _
(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] <> "" And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] <> "") Then
liberfolioONLY = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Folio]
ElseIf IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] <> "" And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber]) Then
liberfolioONLY = " Receipt # " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]
Else
liberfolioONLY = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Folio] & " and re-recorded as Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!reliber & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio
End If

End If


If Forms![foreclosure database screen]![PropertyState] = "DC" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![reinstrument]) Then
liberfolioONLY = Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno]
Else
liberfolioONLY = Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno] & " and re-recorded as Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!reinstrument
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
rerecorded = ""

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
rerecorded = " and re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If


If (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] = "") Then

If (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] = "") Then

liberfolioONLY = Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& rerecorded
Else
liberfolioONLY = Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

Else
liberfolioONLY = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

End If

End Function

Public Function liberfolioMOT() As String

If Forms![foreclosure database screen]![PropertyState] = "MD" Then

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![mot_liber]) And _
Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![mot_folio]) Then
liberfolioMOT = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![mot_liber] & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![mot_folio]
Else
liberfolioMOT = " Liber _______, Folio _______"
End If

End If

End Function


Public Function liberfolio() As String

If Forms![foreclosure database screen]![PropertyState] = "MD" Then

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
rerecorded = " and re-recorded as Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then

If Forms![foreclosure database screen]!Client Like "Select Portf*" Then
liberfolio = " Liber _______ at Folio ________"
Else
liberfolio = " Liber _______, Folio _______"
End If

ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] <> "" Then

If Forms![foreclosure database screen]!Client Like "Select Portf*" Then
liberfolio = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] & " at Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Folio] & rerecorded
Else
liberfolio = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Folio] & rerecorded
End If

ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] <> "" Then

liberfolio = " Receipt # " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] & rerecorded

End If

End If


If Forms![foreclosure database screen]![PropertyState] = "DC" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![reinstrument]) Then
liberfolio = " Instrument Number " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno]
Else
liberfolio = " Instrument Number " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno] & " and re-recorded as Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!reinstrument
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

rerecorded = ""

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
And Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) _
And Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]) Then
rerecorded = " and re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio] & _
" Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _

ElseIf Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Or Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument = "" Then
rerecorded = " and re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If


If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) And _
Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) And _
Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then
liberfolio = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] & _
" Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & _
" Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] & rerecorded
ElseIf Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) And _
Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) Then
liberfolio = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] & _
" Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded

ElseIf Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then
liberfolio = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] & rerecorded


ElseIf (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] = "") Then

If (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] = "") Then

liberfolio = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& rerecorded
Else
liberfolio = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

Else
liberfolio = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

End If

End Function


Public Function liberfolioDOA() As String

If Forms![foreclosure database screen]![PropertyState] = "MD" Then

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
rerecorded = " and re-recorded as Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber]) And _
IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then

liberfolioDOA = " Liber _______, Folio _______"

ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] <> "" Then

liberfolioDOA = " Liber " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Liber] & ", Folio " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Folio] & rerecorded

ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] <> "" Then

liberfolioDOA = " Receipt # " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] & rerecorded

End If

End If


If Forms![foreclosure database screen]![PropertyState] = "DC" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![reinstrument]) Then
liberfolioDOA = " Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno]
Else
liberfolioDOA = " Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![instno] & " and re-recorded as Instrument No. " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!reinstrument
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

rerecorded = ""

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
And Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) _
And Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]) Then
rerecorded = " and re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio] & _
" Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _

ElseIf Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Or Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument = "" Then
rerecorded = " and re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
rerecorded = " and re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If


Dim strsql
Dim rspropertycounty As RecordSet

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim VDBP
VDBP = rspropertycounty!VA_DeedBookInst
rspropertycounty.Close

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) And _
Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) Then

If VDBP = 1 Or VDBP = 0 Or IsNull(VDBP) Then
liberfolioDOA = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] & _
" Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

ElseIf Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst]) Then
If VDBP = 2 Or VDBP = 0 Or IsNull(VDBP) Then
liberfolioDOA = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] & rerecorded
End If


ElseIf (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] = "") Then

If (IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] = "") Then

If VDBP = 2 Or VDBP = 0 Or IsNull(VDBP) Then
liberfolioDOA = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& rerecorded
End If

Else

If VDBP = 3 Or VDBP = 0 Or IsNull(VDBP) Then
liberfolioDOA = " Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![inst] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

End If

Else
If VDBP = 1 Or VDBP = 0 Or IsNull(VDBP) Then
liberfolioDOA = " Deed Book " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![Book] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![VAPage] & rerecorded
End If

End If

End If

End Function
Public Function liberfolioVA() As String

If Forms!VirginiaSales![PropertyState] = "MD" Then

If Not IsNull(Forms!VirginiaSales![reinstrument]) _
Or Not IsNull(Forms!VirginiaSales![reliber]) Then
rerecorded = " and re-recorded as Liber " & Forms!VirginiaSales![reliber] _
& " Folio " & Forms!VirginiaSales![refolio]
End If

If IsNull(Forms!VirginiaSales![reliber]) And _
IsNull(Forms!VirginiaSales![Liber]) And _
IsNull(Forms!VirginiaSales![InstrumentNo]) Then

liberfolioVA = " Liber _______, Folio _______"

ElseIf Forms!VirginiaSales![Liber] <> "" Then

liberfolioVA = " Liber " & Forms!VirginiaSales![Liber] & ", Folio " & Forms!VirginiaSales![Folio] & rerecorded

ElseIf Forms!VirginiaSales![InstrumentNo] <> "" Then

liberfolioVA = " Receipt # " & Forms!VirginiaSales![InstrumentNo] & rerecorded

End If

End If


If Forms!VirginiaSales![PropertyState] = "DC" Then
If IsNull(Forms!VirginiaSales!ForeclosureSubForm.Form![reinstrument]) Then
liberfolioVA = " Instrument No. " & Forms!VirginiaSales!ForeclosureSubForm.Form![instno]
Else
liberfolioVA = " Instrument No. " & Forms!VirginiaSales!ForeclosureSubForm.Form![instno] & " and re-recorded as Instrument No. " & Forms!VirginiaSales!ForeclosureSubForm.Form!reinstrument
End If
End If

If Forms!VirginiaSales![PropertyState] = "VA" Then

rerecorded = ""

If Not IsNull(Forms!VirginiaSales![reinstrument]) _
And Not IsNull(Forms!VirginiaSales![reliber]) _
And Not IsNull(Forms!VirginiaSales![refolio]) Then
rerecorded = " and re-recorded as DeedBook " & Forms!VirginiaSales![reliber] _
& " Page " & Forms!VirginiaSales![refolio] & _
" Instrument No. " & Forms!VirginiaSales![reinstrument] _

ElseIf Not IsNull(Forms!VirginiaSales![reinstrument]) _
Or Not IsNull(Forms!VirginiaSales![reliber]) Then

If IsNull(Forms!VirginiaSales!reinstrument) Or Forms!VirginiaSales!reinstrument = "" Then
rerecorded = " and re-recorded as DeedBook " & Forms!VirginiaSales![reliber] _
& " Page " & Forms!VirginiaSales![refolio]
Else
If IsNull(Forms!VirginiaSales!refolio) Then
rerecorded = " and re-recorded as Instrument No. " & Forms!VirginiaSales![reinstrument]
Else
rerecorded = " and re-recorded as Instrument No. " & Forms!VirginiaSales![reinstrument] _
& " at Page " & Forms!VirginiaSales![refolio]
End If
End If
End If


If Not IsNull(Forms!VirginiaSales![VAPage]) And _
Not IsNull(Forms!VirginiaSales![Book]) And _
Not IsNull(Forms!VirginiaSales![InstrumentNo]) Then
liberfolioVA = " Deed Book " & Forms!VirginiaSales![Book] & _
" Page " & Forms!VirginiaSales![VAPage] & _
" Instrument No. " & Forms!VirginiaSales![InstrumentNo] & rerecorded
ElseIf Not IsNull(Forms!VirginiaSales![VAPage]) And _
Not IsNull(Forms!VirginiaSales![Book]) Then
liberfolioVA = " Deed Book " & Forms!VirginiaSales![Book] & _
" Page " & Forms!VirginiaSales![VAPage] & rerecorded

ElseIf Not IsNull(Forms!VirginiaSales![InstrumentNo]) Then
liberfolioVA = " Instrument No. " & Forms!VirginiaSales![InstrumentNo] & rerecorded


ElseIf (IsNull(Forms!VirginiaSales![Book]) Or _
Forms!VirginiaSales![Book] = "") Then

If (IsNull(Forms!VirginiaSales![VAPage]) Or _
Forms!VirginiaSales![VAPage] = "") Then

liberfolioVA = " Instrument No. " & Forms!VirginiaSales![InstrumentNo] _
& rerecorded
Else
liberfolioVA = " Instrument No. " & Forms!VirginiaSales![InstrumentNo] _
& " at Page " & Forms!VirginiaSales![VAPage] & rerecorded
End If

Else
liberfolioVA = " Deed Book " & Forms!VirginiaSales![Book] _
& " Page " & Forms!VirginiaSales![VAPage] & rerecorded
End If

End If

End Function

Public Function liberfolioTITLE() As String

If Forms![title open screen]![PropertyState] = "MD" Then
liberfolioTITLE = " Liber " & Forms![title open screen]![Liber] & ", Folio " & Forms![title open screen]![Folio]
End If

If Forms![title open screen]![PropertyState] = "DC" Then
liberfolioTITLE = " Instrument No. " & Forms![title open screen]![InstrumentNo]
End If

If Forms![title open screen]![PropertyState] = "VA" Then
If IsNull(Forms![title open screen]![Book]) Then
If IsNull(Forms![title open screen]![VAPage]) Then
liberfolioTITLE = " Instrument No. " & Forms![title open screen]![InstrumentNo]
Else
liberfolioTITLE = " Instrument No. " & Forms![title open screen]![InstrumentNo] _
& " at Page " & Forms![title open screen]![VAPage]
End If
Else
liberfolioTITLE = " Deed Book " & Forms![title open screen]![Book] _
& " Page " & Forms![title open screen]![VAPage]
End If

End If




End Function
Public Function GetApptype() As String
     GetApptype = AppType
End Function
Public Function IClearFile() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "select iclear_code, organizationname from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!Iclear_Code) Then
IClearFile = "No"
Else
IClearFile = "Yes"
End If

rs.Close
End Function
Public Function NIFile() As String

Dim strsql As String
Dim rs As RecordSet
strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!Iclear_Code) And (rs![newinvoice billing] = 1 Or rs![newinvoice billing] = -1) Then
NIFile = "Yes"
Else
NIFile = "No"
End If

rs.Close
End Function

Function Extension_KeyDown(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
        ' If user presses TAB, ENTER, PAGE UP, PAGE DOWN
        Case 13, 9, 33, 34
            ' Disable the keystroke by setting it to 0
            KeyCode = 0
        Case Else
            Debug.Print KeyCode, Shift
    End Select
End Function
Public Function SecuredParty() As String

If IsNull(Forms![foreclosure database screen]![SecuredParty]) Then
MsgBox ("There is no Abbreviated Secured Party input.  Please check screen data.")

Else

If Forms![foreclosure database screen]![Client] = "JPMorgan Chase Bank, National Association" Or _
Forms![foreclosure database screen]![Client] = "washington mutual bank" Then
SecuredParty = LSecured()
ElseIf Forms![foreclosure database screen]![Client] Like "Citi*" Then
SecuredParty = "THE LENDER"
Else
SecuredParty = LSecured()
End If
End If



End Function

Public Function LSecured()

If Forms![foreclosure database screen]![longsecured] Like "Citifinancial Mortgage Co*" Then
LSecured = "CitiMortgage, Inc. successor by reason of merger with " & Forms![foreclosure database screen]![longsecured]
'LSecured = "CitiMortgage, Inc. fka Citifinancial Mortgage Company, Inc."

Else
LSecured = Forms![foreclosure database screen]![longsecured]
End If
'MsgBox (LSecured)
End Function
Public Function AffNOtePara1()

If [Forms]![foreclosure database screen]![Client] Like "Homeward*" Then
AffNOtePara1 = [Forms]![foreclosure database screen]![Client] & ", successor in interest to Option One Mortgage Corporation, authorized mortgage servicer for " & LSecured & " (" & "" & """" & "" & [SecuredParty] & "" & """" & "" & ")"

Else


If [Forms]![foreclosure database screen]![Client] = "JPMorgan Chase Bank, National Association" _
Or Forms![foreclosure database screen]![Client] = "Washington Mutual Bank" _
Or [Forms]![foreclosure database screen]![Fmortgage] = -1 _
Or [Forms]![foreclosure database screen]![SPsigns] = -1 _
Or [Forms]![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]!SPsameasCl = 1 Then

AffNOtePara1 = LSecured()

ElseIf Client() Like "Household*" Then
AffNOtePara1 = LSecured() & " (" & "" & """" & "" & Forms![foreclosure database screen]![SecuredParty] & "" & """" & "" & ")"

ElseIf Client() Like "Citi*" Then
AffNOtePara1 = Client() & ", authorized servicer for " & LSecured()
Else

AffNOtePara1 = servicerVA() & ", authorized mortgage servicer for " & LSecured() & " (" & "" & """" & "" & Forms![foreclosure database screen]![SecuredParty] & "" & """" & "" & ")"


End If

End If

End Function
Public Function subpurchaser1()
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and (subpurchaser = " & -1 & " or subpurchaser = " & 1 & ") order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rscred.EOF Then
subpurchaser1 = rscred!OrganizationName
End If

rscred.Close






End Function
Public Function subpurchaser2()

strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and (subpurchaser = " & -1 & " or subpurchaser = " & 1 & ") order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rscred.EOF Then

If Not IsNull(rscred!Address) Then
subpurchaser2 = rscred!Address
End If


End If

End Function

Public Function subpurchaser3()

strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and (subpurchaser = " & -1 & " or subpurchaser = " & 1 & ") order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rscred.EOF Then

If Not IsNull(rscred!Address2) Then
subpurchaser3 = rscred!Address2
End If


End If

End Function
Public Function subpurchaser4()

strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and (subpurchaser = " & -1 & " or subpurchaser = " & 1 & ") order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rscred.EOF Then

If Not IsNull(rscred!City) Then
subpurchaser4 = rscred!City & ", " & rscred!State & "  " & rscred!PostalCode

End If


End If

End Function
Public Function CourtAuditor()
Dim Vlisting As String

If Not IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form!court_auditor) Then

VAssigned = Forms![foreclosure database screen]!PostsaleSubForm.Form!court_auditor

Else

VAssigned = AcctComm()
End If


AUDsql = "select * from dba_court_auditors where auditorID = " & VAssigned & ";"
Set rsAuditors = CurrentDb.OpenRecordset(AUDsql, dbOpenSnapshot)
If Not rsAuditors.EOF Then
CourtAuditor = rsAuditors!Auditor_MrMrs & " " & rsAuditors!Auditor_first & " " & rsAuditors!Auditor_last
Else
CourtAuditor = "_______________________"
End If

rsAuditors.Close

End Function
Public Function CourtAuditorAdd()

VAssigned = Forms![foreclosure database screen]!PostsaleSubForm.Form!court_auditor

AUDsql = "select * from dba_court_auditors where auditorID = " & VAssigned & ";"
Set rsAuditors = CurrentDb.OpenRecordset(AUDsql, dbOpenSnapshot)
If Not rsAuditors.EOF Then

CourtAuditorAdd = rsAuditors!Auditor_Add1
End If

rsAuditors.Close

End Function
Public Function CourtAuditorAdd2()

VAssigned = Forms![foreclosure database screen]!PostsaleSubForm.Form!court_auditor

AUDsql = "select * from dba_court_auditors where auditorID = " & VAssigned & ";"
Set rsAuditors = CurrentDb.OpenRecordset(AUDsql, dbOpenSnapshot)

If Not rsAuditors.EOF Then
CourtAuditorAdd2 = rsAuditors!Auditor_add2
End If

rsAuditors.Close

End Function
Public Function CourtAuditorcsz()
VAssigned = Forms![foreclosure database screen]!PostsaleSubForm.Form!court_auditor

AUDsql = "select * from dba_court_auditors where auditorID = " & VAssigned & ";"
Set rsAuditors = CurrentDb.OpenRecordset(AUDsql, dbOpenSnapshot)

If Not rsAuditors.EOF Then
CourtAuditorcsz = rsAuditors!Auditor_CSZ
End If

rsAuditors.Close
End Function

Public Function coverltr()
Dim DocName As String

If [Forms]![foreclosure database screen]![PropertyState] <> "VA" Then
If [Forms]![foreclosure database screen]![Propertycounty] <> "Baltimore" And [Forms]![foreclosure database screen]![Propertycounty] <> "Baltimore City" And [Forms]![foreclosure database screen]![Propertycounty] <> "Charles" And [Forms]![foreclosure database screen]![Propertycounty] <> "Prince George's" And [Forms]![foreclosure database screen]![Propertycounty] <> "St. Mary's" And [Forms]![foreclosure database screen]![PropertyState] <> "DISTRICT OF Columbia" And [Forms]![foreclosure database screen]![Propertycounty] <> "Howard" Then
DocName = "CoverLtrMD"
End If

If [Forms]![foreclosure database screen]![Propertycounty] = "Baltimore" Or [Forms]![foreclosure database screen]![Propertycounty] = "Baltimore City" Or [Forms]![foreclosure database screen]![Propertycounty] = "Charles" Or [Forms]![foreclosure database screen]![Propertycounty] = "Prince George's" Or [Forms]![foreclosure database screen]![Propertycounty] = "St. Mary's" Or [Forms]![foreclosure database screen]![Propertycounty] = "Howard" Then
DocName = "CoverLtrMD2"
End If

If [Forms]![foreclosure database screen]![Propertycounty] = "District of Columbia" Then
DocName = "coverltrdc"
End If

If [Forms]![foreclosure database screen]![Propertycounty] = "Garrett" Or [Forms]![foreclosure database screen]![Propertycounty] = "Somerset" Or [Forms]![foreclosure database screen]![Propertycounty] = "Allegany" Or [Forms]![foreclosure database screen]![Propertycounty] = "Dorchester" Or [Forms]![foreclosure database screen]![Propertycounty] = "Wicomico" Or [Forms]![foreclosure database screen]![Propertycounty] = "Worcester" Then
MsgBox ("PREPARE BOND W/COURT DOCKET")
End If

Else
DocName = "coverltrva"
End If

DoCmd.OpenReport DocName

End Function
Public Function LostNoteVALtrInd()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

'Eviction Code
Dim strsqlE, VVar, VVar2, VVar3, VVar4, VVar5
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & Forms![foreclosure database screen]![filenum]
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)
If Not rsE.EOF Then

If Not IsNull(rsE!PutOutDate) Then
VVar = rsE!PutOutDate
Else
VVar = Null
End If

Else
VVar = Null

End If
rsE.Close
'End Eviction Code

VSaleHeld = rspropertycounty!SaleHeld


vdebtorslist = "1: " & firstdebtor()

If (MailA() = "Grantor1" Or MailA() = "All Grantors" Or MailA() = "All") Then
vdebtorslist = vdebtorslist + vbCr & "1M: " & firstdebtor() & ": Mailing"
Vcnt = Vcnt + 1
End If

If (MailB() = "Grantor1" Or MailB() = "All Grantors" Or MailB() = "All") Then
vdebtorslist = vdebtorslist + vbCr & "1M2: " & firstdebtor() & ": Mailing"
Vcnt = Vcnt + 1
End If


If Forms![foreclosure database screen]![LastNameDebtor2] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "2: " & secondDebtor()
If (MailA() = "Grantor2" Or MailA() = "All Grantors" Or MailA() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "2M: " & secondDebtor() & ": Mailing"
End If
If (MailB() = "Grantor2" Or MailB() = "All Grantors" Or MailB() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "2M2: " & secondDebtor() & ": Mailing"
End If
End If

If Forms![foreclosure database screen]![LastNameDebtor3] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "3: " & thirddebtor()
If (MailA() = "Grantor3" Or MailA() = "All Grantors" Or MailA() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "3M: " & thirddebtor() & ": Mailing"
End If
If (MailB() = "Grantor3" Or MailB() = "All Grantors" Or MailB() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "3M2: " & thirddebtor() & ": Mailing"
End If
End If

If Forms![foreclosure database screen]![lastnamedebtor4] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "4: " & fourthdebtor()
If (MailA() = "Grantor4" Or MailA() = "All Grantors" Or MailA() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "4M: " & fourthdebtor() & ": Mailing"
End If
If (MailB() = "Grantor4" Or MailB() = "All Grantors" Or MailB() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "4M2: " & fourthdebtor() & ": Mailing"
End If
End If

If Forms![foreclosure database screen]![lastnamedebtor5] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "5: " & fifthdebtor()
If (MailA() = "Grantor5" Or MailA() = "All Grantors" Or MailA() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "5M: " & fourthdebtor() & ": Mailing"
End If
If (MailB() = "Grantor5" Or MailB() = "All Grantors" Or MailB() = "All") Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "5M2: " & fifthdebtor() & ": Mailing"
End If
End If

If Forms![foreclosure database screen]![lastnameo1] <> "" Then
vdebtorslist = vdebtorslist + vbCr & "O: " & owner1()
If Forms![foreclosure database screen]![Mailing Address] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "0M: " & owner1() & ": Mailing"
End If
End If

If Forms![foreclosure database screen]![lastnameo2] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & "02: " & owner2()
If Forms![foreclosure database screen]![Mailing Address] <> "" Then
Vcnt = Vcnt + 1
vdebtorslist = vdebtorslist + vbCr & Vcnt & "02M: " & owner2() & ": Mailing"
End If
End If



VMsg = InputBox("Print Individual Lost Note Letter.  Select which letter to print: " & vbCr & vdebtorslist)

If VMsg = "1" Or VMsg = "1M" Then
VDebtor = firstdebtor()
ElseIf VMsg = "2" Or VMsg = "2M" Then
VDebtor = secondDebtor()
ElseIf VMsg = "3" Or VMsg = "3M" Then
VDebtor = thirddebtor()
ElseIf VMsg = "4" Or VMsg = "4M" Then
VDebtor = fourthdebtor()
ElseIf VMsg = "5" Or VMsg = "5M" Then
VDebtor = fifthdebtor()
ElseIf VMsg = "01" Or VMsg = "01M" Or VMsg = "o1" Or VMsg = "o1M" Then
VDebtor = owner1()
ElseIf VMsg = "02" Or VMsg = "02M" Or VMsg = "o2" Or VMsg = "o2M" Then
VDebtor = owner2()
Else
MsgBox ("Did not enter correct combination to print letter, run letter again")
Exit Function
End If

If VMsg Like "*M" Then
With rsnotice
.AddNew
!NoticeTo = VDebtor
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VVar) Then
Else
!PutOutDate = VVar
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

Else

With rsnotice
.AddNew
!NoticeTo = VDebtor
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
If IsNull(VVar) Then
Else
!PutOutDate = VVar
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

rsnotice.Close
rspropertycounty.Close

DoCmd.OpenReport "LostNoteVA1-NotFDINDIVIDUAL", acViewPreview


End Function
Public Function PrintEvicTF()

MsgBox ("Printing Eviction-VA Tenant Form")

PrtPDF ("\\rvdv-fs01\datatransfer\attachments\TENANT INFORMATION FORM-VA.pdf")

End Function
Public Function PrintBCity()

If [Forms]![foreclosure database screen]![Propertycounty] = "Baltimore City" Then
MsgBox ("Printing Baltimore City Docket Pages for insertion")
PrtPDF ("\\rvdv-fs01\datatransfer\attachments\Baltimore City Docket.pdf")
End If

End Function
Public Function MilitaryaffPara()

If Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
[Forms]![foreclosure database screen]!lb = 1 Or _
[Forms]![foreclosure database screen]!mers = -1 Or _
[Forms]![foreclosure database screen]!SPsigns = -1 Then
MilitaryaffPara = LSecured()
Else
MilitaryaffPara = Client() & ", authorized servicer for " & LSecured() & " which"
End If

End Function
Public Function MilActive()
If [Forms]![foreclosure database screen]![ForeclosureSubForm].Form!mil_active = -1 Then
VActive = MsgBox("In Active Duty PRIOR to the Date of the DOT?", vbYesNo)
If VActive = vbYes Then
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!Mortgage = -1 Then
VMort = "Mortgage"
Else
VMort = "Trust"
End If
MilActive = " but were on said duty prior to the execution of the Deed of " & VMort & " and therefore are not"
Else

MilActive = " and none are"

End If

Else
MilActive = " and none are"
End If

End Function
Public Function AffLostNoteCert() As String

Dim VP1, VP2, VP3, Vp4 As String
VP1 = ""
VP2 = ""
VP3 = ""
Vp4 = ""

If Forms![foreclosure database screen]!Client Like "Carrington*" And Forms![foreclosure database screen]!PropertyState = "VA" Then

VP1 = "Subscribed and sworn to (or affirmed) before me on this _______ day of ______________________, 20____, by_______________________________________________________________________, proved to me on the basis of satisfactory evidence to be the person(s) who appeared before me."


ElseIf [Forms]![foreclosure database screen]![signature block] = "" Or _
IsNull([Forms]![foreclosure database screen]![signature block]) Then
VP1 = "           The foregoing affidavit was acknowledged before me this ________ day of _________ 20__, by " & "_______________________________________"

If [Forms]![foreclosure database screen]![Client] = "JPMorgan Chase Bank, National Association" _
Or Forms![foreclosure database screen]![Client] = "Washington Mutual Bank" _
Or [Forms]![foreclosure database screen]![Fmortgage] = -1 _
Or ([Forms]![foreclosure database screen]![SPsigns] = -1 _
And ([Forms]![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]!SPsameasCl))) Then

VP2 = " of " & LSecured() & "."
Else
VP2 = ", the person with authority so to act on behalf of "
End If

If [Forms]![foreclosure database screen]![SPsameasCl] = -1 Then
If Client() Like "Citi*" Then
VP3 = "the above referenced secured party."
Else
If Forms![foreclosure database screen]!SPsigns = -1 Then
VP3 = ""
Else
VP3 = [Forms]![foreclosure database screen]![SecuredParty] & "."
End If
End If
End If

If [Forms]![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull([Forms]![foreclosure database screen]![SPsameasCl]) Then
If Forms![foreclosure database screen]!SPsigns = -1 Then
Vp4 = ""
Else
Vp4 = Client() & ", authorized servicer for " & _
[Forms]![foreclosure database screen]![SecuredParty] & "."
End If
End If


Else
VP1 = "      Subscribed and sworn before me this ____________ day of ______________________, 20__."
End If

'MsgBox (VP4)
'MsgBox ("SP Same as client: " & [Forms]![foreclosure database screen]![SPsameasCl])
'MsgBox ("SP Signs: " & Forms![foreclosure database screen]!SPsigns)

AffLostNoteCert = VP1 + VP2 + VP3 + Vp4


End Function
Public Function DOACert()
Dim D1, D2, d3 As String
D1 = ""
D2 = ""
d3 = ""

If IsNull([Forms]![foreclosure database screen]![SecuredParty]) Then
MsgBox ("No Secured Party Input!")
End If

Dim rs As RecordSet
Dim strsql As String
strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Vnt

If rs!NewTrak = 1 Or rs!NewTrak = -1 Then
Vnt = "YES"
End If

VSpSigns = [Forms]![foreclosure database screen]!SPsigns
vspsameascl = [Forms]![foreclosure database screen]!SPsameasCl
vClient = [Forms]![foreclosure database screen]!Client

If vClient Like "Homecomings*" Then
A = "Default Services Junior Officer"
ElseIf vClient = "Washington Mutual Bank" Or vClient Like "Wilsh*" Or vClient Like "Select P*" Or vClient Like "Homeward*" Or _
vClient Like "EMC*" Or vClient Like "Saxon*" Or vClient Like "JP*" Or VSpSigns = 1 Or VSpSigns = -1 Or vspsameascl = 1 Or vspsameascl = -1 Then
A = ""
Else
A = "Authorized Servicer"
End If

If vClient Like "Homecomings*" Then
A = "Default Services Junior Officer"
Else
A = ""
End If

If rs![attSign2] <> "" Then
B = " and " & rs![attSign2] & ",  " & rs![Title2]
End If

If (IsNull(vspsameascl) Or vspsameascl = 0) And (VSpSigns = 0 Or IsNull(VSpSigns)) Then
C = "of " & vClient & ", as Authorized Servicer of " & LSecured()
Else
C = " of "
If VSpSigns = 0 Or IsNull(VSpSigns) Then
d = vClient
Else
d = LSecured()
End If
End If


If ((VSpSigns = -1 Or VSpSigns = 1) Or _
(vspsameascl = -1 Or vspsameascl = 1)) Then

If Forms![foreclosure database screen]!longsecured Like "Mortgage Electron*" Then
D1 = "_______________ of " & LSecured()
ElseIf vClient Like "Citi Res*" Or (Vnt = "YES" And (vClient <> "Wilshire Credit Corporation" Or vClient <> "Seterus, Inc. fka IBM Lender Business Process Services") And _
IsNull(Forms![foreclosure database screen]![signature block])) Then
D1 = " of " & vClient & " as Authorized Servicer for " & LSecured()

ElseIf vClient Like "wilshire*" Or vClient = "Lender Business Process Services" Or _
Forms![foreclosure database screen]![signature block] Like "*authorized servicing*" Then
D1 = " of " & vClient & ", authorized servicer for " & UCase([Forms]![foreclosure database screen]![longsecured])
Else
D2 = " of "
End If

If Vcient Like "citi Res*" Or Vnt = "YES" Or _
vClient Like "wilshire*" Or _
vClient = "Lender Business Process Services" Or _
Forms![foreclosure database screen]![signature block] Like "*authorized servicing*" Then
Else

If IsNull([Forms]![foreclosure database screen]![SecuredParty]) Or _
[Forms]![foreclosure database screen]!SPsameasCl = -1 Or _
[Forms]![foreclosure database screen]!SPsameasCl = 1 Then
D1 = D2 & vClient
ElseIf [Forms]![foreclosure database screen]!SPsigns = -1 Then
D1 = " of " & LSecured()

Else

'D1 = D2 & Vclient & ", servicing agent for " & UCase([Forms]![foreclosure database screen]![LongSecured])

End If

End If
Else
D1 = "_______________________________ of " & Client() & ", servicing agent for " & LSecured()

End If

If vClient Like "OneWest*" Then
DOACert = A + B + C + d
Else
DOACert = D1
End If


'MsgBox (DOACert)

'DOACert = D1 + D2 + d3
'MsgBox (DOACert & " d1: " & D1 & " D2: " & D2 & " D3: " & d3 & " Long Secured: " & LSecured())
End Function
Public Function DOACertVA()
Dim D1, D2, d3 As String
D1 = ""
D2 = ""
d3 = ""

If IsNull([Forms]![foreclosure database screen]![SecuredParty]) Then
MsgBox ("No Secured Party Input!")
End If

Dim rs As RecordSet
Dim strsql As String
strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Vnt

'If rs!newtrak = 1 Or rs!newtrak = -1 Then
'Vnt = "YES"
'End If
'rs.Close

VSpSigns = [Forms]![foreclosure database screen]!SPsigns
vspsameascl = [Forms]![foreclosure database screen]!SPsameasCl
vClient = [Forms]![foreclosure database screen]!Client

'If Vclient Like "Homecomings*" Then
'A = "Default Services Junior Officer"
'ElseIf Vclient = "Washington Mutual Bank" Or Vclient Like "Wilsh*" Or Vclient Like "Select P*" Or Vclient like "Homeward*" Or _
'Vclient Like "EMC*" Or Vclient Like "Saxon*" Or Vclient Like "JP*" Or vspsigns = 1 Or vspsigns = -1 Or vspsameascl = 1 Or vspsameascl = -1 Then
'A = ""
'Else
'A = "Authorized Servicer"
'End If

If vClient Like "Homecomings*" Then
A = "Default Services Junior Officer"
Else
A = ""
End If

If rs![attSign2] <> "" Then
B = " and " & rs![attSign2] & ",  " & rs![Title2]
End If

If (IsNull(vspsameascl) Or vspsameascl = 0) And (VSpSigns = 0 Or IsNull(VSpSigns)) Then
If vClient Like "Wilshire*" Or vClient = "Lender Business Process Services" Then
C = "of " & vClient & ", Attorney-in-Fact for " & LSecured()
Else
C = "of " & vClient & ", as Authorized Servicer of " & LSecured()
End If
Else
C = " of "
If VSpSigns = 0 Or IsNull(VSpSigns) Then
d = vClient
Else
d = LSecured()
End If
End If

'If ((vspsigns = -1 Or vspsigns = 1) Or _
'(vspsameascl = -1 Or vspsameascl = 1)) Then
''Forms![foreclosure database screen]!LongSecured Like "Mortgage Electron*" Then
'D1 = "_______________ of " & LSecured()
'ElseIf Vclient Like "Citi Res*" Or (Vnt = "YES" And Vclient <> "Wilshire Credit Corporation" And _
'IsNull(Forms![foreclosure database screen]![signature block])) Then
'D1 = " of " & Vclient & " as Authorized Servicer for " & LSecured()
'ElseIf Vclient Like "wilshire*" Or _
'Forms![foreclosure database screen]![signature block] Like "*authorized servicing*" Then
'D1 = " of " & Vclient & ", authorized servicer for " & UCase([Forms]![foreclosure database screen]![LongSecured])
'Else
'D2 = " of "
'End If
'If Vcient Like "citi Res*" Or Vnt = "YES" Or _
'Vclient Like "wilshire*" Or _
'Forms![foreclosure database screen]![signature block] Like "*authorized servicing*" Then
'Else
'If IsNull([Forms]![foreclosure database screen]![SecuredParty]) Or _
'[Forms]![foreclosure database screen]!vspsameascl = -1 Or _
'[Forms]![foreclosure database screen]!vspsameascl = 1 Then
'D1 = D2 & Vclient
'ElseIf [Forms]![foreclosure database screen]!SPsigns = -1 Then
'D1 = " of " & LSecured()
'Else
'D1 = D2 & Vclient & ", servicing agent for " & UCase([Forms]![foreclosure database screen]![LongSecured])
'End If
'End If



'End If

DOACertVA = A + B + C + d

'MsgBox (DOACertVA)
'DOACert = D1 + D2 + d3
'MsgBox (DOACert & " d1: " & D1 & " D2: " & D2 & " D3: " & d3 & " Long Secured: " & LSecured())
End Function


Public Function DOAWitness()
Dim D1, D2, d3, d4, D5, strsql As String
Dim rs As RecordSet
D1 = ""
D2 = ""
d3 = ""
d4 = ""
D5 = ""

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Vnt
If rs!NewTrak = 1 Or rs!NewTrak = -1 Then

Vnt = "YES"
End If
rs.Close

If Vnt = "YES" And Forms![foreclosure database screen]!PropertyState <> "MD" Then

If (Forms![foreclosure database screen]!SPsigns = -1 Or _
Forms![foreclosure database screen]!SPsigns = 1) Or _
Forms![foreclosure database screen]!longsecured Like "Mortgage Electron*" Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 _
Or Forms![foreclosure database screen]![SPsameasCl] = 1 Then
D1 = "_______________ of " & LSecured()
Else
If Client() Like "onewest*" And _
Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF) Then
D1 = " by " & Client() & " as Servicer for " & LSecured()
ElseIf Client() Like "Wilshire*" Or Client() = "Lender Business Process Services" Then
D1 = "_______________ of " & Client() & ", Attorney-in-Fact for " & LSecured()

Else
D1 = "_______________ of " & Client() & " as Authorized Servicer for " & LSecured()
End If
End If


DOAWitness = D1

Else

If Forms![foreclosure database screen]!SPsigns = -1 Then

If Forms![foreclosure database screen]![signature block] <> "" Then
D1 = Forms![foreclosure database screen]![SecuredParty] & " " & Forms![foreclosure database screen]![signature block]
Else
D1 = Forms![foreclosure database screen]![SecuredParty] & ", its authorized Servicing Agent, by "
End If

ElseIf Forms![foreclosure database screen]![SPsameasCl] = -1 _
Or Forms![foreclosure database screen]![SPsameasCl] = 1 Then
D1 = Client() & ", by "
ElseIf Client() Like "Citi Res*" Then
D1 = Client() & " as Authorized Servicer for " & LSecured()
Else
D1 = Client() & ", its authorized Servicing Agent, by "
End If


clientname = Forms![foreclosure database screen]![Client]
strsql = "Select * from clients where organizationname = " & """" & clientname & """"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If clientname Like "Ocwen*" Or clientname Like "Citi Res*" Then

If IsNull(rs!doaSign1) Then
D2 = "_______________________"
Else
D2 = rs![doaSign1]
End If

ElseIf clientname Like "Equicr*" Then
D2 = "Karen Dickinson"

ElseIf clientname Like "Household*" Then
D2 = "Scott Ellerbee"

Else
D2 = "__________________________"
End If

If clientname Like "Ocwen*" Or clientname Like "Citi Res*" Then

If IsNull(rs!Title1) Then
'd4 = "authorized agent"
d4 = "____________________"
Else
d4 = rs![Title1]
End If

ElseIf clientname Like "Equicr*" Then
d4 = "Foreclosure Administrator"
ElseIf clientname Like "Household*" Then
d4 = "Vice President"
Else
d4 = "___________________"
End If

If Forms![foreclosure database screen]!SPsigns = -1 Then
If Forms![foreclosure database screen]![signature block] <> "" Then

DOAWitness = D1

End If
End If

If IsNull(rs!attSign2) Then
D5 = ""
Else
If IsNull(rs!Title2) Then
D5 = " and attested to by " & rs!attSign2
Else
D5 = " and attested to by " & rs!attSign2 & ", " & rs!Title2
End If

End If

If Forms![foreclosure database screen]!SPsigns = 0 Or IsNull(Forms![foreclosure database screen]!SPsigns) Then
DOAWitness = D1 + D2 + ", " + d4
End If

End If


'MsgBox (DOAWitness)


End Function
Public Function DOAWitness2()



If Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Or _
Forms![foreclosure database screen]![SPsigns] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsigns]) Then

If Client() Like "Household*" Then
DOAWitness2 = ", which individual the said " & UCase(Forms![foreclosure database screen]![longsecured]) & " has been "
'ElseIf Client() Like "Citi*" Then
'DOAWitness2 = " the said LENDER has been "
ElseIf Forms![foreclosure database screen]![SPsigns] = 0 Or IsNull(Forms![foreclosure database screen]![SPsigns]) Then
DOAWitness2 = ", which individual the said " & UCase(Client()) & " has been "
Else
DOAWitness2 = ", which individual has been duly "
End If

Else

DOAWitness2 = ", which individual has been duly "
End If


End Function

Public Function PartOneMortgage() As String

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![POSCTD]) Then
MsgBox "Please Select POS or CTD on Foreclosure Screen", vbOKOnly
Exit Function
End If

DoCmd.RunMacro "Partone - Mortgage"

If [Forms]![foreclosure database screen]![Client] <> "OneWest Bank, FSB" _
And [Forms]![foreclosure database screen]![PropertyState] <> "DC" Then
Call AffidavitLostNote
End If


End Function
Public Function PartTwo()


'DoCmd.OpenReport "PartTwoCert", acViewPreview

Call CertDebtorsOwners


If [Forms]![foreclosure database screen]![PropertyState] = "MD" Or _
[Forms]![foreclosure database screen]![PropertyState] = "DC" Then

Dim VarEmailPrint As String
VarEmailPrint = InputBox("1. Preview for Emailing" & vbCr & "2. Print Directly to Printer" & vbCr & "(Enter 1 or 2 to Select)")

If VarEmailPrint <> "1" And VarEmailPrint <> "2" Then
MsgBox ("Enter 1 or 2 for Selection")

Call PartTwo

ElseIf VarEmailPrint = "1" Then

If Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or _
Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1 Then

Else
If [Forms]![foreclosure database screen]![PropertyState] = "MD" And _
[Forms]![foreclosure database screen]![Propertycounty] = "Allegany" And _
[Forms]![foreclosure database screen]![Propertycounty] = "Garrett" Then
DoCmd.OpenReport "RptofSale AttachCOHEN", acViewPreview
Else
DoCmd.OpenReport "RptofSale Attach", acViewPreview
End If
End If

If [Forms]![foreclosure database screen]![PropertyState] = "MD" And _
[Forms]![foreclosure database screen]![Propertycounty] = "Baltimore City" And _
(IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].Form![3rd_party]) Or [Forms]![foreclosure database screen]![PostsaleSubForm].Form![3rd_party] = 0) And _
([Forms]![foreclosure database screen]![PostsaleSubForm].Form![Buyer] <> [Forms]![foreclosure database screen]![longsecured]) Then
DoCmd.OpenReport "Rule14-HoldersDesignation", acViewPreview
End If

If [Forms]![foreclosure database screen]![Propertycounty] = "Montgomery" Then
Call MilAffSelPS
Call RunMilAffCheck
End If

'DoCmd.OpenReport "CertOfCompliance", acViewPreview
DoCmd.RunMacro "PartTwoMD-preview"

ElseIf VarEmailPrint = "2" Then

DoCmd.RunMacro "PartTwoMD"

If Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = -1 Or _
Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 1 Then

Else
If [Forms]![foreclosure database screen]![PropertyState] = "MD" And _
[Forms]![foreclosure database screen]![Propertycounty] = "Allegany" And _
[Forms]![foreclosure database screen]![Propertycounty] = "Garrett" Then
DoCmd.OpenReport "RptofSale AttachCOHEN", acViewPreview
Else
DoCmd.OpenReport "RptofSale Attach", acViewPreview
End If
End If

If [Forms]![foreclosure database screen]![PropertyState] = "MD" And _
(IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].Form![3rd_party]) Or [Forms]![foreclosure database screen]![PostsaleSubForm].Form![3rd_party] = 0) And _
([Forms]![foreclosure database screen]![PostsaleSubForm].Form![Buyer] <> [Forms]![foreclosure database screen]![longsecured]) Then
DoCmd.OpenReport "Rule14-HoldersDesignation", acViewNormal
End If
'DoCmd.OpenReport "CertOfCompliance", acViewNormal
If [Forms]![foreclosure database screen]![Propertycounty] = "Montgomery" Then
Call MilAffSelPS
End If
End If

Else

DoCmd.OpenReport "PartTwoVAcomplete", acViewPreview
DoCmd.OutputTo acOutputReport, "PartTwoVAComplete", acFormatSNP, pathuser() & "\Part2Package" & Forms![foreclosure database screen]!filenum & ".snp"
'DoCmd.OpenReport "CertOfCompliance", acViewPreview

End If



End Function
Function ReadFile(ByVal sFileName As String) As String
'Reads file into string
'example
'mytextfilestring = ReadFile("C:\myexportedreport.txt")
    Dim fhFile As Long
    fhFile = FreeFile
    Open sFileName For Binary As #fhFile
    ReadFile = Input$(LOF(fhFile), fhFile)
    Close #fhFile
End Function

Public Function varTaxID() As String
Dim strsql, varFileNum As String
Dim rs As RecordSet

varFileNum = Forms![foreclosure database screen]![filenum]

strsql = "select taxid from postsale where subfilenum = " & varFileNum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs!taxid) Or rs.EOF Then
varTaxID = ""
Else
varTaxID = taxidCode() & rs!taxid
End If

rs.Close

End Function
Public Function taxid()

If IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form!taxid) Then
taxid = InputBox("Tax ID Field is Blank, Enter Tax ID:")
Forms![foreclosure database screen]![PostsaleSubForm].Form!taxid = taxid
Else
taxid = Forms![foreclosure database screen]![PostsaleSubForm].Form!taxid
End If

End Function

Public Function propadd2() As String

If IsNull(Forms![foreclosure database screen]![propaddress2]) Then
propadd2 = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & "  " & Forms![foreclosure database screen]![propzip]
Else
propadd2 = Forms![foreclosure database screen]![propaddress2]
End If

End Function
Public Function propadd() As String
If Not IsNull(Forms![foreclosure database screen]!PropAddress) Then
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
propadd = Forms![foreclosure database screen]![PropAddress]
Else
propadd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
Else
propadd = ""
End If

End Function
Public Function mailadd() As String
If IsNull(Forms![foreclosure database screen]![Mailing Address]) Then
mailadd = ""
Else

mailadd = Forms![foreclosure database screen]![Mailing Address]
End If

End Function
Public Function mailaddb() As String
If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Then
mailaddb = ""
Else

mailaddb = Forms![foreclosure database screen]![Mailing AddressB]
End If

End Function
Public Function mailadd2b() As String
If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Then
mailadd2b = ""
Else

If IsNull(Forms![foreclosure database screen]![Mailing Address2B]) Then
mailadd2b = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
Else
mailadd2b = Forms![foreclosure database screen]![Mailing Address2B]
End If
End If

End Function
Public Function mailadd3B() As String
If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Then
mailadd3B = ""
Else

If IsNull(Forms![foreclosure database screen]![Mailing Address2B]) Then
mailadd3B = ""
Else
mailadd3B = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
End If
End If

End Function
Public Function propTE() As String

If IsNull(Forms![titleform]![propaddress2]) Then

If IsNull(Forms![titleform]![unit_no]) Or Forms![titleform]![unit_no] = "" Then
propTE = Forms![titleform]![PropAddress] & ", " & Forms![titleform]![PropertyCity] & ", " & Forms![titleform]![PropertyState] & " " & Forms![titleform]![propzip]
Else
propTE = Forms![titleform]![PropAddress] & ", Unit # " & Forms![titleform]![unit_no] & ", " & Forms![titleform]![PropertyCity] & ", " & Forms![titleform]![PropertyState] & " " & Forms![titleform]![propzip]
End If

Else
If IsNull(Forms![titleform]![unit_no]) Or Forms![titleform]![unit_no] = "" Then
propTE = Forms![titleform]![PropAddress] & ", " & Forms![titleform]![propaddress2] & ", " & Forms![titleform]![PropertyCity] & ", " & Forms![titleform]![PropertyState] & " " & Forms![titleform]![propzip]
Else
propTE = Forms![titleform]![PropAddress] & ", Unit # " & Forms![titleform]![unit_no] & ", " & Forms![titleform]![propaddress2] & ", " & Forms![titleform]![PropertyCity] & ", " & Forms![titleform]![PropertyState] & " " & Forms![titleform]![propzip]
End If
End If


End Function

Public Function PROP() As String

If IsNull(Forms![foreclosure database screen]![propaddress2]) Then
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
PROP = Forms![foreclosure database screen]![PropAddress] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
Else
PROP = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If

Else
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
PROP = Forms![foreclosure database screen]![PropAddress] & ", " & Forms![foreclosure database screen]![propaddress2] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
Else
PROP = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no] & ", " & Forms![foreclosure database screen]![propaddress2] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If
End If

End Function
Public Function propVA()


If IsNull(Forms![VirginiaSales]![propaddress2]) Then
If IsNull(Forms![VirginiaSales]![unit_no]) Or Forms![VirginiaSales]![unit_no] = "" Then
propVA = Forms![VirginiaSales]![PropAddress] & ", " & Forms![VirginiaSales]![PropertyCity] & ", " & Forms![VirginiaSales]![PropertyState] & " " & Forms![VirginiaSales]![propzip]
Else
propVA = Forms![VirginiaSales]![PropAddress] & ", Unit # " & Forms![VirginiaSales]![unit_no] & ", " & Forms![VirginiaSales]![PropertyCity] & ", " & Forms![VirginiaSales]![PropertyState] & " " & Forms![VirginiaSales]![propzip]
End If

Else
If IsNull(Forms![VirginiaSales]![unit_no]) Or Forms![VirginiaSales]![unit_no] = "" Then
propVA = Forms![VirginiaSales]![PropAddress] & ", " & Forms![VirginiaSales]![propaddress2] & ", " & Forms![VirginiaSales]![PropertyCity] & ", " & Forms![VirginiaSales]![PropertyState] & " " & Forms![VirginiaSales]![propzip]
Else
propVA = Forms![VirginiaSales]![PropAddress] & ", Unit # " & Forms![VirginiaSales]![unit_no] & ", " & Forms![VirginiaSales]![propaddress2] & ", " & Forms![VirginiaSales]![PropertyCity] & ", " & Forms![VirginiaSales]![PropertyState] & " " & Forms![VirginiaSales]![propzip]
End If
End If
'MsgBox (propVA)
End Function

Public Function propadd3() As String

If IsNull(Forms![foreclosure database screen]![propaddress2]) Then
propadd3 = ""
Else
propadd3 = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If
End Function
Public Function mailadd2() As String
If IsNull(Forms![foreclosure database screen]![Mailing Address]) Then
mailadd2 = ""
Else

If IsNull(Forms![foreclosure database screen]![Mailing Address2]) Then
mailadd2 = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & " " & Forms![foreclosure database screen]![Mailing Zip]
Else
mailadd2 = Forms![foreclosure database screen]![Mailing Address2]
End If
End If

End Function
Public Function mailadd3() As String
If IsNull(Forms![foreclosure database screen]![Mailing Address]) Then
mailadd3 = ""
Else

If IsNull(Forms![foreclosure database screen]![Mailing Address2]) Then
mailadd3 = ""
Else
mailadd3 = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & " " & Forms![foreclosure database screen]![Mailing Zip]
End If
End If

End Function

Public Function labelsNOTICE()
Dim Cfilenum As String
Dim SaleDate As String
Dim LoanNo As String
Dim ClientID As String
Dim rs As RecordSet
Dim rsClient As RecordSet
Dim strsql As String
Dim strsqlClient As String
Dim bottomline As String
Dim labeltbl As TableDef
Dim cl As String
Dim rslabels As RecordSet
Dim rsCounty As RecordSet
Dim strsqlCounty As String
Dim cty As String
Dim StateMD As String


CurrentDb.Execute "Delete * from Labels;", dbFailOnError

Cfilenum = Forms![foreclosure database screen]![filenum]

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
SaleDate = Forms![foreclosure database screen]![ForeclosureSubForm].Form![SaleDate]
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form![SaleDate]
ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then
SaleDate = Forms![foreclosure database screen]![ForeclosureSubForm].Form![SaleDate]
End If

cl = Forms![foreclosure database screen]![Client]
strsqlClient = "Select * from Clients where [OrganizationName] = " & """" & cl & """"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)
LoanNo = Forms![foreclosure database screen]![ClientRefNumber]
ClientID = rsClient!CustomerID
rsClient.Close

bottomline = ClientID & " / " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & LoanNo & " / " & SaleDate

strsql = "SELECT FirstNameDebtor1, MiddleNameDebtor1, LastNameDebtor1, " _
& " FirstNameDebtor2, MiddleNameDebtor2, LastNameDebtor2, PropAddress, PropAddress2, " _
& " PropertyCounty, PropertyCity, PropertyState, PropZip, [mailing addressb], [mailing address2b], [mailing cityb], [mailing stateb], [mailing zipb], [Mailing Address], " _
& " [Mailing Address2], [Mailing City], mailA_to, mailB_to, [Mailing State], [Mailing Zip], " _
& " Mr_Mrs_Ms, Mr_Mrs_Ms2, Mr_Mrs_Ms3, FirstNameDebtor3, MiddleNameDebtor3, " _
& " LastNameDebtor3, ClientRefNumber,  firstnamedebtor4," _
& " middlenamedebtor4, lastnamedebtor4, typeofloan FROM Cases WHERE Cases.FileNum = " & Cfilenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Set rslabels = CurrentDb.OpenRecordset("labels", dbOpenDynaset, dbSeeChanges)

With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms
!FirstName = rs!FirstNameDebtor1
!MiddleName = rs!MiddleNameDebtor1
!LastName = rs!LastNameDebtor1
!Address = rs![PropAddress]
!Address2 = rs!propaddress2
!City = rs![PropertyCity]
!State = rs![PropertyState]
!zip = rs![propzip]
!bottomline = bottomline
.Update
End With

If Not IsNull(rs![Mailing Address]) And (IsNull(rs!MailA_To) Or rs!MailA_To = "Grantor1" Or rs!MailA_To = "All Grantors" Or rs!MailA_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms
!FirstName = rs!FirstNameDebtor1
!MiddleName = rs!MiddleNameDebtor1
!LastName = rs!LastNameDebtor1
!Address = rs![Mailing Address]
!Address2 = rs![Mailing Address2]
!City = rs![Mailing City]
!State = rs![Mailing State]
!zip = rs![Mailing Zip]
!bottomline = bottomline
.Update
End With
End If

If Not IsNull(rs![Mailing AddressB]) And (IsNull(rs!MailB_To) Or rs!MailB_To = "Grantor1" Or rs!MailB_To = "All Grantors" Or rs!MailB_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms
!FirstName = rs!FirstNameDebtor1
!MiddleName = rs!MiddleNameDebtor1
!LastName = rs!LastNameDebtor1
!Address = rs![Mailing AddressB]
!Address2 = rs![Mailing Address2B]
!City = rs![Mailing CityB]
!State = rs![Mailing StateB]
!zip = rs![Mailing ZipB]
!bottomline = bottomline
.Update
End With
End If

If rs!LastNameDebtor2 <> "" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms2
!FirstName = rs!FirstNameDebtor2
!MiddleName = rs!MiddleNameDebtor2
!LastName = rs!LastNameDebtor2
!Address = rs![PropAddress]
!Address2 = rs!propaddress2
!City = rs![PropertyCity]
!State = rs![PropertyState]
!zip = rs![propzip]
!bottomline = bottomline
.Update
End With
If Not IsNull(rs![Mailing Address]) And (IsNull(rs!MailA_To) Or rs!MailA_To = "Grantor2" Or rs!MailA_To = "All Grantors" Or rs!MailA_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms2
!FirstName = rs!FirstNameDebtor2
!MiddleName = rs!MiddleNameDebtor2
!LastName = rs!LastNameDebtor2
!Address = rs![Mailing Address]
!Address2 = rs![Mailing Address2]
!City = rs![Mailing City]
!State = rs![Mailing State]
!zip = rs![Mailing Zip]
!bottomline = bottomline
.Update
End With
End If
If Not IsNull(rs![Mailing AddressB]) And (IsNull(rs!MailB_To) Or rs!MailB_To = "Grantor2" Or rs!MailB_To = "All Grantors" Or rs!MailB_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms2
!FirstName = rs!FirstNameDebtor2
!MiddleName = rs!MiddleNameDebtor2
!LastName = rs!LastNameDebtor2
!Address = rs![Mailing AddressB]
!Address2 = rs![Mailing Address2B]
!City = rs![Mailing CityB]
!State = rs![Mailing StateB]
!zip = rs![Mailing ZipB]
!bottomline = bottomline
.Update
End With
End If
End If

If rs!LastNameDebtor3 <> "" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms3
!FirstName = rs!FirstNameDebtor3
!MiddleName = rs!MiddleNameDebtor3
!LastName = rs!LastNameDebtor3
!Address = rs![PropAddress]
!Address2 = rs!propaddress2
!City = rs![PropertyCity]
!State = rs![PropertyState]
!zip = rs![propzip]
!bottomline = bottomline
.Update
End With
If Not IsNull(rs![Mailing Address]) And (IsNull(rs!MailA_To) Or rs!MailA_To = "Grantor3" Or rs!MailA_To = "All Grantors" Or rs!MailA_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms3
!FirstName = rs!FirstNameDebtor3
!MiddleName = rs!MiddleNameDebtor3
!LastName = rs!LastNameDebtor3
!Address = rs![Mailing Address]
!Address2 = rs![Mailing Address2]
!City = rs![Mailing City]
!State = rs![Mailing State]
!zip = rs![Mailing Zip]
!bottomline = bottomline
.Update
End With
End If

If Not IsNull(rs![Mailing AddressB]) And (IsNull(rs!MailB_To) Or rs!MailB_To = "Grantor3" Or rs!MailB_To = "All Grantors" Or rs!MailB_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = rs!Mr_Mrs_Ms3
!FirstName = rs!FirstNameDebtor3
!MiddleName = rs!MiddleNameDebtor3
!LastName = rs!LastNameDebtor3
!Address = rs![Mailing AddressB]
!Address2 = rs![Mailing Address2B]
!City = rs![Mailing CityB]
!State = rs![Mailing StateB]
!zip = rs![Mailing ZipB]
!bottomline = bottomline
.Update
End With
End If
End If

If rs!lastnamedebtor4 <> "" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = ""
!FirstName = rs!firstnamedebtor4
!MiddleName = rs!middlenamedebtor4
!LastName = rs!lastnamedebtor4
!Address = rs![PropAddress]
!Address2 = rs!propaddress2
!City = rs![PropertyCity]
!State = rs![PropertyState]
!zip = rs![propzip]
!bottomline = bottomline
.Update
End With
If Not IsNull(rs![Mailing Address]) And (IsNull(rs!MailA_To) Or rs!MailA_To = "Grantor4" Or rs!MailA_To = "All Grantors" Or rs!MailA_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = ""
!FirstName = rs!firstnamedebtor4
!MiddleName = rs!middlenamedebtor4
!LastName = rs!lastnamedebtor4
!Address = rs![Mailing Address]
!Address2 = rs![Mailing Address2]
!City = rs![Mailing City]
!State = rs![Mailing State]
!zip = rs![Mailing Zip]
!bottomline = bottomline
.Update
End With
End If
If Not IsNull(rs![Mailing AddressB]) And (IsNull(rs!MailB_To) Or rs!MailB_To = "Grantor4" Or rs!MailB_To = "All Grantors" Or rs!MailB_To = "Grantors/Owners") Then
With rslabels
.AddNew
!Mr_Mrs_Ms = ""
!FirstName = rs!firstnamedebtor4
!MiddleName = rs!middlenamedebtor4
!LastName = rs!lastnamedebtor4
!Address = rs![Mailing AddressB]
!Address2 = rs![Mailing Address2B]
!City = rs![Mailing CityB]
!State = rs![Mailing StateB]
!zip = rs![Mailing ZipB]
!bottomline = bottomline
.Update
End With
End If
End If

If rs![TypeOfLoan] = "VA" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = "The Department of Veterans Affairs Regional Office"
!Address = "Loan Guarantee Program"
!Address2 = "Attn: Property Management (263)"
!address3 = "210 Franklin Road, SW"
!City = "Roanoke"
!State = "VA"
!zip = "24011"
!bottomline = bottomline
.Update
End With
End If

If rs![TypeOfLoan] Like "FHA*" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = "Department of Housing and Urban Development"
!Address = "Attention: Single Family Housing Division"
!Address2 = "10 South Howard Street"
!City = "Baltimore"
!State = "MD"
!zip = "21201"
!bottomline = bottomline
.Update
End With
If rs![PropertyState] = "MD" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = "Michaelson, Conner & Boul"
!Address2 = "5312 Bolsa Avenue, Suite 200"
!Address = "Attn:  Kathleen Harris"
!City = "Huntington Beach"
!State = "CA"
!zip = "92649-1020"
!bottomline = bottomline
.Update
End With
End If
If rs![PropertyState] = "VA" Or rs![PropertyState] = "DC" Then
With rslabels
.AddNew
!Mr_Mrs_Ms = "HMBI"
!Address = "One Sentry Park"
!Address2 = "475 Sentry Parkway, Suite 5000"
!City = "Blue Bell"
!State = "PA"
!zip = "19422"
!bottomline = bottomline
.Update
End With
End If
End If

With rslabels
.AddNew
!Mr_Mrs_Ms = "Occupant"
!Address = rs![PropAddress]
!Address2 = rs!propaddress2
!City = rs![PropertyCity]
!State = rs![PropertyState]
!zip = rs![propzip]
!bottomline = bottomline
.Update
End With

If rs![PropertyState] = "MD" Then
cty = rs!Propertycounty
StateMD = rs!PropertyState
strsqlCounty = ("Select * from Jurisdiction where County = " & """" & cty & """" & " and State = " & """" & StateMD & """")
Set rsCounty = CurrentDb.OpenRecordset(strsqlCounty, dbOpenSnapshot)
With rslabels
.AddNew
!Mr_Mrs_Ms = rsCounty![county att]
!Address = rsCounty!countyadd1
!Address2 = rsCounty!countyadd2
!address3 = rsCounty!countyadd3
!City = rsCounty!countyadd4
!bottomline = bottomline
.Update
End With
End If

If rs!PropertyState <> "VA" Then
DoCmd.OpenReport ("labels, notice")
Else
DoCmd.OpenReport ("labels, notice-va")
End If



rs.Close
rslabels.Close

End Function

Public Function SetBGWContact()
 

Dim vpassword
vpassword = InputBox("This Screen Requires a password for viewing.  Please enter or contact Howie regarding same.")
If vpassword = "meera" Then

CurrentDb.Execute "Delete * from tempbgwcontact;", dbFailOnError

DoCmd.OpenQuery ("bgwcontact")
DoCmd.OpenQuery ("BgwcontactPS")
DoCmd.OpenQuery ("BgwcontactPSVA")

Dim rsSales As RecordSet
Dim VSDate, vad, strsql
Dim VStartTime As Date
Dim ContNo As Double

ContNo = 0

strsql = "select * from tempbgwcontact order by propertycounty,saletime"
Set rsSales = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsSales.EOF Then

MsgBox ("No records fall between the 2 dates input.  Screen will not open")

Else

If Not rsSales.EOF Then
rsSales.MoveFirst
Do While Not rsSales.EOF
ContNo = ContNo + 1
With rsSales
.Edit
!contact_no = ContNo
.Update
End With
rsSales.MoveNext
Loop
End If
rsSales.Close


DoCmd.OpenForm ("Sale Date BGW Contacts")
End If

Else
MsgBox ("Incorrect Password")
End If

End Function
Public Function salecontact()
Dim strsql, VContact
Dim VStart, VEnd
Dim rs As RecordSet
salecontact = ""

strsql = "select * from tempbgwcontact where contact_no > " & 0 & " order by contact_no;"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
rs.Close
Exit Function
Else
rs.MoveFirst

Do While Not rs.EOF
'if rs![3rd_bgw_contact] = vcontact then
VContact = rs![3rd_bgw_contact]
VStart = rs!contact_no
VEnd = rs!contact_no
rs.MoveNext

If salecontact <> "" Then
salecontact = "From: " & VStart & " To: " & VEnd & ": " & VContact
Else
salecontact = salecontact + "//"
End If

Loop
End If


End Function
Public Function VASalesADDBGW()
DoCmd.OpenQuery ("VaSaleScreenADD")
DoCmd.Close acForm, "VirginiaSales"
DoCmd.OpenForm "virginiasales"

End Function
Public Function DOCKETScn()
 


CurrentDb.Execute "DELETE * FROM tempvasales;", dbFailOnError
DoCmd.OpenQuery ("docketingscrn")

DoCmd.OpenForm ("DocketingScreen")
End Function
Public Function MDSaleScn()
 

CurrentDb.Execute "DELETE * FROM tempvasales;", dbFailOnError
Dim rs, rsTemp As RecordSet
Dim VSel, VSel2
VSel = InputBox("Sale Date")
VSel2 = InputBox("End Sale Date")

Dim strsql As String

strsql = "SELECT Cases.LastNameDebtor1, foreclosure.fc_opens, foreclosure.resume_da, Cases.PropAddress, cases.resume_recd, Cases.ClientRefNumber, " _
& "Cases.Client, Cases.FileNum, Cases.PropertyState, foreclosure.titlereportordered, Foreclosure.TitleReportRecieved, " _
& " Foreclosure.Book, Foreclosure.info, " _
& " Cases.PropertyCounty, cases.[date recieved], Foreclosure.SaleDate, Foreclosure.SaleTime, Cases.Status, " _
& " Foreclosure.pubreq, Foreclosure.[1st_ad], Foreclosure.[Ad Proof Recd], " _
& " Foreclosure.newspaper1, Foreclosure.newspaper2, Cases.PropertyCity, Cases.PropZip, " _
& " Cases.propaddress2, Cases.Unit_no FROM Cases " _
& " INNER JOIN Foreclosure ON Cases.FileNum = Foreclosure.SubFileNum " _
& " WHERE cases.PropertyState = " & """" & "MD" & """" & " And " _
& " Foreclosure.Saledate >= #" & VSel & "# and foreclosure.saledate <= #" & VSel2 & "# and " _
& " Cases.Status = " & """" & "foreclosure" & """" & ";"


Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Set rsTemp = CurrentDb.OpenRecordset("tempVASales", dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then
rs.MoveFirst
End If

Do While Not rs.EOF
With rsTemp
.AddNew
!filenum = rs!filenum
!LastNameDebtor1 = rs!LastNameDebtor1
!resume_recd = rs!resume_recd
!PropAddress = rs!PropAddress
!ClientRefNumber = rs!ClientRefNumber
!Client = rs!Client
!PropertyState = rs!PropertyState
!TitleReportRecieved = rs!TitleReportRecieved
!TitleReportOrdered = rs!TitleReportOrdered
!Info = rs!Info
!resume_DA = rs!resume_DA
!fc_opens = rs!fc_opens
!Propertycounty = rs!Propertycounty
!SaleDate = rs!SaleDate
!SaleTime = rs!SaleTime
!Status = rs!Status
!pubreq = rs!pubreq
![1st_ad] = rs![1st_ad]
!omit = 0
![Ad Proof Recd] = rs![Ad Proof Recd]
!newspaper1 = rs!newspaper1
!newspaper2 = rs!newspaper2
!PropertyCity = rs!PropertyCity
!propzip = rs!propzip
!propaddress2 = rs!propaddress2
!unit_no = rs!unit_no
![Date Recieved] = rs![Date Recieved]
.Update
End With
rs.MoveNext
Loop
rs.Close

DoCmd.OpenForm ("MDSales")
End Function
Public Function VASalesRETRIEVE()
Dim VOWrite
VOWrite = InputBox("The New Create Screen will BE DELETED and the previous data will overwrite, Continue?")
If VOWrite = "YES" Then
CurrentDb.Execute "DELETE * FROM tempvasales;", dbFailOnError
DoCmd.OpenQuery ("VASalesMKRetrieve")
DoCmd.OpenForm ("virginiasales")
Else
MsgBox ("Exiting Now will not overwrite")
End If

End Function

Public Function MDAcctScn()
 

CurrentDb.Execute "DELETE * FROM tempvasales;", dbFailOnError
Dim rs, rsTemp As RecordSet
Dim VBegSale, VEndSale
VBegSale = InputBox("Enter Beginning Sale Date")
VEndSale = InputBox("Enter Ending Sale Date")

Dim strsql As String

strsql = "SELECT Cases.LastNameDebtor1, Cases.PropAddress, Cases.ClientRefNumber, " _
& "Cases.Client, Cases.FileNum, Cases.PropertyState, foreclosure.titlereportordered, Foreclosure.TitleReportRecieved, " _
& " Foreclosure.liber, Foreclosure.folio, Foreclosure.InstrumentNo, " _
& " Cases.PropertyCounty, cases.[date recieved],  foreclosure.irsnotice, Foreclosure.SaleDate, Foreclosure.SaleTime, Cases.Status, " _
& " Foreclosure.pubreq, foreclosure.title_button, Foreclosure.[1st_ad], Foreclosure.[Ad Proof Recd], " _
& " Foreclosure.newspaper1, Foreclosure.sale_cancelled, Foreclosure.newspaper2, Cases.PropertyCity, Cases.PropZip, " _
& " Cases.propaddress2, Cases.Unit_no, Foreclosure.pub2, Foreclosure.pub3, " _
& " Foreclosure.pub4, Foreclosure.pub5 FROM Cases " _
& " INNER JOIN Foreclosure ON Cases.FileNum = Foreclosure.SubFileNum " _
& " WHERE cases.PropertyState = " & """" & "md" & """" & " And sale_cancelled is null and " _
& " foreclosure.SaleDate >= #" & VBegSale & "# and foreclosure.saledate <=#" & VEndSale & "#;"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsTemp = CurrentDb.OpenRecordset("tempVASales", dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then
rs.MoveFirst
End If

Do While Not rs.EOF
With rsTemp
.AddNew
!filenum = rs!filenum
!LastNameDebtor1 = rs!LastNameDebtor1
!PropAddress = rs!PropAddress
!ClientRefNumber = rs!ClientRefNumber
!Client = rs!Client
!IRSnotice = rs!IRSnotice
!irs_lien = rs!title_button

!PropertyState = rs!PropertyState
!TitleReportRecieved = rs!TitleReportRecieved
!TitleReportOrdered = rs!TitleReportOrdered
!Book = rs!Liber
!VAPage = rs!Folio
!InstrumentNo = rs!InstrumentNo
!Propertycounty = rs!Propertycounty
!SaleDate = rs!SaleDate
!SaleTime = rs!SaleTime
!Status = rs!Status
!pubreq = rs!pubreq
![1st_ad] = rs![1st_ad]
!omit = 0
!newspaper1 = rs!newspaper1
!newspaper2 = rs!newspaper2
!PropertyCity = rs!PropertyCity
!propzip = rs!propzip
!propaddress2 = rs!propaddress2
!unit_no = rs!unit_no
!pub2 = rs!pub2
!pub3 = rs!pub3
!pub4 = rs!pub4
!pub5 = rs!pub5
![Date Recieved] = rs![Date Recieved]
.Update
End With
rs.MoveNext
Loop
rsTemp.Close
rs.Close
DoCmd.OpenQuery ("VAAcctUpdate1")
DoCmd.OpenQuery ("VAAcctUpdate2")

DoCmd.OpenForm ("MDAccounting")

End Function
Public Function VASaleScn()
 

CurrentDb.Execute "Delete * from Temp2VASales;", dbFailOnError
DoCmd.OpenQuery ("VASalesMKCopy")

CurrentDb.Execute "DELETE * FROM tempvasales;", dbFailOnError


DoCmd.OpenQuery "VaSaleScreenCreateTbl"
DoCmd.OpenQuery "VaSaleScreenQC"
DoCmd.OpenQuery "VaSaleScreenTAGrade"

DoCmd.OpenForm ("VirginiaSales")
End Function
Public Function MDSetSales()
 

CurrentDb.Execute "Delete * from Temp2VASales;", dbFailOnError
DoCmd.OpenQuery ("VASalesMKCopy")

CurrentDb.Execute "Delete * from tempvasales;", dbFailOnError
Dim rs, rsTemp As RecordSet
Dim VSel
VSel = InputBox("Enter Group" & vbCr & "1. ALL MD" & vbCr & "2. Non-Cooper-MD" & vbCr & "3. LPS-MD" & vbCr & "4. Vendorscape-MD" & vbCr & "5. FHA Files ONLY-MD" & vbCr & "6. Lenstar-MD")
Dim strsql As String

Set rsTemp = CurrentDb.OpenRecordset("tempVASales", dbOpenDynaset, dbSeeChanges)

'----------------
If VSel = 1 Then
Set rs = CurrentDb.OpenRecordset("MDCountyFCTracking", dbOpenSnapshot)
ElseIf VSel = 2 Then
Set rs = CurrentDb.OpenRecordset("MDNCCountyFCTracking", dbOpenSnapshot)
ElseIf VSel = 3 Then
Set rs = CurrentDb.OpenRecordset("MDCountyFCTrackingNT", dbOpenSnapshot)
ElseIf VSel = 4 Then
Set rs = CurrentDb.OpenRecordset("MDCountyFCTrackingVS", dbOpenSnapshot)
ElseIf VSel = 5 Then
Set rs = CurrentDb.OpenRecordset("MDCountyFCTrackingFHA", dbOpenSnapshot)
ElseIf VSel = 6 Then
Set rs = CurrentDb.OpenRecordset("MDCountyFCTrackingLenstar", dbOpenSnapshot)
'ElseIf VSel = 7 Then
'Set rs = CurrentDb.OpenRecordset("DCSetSales", dbOpenSnapshot)
Else
Set rs = CurrentDb.OpenRecordset("MDCountyFCTracking", dbOpenSnapshot)

End If
Dim strsqlChk As String
Dim rsChk As RecordSet

If Not rs.EOF Then
rs.MoveFirst
End If

Do While Not rs.EOF

strsqlChk = "select * from tempvasales where filenum = " & rs!filenum
Set rsChk = CurrentDb.OpenRecordset(strsqlChk, dbOpenSnapshot)

If rsChk.EOF Then
With rsTemp
.AddNew
!Corp_Trus = rs!commercial
!comments = rs!Info
!resume_DA = rs!resume_DA
!Comm_Check_Cut = rs!date_reset
!filenum = rs!filenum
!breech_exp = rs!breech_exp
!mot_prinbal = rs!mot_prinbal

!pub3 = rs!pre_docket_filed
!pub4 = rs!final_docket_filed
!pub5 = rs!final_LMA_filed
!LastNameDebtor1 = rs!LastNameDebtor1
!PropAddress = rs!PropAddress
!ClientRefNumber = rs!ClientRefNumber
!pub2 = rs![1ST Legal]
!Client = rs!Client
!TypeOfLoan = rs!TypeOfLoan
!PropertyState = rs!PropertyState
!TitleReportRecieved = rs!TitleReportRecieved
!TitleReportOrdered = rs!fc_cooper
!fdl_sent = rs!fdl_sent
!Propertycounty = rs!Propertycounty
!SaleDate = rs!SaleDate
!SaleTime = rs!SaleTime
!Status = rs!Status
![1st_ad] = rs![1st_ad]
!resume_recd = rs!resume_recd
!vasb797_hold = rs!VA_App_Ord
!cert_dot_date = rs!VA_App_recd
!omit = 0
!Hoc_Sent = rs!Hoc_Sent
!Book = rs!Liber
!VAPage = rs!Folio
!book1 = rs!reliber
!vapage1 = rs!refolio
!adu = rs!adu
!newspaper1 = rs!newspaper1
!newspaper2 = rs!newspaper2
!PropertyCity = rs!PropertyCity
!propzip = rs!propzip
!propaddress2 = rs!propaddress2
!unit_no = rs!unit_no
![Date Recieved] = rs![service_complete]
!OrgAmount = rs![vadeposit]
!FirstNameDebtor1 = rs!FirstNameDebtor1
!FirstNameDebtor2 = rs!FirstNameDebtor2
!FirstNameDebtor3 = rs!FirstNameDebtor3
!firstnamedebtor4 = rs!firstnamedebtor4
!LastNameDebtor2 = rs!LastNameDebtor2
!LastNameDebtor3 = rs!LastNameDebtor3
!lastnamedebtor4 = rs!lastnamedebtor4
!lma_mailed = rs!final_LMA_Mailed
!SS1 = rs!Ssno_1
If rs!Ssno_2 = "" Then
!ss2 = Null
Else
!ss2 = rs!Ssno_2
End If
If rs!Ssno_3 = "" Then
!ss3 = Null
Else
!ss3 = rs!Ssno_3
End If
If rs!Ssno_4 = "" Then
!ss4 = Null
Else
!ss4 = rs!Ssno_4
End If
!sbl_sent = rs!DateAbsractSentToClient
!irs_lien = rs!title_button
!saledaycomments = rs!sale_comments

If Not IsNull(rs!final_LMA_filed) Or Not IsNull(rs!service_complete) Then
Dim VNo As Integer

If (rs!flma_no_med = -1 Or rs!flma_no_med = 1) And rs!rev_mtg = 2 Then
VNo = 16
Else
VNo = 28
End If

If Not IsNull(rs![pre_docket_filed]) And Not IsNull(rs!final_LMA_filed) Then
!acct_prepared = Format(rs![final_LMA_filed] + VNo, "mm/dd/yy")
ElseIf Not IsNull(rs!service_complete) Then
!acct_prepared = Format(rs![service_complete] + VNo, "mm/dd/yy")
Else
!acct_prepared = Null

End If

End If

.Update
End With

rsChk.Close
End If

rs.MoveNext
Loop
'-----------------------
rsTemp.Close
rs.Close

DoCmd.OpenQuery ("MDCounty-SODMonies")
DoCmd.OpenQuery ("MDCounty-ps")
DoCmd.OpenQuery ("MDCounty-pm")
DoCmd.OpenQuery ("MDCounty-Walz")
DoCmd.OpenQuery ("MDCountyps")
DoCmd.OpenQuery ("MDCounty-FC")

DoCmd.OpenForm ("MDSetSales")
End Function

Public Function VASales()
DoCmd.Close acForm, "virginiasales"

Dim rsSales As RecordSet
Dim VSDate
Dim vad As Date
Dim VStartTime As Date
Dim timetoadd As Double

timetoadd = 0.02


VSDate = InputBox("Set Sale Date")
VStartTime = InputBox("Set Start Time.  Pleae use Military TIME!")
vad = InputBox("Set 1st Ad")

Set rsSales = CurrentDb.OpenRecordset("tempvasales", dbOpenDynaset, dbSeeChanges)

If Not rsSales.EOF Then
rsSales.MoveFirst
Do While Not rsSales.EOF

'vstarttime = DateAdd "m", 1, VStartTime
If rsSales!omit = -1 Then
VStartTime = DateAdd("n", (timetoadd - CInt(timetoadd)) * 60, VStartTime)

With rsSales
.Edit
!SaleDate = VSDate
!SaleTime = VStartTime
![1st_ad] = vad
'![Ad Proof Recd] = -1
!pub2 = vad + 7
If rsSales!pubreq = "3 times" Or rsSales!pubreq = "4 times" Or rsSales!pubreq = "Other" Then
!pub3 = vad + 14
End If
If rsSales!pubreq = "4 times" Or rsSales!pubreq = "other" Then
!pub4 = vad + 21
End If
If rsSales!pubreq = "Other" Then
!pub5 = vad + 28
End If
'!Book = Forms!virginiasales!Book
'!VAPage = Forms!virginiasales!VAPage
'!InstrumentNo = Forms!virginiasales!InstrumentNo
'!pubreq = Forms!virginiasales!pubreq
.Update
End With
End If

rsSales.MoveNext
Loop
End If
rsSales.Close

DoCmd.OpenForm ("Virginiasales")

End Function
Public Function MDSales()
DoCmd.Close acForm, "mdsetsales"

Dim rsSales As RecordSet
Dim VSDate
Dim vad As Date
Dim VStartTime As Date
Dim timetoadd As Double

timetoadd = 0.02

If NonCooper() = "yes" Then
VSDate = InputBox("Set Sale Date")
VStartTime = InputBox("Set Start Time.  Pleae use Military TIME!")
vad = InputBox("Set 1st Ad")
Set rsSales = CurrentDb.OpenRecordset("tempvasales", dbOpenDynaset, dbSeeChanges)
If Not rsSales.EOF Then
rsSales.MoveFirst
Do While Not rsSales.EOF
'vstarttime = DateAdd "m", 1, VStartTime
If rsSales!omit = -1 Then
VStartTime = DateAdd("n", (timetoadd - CInt(timetoadd)) * 60, VStartTime)
With rsSales
.Edit
!SaleDate = VSDate
!SaleTime = VStartTime
![1st_ad] = vad
'![Ad Proof Recd] = -1
!pub2 = vad + 7
If rsSales!pubreq = "3 times" Or rsSales!pubreq = "4 times" Or rsSales!pubreq = "Other" Then
!pub3 = vad + 14
End If
If rsSales!pubreq = "4 times" Or rsSales!pubreq = "other" Then
!pub4 = vad + 21
End If
If rsSales!pubreq = "Other" Then
!pub5 = vad + 28
End If
'!Book = Forms!virginiasales!Book
'!VAPage = Forms!virginiasales!VAPage
'!InstrumentNo = Forms!virginiasales!InstrumentNo
'!pubreq = Forms!virginiasales!pubreq
.Update
End With
End If
rsSales.MoveNext
Loop
End If
rsSales.Close
DoCmd.OpenForm ("mdsetsales")

Else



End If


End Function

Public Function emaildocsMortgage()
Dim prtdocs As String

Dim DocName As String
Dim doemail As String

            
If [Forms]![foreclosure database screen]![PropertyState] <> "VA" And IsNull([Forms]![foreclosure database screen]![sp]) Then
DocName = "Part One Email Pkg MD-Mortgage"
End If

If [Forms]![foreclosure database screen]![PropertyState] <> "VA" And [Forms]![foreclosure database screen]![sp] <> "" Then
DocName = "Part One Email Pkg MD2-Mortgage"
End If


If Forms![foreclosure database screen]![Client] = "JPMorgan Chase Bank, National Association" Or Forms![foreclosure database screen]![Client] Like "Bank of A*" _
Or Forms![foreclosure database screen]![Client] = "Washington Mutual Bank" Then
prtdocs = InputBox("(E)mail or (P)rint Foreclosure Docs")

If prtdocs = "P" Then
DoCmd.RunMacro ("PartOne-Normal-Email-Mortgage")
ElseIf prtdocs = "E" Then

MsgBox ("The Documents are Saved in My Documents.  Since this is an Acrobat file you have to manually attach it to your email.  Please Attach once your document to your email.")
DoCmd.OpenReport DocName, acViewPreview


End If

Else

DoCmd.RunMacro ("PartOne-Normal-Email-Mortgage")

End If

End Function

Public Function ComplaintDef() As String

Dim firstdebtor As String
Dim secondDebtor As String
Dim thirddebtor As String
Dim fourthdebtor As String
Dim fifthdebtor As String
Dim powner1 As String
Dim powner2 As String

Dim fs As String
Dim st As String
Dim tf As String
Dim FF As String
Dim fsx As String
Dim fff As String

fs = ""
st = ""
tf = ""
FF = ""
fsx = ""
fff = ""

If IsNull(Forms!Complaint![defendant1_name]) Then
powner1 = ""
Else
powner1 = Forms!Complaint![defendant1_name]
End If

If IsNull(Forms!Complaint![defendant2_name]) Then
powner2 = ""
Else
powner2 = Forms!Complaint!defendant2_name
End If


If IsNull(Forms![foreclosure database screen]![MiddleNameDebtor1]) Then
firstdebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]![LastNameDebtor1])
Else
firstdebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]![MiddleNameDebtor1] & " " & Forms![foreclosure database screen]![LastNameDebtor1])
End If

If IsNull(Forms![foreclosure database screen]![MiddleNameDebtor2]) Then
secondDebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]![LastNameDebtor2])
Else
secondDebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]![MiddleNameDebtor2] & " " & Forms![foreclosure database screen]![LastNameDebtor2])
End If

If IsNull(Forms![foreclosure database screen]![MiddleNameDebtor3]) Then
thirddebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]![LastNameDebtor3])
Else
thirddebtor = Trim(Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]![MiddleNameDebtor3] & " " & Forms![foreclosure database screen]![LastNameDebtor3])
End If

If IsNull(Forms![foreclosure database screen]![middlenamedebtor4]) Then
fourthdebtor = Trim(Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]![lastnamedebtor4])
Else
fourthdebtor = Trim(Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]![middlenamedebtor4] & " " & Forms![foreclosure database screen]![lastnamedebtor4])
End If

If IsNull(Forms![foreclosure database screen]![middlenamedebtor5]) Then
fifthdebtor = Trim(Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]![lastnamedebtor5])
Else
fifthdebtor = Trim(Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]![middlenamedebtor5] & " " & Forms![foreclosure database screen]![lastnamedebtor5])
End If

If secondDebtor <> "" Then
If thirddebtor <> "" Or powner1 <> "" Then
fs = ", "
Else
fs = " and "
End If
End If

If thirddebtor <> "" Then
If fourthdebtor <> "" Or powner1 <> "" Then
st = ", "
Else
st = " and "
End If
End If

If fourthdebtor <> "" Then
If fifthdebtor <> "" Or powner1 <> "" Then
tf = ", "
Else
tf = " and "
End If
End If

If fifthdebtor <> "" Then
If powner1 <> "" Then
fff = ", "
Else
fff = " and "
End If
End If

If powner1 <> "" Then
If powner2 <> "" Then
FF = ", "
Else
FF = " and "
End If
End If

If powner2 <> "" Then
fsx = " and "
End If




ComplaintDef = firstdebtor & fs & secondDebtor & st & thirddebtor & tf & fourthdebtor & fff & fifthdebtor & FF & powner1 & fsx & powner2


End Function
Public Function marixdoadate()

If IsNull(Forms![foreclosure database screen]!resume_recd) Or Forms![foreclosure database screen]!resume_recd <> "" Then
marixdoadate = Forms![foreclosure database screen]![Date Recieved]
Else
marixdoadate = Forms![foreclosure database screen]![resume_recd]
End If

End Function
Public Function MarixDayTH()

Dim todayth As String
Dim dayth As String

todayth = Format(marixdoadate(), "dd")

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayth = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayth = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayth = "rd"
Else
dayth = "th"
End If

MarixDayTH = Format(marixdoadate(), "dd") & " day of " & Format(marixdoadate(), "mmmm") & ", " & Format(marixdoadate(), "yyyy")

End Function
Public Function DOADayth()
Dim todayth As String
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentClient) Then

todayth = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DocsSentClient, "dd")

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
DOADayth = "st"
ElseIf todayth = 2 Or todayth = 22 Then
DOADayth = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
DOADayth = "rd"
Else
DOADayth = "th"
End If
End If

End Function
Public Function SaleDayth()
Dim todayth As String
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then


todayth = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "dd")

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
SaleDayth = "st"
ElseIf todayth = 2 Or todayth = 22 Then
SaleDayth = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
SaleDayth = "rd"
Else
SaleDayth = "th"
End If

End If

End Function
Public Function dayth()

Dim todayth As String
todayth = Format(Date, "dd")

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayth = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayth = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayth = "rd"
Else
dayth = "th"
End If


End Function

Public Function CaseNoCaption() As String
Dim rs As RecordSet
Dim strsql As String
Dim filenum As String

filenum = Forms![foreclosure database screen]![filenum]

strsql = "Select * from postsale where subfilenum = " & filenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If rs.EOF Then
CaseNoCaption = ""
Else
If IsNull(rs!CaseNo) Then
CaseNoCaption = ""
Else
CaseNoCaption = rs!CaseNo
End If
End If

rs.Close



End Function
Public Function SignsDocsVA() As String

Dim clientname As String
Dim rs As RecordSet
Dim strsql As String
Dim DocName As String
Dim masign As String
Dim doasign As String

DocName = Application.CurrentObjectName

clientname = Forms![foreclosure database screen]![Client]
strsql = "Select * from clients where organizationname = " & """" & clientname & """"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If clientname Like "Ocwen*" Then
If IsNull(rs!doaSign1) Then
SignsDocsVA = ""
Else
SignsDocsVA = rs![doaSign1]
End If

ElseIf clientname Like "Equicr*" Then
SignsDocsVA = "Karen Dickinson"
ElseIf clientname Like "Household*" Then
SignsDocsVA = "Scott Ellerbee"
ElseIf clientname Like "Bank of Am*" Or clientname Like "Citi*" Then
SignsDocsVA = "Name: _________________________"

ElseIf DocName Like "Military*" Then

If IsNull(rs!masign1) Then
masign = ""
Else
masign = rs!masign1
End If

If IsNull(rs!doaSign1) Then
doasign = ""
Else
doasign = rs!doaSign1
End If

If masign <> "" Then
SignsDocsVA = masign
Else
SignsDocsVA = doasign
End If

End If

rs.Close



End Function


Public Function TitleDocsVA() As String

Dim clientname As String
Dim rs As RecordSet
Dim strsql As String
Dim DocName As String
Dim matitle As String
Dim Title As String

DocName = Application.CurrentObjectName


clientname = Forms![foreclosure database screen]![Client]
strsql = "Select * from clients where organizationname = " & """" & clientname & """"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If clientname Like "Ocwen*" Then
If IsNull(rs!Title1) Then
TitleDocsVA = ""
Else
TitleDocsVA = rs![Title1]
End If

ElseIf clientname Like "Equicr*" Then
TitleDocsVA = "Foreclosure Administrator"
ElseIf clientname Like "Household*" Then
TitleDocsVA = "Vice President"
ElseIf clientname Like "Bank of Am*" Then
TitleDocsVA = "Title: __________________________"
ElseIf clientname Like "Citi*" Then
TitleDocsVA = "Its: Authorized Representative"

ElseIf DocName Like "Military*" Then

If IsNull(rs!matitle1) Then
matitle = ""
Else
matitle = rs!matitle1
End If

If IsNull(rs!Title1) Then
Title = ""
Else
Title = rs!Title1
End If

If masign <> "" Then
TitleDocsVA = masign
Else
TitleDocsVA = Title
End If


End If
rs.Close

End Function

Public Function startdate() As Date
Dim yeard, todaydate, monthd As String

If todaydate > 15 Then
startdate = Reports![Eviction MD Report]![startdate]
End If

If todaydate < 15 Then
startdate = Reports![Eviction MD Report]![startdate]
End If


End Function
Public Function startdateDC() As Date
Dim yeard, todaydate, monthd As String

If todaydate > 15 Then
startdateDC = Reports![Eviction DC Report]![startdate]
End If

If todaydate < 15 Then
startdateDC = Reports![Eviction DC Report]![startdate]
End If


End Function
Public Function enddateDC() As Date
Dim yeard, todaydate, monthd As String
Dim message, Title As String

If todaydate > 15 Then
enddateDC = Reports![Eviction DC Report]![EndDate]
End If

If todaydate < 15 Then
enddateDC = Reports![Eviction DC Report]![startdate]

End If

End Function
Public Function EndDate() As Date
Dim yeard, todaydate, monthd As String
Dim message, Title As String


monthd = Format(Date, "mm")
todaydate = Format(Date, "dd")
yeard = Format(Date, "yy")

If todaydate > 15 Then
EndDate = Reports![Eviction MD Report]![EndDate]
End If

If todaydate < 15 Then
EndDate = Reports![Eviction MD Report]![startdate]

Rem If monthd = 1 Or monthd = 3 Or monthd = 5 Or monthd = 7 Or monthd = 8 Or monthd = 10 Or monthd = 12 Then
Rem enddate = monthd & "/" & 31 & "/" & yeard
Rem ElseIf monthd = 4 Or monthd = 6 Or monthd = 9 Or monthd = 11 Then
Rem enddate = monthd & "/" & 30 & "/" & yeard
Rem ElseIf monthd = 2 Then
Rem If yeard = 4 Or yeard = 8 Or yeard = 12 Or yeard = 16 Or yeard = 20 Then
Rem enddate = monthd & "/" & 29 & "/" & yeard
Rem Else
Rem enddate = monthd & "/" & 28 & "/" & yeard
Rem End If
Rem End If

End If





End Function
Public Function NoticeIndLienEmail()
ContactID = Forms![creditors]![Creditor].[Form]!ContactID

strsql = "select * from creditors where [contactid] = " & ContactID
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Dim DocName As String

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

If [Forms]![creditors]![Creditor].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 14 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

'FIX

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
VConvRpt = "indcredva"
Else
VConvRpt = "indcred"
End If

Call ConvertPDFALL

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Attachments.ADD pathuser() & "\" & VConvRpt & ".pdf"
MyMail.Subject = "Borrower(s): " & debtorsFORE() & ": Lienholder Letter Attached"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End Function

Public Function NoticeIndLien()

ContactID = InputBox("Enter Letter Number:")
strsql = "select * from creditors where [contactid] = " & ContactID
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


Dim DocName As String

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
rs.Close

Exit Function
End If

If ([Forms]![creditors]![Creditor].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Or _
([Forms]![creditors]![noticesent_lien] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close
Exit Function
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 14 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close

Exit Function
End If
End If
End If

rs.Close


If Forms![foreclosure database screen]![PropertyState] = "VA" Then
VConvRpt = "indcredva"
Else
VConvRpt = "indcred"
End If



Dim VWalz

VWalz = MsgBox("Dump to Walz?", vbYesNo)
If VWalz = vbYes Then
'WO Call IndLienholder
 Call WalzLienInd
 'MsgBox ("Letter Sent to Walz")

End If

End Function
Public Function noticeindlienCHANGE()
'ContactID = InputBox("Enter Letter Number:")
'strsql = "select * from creditors where [contactid] = " & ContactID
'Set RS = CurrentDb.OpenRecordset(strsql, dbopensnapshot)


If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
rs.Close

Exit Function
End If


Dim DocName As String



DoCmd.OpenReport "indcredCHANGE", acViewPreview





End Function

Public Function NoticesLienholdersPRT() As String
Dim rs As RecordSet
Dim strsql, VarNoticeFile As String

VarNoticeFile = Forms![foreclosure database screen]![filenum]
varsaledate = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]

strsql = "select * from creditors where filenum = " & VarNoticeFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent_lien) And IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![noticesent]) Then
MsgBox "NOTICE SENT FIELD NOT FILLED IN, Please input!!!!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
VexitFunc = 1
Exit Function
End If

If (Forms![foreclosure database screen]!ForeclosureSubForm.Form![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Or _
(Forms![foreclosure database screen]!ForeclosureSubForm.Form![noticesent_lien] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
VexitFunc = 1
Exit Function
End If
End If


Dim VarBadDate As Integer
Dim VarLien As String

VarBadDate = 0

While Not rs.EOF
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If varsaledate < Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent + 10 Or varsaledate > Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent + 30 Then
VarBadDate = VarBadDate + 1
VarLien = VarLien + rs!OrganizationName + "; "

End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
'MsgBox (varsaledate)
If varsaledate < Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent + 14 Or varsaledate > Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent + 30 Then
VarBadDate = VarBadDate + 1
VarLien = VarLien + rs!OrganizationName + "; "
End If
End If

If rs!Address = "" Or IsNull(rs!Address) Then
VarBadDate = VarBadDate + 1
MsgBox (rs!OrganizationName & " has no address please input address and run letters again")
VexitFunc = 1
Exit Function
End If

rs.MoveNext
Wend


If VarBadDate <> 0 Then
MsgBox "ONE OR MORE OF THE NOTICE SENT DATE(S) FOR THIS FILE IS INCORRECT: " & vbCr & VarLien & vbCr & "Please update these dates or input an Override Notice Sent Date."
VexitFunc = 1
Exit Function
End If





If Forms![foreclosure database screen]![PropertyState] = "VA" Then
DoCmd.OpenReport ("creditorsva"), acViewPreview
DoCmd.OpenReport ("Adv-VA"), acViewPreview


ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
DoCmd.OpenReport ("creditors"), acViewPreview
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
DoCmd.OpenReport ("creditors"), acViewPreview
End If




'Call NOSCreditors
'MsgBox ("text file to Walz")


End Function


Public Function NoticesLienholders() As String

If IsNull(Forms!creditors!noticesentOR) Then

If IsNull(Forms!creditors!noticesent_lien) And IsNull([Forms]![creditors]![Creditor].[Form]![noticesent]) Then
MsgBox "NOTICE SENT FIELD NOT FILLED IN, Please input!!!!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
VexitFunc = 1
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
VexitFunc = 1
Exit Function
End If

If ([Forms]![creditors]![Creditor].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Or _
([Forms]![creditors]![noticesent_lien] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
VexitFunc = 1
Exit Function
End If
End If

If IsNull(Forms!creditors!noticesentOR) Then

Dim rs As RecordSet
Dim strsql, VarNoticeFile As String

VarNoticeFile = Forms![foreclosure database screen]![filenum]
varsaledate = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]

strsql = "select * from creditors where filenum = " & VarNoticeFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


Dim VarBadDate As Integer
Dim VarLien As String

VarBadDate = 0

While Not rs.EOF
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If varsaledate < rs!noticesent + 10 Or varsaledate > rs!noticesent + 30 Then
VarBadDate = VarBadDate + 1
VarLien = VarLien + rs!OrganizationName + "; "

End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
'MsgBox (varsaledate)
If varsaledate < rs!noticesent + 14 Or varsaledate > rs!noticesent + 30 Then
VarBadDate = VarBadDate + 1
VarLien = VarLien + rs!OrganizationName + "; "
End If
End If

If rs!Address = "" Or IsNull(rs!Address) Then
VarBadDate = VarBadDate + 1
MsgBox (rs!OrganizationName & " has no address please input address and run letters again")
VexitFunc = 1
Exit Function
End If

rs.MoveNext
Wend


If VarBadDate <> 0 Then
MsgBox "ONE OR MORE OF THE NOTICE SENT DATE(S) FOR THIS FILE IS INCORRECT: " & vbCr & VarLien & vbCr & "Please update these dates or input an Override Notice Sent Date."
VexitFunc = 1
Exit Function
End If

End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
DoCmd.OpenReport ("creditorsva"), acViewPreview
DoCmd.OpenReport ("Adv-VA"), acViewPreview


ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
DoCmd.OpenReport ("creditors"), acViewPreview
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
DoCmd.OpenReport ("creditors"), acViewPreview
End If


Else

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < Forms!creditors!noticesentOR + 10 Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > Forms!creditors!noticesentOR + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
VexitFunc = 1
End If
End If

End If


If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < Forms!creditors!noticesentOR + 14 Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > Forms!creditors!noticesentOR + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
VexitFunc = 1
End If
End If
End If
End If


'Call NOSCreditors
'MsgBox ("text file to Walz")


End Function
Public Function NoticesDebtorsVASales() As String

If [Forms]![VirginiaSales]![SaleDate] < _
[Forms]![VirginiaSales]![noticesent] + 14 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If


If [Forms]![VirginiaSales]![SaleTime] > #6:00:00 PM# Or _
[Forms]![VirginiaSales]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
Exit Function
End If

If [Forms]![VirginiaSales]![noticesent] > _
[Forms]![VirginiaSales]![SaleDate] Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If


If IsNull([Forms]![VirginiaSales]![noticesent]) Or _
[Forms]![VirginiaSales]![noticesent] = "" Then
MsgBox "PLEASE FILL IN NOTICE SENT FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

If Forms![VirginiaSales]![PropertyState] = "VA" Then

Call ExportNotices

DoCmd.OpenReport ("Notice of Sale - Virginia")

'End If

DoCmd.OpenReport ("Adv-VA")

'If [Forms]![virginiasales]![BKSub].[Form]![chapter] = 7 Then
'DoCmd.OpenReport ("Notice of Sale - VirginiaBKTrustee"), acViewNormal
'End If


End If

Dim VSend As String

VSend = InputBox("Send Notice of Sale Letters to Walz for Mailing?")

If VSend = "YES" Then

If Forms![VirginiaSales]![PropertyState] = "VA" Then
If [Forms]![VirginiaSales]![SaleDate] < _
[Forms]![VirginiaSales]![noticesent] + 14 Then
MsgBox "WALZ INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days From Sale Date.  MUST DO LETTERS MANUALLY.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "Walz" Then
Else
Exit Function
End If
End If
End If
VCancelDump = 0

Call NOSCheck
 If VCancelDump = 1 Then
 MsgBox ("LETTERS NOT SENT TO WALZ!!")
 Exit Function
 
 Else
 'MsgBox ("Letters Sent to Walz")
 End If
 End If

End Function
Public Function NoticesDebtorsEmail() As String
Dim VNoAtt As Integer
VNoAtt = 0

If Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 14 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If

'MsgBox ("Date: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![NoticeSent])

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent]) Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] = "" Then
MsgBox "PLEASE FILL IN NOTICE SENT FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

If Forms![foreclosure database screen]![PropertyState] = "VA" Then

Call ExportNotices
'Call ExportLienholderNoticesVA

VConvRpt = "Notice of Sale - Virginia"
Call ConvertPDFALL
MyMail.Attachments.ADD pathuser() & "\Notice of Sale - Virginia.pdf"
VNoAtt = VNoAtt + 1

'DoCmd.OutputTo acOutputReport, "Adv-VA", acFormatSNP, "C:\4closure\NOSLettersVAAd.snp"

VConvRpt = "Adv-VA"
Call ConvertPDFALL
MyMail.Attachments.ADD pathuser() & "\Adv-VA.PDF"

VNoAtt = VNoAtt + 1

If [Forms]![foreclosure database screen]![BankruptcySubForm].[Form]![chapter] = 7 Then
'DoCmd.OutputTo acOutputReport, "Notice of Sale - VirginiaBKTrustee", acFormatSNP, "C:\4closure\NOSLettersVABk.snp"
'VConvRpt = "Notice of Sale - VirginiaBKTrustee"
'Call ConvertPDFALL
'MyMail.Attachments.ADD pathuser() & "\Notice of Sale - VirginiaBKTrustee.PDF"
'VNoAtt = VNoAtt + 1

End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then

Call ExportNotices

'DoCmd.OutputTo acOutputReport, "Notice of Sale", acFormatSNP, "C:\4closure\NOSLetters.snp"
VConvRpt = "Notice of Sale"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of Sale.PDF"
VNoAtt = VNoAtt + 1

If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!PropertyCity = "Allen" Or _
Forms![foreclosure database screen]!PropertyCity = "Bivalve" Or _
Forms![foreclosure database screen]!PropertyCity = "Nanticoke" Or _
Forms![foreclosure database screen]!PropertyCity = "Parsonburg" Or _
Forms![foreclosure database screen]!PropertyCity = "Powellville" Or _
Forms![foreclosure database screen]!PropertyCity = "Quantico" Or _
Forms![foreclosure database screen]!PropertyCity = "Tyaskin" Then
Else
VConvRpt = "Notice of Sale - City"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of Sale - City.PDF"
VNoAtt = VNoAtt + 1
End If

End If

If [Forms]![foreclosure database screen]!PropertyState = "DC" Or _
Forms![foreclosure database screen]![resume_recd] <> "" Or _
(IsNull(Forms![foreclosure database screen]![resume_recd]) And _
[Forms]![foreclosure database screen]![Date Recieved] < #11/22/2005#) Or _
[Forms]![foreclosure database screen]![resume_recd] < #11/22/2005# Then

'DoCmd.OutputTo acOutputReport, "Notice of Sale - PG", acFormatSNP, "C:\4closure\NOSLettersCounty.snp"
VConvRpt = "Notice of Sale - PG"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of Sale - PG.PDF"
VNoAtt = VNoAtt + 1

End If

If [Forms]![foreclosure database screen]![BankruptcySubForm].[Form]![chapter] = 7 Then
'DoCmd.OutputTo acOutputReport, "Notice of SaleBKTrustee", acFormatSNP, "C:\4closure\NOSLettersBKTrus.snp"
VConvRpt = "Notice of SaleBKTrustee"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of SaleBKTrustee.PDF"
VNoAtt = VNoAtt + 1

End If

End If

If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Then
'DoCmd.OutputTo acOutputReport, "Notice of Saleva", acFormatSNP, "C:\4closure\NOSLettersV.snp"
VConvRpt = "Notice of Saleva"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of Sale.PDF"

VNoAtt = VNoAtt + 1

End If
If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
VConvRpt = "Notice of Salehud"
Call ConvertPDFALL

MyMail.Attachments.ADD pathuser() & "\Notice of Salehud.PDF"
VNoAtt = VNoAtt + 1

End If


MyMail.Subject = "Borrower(s): " & debtorsFORE() & ": NOS Letters Attached"
'MyMail.Body = vbcr & vbcr & vbcr & vbcr & "The attached letter is in Snapshot format.  If your system does not have the viewer installed please click on the below link. http://www.microsoft.com/downloads/details.aspx?amp;displaylang=en&familyid=B73DF33F-6D74-423D-8274-8B7E6313EDFB&displaylang=en"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing




End Function
Public Function trusteesignsDeed()
Dim rs As RecordSet
Dim strsql As String
Dim VMname As String

VMname = InputBox("Enter Initials of Attorney Signing Deed.")

strsql = "Select * from employees where EmployeeID = " & """" & VMname & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
MsgBox ("INCORRECT Initials!! DO NOT PRINT OUT DEED!!")
rs.Close
Exit Function

Else

If IsNull(rs!MiddleName) Then
trusteesignsDeed = rs!FirstName & " " & rs!LastName
Else
trusteesignsDeed = rs!FirstName & " " & rs!MiddleName & " " & rs!LastName
End If

rs.Close

End If


End Function
Public Function trusteesigns() As String
Dim VarCounty, strsql As String
Dim rs As RecordSet

VarCounty = Forms![foreclosure database screen]![Propertycounty]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs!Trustee) Then
trusteesigns = ""
Else

If IsNull(rs!trustee2) Then
Forms![foreclosure database screen]![jurTrustee] = rs![Trustee_First] & " " & rs![Trustee]
Forms![foreclosure database screen]![jurTrusteeAdd] = rs![trustee address]
Forms![foreclosure database screen]![jurtrusteecsz] = rs![trustee citystatezip]
Forms![foreclosure database screen]![jurTrusteefax] = rs![Trustee_fax]

Else


If VarTrustee = 1 Then
Forms![foreclosure database screen]![jurTrustee] = rs![Trustee_First] & " " & rs![Trustee]
Forms![foreclosure database screen]![jurTrusteeAdd] = rs![trustee address]
Forms![foreclosure database screen]![jurtrusteecsz] = rs![trustee citystatezip]
Forms![foreclosure database screen]![jurTrusteefax] = rs![Trustee_fax]

ElseIf VarTrustee = 2 Then

Forms![foreclosure database screen]![jurTrustee] = rs![trustee2_first] & " " & rs![trustee2]
Forms![foreclosure database screen]![jurTrusteeAdd] = rs![trustee2_address] & " " & rs!trustee2_address2
Forms![foreclosure database screen]![jurtrusteecsz] = rs![trustee2_csz]
Forms![foreclosure database screen]![jurTrusteefax] = rs![trustee2_fax]

ElseIf VarTrustee = 3 Then

Forms![foreclosure database screen]![jurTrustee] = rs![Trustee_First] & " " & rs![Trustee]
Forms![foreclosure database screen]![jurTrusteeAdd] = rs![trustee address]
Forms![foreclosure database screen]![jurtrusteecsz] = rs![trustee citystatezip]
Forms![foreclosure database screen]![jurTrusteefax] = rs![Trustee_fax]

Forms![foreclosure database screen]![jurtrustee2] = rs![trustee2_first] & " " & rs![trustee2]
Forms![foreclosure database screen]![jurTrusteeAdd2] = rs![trustee2_address] & " " & rs!trustee2_address2
Forms![foreclosure database screen]![jurtrusteecsz2] = rs![trustee2_csz]
Forms![foreclosure database screen]![jurTrusteefax2] = rs![trustee2_fax]


End If
End If

End If

rs.Close

End Function
Public Function SubTrusteeDEED()
Dim rs As RecordSet
Dim strsql As String
Dim VMname As String

If Forms![foreclosure database screen]!PostsaleSubForm.Form!mswtransfer = -1 Or Forms![foreclosure database screen]!PostsaleSubForm.Form!mswtransfer = 1 Then

SubTrusteeDEED = "MARK WITTSTADT or GERARD WM. WITTSTADT, JR."

Else

VMname = InputBox("Enter Initials of Substitute Trustee Signing Deed or return for blank.")

If VMname = "" Then
SubTrusteeDEED = ""

Else

If Forms![foreclosure database screen]!AttorneyCAPFIELD = "6 Trustees" Then
strsql = "Select * from qry6trustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "9 Trustees" Then
strsql = "Select * from qry9trustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "10 Trustees" Then
strsql = "Select * from qry10trustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "12 Trustees" Then
strsql = "Select * from qry11trustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "8 TrusteesDC" Then
strsql = "Select * from qry8DCtrustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "6 TrusteesDC" Then
strsql = "Select * from qry6DCtrustees where EmployeeID = " & """" & VMname & """" & ";"
ElseIf Forms![foreclosure database screen]!AttorneyCAPFIELD = "2 TrusteesDC" Then
strsql = "Select * from qry2DCtrustees where EmployeeID = " & """" & VMname & """" & ";"

End If


If Len(strsql) = 0 Then

    SubTrusteeDEED = ""
    Exit Function
End If


Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
MsgBox ("INCORRECT Initials (Not a Sub Trustee for this file!!) DO NOT PRINT OUT DEED!!")
rs.Close
Exit Function

Else


If IsNull(rs!MiddleName) Then
SubTrusteeDEED = rs!FirstName & " " & rs!LastName
Else
SubTrusteeDEED = rs!FirstName & " " & rs!MiddleName & " " & rs!LastName
End If

rs.Close

End If
End If

End If


End Function
Public Function TrusteeSignAdd1() As String
If IsNull(Forms![foreclosure database screen]![Trustee].Form![Trustee]) Then
TrusteeSignAdd1 = ""
Else

If IsNull(Forms![foreclosure database screen]![Trustee].Form![trustee2]) Then
TrusteeSignAdd1 = Forms![foreclosure database screen]![Trustee].Form![trustee address]
Else
If VarTrustee = 1 Then
TrusteeSignAdd1 = Forms![foreclosure database screen]![Trustee].Form![trustee address]
ElseIf VarTrustee = 2 Then
TrusteeSignAdd1 = Forms![foreclosure database screen]![Trustee].Form![trustee2_address]
ElseIf VarTrustee = 3 Then
TrusteeSignAdd1 = Forms![foreclosure database screen]![Trustee].Form![trustee address]
'TrusteeSignAdd2 = Forms![foreclosure database screen]![Trustee].Form![trustee2_address]
End If
End If

End If

End Function
Public Function purchaserVS()

If [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer] Like "*REO*" _
Or [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]!Purchaser_Last Like "*REO*" Then
purchaserVS = Forms![foreclosure database screen]![SecuredParty]
Else

If IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer]) And _
IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Purchaser_Last]) Then
Dim VarPurchaser As String
VarPurchaser = InputBox("No Purchaser Input, Please type in Purchaser and make sure to add into Screen")
purchaserVS = VarPurchaser
Else
If IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Purchaser_Last]) Then
purchaserVS = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer]
Else
purchaserVS = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Buyer] & " " & [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![Purchaser_Last]
End If
End If

End If
End Function

Public Function trusteeConsent()
Dim Jurisdiction As String
If Not IsNull(Forms![foreclosure database screen]![BankruptcySubForm].Form![Jurisdiction]) Then

Jurisdiction = Forms![foreclosure database screen]![BankruptcySubForm].Form![Jurisdiction]

If IsNull(Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename]) Then

If Jurisdiction Like "Alex*" Then
trusteeConsent = "Thomas P. Gorman"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteeConsent = "Lucinda B. Connelly"
ElseIf Jurisdiction Like "Roan*" Then
trusteeConsent = "J. Glenwood Strickler"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
If Forms!consentpopup!VBarnhart = -1 Then
trusteeConsent = "Kelly M. Barnhart"
Else
trusteeConsent = "Debera F. Conlon"
End If

ElseIf Jurisdiction Like "Rich*" Then
trusteeConsent = "Robert E. Hyman"
ElseIf Jurisdiction = "D.C." Then
trusteeConsent = "Cynthia Niklas"
ElseIf Jurisdiction Like "Charlot*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Harris*" Then
trusteeConsent = "Helen P. Parrish"
ElseIf Jurisdiction Like "Abing*" Then
trusteeConsent = "Jo S. Widener"
ElseIf Jurisdiction Like "Greenbe*" Then
trusteeConsent = "Thomas L. Lackey"
ElseIf Jurisdiction Like "Balti*" Then
trusteeConsent = "Ellen W. Cosby"
End If

Else

If Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename] Like "*Conlon*" Then
If Forms!consentpopup!VBarnhart = -1 Then
trusteeConsent = "Kelly M. Barnhart"
Else
trusteeConsent = Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename]
End If
Else
trusteeConsent = Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename]
End If
End If


Else
trusteeConsent = ""
End If
End Function


Public Function PropertyAddress() As String
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
PropertyAddress = Forms![foreclosure database screen]![PropAddress] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
Else
PropertyAddress = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no] & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip]
End If

End Function
Public Function County() As String


If Forms![foreclosure database screen]![Propertycounty] = "James City" Then
County = "City of Williamsburg and County of James City"
Else

If Forms![foreclosure database screen]![Propertycounty] Like "*City" Or _
Forms![foreclosure database screen]![Propertycounty] Like "City*" Then
County = Forms![foreclosure database screen]![Propertycounty]
ElseIf Forms![foreclosure database screen]![Propertycounty] Like "District of*" Then
County = Forms![foreclosure database screen]![Propertycounty]
Else
County = Forms![foreclosure database screen]![Propertycounty] & " County"
End If

End If


End Function
Public Function CountySALES() As String


If Forms![VirginiaSales]![Propertycounty] = "James City" Then
CountySALES = "City of Williamsburg and County of James City"
Else

If Forms![VirginiaSales]![Propertycounty] Like "*City" Or _
Forms![VirginiaSales]![Propertycounty] Like "City*" Then
CountySALES = Forms![VirginiaSales]![Propertycounty]
Else
CountySALES = Forms![VirginiaSales]![Propertycounty] & " County"
End If

End If

End Function
Public Function DeferLanguage()

Dim VSel

VSel = InputBox("Sale Cancelled because: " & vbCr & "1.  The parties entered into a Forbearance Agreement." & vbCr & "2. The Defendant Filed Bankruptcy" & vbCr & "3. Other")
If VSel = 1 Then
DeferLanguage = "the parties entered into a repayment agreement.  Under the terms of the repayment agreement, the lender was entitled to keep this case open and schedule a new foreclosure sale in the event of a default by the borrower.  A default under the repayment agreement occurred."
ElseIf VSel = 2 Then
DeferLanguage = "a defendant herein filed a bankruptcy petition in Case Number " & Forms!bankruptcymain!BankruptcySubForm.Form![BKY Case Number] & " on " & Forms!bankruptcymain!BankruptcySubForm.Form![DateFiled] & " which stayed this foreclosure action.  The bankruptcy stay has now been terminated.  "
ElseIf VSel = 3 Then
Dim VSel2
VSel2 = InputBox("You selected OTHER.  Please input information to populate this option.")

If VSel2 = "" Or IsNull(VSel2) Then
DeferLanguage = "Other"
Else
DeferLanguage = VSel2
End If

End If

End Function
Public Function CountyState() As String

If Forms![foreclosure database screen]![Propertycounty] = "James City" Then
CountyState = "City of Williamsburg and County of James City, Virginia"
Else
Dim VState As String
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VState = "Maryland"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VState = ""
ElseIf Forms![foreclosure database screen]!PropertyState = "VA" Then
VState = "Virginia"
End If

If Forms![foreclosure database screen]![Propertycounty] Like "*City" Or _
Forms![foreclosure database screen]![Propertycounty] Like "City*" Then

CountyState = Forms![foreclosure database screen]![Propertycounty] & ", " & VState

ElseIf Forms![foreclosure database screen]![Propertycounty] Like "District of*" Then
CountyState = Forms![foreclosure database screen]![Propertycounty]
Else
CountyState = Forms![foreclosure database screen]![Propertycounty] & " County" & ", " & VState
End If

End If

End Function
Public Function CountyOf() As String
If Forms![foreclosure database screen]![Propertycounty] = "James City" Then
CountyOf = "the County of City of Williamsburg and County of James City"
Else
If Forms![foreclosure database screen]![Propertycounty] Like "*City" Or _
Forms![foreclosure database screen]![Propertycounty] Like "City*" Then
CountyOf = Forms![foreclosure database screen]![Propertycounty]
Else
CountyOf = "the County of " & Forms![foreclosure database screen]![Propertycounty]
End If
End If

End Function


Public Function trusteeadd() As String
Dim Jurisdiction As String

If IsNull(Forms![foreclosure database screen]![BankruptcySubForm].Form![Jurisdiction]) Then
Jurisdiction = ""
MsgBox ("No BK Jurisdiction selected. exiting...")
Exit Function

Else
Jurisdiction = Forms![foreclosure database screen]![BankruptcySubForm].Form![Jurisdiction]
End If

If IsNull(Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename]) Then

If Jurisdiction Like "Alex*" Then
trusteeadd = "201 N. Union Street, Suite 240"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteeadd = "P.O. Box 1001"
ElseIf Jurisdiction Like "Roan*" Then
trusteeadd = "P.O. Box 1001"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
trusteeadd = "P.O. Drawer 1455"
ElseIf Jurisdiction Like "Rich*" Then
trusteeadd = "P.O. Box 1780"
ElseIf Jurisdiction Like "Harris*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Charlot*" Then
trusteeadd = "Lewis & Clark Square, 250 West Main St., #102"
ElseIf Jurisdiction = "D.C." Then
trusteeadd = "4545 42nd St., N.W."
ElseIf Jurisdiction Like "Abing*" Then
trusteeadd = "52 Piedmont St."
ElseIf Jurisdiction Like "Greenb*" Then
trusteeadd = "P.O. Box 958"
ElseIf Jurisdiction Like "Balti*" Then
trusteeadd = "P.O. Box 20016"
End If

Else
trusteeadd = Forms![foreclosure database screen]![BankruptcySubForm].Form![trustee_add]
End If


End Function
Public Function trusteecsz() As String
Dim Jurisdiction As String

Jurisdiction = Forms![foreclosure database screen]![BankruptcySubForm].Form![Jurisdiction]
If IsNull(Forms![foreclosure database screen]![BankruptcySubForm].Form![trusteename]) Then
If Jurisdiction Like "Alex*" Then
trusteecsz = "Alexandria, VA  22314"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteecsz = "Roanoke, VA 24005"
ElseIf Jurisdiction Like "Roan*" Then
trusteecsz = "Roanoke, VA  24005"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
trusteecsz = "Portsmouth, VA  23705"
ElseIf Jurisdiction Like "Rich*" Then
trusteecsz = "Richmond, VA  23218-1780"
ElseIf Jurisdiction Like "Harris*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Charlot*" Then
trusteecsz = "Charlottesville, VA  22902"
ElseIf Jurisdiction = "D.C." Then
trusteecsz = "Washington, D.C.  20016"
ElseIf Jurisdiction Like "Abing*" Then
trusteecsz = "Bristol, VA  24201"
ElseIf Jurisdiction Like "Greenb*" Then
trusteecsz = "Bowie, MD  20718"
ElseIf Jurisdiction Like "Balti*" Then
trusteecsz = "Baltimore, MD  21284"
End If
Else
trusteecsz = Forms![foreclosure database screen]![BankruptcySubForm].Form![trustee_citystatezip]
End If

End Function

Public Function AffidavitDebt()

Dim Figures As String

Figures = MsgBox("Do you have figures to input for Statement of Debt?", vbYesNo)

If Figures = vbYes Then

Call AffDebtScreen

Else

Call AffDebtSelection

End If

End Function

Public Function fairdebtamt() As String
    
Dim amountowed As String
amountowed = InputBox("Amount Owed as of Fairdebt Letter Date")
fairdebtamt = amountowed

End Function
Function sMaximizeForm()
    DoCmd.Maximize
End Function

Function sRestore_Form()

  DoCmd.Restore
  
End Function

Function TrashCase()
On Error GoTo Err_TrashCase


    DoCmd.DoMenuItem A_FORMBAR, A_EDITMENU, A_SELECTRECORD_V2, , A_MENU_VER20
    DoCmd.DoMenuItem A_FORMBAR, A_EDITMENU, A_DELETE_V2, , A_MENU_VER20
    DoCmd.Close
    'SendKeys "{ENTER}", True

    Dim DocName As String
    Dim linkcriteria As String

    DocName = "Foreclosure Database Screen"
    DoCmd.OpenForm DocName, , , linkcriteria
    'Forms![mainform].Visible = False
    

Exit_TrashCase:
    Exit Function

Err_TrashCase:
    MsgBox Error$
    Resume Exit_TrashCase

End Function

Function SeniorLienTrustee()
Dim rs As RecordSet
Dim strsql As String

strsql = "Select * from brtrustees where trustee_name = " & """" & [Forms]![foreclosure database screen]![Senior Lien SaleSubForm].Form!lender_att & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
MsgBox ("No Trustee Input for this File")
SeniorLienTrustee = ""
Else
SeniorLienTrustee = rs!trustee_name
End If
rs.Close


End Function


Public Function OpenCanLtr()
Dim rs As RecordSet
    Dim strsql As String
    strsql = "select * from PR where filenum = " & Forms![foreclosure database screen]!filenum
    Set rs = CurrentDb.OpenRecordset(strsql)
    If rs.EOF Then
    Set rs = CurrentDb.OpenRecordset("PR", dbOpenDynaset, dbSeeChanges)
    With rs
    .AddNew
    !filenum = Forms![foreclosure database screen]!filenum
    .Update
    .Close
    End With
    End If
    
    DoCmd.OpenForm "CancellationLtr"
    
End Function
Public Function OpenPRLtrClient()
Dim rs As RecordSet
    Dim strsql As String
    strsql = "select * from PR where filenum = " & Forms![foreclosure database screen]!filenum
    Set rs = CurrentDb.OpenRecordset(strsql)
    If rs.EOF Then
    Set rs = CurrentDb.OpenRecordset("PR", dbOpenDynaset, dbSeeChanges)
    With rs
    .AddNew
    !filenum = Forms![foreclosure database screen]!filenum
    .Update
    .Close
    End With
    End If
    
    DoCmd.OpenForm "P/RClient"
    
End Function


Public Function PROpenForm()




Dim rs As RecordSet
    Dim strsql As String
    strsql = "select * from PR where filenum = " & Forms![foreclosure database screen]!filenum
    Set rs = CurrentDb.OpenRecordset(strsql)
    If rs.EOF Then
    Set rs = CurrentDb.OpenRecordset("PR", dbOpenDynaset, dbSeeChanges)
    With rs
    .AddNew
    !filenum = Forms![foreclosure database screen]!filenum
    .Update
    .Close
    End With
    End If
    
    If Client() Like "Nationsta*" Then
    Dim VSl As Integer
    VSl = InputBox(Client() & vbCr & " PO/RI Letter" & vbCr & vbCr & "1. Payoff" & vbCr & "2. Reinstatement")
    End If
    
   If ChaseFile() = 1 Or Client() Like "Citi*" Or Client() Like "BankUn*" Or VSl = 2 Or Client() Like "PNC*" Or Client() Like "Everbank*" Or Client() Like "Select Port*" Then
    
    DoCmd.OpenForm "P/R-Chase"
    Else
    DoCmd.OpenForm "P/R"
    End If
    
End Function

Public Function OpenSRLtr()
Dim rs As RecordSet
    Dim strsql As String
    strsql = "select * from PR where filenum = " & Forms![foreclosure database screen]!filenum
    Set rs = CurrentDb.OpenRecordset(strsql)
    If rs.EOF Then
    Set rs = CurrentDb.OpenRecordset("PR", dbOpenDynaset, dbSeeChanges)
    With rs
    .AddNew
    !filenum = Forms![foreclosure database screen]!filenum
    .Update
    .Close
    End With
    End If
    
       DoCmd.OpenForm "Sales Results Ltr"
 
End Function


    Function CaseNo()

    Dim linkcriteria As String
    Dim findcase As String
           
    DoCmd.OpenForm "caseno PS"
    
    If Forms![CaseNo PS]![filenum] > 0 Then
    findcase = Forms![CaseNo PS]![filenum]
    DoCmd.Close acForm, "Foreclosure Database Screen"
    linkcriteria = "[FileNum] = " & findcase
    DoCmd.OpenForm "Foreclosure Database Screen", , , linkcriteria
    DoCmd.Close acForm, "caseno PS"
    Else
    DoCmd.Close acForm, "caseno PS"
    MsgBox "Case Number Not Found"
    End If
       
      
    End Function

Public Function dowaiver()
Dim runwaiver As String

runwaiver = MsgBox("Does the referral contain a copy of the note?", vbYesNo)
If runwaiver = vbNo Then
DoCmd.OpenReport "PGMotiontoAccept"
End If

End Function

Public Function BondInfoSaleCancelled()

Dim db As DAO.Database
Dim MailList As DAO.RecordSet
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Subjectline As String
Dim BodyFile As String
Dim MyBody As TextStream
Dim MyBodyText As String
Dim strsql, vARDate, VarClient, varborrower, VarLoan As String
Dim SEmail, vtitle, emailsubject, emailmessage, E1, E2, E3, e4, e5, e6, e7, e8, e9, e10 As String
Dim rs As RecordSet
Dim VarParaLegal, strPL  As String
Dim rsPL As RecordSet
Dim varsendemail As String
Dim varEmailPrt
Dim varsending As String
Dim vNot As String
Dim resumes_bond_number As String
Dim resumes_saledate As String
Dim resumes_sale_cancelled As String
Dim resumes_sale_cancelreason As String
 
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled) = False Then

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason) Then
varreason = InputBox("Reason for Cancellation")
Else
varreason = Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason
End If

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled <> Date Then
vNot = "The sale cancelled date input is NOT for " & Date & ".  This file will not be on the Cooper Kills spreadsheet sent in the automatic emails tomorrow a.m."
End If

varsending = MsgBox("Sending Email to VShinsky@lexingtonnational.com, Send?", vbYesNo)

If varsending = vbNo Then Exit Function
If Forms![foreclosure database screen]!PostsaleSubForm.Form!BondNumber > 0 Then



If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then MsgBox ("No Sale Date in sale date field!")
vFldEmail = "VShinsky@lexingtonnational.com"
emailsubject = "RE: SALE CANCELLATION FOR BOND # " & Forms![foreclosure database screen]!PostsaleSubForm.Form!BondNumber
    E2 = "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & "SALE DATE/TIME: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleTime & vbCr
    E3 = "PROPERTY ADDRESS: " & Forms![foreclosure database screen]![PropAddress] & IIf(IsNull(Forms![foreclosure database screen]![propaddress2]), "", ", " & Forms![foreclosure database screen]![propaddress2]) & _
        IIf(IsNull(Forms![foreclosure database screen]![unit_no]), "", ", " & Forms![foreclosure database screen]![unit_no]) & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip] & vbCr
    e4 = "COUNTY: " & Forms![foreclosure database screen]!Propertycounty & vbCr & "BOND #: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!BondNumber & vbCr & "BOND DATE: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!bond_sent & vbCr
    e5 = "CIRCUIT COURT CASE #: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo & vbCr
    e6 = "BORROWER LAST NAME: " & Forms![foreclosure database screen]![LastNameDebtor1] & vbCr
    e7 = "REASON FOR CANCELLATION: " & varreason
    
    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7

    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
        
MyMail.To = vFldEmail
MyMail.CC = "robert.johnson@bww-law.com;howie.bierman@bww-law.com"
MyMail.Subject = emailsubject
emailmessage = emailmessage & vbCr & vNot
MyMail.body = emailmessage
MyMail.Display

'coding for bond info from prev sales screen
Else

'additional bond information from the resumes table
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate >= #10/21/2014# Then

Set rs = CurrentDb.OpenRecordset("select bond_number,bond_sent,bond_amt, sale_cancelled,saledate, saletime,sale_cancelreason from resumes where filenum = " & Forms![foreclosure database screen]!filenum & " order by bond_sent desc", dbOpenSnapshot)

Do While Not rs.EOF

If rs.Fields("bond_amt").Value > 0 Or _
 rs.Fields("bond_number").Value > 0 Or _
 IsNull(rs.Fields("bond_sent").Value) = False Then
    'go back here
 
 resumes_bond_number = IIf(IsNull(rs.Fields("bond_number").Value), "", rs.Fields("bond_number").Value)
 resumes_saledate = IIf(IsNull(rs.Fields("saledate").Value), "", rs.Fields("saledate").Value)
  resumes_saletime = IIf(IsNull(rs.Fields("saletime").Value), "", rs.Fields("saletime").Value)
 resumes_sale_cancelled = IIf(IsNull(rs.Fields("sale_cancelled").Value), "", rs.Fields("sale_cancelled").Value)
 resumes_sale_cancelreason = IIf(IsNull(rs.Fields("sale_cancelreason").Value), "", rs.Fields("sale_cancelreason").Value)
 
 
 Exit Do
 End If
 rs.MoveNext
Loop

rs.Close
Set rs = Nothing


If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then MsgBox ("No Sale Date in sale date field!")
vFldEmail = "VShinsky@lexingtonnational.com"
emailsubject = "RE: SALE CANCELLATION FOR BOND # " & resumes_bond_number

    E1 = "BWW#: " & Forms![foreclosure database screen]!filenum
    E2 = "SALE DATE/TIME: " & resumes_saledate & vbCr & "/" & resumes_saletime & vbCr
    E3 = "PROPERTY ADDRESS: " & Forms![foreclosure database screen]![PropAddress] & IIf(IsNull(Forms![foreclosure database screen]![propaddress2]), "", ", " & Forms![foreclosure database screen]![propaddress2]) & _
        IIf(IsNull(Forms![foreclosure database screen]![unit_no]), "", ", " & Forms![foreclosure database screen]![unit_no]) & ", " & Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & " " & Forms![foreclosure database screen]![propzip] & vbCr
    e4 = "BOND #: " & resumes_bond_number & vbCr
    e5 = "CIRCUIT COURT CASE #: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo & vbCr
    e6 = "BORROWER LAST NAME: " & Forms![foreclosure database screen]![LastNameDebtor1] & vbCr
    e7 = "REASON FOR CANCELLATION: " & resumes_sale_cancelreason
    
    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7

    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
        
MyMail.To = vFldEmail
MyMail.CC = "robert.johnson@bww-law.com;howie.bierman@bww-law.com"
MyMail.Subject = emailsubject
emailmessage = emailmessage & vbCr & vNot
MyMail.body = emailmessage
MyMail.Display

End If
End If

End If
End If

End Function


Public Function getFieldDataType(recordsource As String, FieldName As String)

Dim rs As RecordSet

On Error GoTo handler


Set rs = CurrentDb.OpenRecordset("select [" & recordsource & "].[" & FieldName & "] from [" & recordsource & "]", dbOpenSnapshot)

Select Case rs.Fields(FieldName).type

Case dbBigInt
    getFieldDataType = "Number/Currency"
Case dbBinary
    getFieldDataType = "Number/Currency"
Case dbBoolean
    getFieldDataType = "Number/Currency"
Case dbByte
    getFieldDataType = "Number/Currency"
Case dbChar
    getFieldDataType = "Text"
Case dbCurrency
    getFieldDataType = "Number/Currency"
Case dbDate
    getFieldDataType = "Date"
Case dbDecimal
    getFieldDataType = "Number/Currency"
Case dbDouble
    getFieldDataType = "Number/Currency"
Case dbFloat
    getFieldDataType = "Number/Currency"
Case dbInteger
    getFieldDataType = "Number/Currency"
Case dbLong
    getFieldDataType = "Number/Currency"
Case dbLongBinary
    getFieldDataType = "Number/Currency"
Case dbMemo
    getFieldDataType = "Text"
Case dbNumeric
    getFieldDataType = "Number/Currency"
Case dbSingle
    getFieldDataType = "Number/Currency"
Case dbText
    getFieldDataType = "Text"
Case dbTime
    getFieldDataType = "Date"
Case dbVarBinary
    getFieldDataType = "Number/Currency"

End Select

rs.Close
Set rs = Nothing

Exit Function

handler:

getFieldDataType = Null

'rs.Close
'Set rs = Nothing

End Function

