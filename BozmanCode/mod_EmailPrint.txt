Attribute VB_Name = "EmailPrint"

Option Compare Database
Option Explicit

Public Function EmailSaleCancelled()


Dim db As DAO.Database
Dim MailList As DAO.RecordSet
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Subjectline As String
Dim BodyFile As String
Dim MyBody As TextStream
Dim MyBodyText As String
Dim strsql, vARDate, VarClient, varborrower, VarLoan As String
Dim SEmail, vtitle, emailsubject, emailmessage, E1, E2, E3, e4, e5, e6, e7, e8, e9, e10 As String
Dim rs As RecordSet
Dim VarParaLegal, strPL  As String
Dim rsPL As RecordSet
Dim varsendemail As String
Dim varEmailPrt
Dim varsending As String
Dim vNot As String
Dim BondSent As Date
Dim varreason, varfax, sig1


'Call EmailWalzInvRequest
Dim isBondInfo As Boolean
isBondInfo = False
'Call EmailWalzInvRequest
    

Set rs = CurrentDb.OpenRecordset("select bond_amt,bond_number,bond_sent,Bond_court from postsale where subfilenum = " & Forms![foreclosure database screen]!filenum, dbOpenSnapshot)

'set isBondInfo = True after 10/21/14

If (rs.Fields("bond_amt").Value > 0 Or _
 rs.Fields("bond_number").Value > 0 Or _
 IsNull(rs.Fields("bond_sent").Value) = False Or _
 IsNull(rs.Fields("Bond_court").Value) = False) And rs.Fields("bond_sent").Value > DateSerial(2014, 10, 21) Then
 
 isBondInfo = True
 
 End If

rs.Close
Set rs = Nothing

'additional bond information from the resumes table

Set rs = CurrentDb.OpenRecordset("select bond_number,bond_sent,bond_amt from resumes where filenum = " & Forms![foreclosure database screen]!filenum & " order by bond_sent desc", dbOpenSnapshot)

Do While Not rs.EOF

If (rs.Fields("bond_amt").Value > 0 Or _
 rs.Fields("bond_number").Value > 0 Or _
 IsNull(rs.Fields("bond_sent").Value) = False) And rs.Fields("bond_sent").Value > DateSerial(2014, 10, 21) Then
    
 
 isBondInfo = True
 
 Exit Do
 End If
 rs.MoveNext
Loop

rs.Close
Set rs = Nothing



If isBondInfo Then
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > _
    Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled Then
    Call BondInfoSaleCancelled
End If
End If



If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason) Then
varreason = InputBox("Reason for Cancellation")
Else
varreason = Forms![foreclosure database screen]!ForeclosureSubForm.Form!salecancel_reason
End If

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!sale_cancelled <> Date Then
vNot = "The sale cancelled date input is NOT for " & Date & ".  This file will not be on the Cooper Kills spreadsheet sent in the automatic emails tomorrow a.m."
End If

Dim VCont
    VCont = ""
    
    
    If Forms![foreclosure database screen]!PropertyState = "MD" And _
    Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact] <> "" Then
    
    VCont = Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_bgw_contact]
    
    strPL = "Select * from employees where EmployeeID = " & """" & VCont & """" & ";"
    Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)
    If Not rsPL.EOF Then
    
    If rsPL!EmailName <> "" Then
    VCont = rsPL!EmailName
    End If
    
    Else
    VCont = ""
    End If
    
    rsPL.Close
    End If



If Forms![foreclosure database screen]![PropertyState] = "MD" Then

  If varreason Like "Paid Off*" Or varreason Like "*Reinst*" Or varreason Like "Pay Of*" Then
    If VCont = "" Then
    VCont = " Dismissals@bww-law.com; Janice.Hill@bww-law.com"
    Else
    VCont = VCont & "; Dismissals@bww-law.com"
    End If
    End If
    
   ' MsgBox (VCont)
    

If Forms![foreclosure database screen]![Propertycounty] = "Allegany" _
Or Forms![foreclosure database screen]![Propertycounty] = "Garrett" Then
varsending = MsgBox("Sending Email to DebHidey@atlanticbbn.net, damyot@atlanticbbn.net; diana@alexcooper.com, Jeberly@atlanticbbn.net and MichaelCohen@atlanticbbn.net, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
varsending = MsgBox("Sending Email to diana@alexcooper.com, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
varsending = MsgBox("Sending Email to dccancellations@alexcooper.com, Send?", vbYesNo)
ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then
varsending = vbNo
End If

    If varsending = vbYes Then
    
    If Forms![foreclosure database screen]!Client Like "Nationst*" Then
    emailsubject = " **INVOICE MUST BE SUBMITTED WITHIN 24 HOURS** " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    Else
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    End If
    
        

        If Forms![foreclosure database screen]![PropertyState] <> "DC" And _
        Forms![foreclosure database screen]![Propertycounty] <> "Allegany" _
        And Forms![foreclosure database screen]![Propertycounty] <> "Garrett" Then
        varfax = "410/828-9348"
        ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
        varfax = "202/364-0325"
        End If

   'Remove this piece
    VarParaLegal = DLookup("employeeid", "employees", "login='" & Environ("username") & "'")
    strPL = "Select * from employees where EmployeeID = " & """" & VarParaLegal & """" & ";"
    Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)
If rsPL.EOF Then
MsgBox "Your username is not found in the system.  Please submit an IT ticket and email awilson@systemadix.com for assistance", vbCritical
Exit Function
End If
        
        If IsNull(rsPL!MiddleName) Then
        sig1 = rsPL!FirstName & " " & rsPL!LastName
        vtitle = rsPL!Title
        Else
        sig1 = rsPL!FirstName & " " & rsPL!MiddleName & " " & rsPL!LastName
        'vtitle = rsPL!Title
        End If
        rsPL.Close
        

    
    E1 = ""
   
    
    E2 = ""
    
    
    E3 = "BWW Case#: " & Forms![foreclosure database screen]![filenum] & "  Client: " & Client() & vbCr & vbCr
    e4 = ""
    e5 = "SALE DATE/TIME: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleTime & vbCr & vbCr
    e6 = "PROPERTY STREET ADDRESS: " & PROP() & vbCr & vbCr & "PROPERTY COUNTY: " & Forms![foreclosure database screen]![Propertycounty] & vbCr & vbCr & "BORROWER NAME: " & debtorsFORE() & vbCr & vbCr
    e7 = "REASON FOR CANCELLATION: " & varreason & vbCr & vbCr
    e8 = "DATE/TIME RECEIVED__________" & vbCr & vbCr & "WITHDRAWAL FEE $_________" & vbCr & vbCr & "AD COST  $_________"
    e9 = ""
    
    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7 + e8 ' + e9

    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
        

    If Date >= #8/4/2014# And Forms![foreclosure database screen]!Client Like "Suntrust*" Or _
    Forms![foreclosure database screen]!Client Like "Bank of Am*" Or _
      Forms![foreclosure database screen]!Client Like "Champion*" Or _
      Forms![foreclosure database screen]!Client Like "Residential*" Or _
      Forms![foreclosure database screen]!Client Like "Ditech*" Or _
    Forms![foreclosure database screen]!Client Like "Wells*" Then
    Dim vFldEmail
    vFldEmail = "SuntrustBills@bww-law.com; "
    Else
    vFldEmail = "MDKills@bww-law.com; "
    End If
    
     
    If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
    MsgBox ("No Sale Date in sale date field!")
    MyMail.To = vFldEmail & "Robert.Johnson@bww-law.com; cancel@trioservices.net; Eddie.Kutz@trioservices.net;" & VCont
    
    If Forms![foreclosure database screen]!Client Like "Nationst*" Then
    MyMail.CC = "Sonya.Moore@bww-law.com; Motylik.Zofajova@bww-law.com"
    ElseIf Forms![foreclosure database screen]!Client Like "Carrington*" Then
    MyMail.CC = "Sonya.Moore@bww-law.com; Motylik.Zofajova@bww-law.com"
    ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then
    MyMail.CC = "billing@bww-law.com; evangeline.tubilla@bww-law.com"

    ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com"
    End If
    
    ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
    MyMail.To = "dccancellations@alexcooper.com; DCKills@bww-law.com; cancelsaleDC@bww-law.com" & VCont
    Call AddBillToBePrep
    ElseIf Forms![foreclosure database screen]![Propertycounty] = "Allegany" _
    Or Forms![foreclosure database screen]![Propertycounty] = "Garrett" Then
    MyMail.To = vFldEmail & "diana@alexcooper.com; bandrews@atlanticbbn.net; DebHidey@atlanticbbn.net; MichaelCohen@atlanticbbn.net; Robert.Johnson@bww-law.com; " & VCont
    emailmessage = emailmessage & vbCr & vNot
    Call AddBillToBePrep
    Else
    MyMail.To = vFldEmail & "diana@alexcooper.com; Robert.Johnson@bww-law.com; " & VCont
    emailmessage = emailmessage ' & vbCr & vNot
    Call AddBillToBePrep
    
   End If
    
    If VCont <> "" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate = Date Then
     If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com; "
    Else
    MyMail.CC = "Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com; "
    End If
    ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate = Date And VCont = "" Then
    If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com"
    Else
    MyMail.CC = "Joshua.Coleman@bww-law.com; Robert.Johnson@bww-law.com"
    End If
    ElseIf VCont <> "" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate <> Date Then
    If Forms![foreclosure database screen]!Client Like "Wells*" Then
    MyMail.CC = "directsource@bww-law.com; "
    End If
    End If
    
    MyMail.Subject = "Kill and Bill - " + emailsubject
    emailmessage = emailmessage & SEmail
    emailmessage = Replace(Replace(emailmessage, vbCrLf, "<br>"), vbCr, "<br>")
    emailmessage = "<body style=font-size:10.5pt>" & emailmessage & "</body>"
    MyMail.HTMLBody = emailmessage
    MyMail.Display
    
   Else
   Exit Function
   
End If
End If

If Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then
DoCmd.OpenReport "Cooper-Cancel-AttachmentMD", acViewPreview
End If

If Forms![foreclosure database screen]![Propertycounty] = "Somerset" _
Or Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then

If Forms![foreclosure database screen]![Propertycounty] = "Somerset" Then
varsendemail = MsgBox("Sending Email to dwslaw@comcast.net, Continue?", vbYesNo)
End If

If Forms![foreclosure database screen]![Propertycounty] = "Dorchester" _
Or Forms![foreclosure database screen]![Propertycounty] = "Wicomico" _
Or Forms![foreclosure database screen]![Propertycounty] = "Worcester" Then

varsendemail = MsgBox("Sending Email to Swlaw@comcast.net, Continue?", vbYesNo)
End If

    If varsendemail = vbYes Then
    
    If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " /" & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    ElseIf Forms![foreclosure database screen]!Client Like "Nationsta*" Then
    emailsubject = " **INVOICE MUST BE SUBMITTED WITHIN 24 HOURS** " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    Else
    emailsubject = Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / KILL " & Forms![foreclosure database screen]![LastNameDebtor1] & " / " & Forms![foreclosure database screen]!Client & " / " & Forms![foreclosure database screen]![PropAddress] & "/Reason Cancelled: " & varreason
    End If
    
    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
    If Forms![foreclosure database screen]![Propertycounty] = "Somerset" Then
    MyMail.To = "dwslaw@comcast.net; Robert.Johnson@bww-law.com; " & VCont
    Else
    MyMail.To = "Swlaw@comcast.net; dwslaw@comcast.net; Robert.Johnson@bww-law.com; " & VCont
    End If
    
    MyMail.Subject = emailsubject
    Dim vtrustee As String
    
    If IsNull([Forms]![foreclosure database screen]![jurTrustee]) Then
    vtrustee = ""
    Else
    
    vtrustee = [Forms]![foreclosure database screen]![jurTrustee]
    If [Forms]![foreclosure database screen]![jurtrustee2] <> "" Then
    vtrustee = vtrustee & " and " & [Forms]![foreclosure database screen]![jurtrustee2]
    End If
    End If
    
    
    E1 = "BWW Law Group, LLC" & vbCr & "(301) 961-6555" & vbCr & "TRUSTEE CANCELLATION FORM" & vbCr
    E2 = "Fax: " & varfax & vbCr & vbCr
    E3 = "BWW Case#: " & Forms![foreclosure database screen]![filenum] & "  Client: " & Client() & vbCr & vbCr
    e4 = ""
    e5 = "SALE DATE/TIME: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & " / " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleTime & vbCr & vbCr
    e6 = "PROPERTY STREET ADDRESS: " & PROP() & vbCr & vbCr & "PROPERTY COUNTY: " & Forms![foreclosure database screen]![Propertycounty] & vbCr & vbCr & "BORROWER NAME: " & debtorsFORE() & vbCr & vbCr
    e7 = "REASON FOR CANCELLATION: " & varreason & vbCr & vbCr
    e8 = vtrustee & vbCr & vbCr & "DATE/TIME RECEIVED__________" & vbCr & vbCr & "WITHDRAWAL FEE $_________" & vbCr & vbCr
    e9 = "(Please note: We will fax a confirmation back to you within 45 minutes; if you do not receive this back within that time period, please call us.)"

    emailmessage = E1 + E2 + E3 + e4 + e5 + e6 + e7 + e8 + e9
    
    emailmessage = emailmessage & SEmail
    emailmessage = Replace(Replace(emailmessage, vbCrLf, "<br>"), vbCr, "<br>")
    emailmessage = "<body style=font-size:10.5pt>" & emailmessage & "</body>"
    
    MyMail.Display
    Else
    Exit Function
    End If

Set MyMail = Nothing
Set MyOutlook = Nothing
End If


End Function

Public Function BaltCityTaxSaleRedemptionReq()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim filenum As Double

filenum = Forms![foreclosure database screen]!filenum

Set MyOutlook = New Outlook.Application


emailsubject = "Baltimore City Tax Sale Redemption request for BWW#: " & filenum

emailbody = "Good afternoon," & vbCrLf & vbCrLf
emailbody = emailbody & "I am writing to request redemption figures for the property located at "
emailbody = emailbody & propadd & " " & propadd2 & "."
emailbody = emailbody & " If there are any potential legal fees involved, could you also provide for me either the amount or contact information for the attorney?"
emailbody = emailbody & vbCrLf & vbCrLf
emailbody = emailbody & "We are attempting to record the foreclosure deed and have learned that the property is in tax sale." & vbCrLf & vbCrLf
emailbody = emailbody & "Thank you in advance."


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = ""
MyMail.Subject = emailsubject

MyMail.body = emailbody + SigEmail()

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function SuntrustBillMdSetSale()

If Forms![MDSetSales]!Client Like "Suntrust*" Or _
Forms![MDSetSales]!Client Like "Citi*" Then
Dim emailmessage As String

emailmessage = "BWW#: " & Forms![MDSetSales]!filenum & vbCr & _
"Loan#: " & Forms![MDSetSales]!ClientRefNumber & vbCr & _
"Borrower(s)" & Forms!MDSetSales!LastNameDebtor1 & vbCr & _
"Property: " & Forms!MDSetSales!PropAddress & vbCr & _
"State: " & Forms![MDSetSales]!PropertyState & vbCr & _
VFieldNameDate
 
    
Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "*** " & Forms![MDSetSales]!Client & " for BWW# " & Forms![MDSetSales]!filenum & " (" & Forms![MDSetSales]!PropertyState & ")"
MyMail.To = "SuntrustBills@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
   
End If
    
End Function

Public Function CitiBill()

If Forms![foreclosure database screen]!Client Like "Citi*" Then
Dim emailmessage As String

emailmessage = "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower(s)" & debtorsFORE() & vbCr & _
"Property: " & PROP() & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
VFieldNameDate
 
    
Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "*** SUNTRUST BILL for BWW# " & Forms![foreclosure database screen]!filenum & " (" & Forms![foreclosure database screen]!PropertyState & ")"
MyMail.To = "CitiBills@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
   
End If
    
End Function

Public Function SuntrustBill()

If Forms![foreclosure database screen]!Client Like "Suntrust*" Or _
Forms![foreclosure database screen]!Client Like "Citi*" Then
Dim emailmessage As String

emailmessage = "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower(s)" & debtorsFORE() & vbCr & _
"Property: " & PROP() & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
VFieldNameDate
 
Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = "*** " & Forms![foreclosure database screen]!Client & " BILL for BWW# " & Forms![foreclosure database screen]!filenum & " (" & Forms![foreclosure database screen]!PropertyState & ")"
MyMail.To = "SuntrustBills@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
   
End If
    
End Function

Public Function OcwenInfoEmail()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, body As String
Dim FrmName As String
Dim rs As RecordSet
Dim strsql As String




Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


emailsubject = "BWW#: " & Forms![foreclosure database screen]!filenum & "/ Borrower(s): " & debtorsFORE()

body = "Client: " & Client() & vbCr & "LOAN#: " & Forms![foreclosure database screen]![ClientRefNumber] & vbCrLf
body = body & vbCrLf
body = body & "Hello," & vbCrLf
body = body & vbCrLf
body = body & "Please provide the following information as soon as possible in order to move this file to the next foreclosure milestone:" & vbCrLf
body = body & vbCrLf
body = body & "        ·        Please confirm the occupancy status.  If occupied, please verify if by owner, tenant or unknown." & vbCrLf
body = body & vbCrLf
body = body & "        ·        Please provide a payment history which confirms the date of last payment made by the borrower and the period to which it was applied." & vbCrLf
body = body & vbCrLf
body = body & "        ·        Are there any deferred principal balances on the loan?" & vbCrLf
body = body & "        ·        Are there any shared waive adjustments on the loan?" & vbCrLf
body = body & vbCrLf
body = body & "**Please respond to all addresses included on this email when responding with the requested information**" & vbCrLf
body = body & "Thank you!" & vbCrLf
body = body & SigEmail()

MyMail.Subject = emailsubject
'MyMail.Body = "Client: " & Client() & vbCr & "LOAN#: " & Forms![foreclosure database screen]![ClientRefNumber] & SigEmail()
MyMail.body = body

MyMail.CC = "OcwenInfoRequest@bww-law.com"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function


Public Function OcwenNMSDCSetSale()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow
Dim VProp

VProp = Forms!dcsetsales!PropAddress & ", " & Forms!dcsetsales!csz


'OcwenNMSCertification

emailmessage = "Loan#: " & Forms![dcsetsales]!ClientRefNumber & vbCr & "Borrowers: " & Forms![dcsetsales]!LastNameDebtor1 & vbCr & "Property Address: " & _
VProp & vbCr & "Jurisdiction: District of Columbia" & vbCr & vbCr & _
"Prior to our firm proceeding with the scheduling of the foreclosure sale, please confirm that Loan #: " & Forms![dcsetsales]!ClientRefNumber & _
" having a property address of " & VProp & " is not currently in consideration for loss mitigation or foreclosure alternatives.  " _
& " If the loan cannot be located than we are accepting this as authority to proceed as the loan doesn’t appear to qualify to require approval to seek a sale date under the new NMS directive." & vbCr & vbCr & SigEmail()


Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "*** URGENT - RESPONSE REQUIRED ***"
MyMail.To = "NMSCertificationMailbox@ocwen.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing



End Function


Public Function OcwenNMSMdSetSale()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow
Dim VProp

VProp = Forms!MDSetSales!PropAddress & ", " & Forms!MDSetSales!csz


'OcwenNMSCertification

emailmessage = "Loan#: " & Forms![MDSetSales]!ClientRefNumber & vbCr & "Borrowers: " & Forms![MDSetSales]!LastNameDebtor1 & vbCr & "Property Address: " & _
VProp & vbCr & "Jurisdiction: " & Forms![MDSetSales]!Propertycounty & vbCr & vbCr & _
"Prior to our firm proceeding with the scheduling of the foreclosure sale, please confirm that Loan #: " & Forms![MDSetSales]!ClientRefNumber & _
" having a property address of " & VProp & " is not currently in consideration for loss mitigation or foreclosure alternatives.  " _
& " If the loan cannot be located than we are accepting this as authority to proceed as the loan doesn’t appear to qualify to require approval to seek a sale date under the new NMS directive." & vbCr & vbCr & SigEmail()


Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "*** URGENT - RESPONSE REQUIRED ***"
MyMail.To = "NMSCertificationMailbox@ocwen.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing



End Function

Public Function OcwenNMS()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow


'OcwenNMSCertification

emailmessage = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Borrowers: " & debtorsFORE() & vbCr & "Property Address: " & _
PROP() & vbCr & "Jurisdiction: " & Forms![foreclosure database screen]!Propertycounty & vbCr & vbCr & _
"Prior to our firm proceeding with the scheduling of the foreclosure sale, please confirm that Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & _
" having a property address of " & PROP() & " is not currently in consideration for loss mitigation or foreclosure alternatives.  " _
& " If the loan cannot be located than we are accepting this as authority to proceed as the loan doesn’t appear to qualify to require approval to seek a sale date under the new NMS directive." & vbCr & vbCr & SigEmail()


Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "*** URGENT - RESPONSE REQUIRED ***"
MyMail.To = "NMSCertificationMailbox@ocwen.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing



End Function
Public Function ProvideAdCosts()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow



emailmessage = "Borrowers: " & debtorsFORE() & vbCr & "Property Address: " & PROP() & vbCr & "Jurisdiction: " & Forms![foreclosure database screen]!Propertycounty & vbCr & "1st Pub: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad] & vbCr & _
"Foreclosure sale date scheduled for: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & vbCr & SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Full Ad Costs.  Sale Set for: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
MyMail.To = "DMorgan@AlexCooper.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing



End Function
Public Function DisregardTitle()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow



emailmessage = "Borrowers: " & debtorsFORE() & vbCr & "Property Address: " & PROP() & vbCr & "Jurisdiction: " & Forms![foreclosure database screen]!Propertycounty & vbCr & "DOT Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![DOTDate] & vbCr & _
"Original Amount: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgamt & vbCr & "Original Amount: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgamt & vbCr & _
"Beneficiary: " & Forms![foreclosure database screen]!longsecured & vbCr & "Liber/Folio: " & liberfolio() & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & vbCr & SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Please disregard Title Order.  Property: " & PROP()
'MyMail.To = "DMorgan@AlexCooper.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function
Public Function EmailHB1373()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow



emailmessage = "Please provide a recording update on the attached trustee's deed.  We are trying to register the property with the State of Maryland pursuant to HB 1373 requirements." & vbCr & vbCr & SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Property Address: " & PROP() & " / BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing






End Function

Public Function EmailReturnDocs()

Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow



emailmessage = "Property Address: " & PROP() & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & vbCr + "Please return the original loan documents for the above listed file.  The file has been closed." & vbCr & vbCr & SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Returns@bww-law.com"
MyMail.Subject = Client() & " RETURN: " & Forms![foreclosure database screen]!LastNameDebtor1 & ", " & Forms![foreclosure database screen]!FirstNameDebtor1 & ", Loan#: " & Forms![foreclosure database screen]!ClientRefNumber
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing






End Function

Public Function EmailAdvisement()
'replace this function EmailAdvisement
Dim emailsubject As String
Dim emailmessage As String
Dim VPF As String
Dim strsqlfc As String
Dim rsFC As RecordSet
Dim VDOcketServed
Dim vFirstAllow

strsqlfc = "select * from fctracking where filenum = " & GblFilenum
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)

If IsNull(DLookup("service_complete", "foreclosure", "[subfilenum]=" & GblFilenum)) Then
VDOcketServed = "_________________"
vFirstAllow = ""
Else
VDOcketServed = DLookup("service_complete", "foreclosure", "[subfilenum]=" & GblFilenum)
vFirstAllow = " (" & VDOcketServed + 28 & ")"

End If


VPF = InputBox("(P)relim LMA or (F)inal LMA")
If VPF = "p" Then
emailmessage = "Loan#: " & DLookup("ClientRefNumber", "cases", "[filenum]=" & GblFilenum) & vbCr & vbCr & _
"BWW#: " & GblFilenum & vbCr & vbCr & _
"Please be advised that 1st legal was obtained by using the PRELIMINARY LOSS MIT AFF and same was filed on " & _
rsFC!pre_docket_filed & "; service was completed on " & VDOcketServed & _
".  Please note that we cannot proceed with FC for 28 days after service per MD HB 472" & vFirstAllow & _
".  After the 29 days has passed from service, the FLMA will be sent for execution as a sale date cannot be scheduled until this has been recd and filed."
Else

emailmessage = "Loan#: " & DLookup("ClientRefNumber", "cases", "[filenum]=" & GblFilenum) & vbCr & vbCr & _
"BWW#: " & GblFilenum & vbCr & vbCr & _
"Please be advised that 1st legal was obtained by using the FINAL LOSS MIT AFF and same was filed on " & rsFC!final_docket_filed & _
"; service was completed on " & VDOcketServed & ".  Please note that we cannot proceed with FC for 28 days after service per MD HB 472" & _
vFirstAllow & ".  After the 29 days has passed from service, we will be able to schedule the pub and FC sale dates."
End If

rsFC.Close

emailmessage = emailmessage + SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "ADVISEMENT OF 1st LEGAL"
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing






End Function
Function SendEmail(strRecipients As String, strCCRecipients As String, strSUBJECT As String, strBODY As String, strAttachment1 As String, strAttachment2 As String, strattachment3 As String, strattachment4 As String) As Boolean

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.To = strRecipients
MyMail.CC = strCCRecipients
MyMail.Subject = strSUBJECT
MyMail.body = strBODY

If Not IsNull(strAttachment1) And strAttachment1 <> "" Then
MyMail.Attachments.ADD strAttachment1
End If
If Not IsNull(strAttachment2) And strAttachment2 <> "" Then
MyMail.Attachments.ADD strAttachment2
End If
If Not IsNull(strattachment3) And strattachment3 <> "" Then
MyMail.Attachments.ADD strattachment3
End If
If Not IsNull(strattachment4) And strattachment4 <> "" Then
MyMail.Attachments.ADD strattachment4
End If
     
MyMail.Display
strRecipients = ""
strCCRecipients = ""
strSUBJECT = ""
strBODY = ""
strAttachment1 = ""
strAttachment2 = ""
strattachment3 = ""
strattachment4 = ""

Set MyMail = Nothing
Set MyOutlook = Nothing

End Function

Function EmailTemplate()
GSubject = ""
gBody = ""
gRecipients = ""
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function
Public Function EmailLienCert()

Dim emailsubject As String
Dim emailmessage As String
Dim varsendemail, varappend As String
Dim MyMail As Outlook.MailItem
Dim MyOutlook As Outlook.Application

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)



emailmessage = "Property: " & PROP() & vbCr & "County: " & Forms![foreclosure database screen]![Propertycounty] & vbCr & vbCr & "Please order a lien certificate on the above referenced property."
emailmessage = emailmessage + SigEmail()

MyMail.To = "Karlene.Bryan@bww-law.com"
MyMail.Subject = "Lien Cert Order Reminder: BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function

Public Function EmailDismiss()

Dim VSel
Dim VSel2

VSel = InputBox("Enter Case Number:")
VSel2 = InputBox("Dismissal Due to:")

gRecipients = ""
gCCRecipients = ""
GSubject = "BWW#: " & Forms![foreclosure database screen]!filenum & ": " & debtorsFORE()
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

gBody = "Please dismiss case#: " & VSel & " on Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & " due to " & VSel2 & _
vbCr & vbCr & "We received the following message: " & vbCr & _
"Loan Number: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower's Name: " & debtorsFORE() & vbCr & _
"Property Address: " & PROP() & vbCr & _
vbCr & "Please note that this loan has/is " & VSel2 & vbCr & _
"We request that your office cancel the sale and close out your file.  Please submit a final invoice for processing.  Thank you." & vbCr & _
vbCr & "Sale Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & "." & vbCr & _
"This is a Beneficiary Request."

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

If Forms![foreclosure database screen]!PropertyState = "MD" Then
GSubject = Client() & " - " & debtorsFORE() & " - " & Forms![foreclosure database screen]!PropertyState & " - BWW#: " & Forms![foreclosure database screen]!filenum

gBody = "Loan Number: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower's Name: " & debtorsFORE() & vbCr & _
"Property Address: " & PROP() & vbCr & _
"Please return original documents at your earliest convenience.  Loan has been " & VSel2 & " and we are in the process of dismissing our case." & vbCr & vbCr & "Thank you!"

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End If


'LITIGATION Mediation Tab CODE
Dim strql As String
Dim rs As RecordSet

strsql = "Select * from fctracking where filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)


If IsNull(rs![Med_Concluded]) And _
Not IsNull(rs![med_req]) Then

GSubject = "BWW#: " & Forms![foreclosure database screen]!filenum & "/ FC Docket Dismissed for this file"
gBody = ""
gRecipients = "Nicolas.Treviso@bww-law.com;Lauren.Sponaugle@bww-law.com"
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End If
rs.Close



End Function

Public Function EmailADU()


gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

GSubject = "ADU for BWW#: " & Forms![titleform]!filenum
gBody = "The Title Examiner has determined that an ADU exists on the property located at " & Forms!titleform![Property Address] & "." & vbCr & vbCr & "Please review title to determine that we are complying with all notice provisions."
gRecipients = "Sean.Nelson@bww-law.com; John.Lenoir@bww-law.com; Robert.Michael@bww-law.com"
gCCRecipients = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function
Public Function FNMABilling()
DoCmd.OpenQuery ("TEMPPSdelete")
DoCmd.OpenQuery ("Missing RatDeedRecALL")
ExcelSaveAsQRY ("FNMABillingQuery")
End Function
Public Function CertDOTReRecord()

gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


gBody = "Please provide us with a certified copy of the Deed of Trust so that we can re-record to include the legal description.  Thanks." & vbCr & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & _
 "Client: " & Forms![foreclosure database screen]!Client & vbCr & _
 "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
 "Property: " & PROP() & vbCr & _
 "Jurisdiction: " & County() & vbCr & _
 "Deed of Trust Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate & vbCr & _
 "Original Loan Amount: " & Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![orgamt], "$###,##0.00") & vbCr & _
 "Liber/Folio: " & liberfolio()

gBody = gBody + SigEmail()

gRecipients = "MDOrders@compassresearchgroup.com"
GSubject = "Cert DOT to Re-Record Legal"

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function
Public Function EmailSaleTime()
 
gBody = "Borrower(s): " & debtorsFORE() & vbCr & _
 "Property: " & PROP() & vbCr & _
 "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
 "Jurisdiction: " & County() & vbCr & _
 "Deed of Truste Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate & vbCr & _
 "Original Loan Amount: " & Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![orgamt], "$###,##0.00") & vbCr & _
 "Beneficiary: " & LSecured() & vbCr & _
 "Liber/Folio: " & liberfolio()

gBody = gBody + SigEmail()


gRecipients = "dmorgan@alexcooper.com; rebecca.delaney@bww-law.com; Reese.Lesko@bww-law.com"
gCCRecipients = ""
GSubject = "Sale Time Needed: Sale Date: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function
Public Function EmailServiceRelease()
Dim VSRto
VSRto = InputBox("Service File Released from " & Forms![foreclosure database screen]!Client & " TO: ")

gBody = "Our office has just been advised that this file has been service released from " & Client() & " to " & VSRto & " and we have closed our file.  Can you please confirm if we are to proceed with the FC process on your behalf and if so, please provide your loan number ASAP so we can update our system to reflect same so we can process the file on your behalf.  Thanks you very much." & _
vbCr & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & _
 "Property: " & PROP() & vbCr & _
 "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
 "Jurisdiction: " & County() & vbCr & _
 "Deed of Truste Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate & vbCr & _
 "Original Loan Amount: " & Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![orgamt], "$###,##0.00") & vbCr & _
 "Beneficiary: " & LSecured() & vbCr & _
 "Liber/Folio: " & liberfolio()

gBody = gBody + SigEmail()


gRecipients = ""
gCCRecipients = ""
GSubject = "Service Release file from " & Forms![foreclosure database screen]!Client & " To " & VSRto
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function

Public Function EmailLoanMod()

Dim emailsubject As String
Dim emailmessage As String
Dim VOrgAmt
Dim VOrgPB


VOrgAmt = Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![orgamt], "$###,##0.00")
VOrgPB = Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![Principal Balance], "$###,##0.00")

emailmessage = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & _
"Could you please verify if this loan has a Loan Modification Agreement because the Original Principal Balance of the" _
& " mortgage is for " & VOrgAmt & " and the Unpaid Principal Balance due is now " & VOrgPB & " that you are asking us to" _
& " foreclose on; or is the unpaid balance due to miscellaneous charges which have surpassed the original principal balance?  " _
& " If there is a Loan Modification Agreement, could you please forward us a copy of same, so that we may docket the case" _
& " and meet your timelines?  Thanks for your help… Status: Active"

emailmessage = emailmessage + SigEmail()

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Loan Modification: " & debtorsFORE()
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End Function


Public Function EmailHOCRestart()

Dim emailsubject As String
Dim emailmessage As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailmessage = "BWW#: " & [Forms]![foreclosure database screen]![filenum] & vbCr & _
"Lender: " & Forms![foreclosure database screen]!Client & vbCr & _
"Borrower: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & vbCr & _
"Please issue the HUD Occ Letter on the above referenced file ASAP so we can schedule the Foreclosure Sale Date."

MyMail.To = "MD-DocketDept@bww-law.com; rebecca.delaney@bww-law.com"
MyMail.Subject = "Please issue the HUD Occ Letter for BWW#: " & [Forms]![foreclosure database screen]![filenum]
MyMail.body = emailmessage + SigEmail()
MyMail.Display

Set MyMail = Nothing
End Function
Public Function EmailFHAVATclaim()
'TitleDistribution_VA@bww-law.com
Dim emailsubject As String
Dim emailmessage As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailsubject = "Foreclosure Restart. Title Claim Sent for Loan Type: " & [Forms]![foreclosure database screen]![TypeOfLoan] & "/BWW#: " & Forms![foreclosure database screen]!filenum
emailmessage = ""

MyMail.To = "TitleDistribution_VA@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailmessage + SigEmail()
MyMail.Display

Set MyMail = Nothing

End Function
Public Function EmailFHLMC()

Dim emailsubject As String
Dim emailmessage As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailsubject = "Foreclosure Restart Requests for FHLMC#: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![loantype].[Form]![HUD/VA Num] & "/BWW Ref#: " & Forms![foreclosure database screen]!filenum
emailmessage = "Foreclosure Restart Requests:" & vbCr & vbCr & "Freddie Mac#: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![loantype].[Form]![HUD/VA Num] & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
"Sale/Redemption/Ratification Date:" & vbCr & _
"Number of Restarts: " & vbCr & _
"Dollar amount of restart fees: $" & vbCr & _
"Restart Dates: " & vbCr & _
"Reason for each of the restart(s):" & vbCr

MyMail.To = "overallowables@freddiemac.com"""
MyMail.Subject = emailsubject
MyMail.body = emailmessage + SigEmail()
MyMail.Display

Set MyMail = Nothing
End Function

Public Function EmailIRSResume()
Dim emailsubject As String
Dim emailmessage As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailsubject = "BWW#: " & Forms![foreclosure database screen]!filenum & ": IRS Notice needs to be sent on this file"
emailmessage = "Borrower(s): " & debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & "Sale Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
MyMail.To = "reese.lesko@bww-law.com; James.Bynum@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing
End Function

Public Function EmailFNMA()
Dim emailsubject As String
Dim emailmessage As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailsubject = "FNMA File for BWW#: " & Forms![foreclosure database screen]!filenum & "/" & Forms![foreclosure database screen]!FirstNameDebtor1 & " " & Forms![foreclosure database screen]!LastNameDebtor1
emailmessage = "Listed below is a " & Forms![foreclosure database screen]!TypeOfLoan & " File that needs fee approval" & vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Client: " & Forms![foreclosure database screen]!Client & vbCr & "FNMA#: " & Forms![foreclosure database screen]![HUD/VA Num] & vbCr & "Resumed: " & Forms![foreclosure database screen]![resume_recd] & vbCr & "County: " & County()
If Forms![foreclosure database screen]!PropertyState = "MD" Then
MyMail.To = "Abigail.Sawyerr@bww-law.com"
Else
MyMail.To = ""
End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing
End Function
Public Function EmailPreviewEvictionPos()
Dim Vselect

Vselect = InputBox("1. Preview Letter" & vbCr & "2. Email")
If Vselect = 1 Then

DoCmd.OpenReport "CoverLtrLockOutVirginia", acViewPreview
Else
Call EmailEvictionPos
End If



End Function
Public Function emaildocs()
Dim prtdocs As String

Dim DocName As String
Dim doemail As String
Dim DoMacro As String

If Forms![foreclosure database screen]!PropertyState = "MD" Then
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!docket_ltrsent) Then
Dim VLtrSent As String
VLtrSent = MsgBox("Was the Docket Letter Sent?", vbYesNo)
If VLtrSent = vbYes Then
Dim VDateSent As Date
VDateSent = InputBox("What was the Date it was Sent?")
Forms![foreclosure database screen]!ForeclosureSubForm.Form!docket_ltrsent = VDateSent
Else
MsgBox ("PLEASE SEND LETTER ASAP!")
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!Mortgage = -1 Then
MsgBox "THIS FILE HAS THE MORTGAGE BUTTON PUSHED, CONTINUE PRINTING THIS PART ONE PACKAGE?", vbYesNo
Else
DoMacro = "Yes"
End If
If Forms![foreclosure database screen]![PropertyState] = "DC" And Forms![foreclosure database screen]!ForeclosureSubForm.Form!Mortgage = -1 Then
MsgBox "THIS FILE HAS THE MORTGAGE BUTTON PUSHED, CONTINUE PRINTING THIS PART ONE PACKAGE?", vbYesNo
Else
DoMacro = "Yes"
End If
If Forms![foreclosure database screen]![PropertyState] = "VA" And Forms![foreclosure database screen]![ForeclosureSubForm].Form!Mortgage = -1 Then
MsgBox "THIS FILE HAS THE MORTGAGE BUTTON PUSHED, CONTINUE PRINTING THIS PART ONE PACKAGE?", vbYesNo
DoMacro = "yes"
End If


If vbYesNo = vbYes Or DoMacro = "yes" Then
MsgBox ("All Files may NOW be dumped into Word. These file still have to be attached manually to your email.")

DoCmd.RunMacro "PartOne-Normal-Email"
Else
Exit Function
End If

End Function
Public Function EmailUrgentlandsafe()

DoCmd.OutputTo acOutputQuery, "LandsafeUrgent", acFormatXLS, pathuser() & "\LandsafeUrgent" & ".xls"

GSubject = "Order Title/Update: Urgent Request: Attached Spreadsheet"
gBody = "BWW#: " & Forms![foreclosure database screen]!filenum & SigEmail()

gAttachment1 = pathuser() & "\LandsafeUrgent.xls"
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

If Forms![foreclosure database screen]!PropertyState = "DC" Then
gRecipients = "NONCHL@Landsafe.com; ordertitles@bww-law.com"
gCCRecipients = ""
ElseIf Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Or _
Forms![foreclosure database screen]!Client = "Bank of America, N.A." Then
gRecipients = "CHL@Landsafe.com; ordertitles@bww-law.com"
gCCRecipients = ""
Else
gRecipients = "NONCHL@Landsafe.com; ordertitles@bww-law.com"
gCCRecipients = ""
End If

ElseIf (Forms![foreclosure database screen]!Client Like "Bank of Am*" Or _
Forms![foreclosure database screen]!Client = "Bank of America, N.A.") And _
Forms![foreclosure database screen]!PropertyState = "MD" Then
gRecipients = "CHL@Landsafe.com; ordertitles@bww-law.com"
gCCRecipients = ""
End If

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function

Public Function EmailLittonForm()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Litton Loan Servicing Financial Information Form Attached"
emailbody = "Property Address: " & PROP()

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Attachments.ADD "\\rvdv-fs01\DataTransfer\Attachments\Litton_Financial_Form.pdf"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function DeedRecordedEmail2()
Dim emailsubject, emailbody As String

emailsubject = "FHA Deed Recorded for BWW#: " & Forms![foreclosure database screen]!filenum & "/" & _
Forms![foreclosure database screen]!PropertyState
emailbody = "Client: " & Forms![foreclosure database screen]!Client & vbCr & "Client Loan#: " & _
Forms![foreclosure database screen]!ClientRefNumber & vbCr & vbCr & "Upload Deed to Client"

If ThirdPartyOLServ() = "NT" Then
gRecipients = "cathy.robinson@bww-law.com"
Else
gRecipients = "carlene.assing@bww-law.com; abegail.saliente@bww-law.com"
End If

GSubject = emailsubject
gBody = emailbody
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

'Dim MyOutlook As Outlook.Application
'Dim MyMail As Outlook.MailItem
'Set MyOutlook = New Outlook.Application
'Set MyMail = MyOutlook.CreateItem(olMailItem)
'MyMail.To = "Jermaine.Armstrong@bww-law.com"
'MyMail.Subject = emailsubject
'MyMail.Body = emailbody
'MyMail.Display
'Set MyMail = Nothing
'Set MyOutlook = Nothing



End Function
Public Function REOemail()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

If Forms![foreclosure database screen]!Propertycounty = "Howard" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent" Or _
Forms![foreclosure database screen]!Propertycounty = "St. Mary's" Or _
Forms![foreclosure database screen]!Propertycounty = "Queen Anne's" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Then

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
emailsubject = "Property Sold REO"
emailbody = "The Property sold REO.  Please bill the client to record the Trustees' Deed"
MyMail.To = "Carlene.assing@bww-law.com; Matthew.Kelly@bww-law.com; Derick.Long@bww-law.com"
MyMail.Subject = emailsubject & " for BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.body = emailbody & " for BWW#: " & Forms![foreclosure database screen]!filenum
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If

End Function
Public Function DeedRecordedEmail3()


If Forms![foreclosure database screen]!PropertyState = "MD" And _
(Forms![foreclosure database screen]!Propertycounty = "Queen Annes" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Or _
Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "St. Mary's" Or _
Forms![foreclosure database screen]!Propertycounty = "Howard" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent") Then

Dim emailsubject, emailbody As String

If ([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![3rd_party] = 0 Or _
IsNull([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![3rd_party])) Then

emailsubject = "Deed Recorded Date Input for BWW#: " & Forms![foreclosure database screen]!filenum
emailbody = "Please notify auditor that deed has been recorded for BWW#: " & Forms![foreclosure database screen]!filenum
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""




Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Janice.Hill@bww-law.com; MDREOAuditDept@bww-law.com; Dagmawit.Makonnen@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End If
End If

End Function
Public Function DeedRecordedEmailHB1373()
If Not IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![hb1373_ini]) Then

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
emailsubject = "HB 1373 Final Registration needed for BWW# " & Forms![foreclosure database screen]!filenum

emailbody = "PLEASE REGISTER THIS PROPERTY PER HB 1373"
'MyMail.To = "cathy.robinson@bww-law.com; "
MyMail.To = "melanie.hawkins@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If
End Function

Public Function DeedRecordedEmail5()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim queryname As String
Dim savepath As String

savepath = pathuser & "DeedRecordedFHASuntrust.xls"

On Error Resume Next
    Kill savepath
On Error GoTo 0

queryname = "DeedRecordedFHASuntrustQry"

DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _
    queryname, savepath, True

    Set MyOutlook = New Outlook.Application
    Set MyMail = MyOutlook.CreateItem(olMailItem)
    
    emailsubject = "BWW# " & Forms![foreclosure database screen]!filenum & " MD Deed sent for Recording"
    emailbody = "Trustees Deed recorded, please obtain approval to order the title update."
    
    MyMail.To = "Postsaleconveyance@bww-law.com"
    MyMail.Subject = emailsubject
    MyMail.body = emailbody
    MyMail.Attachments.ADD savepath
    MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing
Kill savepath

End Function


Public Function DeedRecordedEmail4()

'Eviction Code
Dim strsqlE, VVar, VVar2, VVar3, VVar4, VVar5
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & Forms![foreclosure database screen]![filenum]
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)
If Not rsE.EOF Then
If rsE!evic_billed = 0 Or IsNull(rsE!evic_billed) Then

If Not IsNull(rsE!DateMotionForPossessionRequested) Then
VVar = rsE!DateMotionForPossessionRequested
Else
VVar = Null
End If

Else
VVar = Null

End If
rsE.Close
'End Eviction Code

If Not IsNull(VVar) Then

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
emailsubject = "BWW# " & Forms![foreclosure database screen]!filenum & " MD Deed sent for Recording"
emailbody = "Please note that a deed has been sent for recording for the above case. Please proceed with filing the Motion for possession."
'MyMail.To = "Claudia.menjivar@bww-law.com; evictions@bww-law.com; cathy.robinson@bww-law.com"
MyMail.To = "Claudia.menjivar@bww-law.com; evictions@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If

End If

End Function
Public Function DeedRecordedOCWEN()

If Forms![foreclosure database screen]!Client Like "Ocwen*" Or _
Forms![foreclosure database screen]!Client Like "Select Port*" Then

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
emailsubject = "BWW# " & Forms![foreclosure database screen]!filenum & " Deed sent for Recording"

If Forms![foreclosure database screen]!Client Like "Ocwen*" Or _
Forms![foreclosure database screen]!Client Like "Shellp*" Then
emailbody = "The trustee’s Deed is on record.   Please bill the remainder 10% or whatever the remaining milestone  attorney’s fees to " & Forms![foreclosure database screen]!Client
ElseIf Forms![foreclosure database screen]!Client Like "Select Port*" Then
If Forms![foreclosure database screen]!PropertyState = "DC" Then
emailbody = "The trustee’s Deed is on record.   Please bill the remainder 10% or whatever the remaining milestone  attorney’s fees to " & Forms![foreclosure database screen]!Client
Else
emailbody = "The trustee’s Deed is on record.   Please bill the remainder 20% or whatever the remaining milestone  attorney’s fees to " & Forms![foreclosure database screen]!Client
End If
End If





If Forms![foreclosure database screen]!PropertyState = "VA" Then

MyMail.To = "VAKills@bww-law.com"
Else
MyMail.To = "MDKills@bww-law.com"
End If

MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If

Call DeedRecordedOCWENBill


End Function
Public Function DeedRecordedOCWENBill()

If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
Dim emailsubject As String
Dim emailbody As String

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
emailsubject = "BWW# " & Forms![foreclosure database screen]!filenum & " Ocwen Deed Recorded.  Must bill by " & Forms![foreclosure database screen]!PostsaleSubForm.Form!DeedRecorded + 5

emailbody = "Name: " & debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & "Ocwen Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & _
vbCr & "Date Deed Recorded: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!DeedRecorded & vbCr & ""

MyMail.To = "ccurley@bozmangroup.com"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End If

End Function
Public Function DeedRecordedEMAIL()


Dim Msg1 As String
Dim VAdNo
Dim emailsubject, emailbody As String

If Forms![foreclosure database screen]!PropertyState <> "DC" Then
Msg1 = "If the accounting has been completed and auditor paid, then the account should be zeroed out."
End If
If Forms![foreclosure database screen]!PropertyState = "DC" Then
Msg1 = "The account should also be zero."
End If
If Forms![foreclosure database screen]!PropertyState = "DC" Then
Msg1 = "Real Estate taxes need to be paid as of the date of sale.  If there is money in the account, please notify Noelle to pay the taxes"
End If


emailsubject = "Deed Recorded for BWW#: " & Forms![foreclosure database screen]!filenum & "/" & Forms![foreclosure database screen]!Client & "/" & Forms![foreclosure database screen]!PropertyState

emailbody = "This deed has been recorded.  Please submit a copy to the Auditor.  " _
& "Please check the amount paid in transfer and/or real estate taxes and compare this to what was billed.  If we billed too much, please e-mail acctg dept to get a refund ck to client.  If we did not bill enough, please see that an amended bill is sent." & _
vbCr & Msg1


If Forms![foreclosure database screen]!PropertyState = "MD" And _
(Forms![foreclosure database screen]!Propertycounty = "Queen Annes" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Or _
Forms![foreclosure database screen]!Propertycounty = "St Mary's" Or _
Forms![foreclosure database screen]!Propertycounty = "Cecil" Or _
Forms![foreclosure database screen]!Propertycounty = "Howard" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent") Then
gRecipients = "Janice.Hill@bww-law.com;ivy.mamon@bww-law.com;chivorn.prim@bww-law.com"

ElseIf Forms![foreclosure database screen]!PropertyState = "VA" Then
gRecipients = "Abegail.Saliente@bww-law.com; Monica.Lee@bww-law.com"

ElseIf ChaseFile() = 1 Then
If Forms![foreclosure database screen]!Propertycounty = "Frederick" Or _
Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
gRecipients = "ivy.mamon@bww-law.com;chivorn.prim@bww-law.com"
Else
gRecipients = "ivy.mamon@bww-law.com;chivorn.prim@bww-law.com"
End If

Else
gRecipients = "ivy.mamon@bww-law.com;chivorn.prim@bww-law.com"
End If




Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = gRecipients
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End Function


Public Function EmailEvictionPos()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Borrower: " & Forms![foreclosure database screen]![LastNameDebtor1] & ": Possession per Broker Letter Attached"

emailbody = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr

Dim rs As RecordSet
Dim strsql, VTo As String
Dim vsplenght

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!Email) Or rs!Email = "" Then
MsgBox ("No email address for " & Forms![foreclosure database screen]!Client & ", please go into Client Information Screen and input.")
VTo = ""
Else
VTo = rs!Email
End If

DoCmd.OutputTo acOutputReport, "CoverLtrLockOutVirginia", acFormatSNP, pathuser() & "\PossessionPerBroker.snp"


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = VTo

MyMail.Attachments.ADD pathuser() & "\PossessionPerBroker.snp"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function EmailPreviewEvictionRat()
Dim Vselect

Vselect = InputBox("1. Preview Letter" & vbCr & "2. Email")
If Vselect = 1 Then

DoCmd.OpenReport "Eviction Ratify Before MFP Letter", acViewPreview
Else
Call EmailEvictionRAT
End If



End Function
Public Function EmailEvictionRAT()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Borrower: " & Forms![foreclosure database screen]![LastNameDebtor1] & ": Ratify Before MFP Letter Attached"

emailbody = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr

Dim rs As RecordSet
Dim strsql, VTo As String
Dim vsplenght

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!Email) Or rs!Email = "" Then
MsgBox ("No email address for " & Forms![foreclosure database screen]!Client & ", please go into Client Information Screen and input.")
VTo = ""
Else
VTo = rs!Email
End If

DoCmd.OutputTo acOutputReport, "Eviction Ratify Before MFP Letter", acFormatSNP, pathuser() & "\RatifyBeforeMFP.snp"


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = VTo

MyMail.Attachments.ADD pathuser() & "\RatifyBeforeMFP.snp"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function EmailHarbor()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application
emailsubject = Forms![foreclosure database screen]![LastNameDebtor1] & ": County: " & County() & ": BWW#: " & Forms![foreclosure database screen]!filenum

emailbody = "Attached please find a copy of the recorded DOA for the above file. Please have same certified and return to our office a certified copy of the DOA."

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "MDOrders@compassresearchgroup.com"
'MyMail.To = "bierman.orders@hcrsearch.com"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function
Public Function EmailNewspaper()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String

Dim VCount, vCounty, strsqlCty, VEmail
Dim rsCty As RecordSet
Dim vpubnotes

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]) Then
vpubnotes = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad], "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5, "mmmm dd, yyyy")
End If

strsqlCty = "select newspaper, news_phone, news2_phone, newspaper2, newspaper2_email, newpaper_email from jurisdiction where County = " & """" & vCounty & """" & " and state = " & """" & "VA" & """" & ";"
Set rsCty = CurrentDb.OpenRecordset(strsqlCty)
 
If (Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper1 = -1 Or _
(Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper1 = 0 And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper2 = 0)) And _
(IsNull(rsCty!newpaper_email) Or rsCty!newpaper_email = "") Then
MsgBox ("No Email Address set up for " & rsCty!Newspaper & ". Phone#: " & rsCty!news_phone)
VEmail = ""
ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper2 = -1 Then
If IsNull(rsCty!newspaper2_email) Then
MsgBox ("No Email Address set up for " & rsCty!newspaper2 & ". Phone#: " & rsCty!news2_phone)
VEmail = ""
Else
VEmail = rsCty!newspaper2_email
End If

Else
VEmail = rsCty!newpaper_email
End If

rsCty.Close


emailsubject = "Affidavit of Publication Verification"
emailmessage = "Dear Sir or Madam:" & vbCr & vbCr & "The Commissioner of Accounts is requesting verification of advertising on the below referenced property, and we cannot find the original affidavit of publication.  Can you please provide this office with a duplicate affidavit?  Please send to my attention as soon as possible." & vbCr & vbCr & _
"Advertisement Information:" & vbCr _
& "Borrowers: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & _
"Property: " & Forms![foreclosure database screen]!PropAddress & vbCr & _
"County: " & Forms![foreclosure database screen]!Propertycounty & vbCr & _
"First Pub Date: " & vpubnotes & vbCr & _
"Sale Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum

Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = VEmail
'MyMail.CC = ""
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing

End Function
Public Function PSCheckRequestNadel()


Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Vcountytransfer, VRealestate, emailsubject, emailmessage1, emailmessage2, emailmessage, vwater, vHarbor As String
Dim from, varemailto, varsendemail, VClerk, Vclerk2, vCounty, vCountyRec, VCCNote As String
Dim emailmessage3, emailmessage4, emailmessage5, emailmessage6, emailmessage7, emailmessage8, emailmessage9, emailmessage10, emailmessage11, emailmessage12


emailsubject = "Request for Check: Deed Recording for BWW# " & Forms![deedtransfer]!filenum & ", " & Forms![deedtransfer]!borrower_name

If Forms!deedtransfer!p1 = -1 Or Forms!deedtransfer!p1 = 1 Then
emailmessage1 = Forms!deedtransfer!Payee_RC & ", " & Format(Forms!deedtransfer!recording_charge + Forms!deedtransfer!surcharge, "$###,##0.00") & ", (Recording Charge)" & vbCr & vbCr
Else
emailmessage1 = ""
End If
If Forms!deedtransfer!p2 = -1 Or Forms!deedtransfer!p2 = 1 Then
emailmessage2 = Forms!deedtransfer!Payee_SRT & ", " & Format(Forms!deedtransfer!staterecordationtax, "$###,##0.00") & ", (SRT)" & vbCr & vbCr
Else
emailmessage2 = ""
End If

If Forms!deedtransfer!p3 = -1 Or Forms!deedtransfer!p3 = 1 Then
emailmessage3 = Forms!deedtransfer!Payee_STT & ", " & Format(Forms!deedtransfer!statetransfertax, "$###,##0.00") & ", (STT)" & vbCr & vbCr
Else
emailmessage3 = ""
End If
If Forms!deedtransfer!P4 = -1 Or Forms!deedtransfer!P4 = 1 Then
emailmessage4 = Forms!deedtransfer!Payee_CTT & ", " & Format(Forms!deedtransfer!countytransfertax, "$###,##0.00") & ", (CTT)" & vbCr & vbCr
Else
emailmessage4 = ""
End If

If Forms!deedtransfer!P5 = -1 Or Forms!deedtransfer!P5 = 1 Then
emailmessage5 = Forms!deedtransfer!Payee_RETaxes & ", " & Format(Forms!deedtransfer!realestatetaxes, "$###,##0.00") & ", (RE Taxes)" & vbCr & vbCr
Else
emailmessage5 = ""
End If
If Forms!deedtransfer!P6 = -1 Or Forms!deedtransfer!P6 = 1 Then
emailmessage6 = Forms!deedtransfer!Payee_water & ", " & Format(Forms!deedtransfer!water, "$###,##0.00") & ", (Water)" & vbCr & vbCr
Else
emailmessage6 = ""
End If

If Forms!deedtransfer!P7 = -1 Or Forms!deedtransfer!P7 = 1 Then
emailmessage7 = Forms!deedtransfer!Payee_Abstractor & ", " & Format(Forms!deedtransfer!abstractor, "$###,##0.00") & ", (Abstractor)" & vbCr & vbCr

Else
emailmessage7 = ""
End If
If Forms!deedtransfer!P8 = -1 Or Forms!deedtransfer!P8 = 1 Then
emailmessage8 = Forms!deedtransfer!Payee_utilities & ", " & Format(Forms!deedtransfer!utilities, "$###,##0.00") & ", (Utilities)" & vbCr & vbCr
Else
emailmessage8 = ""
End If

If Forms!deedtransfer!P9 = -1 Or Forms!deedtransfer!P9 = 1 Then
emailmessage9 = Forms!deedtransfer!Payee_liencert & ", " & Format(Forms!deedtransfer!lien_cert, "$###,##0.00") & ", (Lien Cert)" & vbCr & vbCr
Else
emailmessage9 = ""
End If

If Forms!deedtransfer!P10 = -1 Or Forms!deedtransfer!P10 = 1 Then
emailmessage10 = Forms!deedtransfer!Payee_other1 & ", " & Format(Forms!deedtransfer!money_other_intake, "$###,##0.00") & vbCr & vbCr
Else
emailmessage10 = ""
End If
If Forms!deedtransfer!p11 = -1 Or Forms!deedtransfer!p11 = 1 Then
emailmessage11 = Forms!deedtransfer!Payee_other2 & ", " & Format(Forms!deedtransfer!money_other_intake2, "$###,##0.00") & vbCr & vbCr
Else
emailmessage11 = ""
End If
If Forms!deedtransfer!p12 = -1 Or Forms!deedtransfer!p12 = 1 Then
emailmessage12 = Forms!deedtransfer!Payee_other3 & ", " & Format(Forms!deedtransfer!money_other_intake3, "$###,##0.00") & vbCr & vbCr
Else
emailmessage12 = ""
End If







emailmessage = emailmessage1 + emailmessage2 + emailmessage3 + emailmessage4 + emailmessage5 + emailmessage6 + emailmessage7 + emailmessage8 + emailmessage9 + emailmessage10 + emailmessage11 + emailmessage12

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.To = "George.Huang@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End Function

Public Function PSCheckRequest()

 
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD) Then
MsgBox ("THIS SALE HAS NOT RATIFIED.  THE DEED IS NOT RIPE FOR RECORDING.")
Exit Function

Else
Dim rsCounty As RecordSet
Dim strsqlCounty As String

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Dim VCountyTransferCheck, vWaterCheck, vStateTransferCheck, VRecordationCheck, VCountyRecCheck, VLienCertCheck, VRealEstateCheck

Dim Vcountytransfer, vwater, VRealestate, vCountyRec

Dim emailsubject, emailmessage1, emailmessage2, emailmessage As String
Dim from, varemailto, varsendemail, VClerk, Vclerk2, vCounty, VState, VCCNote As String
Dim emailmessage3, emailmessage4

vCounty = Forms![foreclosure database screen]!Propertycounty
strsqlCounty = "select * from jurisdiction where county = " & """" & vCounty & """"
Set rsCounty = CurrentDb.OpenRecordset(strsqlCounty, dbOpenSnapshot)

VCountyTransferCheck = rsCounty!countytransfer_check & ": "
VRealEstateCheck = rsCounty!realestatetaxes_check & ": "
vWaterCheck = rsCounty!water_check & ": "
VRecordationCheck = rsCounty!recordation_check & ": "
vStateTransferCheck = rsCounty!statetransfer_check & ": "
VLienCertCheck = rsCounty!Liencert_check & ": "
VCountyRecCheck = rsCounty!recordingcharge_check & ": "

rsCounty.Close


emailsubject = "Request for Check: Deed Recording for BWW# " & Forms![foreclosure database screen]!filenum & ", " & Forms![foreclosure database screen]!FirstNameDebtor1 & " " & Forms![foreclosure database screen]!LastNameDebtor1

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate < #11/19/2014# Or (Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > #11/19/2014# And (Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or Forms![foreclosure database screen]!TypeOfLoan = "VA" Or _
Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Or Forms![foreclosure database screen]!Client Like "Citi*" Or _
Forms![foreclosure database screen]!Client Like "Ocwen*")) Then
emailmessage3 = "Compass Research Group: $55.00 (Recording Fee)" & vbCr
Else
emailmessage3 = ""
MsgBox ("Cannot Charge Client $55.00 to Record, must pay out of operating system!")
End If


If Forms![foreclosure database screen]!PropertyState = "MD" Then

If Forms![foreclosure database screen]!Propertycounty = "Charles" Then
emailmessage4 = vbCr & vbCr & VLienCertCheck & " $20.00 (Lien Certificate Application)"
Else
emailmessage4 = ""
End If


VClerk = Forms![foreclosure database screen]![PostsaleSubForm].Form![staterecordationtax]
Vclerk2 = Forms![foreclosure database screen]![PostsaleSubForm].Form![recording_charge] + Forms![foreclosure database screen]![PostsaleSubForm].Form!surcharge
VRealestate = VRealEstateCheck & Format(MD_RealEstateTaxes(), "$###,##0.00") & " (Real Estate Taxes)" & vbCr & vbCr


If countymonies() > 0 Then
If Forms![foreclosure database screen]!Propertycounty = "Calvert" Or _
Forms![foreclosure database screen]!Propertycounty = "Carroll" Or _
Forms![foreclosure database screen]!Propertycounty = "Frederick" Or _
Forms![foreclosure database screen]!Propertycounty = "Somerset" Or _
Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
Vcountytransfer = ""
Else
Vcountytransfer = VCountyTransferCheck & Format(countymonies(), "$###,##0.00") & " (County Transfer Tax)" & vbCr & vbCr
End If

End If

If Not IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form!statetransfertax) Then
VState = vStateTransferCheck & Format(Forms![foreclosure database screen]![PostsaleSubForm].Form!statetransfertax, "$###,##0.00") & " (State Transfer Tax)" & vbCr & vbCr
Else
VState = ""
End If

Dim VCecil

'If Forms![foreclosure database screen]!PropertyCounty = "Cecil" Then
'VCecil = VCountyTransferCheck & " $10.00 (County Transfer Tax)" & vbCr & vbCr
'Else
VCecil = ""
'End If

emailmessage1 = "Please prepare the following checks: " & vbCr & vbCr & _
"Tax ID: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid & vbCr & vbCr & _
VRecordationCheck & Format(VClerk, "$###,##0.00") & " (State Recordation Tax)" & vbCr & vbCr & _
Vcountytransfer & VCecil & VRealestate & VState


If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Or _
Forms![foreclosure database screen]!Propertycounty = "Worcester" Then


If Forms![foreclosure database screen]![PostsaleSubForm].Form!intakeOther2 > 0 Then
vwater = vWaterCheck & Format(Forms![foreclosure database screen]![PostsaleSubForm].Form!intakeOther2, "$###,##0.00") & " (Water)" & vbCr & vbCr
Else
vwater = ""
End If
End If
End If


emailmessage2 = VCountyRecCheck & " " & Format(Vclerk2, "$###,##0.00") & " (Recording Charge/Surcharge)" & vbCr & vbCr



If Forms![foreclosure database screen]!PropertyState = "DC" Then

Vclerk2 = Forms![foreclosure database screen]![PostsaleSubForm].Form![recording_charge]
VClerk = Forms![foreclosure database screen]![PostsaleSubForm].Form![staterecordationtax]

emailmessage1 = "Please prepare the following checks: " & vbCr & vbCr & _
"Square: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!square & "/Lot: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!lot & vbCr & vbCr & _
"DC Treasurer: " & Format(VClerk, "$###,##0.00") & " (Recordation Tax)" & vbCr & vbCr & _
"DC Treasurer: " & Format(Vclerk2, "$###,##0.00") & " (Recording Fee)" & vbCr & vbCr
emailmessage2 = ""

End If

emailmessage = emailmessage1 + emailmessage2 + emailmessage3 + emailmessage4

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.To = "Lucy.Poblete@bww-law.com; George.Huang@bww-law.com; Joven.Marcelo@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End If

End Function

Public Function PSCheckRequestDIL()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Vcountytransfer, VRealestate, emailsubject, emailmessage1, emailmessage2, emailmessage, vwater, vHarbor As String
Dim from, varemailto, varsendemail, VClerk, Vclerk2, vCounty, VCCNote As String

emailsubject = "Request for Check: Deed Recording for BWW# " & Forms![foreclosure database screen]!filenum & ", " & Forms![foreclosure database screen]!FirstNameDebtor1 & " " & Forms![foreclosure database screen]!LastNameDebtor1

If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
VClerk = Forms![DILForm]![DILSub].Form![staterecordationtax]
Else
VClerk = Forms![DILForm]![DILSub].Form![ClerkCircuitCourt]
End If

If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
Vclerk2 = Forms![DILForm]![DILSub].Form![recording_charge] + Forms![DILForm]![DILSub].Form!surcharge
Else
Vclerk2 = 0
End If

If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
VRealestate = "Clerk of the Circuit Court: " & Format(MD_RealEstateTaxes(), "$###,##0.00") & " (Real Estate Taxes)" & vbCr & vbCr
ElseIf Forms![foreclosure database screen]!Propertycounty = "Prince George's" Then
VRealestate = County() & " Treasurer: " & Format(MD_RealEstateTaxes(), "$###,##0.00") & " (Real Estate Taxes)" & vbCr & vbCr
Else
VRealestate = ""
End If

If countymonies() > 0 Then

If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
Vcountytransfer = "Director of Finance: " & Format(countymonies(), "$###,##0.00") & " (County)" & vbCr & vbCr

ElseIf Forms![foreclosure database screen]!Propertycounty = "Allegany" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Carroll" Or _
Forms![foreclosure database screen]!Propertycounty = "Dorchester" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Or _
Forms![foreclosure database screen]!Propertycounty = "Washington" Or _
Forms![foreclosure database screen]!Propertycounty = "Wicomico" Or _
Forms![foreclosure database screen]!Propertycounty = "Queen Anne's" Or _
Forms![foreclosure database screen]!Propertycounty = "St. Mary's" Or _
Forms![foreclosure database screen]!Propertycounty = "Garrett" Or _
Forms![foreclosure database screen]!Propertycounty = "Howard" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent" Or _
Forms![foreclosure database screen]!Propertycounty = "Calvert" Then
Vcountytransfer = ""
ElseIf Forms![foreclosure database screen]!Propertycounty = "Cecil" Then
Vcountytransfer = "Treasurer of Cecil County: " & Format(countymonies(), "$###,##0.00") & " (County)" & vbCr & vbCr
Else
Vcountytransfer = County() & ", MD: " & Format(countymonies(), "$###,##0.00") & " (County)" & vbCr & vbCr
End If
End If


If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
VCCNote = " (State Recordation Tax)"
ElseIf Forms![foreclosure database screen]!Propertycounty = "Cecil" Then
VCCNote = " (State Recordation Tax/State Transfer Tax)"
ElseIf Forms![foreclosure database screen]!Propertycounty = "Worcester" Or _
Forms![foreclosure database screen]!Propertycounty = "Harford" Then
VCCNote = " (Clerk Fee/Surcharge/State Recordation Tax/State Transfer Tax)"
ElseIf Forms![foreclosure database screen]!Propertycounty = "Allegany" Or _
Forms![foreclosure database screen]!Propertycounty = "Caroline" Or _
Forms![foreclosure database screen]!Propertycounty = "Dorchester" Or _
Forms![foreclosure database screen]!Propertycounty = "Talbot" Or _
Forms![foreclosure database screen]!Propertycounty = "Washington" Or _
Forms![foreclosure database screen]!Propertycounty = "Wicomico" Or _
Forms![foreclosure database screen]!Propertycounty = "Queen Anne's" Or _
Forms![foreclosure database screen]!Propertycounty = "St. Mary's" Or _
Forms![foreclosure database screen]!Propertycounty = "Garrett" Or _
Forms![foreclosure database screen]!Propertycounty = "Howard" Or _
Forms![foreclosure database screen]!Propertycounty = "Kent" Or _
Forms![foreclosure database screen]!Propertycounty = "Calvert" Then
VCCNote = " (Clerk Fee/Recordation Tax/Surcharge/State Transfer Tax/County Transfer Tax)"
ElseIf Forms![foreclosure database screen]!Propertycounty = "Anne Arundel" Then
VCCNote = " (Clerk Fee/Surcharge/State Transfer Tax/County Transfer Tax"
ElseIf Forms![foreclosure database screen]!Propertycounty = "Prince George's" Or _
Forms![foreclosure database screen]!Propertycounty = "Carroll" Or _
Forms![foreclosure database screen]!Propertycounty = "Frederick" Or _
Forms![foreclosure database screen]!Propertycounty = "Montgomery" Or _
Forms![foreclosure database screen]!Propertycounty = "Baltimore" Then
VCCNote = " (Clerk Fee/Surcharge/State Transfer Tax)"

Else
VCCNote = ""
End If


emailmessage1 = "Please prepare the following checks: " & vbCr & vbCr & _
"Tax ID: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid & vbCr & vbCr & _
"Clerk of the Circuit Court: " & Format(VClerk, "$###,##0.00") & VCCNote & vbCr & vbCr & _
Vcountytransfer & VRealestate


If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then

If Forms![DILForm]![DILSub].Form!intakeOther2 > 0 Then
vwater = "Director of Finance: " & Format(Forms![DILForm]![DILSub].Form!intakeOther2, "$###,##0.00") & " (Water)" & vbCr & vbCr
Else
vwater = ""
End If

If Forms![DILForm]![DILSub].Form!deed_rec_charge > 0 Then
vHarbor = "Harbor City Research: " & Format(Forms![DILForm]![DILSub].Form!deed_rec_charge, "$###,##0.00") & vbCr & vbCr
Else
vHarbor = "Harbor City Research: " & "$55.00" & vbCr & vbCr
End If

emailmessage2 = "Clerk of the Circuit Court: " & Format(Vclerk2, "$###,##0.00") & " (Recording Charge/Surcharge)" & vbCr & vbCr & vwater + vHarbor
ElseIf Forms![foreclosure database screen]!Propertycounty = "Prince George's" Then
emailmessage2 = "Clerk of the Circuit Court: " & Format(Vclerk2, "$###,##0.00") & " (Recording Charge/Surcharge)" & vbCr & vbCr
ElseIf Forms![foreclosure database screen]!Propertycounty = "baltimore" Then
emailmessage2 = County() & ", MD: " & Format(Forms![DILForm]![DILSub].Form!staterecordationtax, "$###,##0.00") & " (Recordation Tax)" & vbCr & vbCr
ElseIf Forms![foreclosure database screen]!Propertycounty = "carroll" Then
emailmessage2 = "The Commissioners of Carroll County: " & Format(Forms![DILForm]![DILSub].Form!staterecordationtax, "$###,##0.00") & " (Recordation Tax)" & vbCr & vbCr
ElseIf Forms![foreclosure database screen]!Propertycounty = "frederick" Then
emailmessage2 = "Treasurer of Frederick County: " & Format(Forms![DILForm]![DILSub].Form!staterecordationtax, "$###,##0.00") & " (Recordation Tax)" & vbCr & vbCr

Else
emailmessage2 = ""
End If


emailmessage = emailmessage1 + emailmessage2

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.To = "Lucy.Poblete@bww-law.com"

MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function EmailChkReqIND()

Dim emailsubject, emailmessage As String
Dim from, varemailto, varsendemail, VAmt As String

emailsubject = "VA Check Request Email " & Date

If IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form![amt_check_req]) Then
VAmt = InputBox("Check Request Amount Not filled in on screen.  Input.  Screen will update.")
Forms![foreclosure database screen]![PostsaleSubForm].Form![amt_check_req] = VAmt
Else
VAmt = Forms![foreclosure database screen]![PostsaleSubForm].Form![amt_check_req]
End If

emailmessage = "Check Request for Virginia:" & vbCr & _
"Amount: " & Format(VAmt, "$###,##0.00") & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Debtor: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & _
"Property: " & PROP()

GSubject = emailsubject
gRecipients = "Lucy.Poblete@bww-law.com"
gBody = emailmessage
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function
Public Function ChkReqRecDeed()
Dim emailsubject, emailmessage, VAmt

VAmt = InputBox("Amount of Check")

emailsubject = "Deed Check Request"
emailmessage = "Please make check payable to the Commissioner of Accounts." & vbCr & _
"Amount: " & Format(VAmt, "$###,##0.00") & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Debtor: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & _
"Property: " & PROP()
Dim from, varemailto, varsendemail As String

gRecipients = "Lucy.Poblete@bww-law.com; George.Huang@bww-law.com; Joven.Marcelo@bww-law.com"
gCCRecipients = ""
GSubject = emailsubject
gBody = emailmessage
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)
End Function
Public Function EMAILLandsafeBatch()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim rs As RecordSet
Dim VCount As Integer

'Set rs = CurrentDb.OpenRecordset("vaacctlandsafeemailALL", dbopensnapshot)

'If Not rs.EOF Then
'rs.MoveFirst

'Do While Not rs.EOF
'VCount = VCount + 1
'rs.MoveNext

'Loop
'rs.Close

DoCmd.OutputTo acOutputReport, "VALandsafeBatch", acFormatXLS, pathuser() & "\VALandsafeEmail" & ".xls"


Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

emailsubject = "Request for Paid Invoices"

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Theresa_Miles@bankofamerica.com"
MyMail.CC = ""
MyMail.Subject = emailsubject
'MyMail.Body = VCount & " records attached in Excel spreadsheet"
MyMail.body = "Attached Excel spreadsheet"

MyMail.Attachments.ADD pathuser() & "\VALandsafeEmail.xls"

MyMail.Display

Set MyMail = Nothing
'End If

End Function
Public Function EMAILCompassBatch()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim rs As RecordSet
Dim VCount As Integer

DoCmd.OutputTo acOutputReport, "VACompassBatch", acFormatXLS, pathuser() & "\VACompassEmail" & ".xls"

Dim from, varemailto, varsendemail As String

emailsubject = "Request for Invoices marked Paid"

gRecipients = "john@compassresearchgroup.com; tyrone@compassresearchgroup.com"
gCCRecipients = ""
GSubject = emailsubject
'gBody = VCount & " records attached in Excel spreadsheet"
gBody = "Attached Excel spreadsheet"

gAttachment1 = pathuser() & "\VACompassEmail.xls"
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

'End If

End Function
Public Function EMAILASAPBatch()

End Function

Public Function ChkReqLienCert()

Dim VCount, vCounty, strsqlCty, VLienCert
Dim rsCty As RecordSet
vCounty = Forms![foreclosure database screen]!Propertycounty
strsqlCty = "select * from jurisdiction where County = " & """" & vCounty & """" & " and state = " & """" & "MD" & """" & ";"
Set rsCty = CurrentDb.OpenRecordset(strsqlCty)

If Not IsNull(rsCty!lien_cert) Then
If rsCty!lien_cert > 0 Then
VLienCert = rsCty!lien_cert
Else
VLienCert = 0
End If
End If

rsCty.Close

Dim VAdNo, emailsubject, emailbody, strsql, VEmail As String


emailsubject = "Check Request for Lien Cert for: BWW#: " & Forms![foreclosure database screen]!filenum & "/" & Forms![foreclosure database screen]!LastNameDebtor1 & " / " & Forms![foreclosure database screen]!PropAddress
emailbody = "This is a check request for the amount of : " & vbCr & vbCr & _
VLienCert & _
"County: " & Forms![foreclosure database screen]!Propertycounty & vbCr & "CLIENT: " _
& Forms![foreclosure database screen]!Client & vbCr & "Loan#:" _
& Forms![foreclosure database screen]![ClientRefNumber] & vbCr & "Borrower(s): " _
& debtorsFORE() & vbCr & "Property: " & Forms![foreclosure database screen]!PropAddress & vbCr & "County: " & Forms![foreclosure database screen]!Propertycounty & vbCr


gRecipients = "Evangeline.Tubila@bww-law.com"
GSubject = emailsubject
gBody = emailbody
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)
End Function
Public Function AdCancel()
Dim VPub, vpubnotes

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5) Then
VPub = Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4) Then
VPub = Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3) Then
VPub = Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2) Then
VPub = Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]) Then
VPub = Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]
End If

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]) Then
vpubnotes = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad], "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub2, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub3, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub4, "mmmm dd, yyyy")
End If
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5) Then
vpubnotes = vpubnotes + vbCr + Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!pub5, "mmmm dd, yyyy")
End If

'MsgBox (vpubnotes)

If Date <= VPub - 1 Then
Dim VCount, vCounty, strsqlCty, VLienCert
Dim rsCty As RecordSet
vCounty = Forms![foreclosure database screen]!Propertycounty
strsqlCty = "select newspaper, newspaper2, newspaper2_email, newpaper_email from jurisdiction where County = " & """" & vCounty & """" & " and state = " & """" & "VA" & """" & ";"
Set rsCty = CurrentDb.OpenRecordset(strsqlCty)

If (Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper1 = -1 Or _
(Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper1 = 0 And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper2 = 0)) And _
(IsNull(rsCty!newpaper_email) Or rsCty!newpaper_email = "") Then

MsgBox ("No Email Address set up for " & rsCty!Newspaper & ".")

VLienCert = ""

ElseIf Forms![foreclosure database screen]![ForeclosureSubForm].Form!newspaper2 = -1 Then

VLienCert = rsCty!newspaper2_email & "; vakills@bww-law.com"

Call AddBillToBePrep
Else

VLienCert = rsCty!newpaper_email & "; vakills@bww-law.com"

Call AddBillToBePrep

End If

rsCty.Close


Dim VAdNo, emailsubject, emailbody, strsql, VEmail As String
If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!asap_no) Then
VAdNo = ""
Else
VAdNo = "Ad#: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!asap_no & vbCr
End If


emailsubject = "Ad Cancellation! " & Forms![foreclosure database screen]!LastNameDebtor1 & " / " & Forms![foreclosure database screen]!PropAddress & " / 1st Ad: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]
emailbody = "Please be advised that we are requesting that you cancel the ad which was scheduled for: " & vbCr & vpubnotes & vbCr & vbCr & _
"Please forward a confirmation and final ad costs IMMEDIATELY." & vbCr & vbCr & _
VAdNo & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & "CLIENT: " _
& Forms![foreclosure database screen]!Client & vbCr & "Borrower(s): " _
& debtorsFORE() & vbCr & "Property: " & Forms![foreclosure database screen]!PropAddress & vbCr & "County: " & Forms![foreclosure database screen]!Propertycounty & vbCr

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem


Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


MyMail.To = VLienCert
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display




End If

End Function
Public Function EMailEscalate()

Dim emailsubject, emailbody As String

emailsubject = "Escalate Missing Foreclosure Docs for BWW#: " & Forms![foreclosure database screen]![filenum] & ", Borrower(s): " & debtorsFORE()

emailbody = "Attached is a report of all the files that we are still in need of the Assignment and SOT to be returned to our office for the listed files. The docs have been sent to the designated email address.  As you know, the timeframe in MD is referral to sale in 47 days or less and so we generally have to have our cases docketed within 10 days from referral. Can you check with your doc execution team and see if we can expedite the return of these fc docs.  If we don't receive them back asap we will have to reset some of the sale dates on these files.  I know that you must be inundated with docs to be executed and I hate to pester, unfortunately the MD timeline is so fast that we don't have much of a choice but to get these back rather quickly to keep your sales in timeline.  Thanks so much in advance for your assistance."

Dim rs As RecordSet
Dim strsql, VTo As String

strsql = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!fc_email_escalate) Or rs!fc_email_escalate = "" Then
MsgBox ("No email address for FC Escalate for " & Forms![foreclosure database screen]!Client & ", please go into Client Information Screen and input.")
VTo = ""
Else
VTo = rs!fc_email_escalate
End If


gRecipients = VTo
GSubject = emailsubject
gBody = emailbody + SigEmail()
gCCRecipients = ""
Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function

Public Function SigEmail()

Dim VarParaLegal
Dim strPL
Dim sig1 As String
Dim vtitle As String
Dim rsPL As RecordSet
Dim VExt
Dim VDDial
Dim VFax
Dim VPhone
Dim VEmail
Dim VEsq
Dim VDept

VarParaLegal = Environ("username")

strPL = "Select * from employees where login = " & """" & VarParaLegal & """" & ";"
Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)

If rsPL.EOF Then

MsgBox "User Name not in Foreclosure employee table", vbOKOnly

sig1 = ""

Else

If Not IsNull(rsPL!Title) Then

If rsPL!Title = "Attorney" Then
If rsPL!EmployeeID = "RLL" Or rsPL!EmployeeID = "PCP" Then
VEsq = ", Esquire"
Else
VEsq = ""
End If
End If


End If


If IsNull(rsPL!MiddleName) Then
sig1 = rsPL!FirstName & " " & rsPL!LastName & VEsq
Else
sig1 = rsPL!FirstName & " " & rsPL!MiddleName & " " & rsPL!LastName & VEsq
End If


If rsPL!office Like "Richmond*" Then
If Not IsNull(rsPL!Extension) Then
VPhone = "Phone: 804-282-0463, ext. " & rsPL!Extension
Else
VPhone = "Phone: 804-282-0463"
End If
Else

If Not IsNull(rsPL!Extension) Then
VPhone = "Phone: 301-961-6555, ext. " & rsPL!Extension
Else
VPhone = "Phone: 301-961-6555"
End If

End If


If Not IsNull(rsPL!Emp_Fax) Then
VFax = "Personal Fax: " & rsPL!Emp_Fax & vbCr
ElseIf rsPL!office Like "Richmond*" Then
VFax = "Fax: 804-282-0541" & vbCr
Else
VFax = "Fax: 301-961-6545" & vbCr
End If

'If Not IsNull(rsPL!WorkPhone) Then
'VDDial = "Direct Dial: " & rsPL!WorkPhone & vbCr
'Else
VDDial = ""
'End If

If Not IsNull(rsPL!WebDepartment) Then
VDept = rsPL!WebDepartment & vbCr
Else
VDept = ""
End If

If IsNull(rsPL!EmailName) Then
MsgBox ("NO Email address input for these initials.  Please have your email address input by either Rachel, Rebecca or Charlene")
VEmail = ""
Else
VEmail = "Email: " & rsPL!EmailName
End If


If rsPL!office Like "Richmond*" Then
SigEmail = vbCr & vbCr & sig1 & vbCr & "BWW Law Group, LLC" & vbCr & "8100 Three Chopt Road, Suite 240" & vbCr & "Richmond, VA 23229" & vbCr & VDept & VPhone & vbCr & VDDial & VFax & VEmail
Else
SigEmail = vbCr & vbCr & sig1 & vbCr & "BWW Law Group, LLC" & vbCr & "6003 Executive Blvd., Ste. 101" & vbCr & "Rockville, MD 20852" & vbCr & VDept & VPhone & vbCr & VDDial & VFax & VEmail
End If

End If


rsPL.Close



End Function
Public Function EmpEmail()
Dim VarParaLegal, strPL, sig1, vtitle, VNotes As String
Dim rsPL As RecordSet


VarParaLegal = Environ("username")
strPL = "Select * from employees where login = " & """" & VarParaLegal & """" & ";"
Set rsPL = CurrentDb.OpenRecordset(strPL, dbOpenSnapshot)

If rsPL.EOF Then
MsgBox "Login not in Foreclosure employee table", vbOKOnly
EmpEmail = ""
Else
EmpEmail = rsPL!EmailName
End If
rsPL.Close

End Function
Public Function EmailEvicDeed()

'Eviction Code
Dim strsqlE, VVar
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & Forms![foreclosure database screen]![filenum]
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)
If Not rsE.EOF Then
VVar = rsE!evic_billed
Else
VVar = Null
End If
rsE.Close
'End Eviction Code

If IsNull(VVar) Or VVar = 0 Then

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application

emailsubject = "Deed Sent to be Recorded: BWW#: " & Forms![foreclosure database screen]!filenum
emailbody = "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & vbCr & "Property Address: " & PROP() & vbCr & vbCr & "The trustee's deed for this file was sent for recording on " & Forms![foreclosure database screen]!PostsaleSubForm.Form!deed_sent_recording & ".  Please proceed with this eviction case as soon as possible."

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "evictions@bww-law.com"

'MyMail.Attachments.ADD "\\rvdv-fs01\DataTransfer\EmailAttachments\IndyMac.pdf"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If

End Function
Public Function EmailIndyOut()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Set MyOutlook = New Outlook.Application

emailsubject = "OneWest Postsale Requirement (FHA/VA): BWW#: " & Forms![foreclosure database screen]!filenum
emailbody = "Please comply with the attached OneWest FHA/VA postsale requirement checklist"

Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms![foreclosure database screen]!PropertyState = "MD" Then
MyMail.To = "Carrie.Ward@bww-law.com; Rachel.Bayard@bww-law.com; ccurley@bozmangroup.com"
Else
MyMail.To = "Monica.Lee@bww-law.com"
End If


MyMail.Attachments.ADD "\\rvdv-fs01\DataTransfer\EmailAttachments\IndyMac.pdf"
MyMail.Subject = emailsubject
MyMail.body = emailbody
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function EmailBondsNEW()

 

Dim VRpt As Integer
VRpt = InputBox("Do Report by: " & vbCr & vbCr & "1.  Sale Date" & vbCr & "2.  Prepared Bond Date")
If VRpt = 1 Then
DoCmd.OpenQuery ("Bondsbulk")
Else
DoCmd.OpenQuery ("BondsPreparedBulk")
End If

VConvRpt = "BondBulk"
Call ConvertPDFALL

Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("Bonds", dbOpenDynaset, dbSeeChanges)
Dim Vcnt As Integer
Vcnt = 0

If Not rs.EOF Then
rs.MoveFirst

Do While Not rs.EOF

With rs
.Edit
If IsNull(rs!sale_cancelled) Then
!Count = Vcnt + 1
Vcnt = Vcnt + 1
End If

.Update
End With
rs.MoveNext
Loop


End If
rs.Close

DoCmd.OutputTo acOutputReport, "BondsNotCancelledNEW", acFormatXLS, pathuser() & "\Bonds" & ".xls"

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Bond Spreadsheet and Bonds in PDF Format"
emailbody = "Attached please find report in Excel Format and Bonds in PDF."


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "robert.johnson@bww-law.com; howie.bierman@bww-law.com"
MyMail.Attachments.ADD pathuser() & "\bonds.xls"
MyMail.Attachments.ADD pathuser() & "\BondBulk.PDF"

Set rs = CurrentDb.OpenRecordset("Bonds", dbOpenDynaset, dbSeeChanges)
Vcnt = 0

If Not rs.EOF Then
rs.MoveFirst

Do While Not rs.EOF

With rs
.Edit
If Not IsNull(rs!sale_cancelled) Then
!Count = Vcnt + 1
Vcnt = Vcnt + 1
End If

.Update
End With
rs.MoveNext
Loop


End If
rs.Close

Dim rsCan As RecordSet
Set rsCan = CurrentDb.OpenRecordset("bondscancelled", dbOpenSnapshot)
If Not rsCan.EOF Then
VConvRpt = "CancelledSalesFiledBonds"
Call ConvertPDFALL
DoCmd.OutputTo acOutputReport, "BondsCancelledNEW", acFormatXLS, pathuser() & "\CancelledSales" & ".xls"
MyMail.Attachments.ADD pathuser() & "\CancelledSales.xls"
MyMail.Attachments.ADD pathuser() & "\CancelledSalesFiledBonds.PDF"
rsCan.Close
End If

MyMail.Subject = emailsubject


MyMail.body = emailbody + SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function DOAMdEmail()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim vardayofweek, emailsubject, emailbody, Vvariable, Vaffnote, vAd3 As String
Dim vad As Date

Set MyOutlook = New Outlook.Application
Vvariable = MsgBox("Email Generating: Do you need to include the Affidavit Lost Note: ", vbYesNo)


If Vvariable = vbYes Then
Vaffnote = " and Affidavit of Lost Note"
Else
Vaffnote = ""
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad]) Then
MsgBox ("Please enter 1st Ad and rerun DOA")
Exit Function
Else
vad = Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad] - 3
End If

vardayofweek = Format(vad, "dddd")
'MsgBox (vardayofweek & ": Ad: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad])

If vardayofweek = "Saturday" Then
vAd3 = vad - 1
ElseIf vardayofweek = "Sunday" Then
vAd3 = vad - 2
Else
vAd3 = vad
End If

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
emailsubject = "Lender: " & Forms![foreclosure database screen]!Client & "/Borrower(s): " & debtorsFORE()
emailbody = "Account#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & vbCr & "Please find attached the Appointment" & Vaffnote & " to be signed, executed and forwarded back to our office by " & vAd3 & " in order for us to docket the case, meet your timelines and keep the sale date set for " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & vbCr & vbCr & "Thanking you in advance for your help with this matter."


Else
emailsubject = "Lender: " & Forms![foreclosure database screen]!Client & "/" & Forms![foreclosure database screen]!LastNameDebtor1 & "/BWW#: " & Forms![foreclosure database screen]!filenum
emailbody = "Please find attached the Appointment" & Vaffnote & " to be signed, executed and forwarded back to our office by " & vAd3 & " in order for us to docket the case, meet your timelines and keep the sale date set for " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & vbCr & vbCr & "Thanking you in advance for your help with this matter."

End If


Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.body = emailbody & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailStatusNote()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody, Vvariable As String
Dim VLoan

Set MyOutlook = New Outlook.Application
'Vvariable = InputBox("Provide NOTE no later than: Date: ")
'If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
'VLoan = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr
'Else
'VLoan = ""
'End If

emailsubject = "Please provide us with a Fully Executed Copy of the Note - BWW#: " & Forms![foreclosure database screen]!filenum

emailbody = "Please provide us with a Fully Executed Copy of the Note. Please note that we are unable to proceed until same is returned to our office  Thanks. " & _
vbCr & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & _
"Property: " & PROP() & vbCr & _
VLoan & _
"Jurisdiction: " & County() & vbCr & _
"Deed of Trust Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate & vbCr & _
"Original Loan Amount: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount & vbCr & _
"Beneficiary: " & Forms![foreclosure database screen]!SecuredParty & vbCr & _
liberfolio()



Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.body = emailbody & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function

Public Function EmailStatusCert()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody, Vvariable As String
Dim VLoan

Set MyOutlook = New Outlook.Application
Vvariable = InputBox("Provide Cert. Copy DOT no later than: Date: ")
'If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
VLoan = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr
'Else
'VLoan = ""
'End If

emailsubject = "Status of Certified Copy of Deed of Trust"
emailbody = "Please provide the certified copy of the deed of trust to be received no later than 10:30 am on " & Vvariable & _
" as same is needed to docket our case and meet first legal.  Please note that if the same is not received, we may be forced to cancel our sale and re-set to a later date. " & _
vbCr & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & _
"Property: " & PROP() & vbCr & _
VLoan & _
"Jurisdiction: " & County() & vbCr & _
"Deed of Trust Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate & vbCr & _
"Original Loan Amount: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount & vbCr & _
"Beneficiary: " & Forms![foreclosure database screen]!SecuredParty & vbCr & _
liberfolio()



Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.Subject = emailsubject
MyMail.body = emailbody & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailRefundTT()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Refund Transfer Taxes to Client. INV#: " & Forms![BillingMainEdit]!CustomerID
emailbody = "Please refund to Client: " & Format(Forms![BillingMainEdit]!d_transfee, "$###,##0.00") & " the taxes were paid by a settlement company." & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Client: " & Client() & vbCr & _
"Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & _
"Property: " & Forms![foreclosure database screen]!PropAddress & vbCr
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Evangeline.Tubilla@bww-law.com; Lucy.Poblete@bww-law.com"

MyMail.Subject = emailsubject

MyMail.body = emailbody

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function EmailRefundRER()
Dim Vrefundclient
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application

If Forms!BillingMainEdit!refund_rer = 1 Then
Vrefundclient = "$40.00"
ElseIf Forms!BillingMainEdit!refund_rer = 2 Then
Vrefundclient = "$55.00"
ElseIf Forms!BillingMainEdit!refund_rer = 3 Then
Vrefundclient = "$95.00"
End If


emailsubject = "Refund Real Estate Recording to Client. INV#: " & Forms![BillingMainEdit]!CustomerID
emailbody = "Please refund to Client: " & Vrefundclient & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Client: " & Client() & vbCr & _
"Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Borrower: " & Forms![foreclosure database screen]!LastNameDebtor1 & vbCr & _
"Property: " & Forms![foreclosure database screen]!PropAddress & vbCr
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Evangeline.Tubilla@bww-law.com; Lucy.Poblete@bww-law.com"

MyMail.Subject = emailsubject

MyMail.body = emailbody

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function EmailRefundRET()

Dim rsDR As RecordSet
Dim RDMd
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

RDMd = ""
Set rsDR = CurrentDb.OpenRecordset("QryPaidRefund")

If rsDR.EOF Then
rsDR.Close
Else

Do While Not rsDR.EOF
RDMd = RDMd + "BWW#: " & rsDR!filenum & vbCr & "Inv#: " & rsDR!CustomerID & vbCr & rsDR!Client & vbCr & "Loan#: " & rsDR!Loan_No & vbCr & "Real Estate Taxes: " & rsDR!d_realestatetaxes & vbCr & vbCr
rsDR.MoveNext
Loop
rsDR.Close
Set MyOutlook = New Outlook.Application
emailsubject = "Refund Real Estate Taxes to Client"
emailbody = "Please refund to Client: " & vbCr & vbCr & RDMd
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Evangeline.Tubilla@bww-law.com; Lucy.Poblete@bww-law.com"

MyMail.Subject = emailsubject
MyMail.body = emailbody

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End If

End Function
Public Function EmailBatchNo()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

Set MyOutlook = New Outlook.Application


emailsubject = "Batch# for Invoice#: " & Forms![BillingMainEdit]!CustomerID
emailbody = "Batch number needed for Invoice#: " & Forms![BillingMainEdit]!CustomerID


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Noemi.Pena@bww-law.com"
MyMail.Subject = emailsubject

MyMail.body = emailbody + SigEmail()

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function EmailNewTrakBillInfo()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String

'Set MyOutlook = New Outlook.Application
'emailsubject = "New Trak Invoice #: " & Forms![billingmainedit]!CustomerID


MsgBox ("Please be advised that we are waiting for funds to record deed, submitted to new invoice on " & [Forms]![billingmain]![BillingSubForm].[Form]![billingdate] & ", Invoice # " & [Forms]![billingmain]![BillingSubForm].[Form]![CustomerID] & " in the amount of " & Format([Forms]![billingmain]![BillingSubForm].[Form]![balance due], "$#,##0.00") & ", please allow approximately four weeks for payment, follow up monthly until the check arrives. Follow up scheduled for " & Date + 30 & ".")

'Set MyMail = MyOutlook.CreateItem(olMailItem)
'MyMail.To = ""
'MyMail.Subject = emailsubject
'MyMail.Body = emailbody + SigEmail()
'MyMail.Display
'Set MyMail = Nothing
'Set MyOutlook = Nothing

End Function

Public Function BillTrackingFC()
 

CurrentDb.Execute "DELETE * FROM tempbilltracking;", dbFailOnError
DoCmd.OpenQuery ("BillTrackingFC2nd")
DoCmd.OpenQuery ("BillTrackingFC4th")
DoCmd.OpenQuery ("BillTrackingFCPostsale")

DoCmd.OpenReport ("Bill Tracking FC MD"), acViewPreview

End Function

Public Function BillTrackingBK()
 



CurrentDb.Execute "DELETE * FROM tempbilltrackingbk;", dbFailOnError
DoCmd.OpenQuery ("BillTrackingBK2nd")
DoCmd.OpenQuery ("BillTrackingbk3rd")

DoCmd.OpenReport ("Bill Tracking BK Report"), acViewPreview

End Function

Public Function EmailWithdrawBond()


GSubject = debtorsFORE() & ", Loan #: " & Forms![foreclosure database screen]!ClientRefNumber
gRecipients = "Robert.Johnson@bww-law.com"

gBody = "Can you Please Withdraw the Bond" & SigEmail()
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""


Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)


End Function
Public Function EmailSetSpecial()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

Dim VRDate As Date
If IsNull(Forms![foreclosure database screen]!resume_recd) Then
VRDate = Format(Forms![foreclosure database screen]![Date Recieved], "mmm dd, yyy")
Else
VRDate = Format(Forms![foreclosure database screen]![resume_recd], "mmm dd, yyy")
End If

MyMail.Subject = "Set Sale Date"
MyMail.body = "Please just e-mail me the info when asked to set the non-cooper sales." _
& vbCr & "Client: " & Forms![foreclosure database screen]!Client _
& vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum _
& vbCr & "Date Received: " & VRDate _
& vbCr & "Debtors: " & debtorsFORE() _
& vbCr & "Street Address: " & PROP() _
& vbCr & "County: " & County() & SigEmail()

MyMail.Display


Set MyMail = Nothing
Set MyOutlook = Nothing

End Function

Public Function EmailCitiInvoices()
DoCmd.OutputTo acOutputReport, "Billing-Aged Receivables Citifinancial Report", acFormatRTF, pathuser() & "\BillingAgedReceivablesHanover" & Format$(Now(), "mmyyyy") & ".rtf"
DoCmd.OutputTo acOutputReport, "Billing-Aged Receivables Citifinancial Dallas", acFormatRTF, pathuser() & "\BillingAgedReceivablesDallas" & Format$(Now(), "mmyyyy") & ".rtf"

gRecipients = "Evangeline.Tubilla@bww-law.com; Howie.Bierman@bww-law.com; ccurley@bozmangroup.com"
GSubject = "Citifinancial Outstanding Invoice Reports"
gBody = "Attached Please find Outstanding Bill Reports." & SigEmail()

gAttachment1 = pathuser() & "\BillingAgedReceivablesDallas"
gAttachment2 = pathuser() & "\BillingAgedReceivablesHanover"
gAttachment3 = ""
gattachment4 = ""
gCCRecipients = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function
Public Function EmailPrtUTClaim()

Dim vEmailPrt As String

While vEmailPrt <> "1" And vEmailPrt <> "2"

vEmailPrt = InputBox("1.  Email: will make RTF file for both Report and Letter to attach to Email." & vbCr & "2.  Print: you must print report normally and Letter will follow" & vbCr & vbCr & "Enter 1 or 2")
If vEmailPrt = "1" Then
MsgBox ("The Letter will print UnclaimedTitleLtr.RTF file to your c:\4closure Directory.  " & vbCr & "The Report will print to your screen and you must Export to an RTF file (click File/Export/. " & vbCr & "To email to Title Company just attach and send")

DoCmd.OutputTo acOutputReport, "Unresolved Report Letter", acFormatRTF, pathuser() & "\UnclaimedTitleLtr.rtf"
'DoCmd.OutputTo acOutputReport, "Unresolved Title Claim (Status/Follow Up) Report", acFormatRTF, pathuser() & "\UnclaimedTitleRPT.rtf"
ElseIf vEmailPrt = "2" Then
'DoCmd.OpenReport ("Unresolved Title Claim (Status/Follow Up) Report")
DoCmd.OpenReport ("Unresolved Report Letter"), acViewPreview
ElseIf vEmailPrt <> "2" Or vEmailPrt <> "1" Then
MsgBox (vEmailPrt & " is not correct input, please try again")
End If

Wend

End Function

Public Function PriorTitle()
'Dim vPT As String
'vPT = MsgBox("Was the prior title ordered within 6 months?", vbYesNo)
'If vPT = vbYes Then
'PriorTitle = "PLEASE RUN A RUN-DOWN TITLE SEARCH ONLY"
'Else
'PriorTitle = "PLEASE RUN A 2 OWNER-BACK TITLE SEARCH"
'End If

End Function
Public Function EmailOcwenSP()
If Forms![foreclosure database screen]!Status = "Foreclosure" _
And Client() Like "Ocwen*" Then

Dim Email, emailsubject, EM1, EM2, emailmessage, emailto As String
Dim VRDate
If IsNull(Forms![foreclosure database screen]!resume_recd) Or Forms![foreclosure database screen]!resume_recd = "" Then
VRDate = Format(Forms![foreclosure database screen]![Date Recieved], "mmm dd, yyy")
Else
VRDate = Format(Forms![foreclosure database screen]![resume_recd], "mmm dd, yyy")
End If

Email = MsgBox("Email to Ocwen re: Secured Party", vbYesNo)
If Email = vbYes Then
emailsubject = "BWW#: " & Forms![foreclosure database screen]!filenum & " / " & Forms![foreclosure database screen]!LastNameDebtor1
EM1 = "According to the investor list previously provided to our office, the secured party on the above referenced loan is "
EM2 = LSecured() & ".  Please notify us if this is not correct.   Also, please advise if any payments have been posted to the above referenced account since " & VRDate & ".  Thank You,"
emailmessage = EM1 + EM2

If Forms![foreclosure database screen]![PropertyState] = "DC" Then
emailto = "avishwas@ocwen.com"
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
emailto = "bww-md@ocwen.com"
ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then
emailto = "SAlyal@ocwen.co.in"
End If

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

MyMail.To = emailto
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing

End If
End If
End Function

Public Function EmailSale()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim EM1 As String
Dim EM2 As String
Dim EM3, em4, em5 As String

If Forms![foreclosure database screen]![PropertyState] = "MD" Then

Dim varsendemail As String
varsendemail = MsgBox("Sending Email to Client, Continue?", vbYesNo)

If varsendemail = vbYes Then

Dim First_LGL As Date
Dim VDocket
Dim rs As RecordSet
Dim strsql As String
strsql = "select * from fctracking where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not IsNull(rs!final_docket_filed) Then
VDocket = rs!final_docket_filed
ElseIf Not IsNull(rs!pre_docket_filed) Then
VDocket = rs!pre_docket_filed
ElseIf Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1ST Legal]) Then
VDocket = Forms![foreclosure database screen]!ForeclosureSubForm.Form![1ST Legal]
Else
VDocket = ""
End If
rs.Close


emailsubject = "Sale Date Set for: " & Forms![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] & " / " & Forms![foreclosure database screen]!LastNameDebtor1
EM1 = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & "Address: " & PROP() & vbCr & "Jurisdiction: " & Forms![foreclosure database screen]!Propertycounty & vbCr
'EM2 = "Please be advised that the foreclosure sale date has been scheduled for " & Forms![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] & "; service was completed on " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![service_complete], "mm/dd/yy")
EM2 = "Please be advised that the service was completed on " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].[Form]![service_complete], "mmmm dd, yyyy") & " and the first advertisement is scheduled on : " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![1st_ad], "mmmm dd, yyyy") & ", and the foreclosure sale date is scheduled for: " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![SaleDate], "mm/dd/yy")
EM3 = "  Please provide your bidding instructions prior to the foreclosure sale date." & _
vbCr & vbCr & "BWW#: " & Forms![foreclosure database screen]!filenum & _
vbCr & "Referral Recd: " & Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd, yyyy") & _
vbCr & "Resume Rec'd: " & Forms![foreclosure database screen]!resume_recd & _
vbCr & "Title Rec'd: " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!TitleReportRecieved, "mmmm dd, yyyy") & _
vbCr & "Title Update Rec'd: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!update_recd & _
vbCr & "Docket Date: " & VDocket & _
vbCr & "Service Complete: " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!service_complete, "mmmm dd, yyyy") & vbCr

If Client() Like "Ocwen*" Then
em4 = vbCr & vbCr & "According to the investor list previously provided to our office, the secured party on the above referenced loan is "
em5 = LSecured() & ".  Please notify us if this is not correct.   Also, please advise if any payments have been posted to the above referenced account since " & Format(Forms![foreclosure database screen]![Date Recieved], "mmm dd, yyyy") & ".  Thank You,"
emailmessage = EM1 + EM2 + EM3 + em4 + em5
ElseIf Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
em4 = vbCr & vbCr & "Please note that I am unable to view the publication date, therefore I am not sure if the dates were accepted into BPI or not.  For all dates that were not accepted same will need to be updated from your end."
emailmessage = EM1 + EM2 + EM3 + em4
Else
emailmessage = EM1 + EM2 + EM3
End If

Dim from, varemailto As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


If Forms![foreclosure database screen]!Client = "Bayview Loan Servicing, LLC (BLS)" Then
MyMail.To = "Michaelparrish@bayviewloanservicing.com"
'MyMail.CC = "Lucinda.Shepard@bww-law.com"
ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
MyMail.To = "bww-md@ocwen.com"
ElseIf Forms![foreclosure database screen]!Client Like "First National Servic*" Then
MyMail.To = "jheightchew@fnba.com"
MyMail.CC = "pratima.lele@bww-law.com"
ElseIf Forms![foreclosure database screen]!Client Like "Aegis*" Then
MyMail.To = "Matthew.Kennedy@aegismtg.com"
MyMail.CC = "pratima.lele@bww-law.com"
ElseIf Forms![foreclosure database screen]!Client Like "GRP*" Then
MyMail.To = "jknyper@grpfs.com; Jdisilvio@grpfs.com"
MyMail.CC = "pratima.lele@bww-law.com"
ElseIf Forms![foreclosure database screen]!Client Like "Security National*" Then
MyMail.To = "appaters@snsc.com"
MyMail.CC = "pratima.lele@bww-law.com"
ElseIf Forms![foreclosure database screen]!Client Like "Nationwide Advantage*" Then
Dim VInt As Integer
VInt = Right(Forms![foreclosure database screen]!ClientRefNumber, 2)
If VInt >= 1 And VInt <= 50 Then
MyMail.To = "CookM7@Nationwide.com"
Else
MyMail.To = "SIMPSOD5@Nationwide.com"
End If
MyMail.CC = "pratima.lele@bww-law.com"
'ElseIf IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!CW_Contact) Then
'MyMail.To = ""
'MyMail.CC = "pratima.lele@bww-law.com"
'Else
'MyMail.To = Forms![foreclosure database screen]!ForeclosureSubForm.Form!CW_Contact
'MyMail.CC = "pratima.lele@bww-law.com"
End If

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
MyMail.CC = "pratima.lele@bww-law.com"
End If

MyMail.Subject = emailsubject

MyMail.body = emailmessage + SigEmail()

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing


End If

End If

End Function

Public Function EmailProbate()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim strsql As String
Dim rs As RecordSet
Dim VBor
Dim VDD
Dim VLR

strsql = "select * from estate where subfilenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then
VBor = rs!Deceased_Borrower
VDD = rs!datedeath
VLR = rs!statedeath
Else
VBor = ""
VDD = ""
VLR = ""
End If

rs.Close

Set MyOutlook = New Outlook.Application

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "New Probate Referral: BWW#: " & Forms![foreclosure database screen]![filenum] & "/" & PROP()

MyMail.body = "A personal representative needs to be assigned for the above referenced property.  Please confirm receipt" & vbCr & vbCr & _
"Order information: " & vbCr & vbCr & VBor & vbCr & _
"D.O.D.: " & VDD & vbCr & _
"Last Place of Residence: " & VLR & vbCr & _
"Loan Servicer Name: " & Forms![foreclosure database screen]!Client & vbCr & vbCr & SigEmail()

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing
End Function




Public Function EmailGRRent()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, VGrRent As String

Set MyOutlook = New Outlook.Application

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent) Or Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent = 0 Then
VGrRent = Format(InputBox("There is no Ground Rent input.  Enter Ground Rent and Screen will update"), "$###,##0.00")
Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent = VGrRent
Else
VGrRent = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent, "$###,##0.00")
End If


emailsubject = debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]![filenum] & vbCr & "Client: " & Forms![foreclosure database screen]![Client] & vbCr & "Property: " & Forms![foreclosure database screen]![PropAddress] & vbCr & "Sale Date: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Add Ground Rent to Ad"
MyMail.body = "Please add Subject to Annual Ground Rent of " & VGrRent & " to Ad" & vbCr & vbCr & emailsubject & SigEmail()

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailIRSDelay()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

emailsubject = debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]![filenum] & vbCr & "Client: " & Forms![foreclosure database screen]![Client] & vbCr & "Property: " & Forms![foreclosure database screen]![PropAddress]


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "IRS DELAY"

MyMail.body = emailsubject & vbCr & vbCr & "We have just received the title report which shows an IRS lien on the property.  We have canceled the sale to give sufficient time to notify the IRS.  Please carve out time for this delay." & vbCr & vbCr & "Thank you for your attention to this matter." & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailBorrowerDeceased()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

emailsubject = debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]![filenum] & vbCr & "Client: " & Forms![foreclosure database screen]![Client] & vbCr & "Property: " & Forms![foreclosure database screen]![PropAddress]


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Borrower Deceased"

MyMail.body = emailsubject + vbCr & vbCr + "Borrower is deceased and there has been (NO) Personal Representative (PR) appointed to the property.  A (PR) must be appointed to the estate in order for us to foreclose on the property." & vbCr & vbCr & "Please note that we have canceled the foreclosure action and will be able to proceed once the (PR) has been appointed." & vbCr & vbCr & "Please carve out time for this delay." & SigEmail()

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailMortInfo()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

emailsubject = debtorsFORE() & vbCr & "BWW#: " & Forms![foreclosure database screen]![filenum] & vbCr & "Client: " & Forms![foreclosure database screen]![Client] & vbCr & "Property: " & Forms![foreclosure database screen]![PropAddress]

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "Mortgage Not Deed of Trust"

MyMail.body = emailsubject & vbCr & vbCr & "This is a Mortgage not a Deed of Trust and in order to proceed with the foreclosure we must file a petition which is forwarded to the court to review and sign giving us permission to foreclose on the property.  Until the court signs the decree we are unable to set a sale date.  Please carve out time for this delay." & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function EmailReqSeniorLien()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailmessage, VLoanAmt, Vprompt As String
Dim VarParaLegal, strPL, sig1, vtitle  As String
Dim rsPL As RecordSet


Set MyOutlook = New Outlook.Application

emailmessage = "According to the referral received/title, this is a 2nd lien; please provide us with the Senior Lien information on this account so that we may request the payoff figures in a timely manner.  If you have their balance due information, that would be great, Otherwise, please provide the name /phone number and loan number for the senior lien.  We would like to announce at the foreclosure sale that this property will be sold subject to the 1st."

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = debtorsFORE() & ", Loan#: " & Forms![foreclosure database screen]!ClientRefNumber
MyMail.body = emailmessage + SigEmail()


MyMail.Display


Set MyMail = Nothing
End Function
Public Function EmailPostSales()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailmessage, VNextSaleDate, signature As String
Dim Vtotal, vCurrentFC, VAntiFC As Currency
Dim VState

If Forms![foreclosure database screen]!PropertyState = "MD" Then
VState = "Maryland"
ElseIf Forms![foreclosure database screen]!PropertyState = "VA" Then
VState = "Virginia"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VState = "District of Columbia"
Else
VState = Forms![foreclosure database screen]!PropertyState
End If


Set MyOutlook = New Outlook.Application


Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
MyMail.Subject = debtorsFORE()
emailmessage = "We are in receipt of instructions advising our firm to postpone the pending sale for loan number " & Forms![foreclosure database screen]!ClientRefNumber & " and re-set to a later date.  Please note that if our firm re-sets the foreclosure sale date then additional legal fees and costs would be due since " & VState & " is considered a re-start state and we cannot postpone the sale. We must update title, re-advertise and send new statutory notices.  The costs to re-set the sale are roughly the same as the original sale." _
& vbCr & vbCr & "However, if our firm places the file on hold pending resolution, no ADDITIONAL fees and costs would be incurred.  If the borrower fails to resolve the issue, then our office would need authorization to proceed and a new sale date would be set immediately." _
& vbCr & vbCr & "Please advise if you would like our office to place the file on hold OR if you would like us to immediately schedule a new sale date.  Next available date will be approximately 30 days out." & signature

Else
MyMail.Subject = debtorsFORE() & ", Loan#: " & Forms![foreclosure database screen]!ClientRefNumber

If Forms![foreclosure database screen]!PropertyState = "MD" Then
emailmessage = "We are in receipt of instructions advising our firm to postpone the pending sale and re-set to a later date.  Please note that MD is a restart state and the courts do not allow postponements.  We will have to cancel and restart.  In order to cancel and restart, please approve our restart fee in the amount of $950.00 as we must update title, re-advertise and send new statutory notices." & _
vbCr & vbCr & "However, if our firm places the file on hold pending resolution, no ADDITIONAL fees and costs would be incurred.  If the borrower fails to resolve the issue, then our office would need authorization to proceed and restart the foreclosure process and schedule a new sale date approximately 30 days from the date of notification." & _
vbCr & vbCr & "Please advise if you would like our office to immediately restart now and incur new fees and costs or whether we should place on hold pending further instructions.  The costs to re-set the sale are roughly the same as the original sale.  Next available date will be approximately 30 days out.  Please advise our office as soon as possible as we are not taking any action at this time." & signature
Else
emailmessage = "We are in receipt of instructions advising our firm to postpone the pending sale and re-set to a later date.  Please note that if our firm re-sets the foreclosure sale date then additional legal fees and costs would be due since " & VState & " is considered a re-start state and we cannot postpone the sale. We must update title, re-advertise and send new statutory notices.  The costs to re-set the sale are roughly the same as the original sale." _
& vbCr & vbCr & "However, if our firm places the file on hold pending resolution, no ADDITIONAL fees and costs would be incurred.  If the borrower fails to resolve the issue, then our office would need authorization to proceed and a new sale date would be set immediately." _
& vbCr & vbCr & "Please advise if you would like our firm to place the file on hold OR if you would like us to immediately schedule a new sale date.  Next available date will be approximately 30 days out." & signature
End If

End If

MyMail.body = emailmessage + SigEmail()
MyMail.Display


Set MyMail = Nothing
End Function

Public Function EmailCltJr()


Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim strsqlClient, emailmessage, VLoanAmt, Vprompt, signature As String
Dim rsClient, rsPL As RecordSet
Dim FrmName As String
FrmName = AppType
Dim VTo As String
Dim VVa



Set MyOutlook = New Outlook.Application


strsqlClient = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!ForeclosureSubForm.Form!Client_Jr_Name & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!Client_Jr_Name) Then
Vprompt = InputBox("A review of title show that______________ may hold the 2nd mortgage.....")
Else
Vprompt = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Client_Jr_Name
End If

If Vprompt Like "Citi*" And Forms![foreclosure database screen]!Client <> "CitiMortgage, Inc." Then

emailmessage = "Please be advised that a search of title reveals that CitiMortgage, Inc. may be servicing the 2nd mortgage on the above property.  Please let us know if you will waive this conflict of interest." & vbCr & _
"Please be advised that if you want to protect your interest at this sale, you should obtain other counsel to do so, as our office will not be able to represent you.  Of course, we will accommodate you or your counsel and provide any necessary information so you can assess your exposure.  Please feel free to call us should you need any further information."

Else

emailmessage = "Please be advised that a search of title reveals that " & Vprompt & " may be servicing the 2nd mortgage on the above property." & vbCr & _
"Please be advised that if you want to protect your interest at this sale, you should obtain other counsel to do so, as our office will not be able to represent you.  Of course, we will accommodate you or your counsel and provide any necessary information so you can assess your exposure.  Please feel free to call us should you need any further information."

End If


Set MyMail = MyOutlook.CreateItem(olMailItem)
VTo = ""
If Not rsClient.EOF Then
If Not IsNull(rsClient!jrlien1_email) Then
VTo = rsClient!jrlien1_email
End If
If Not IsNull(rsClient!jrlien2_email) Then
VTo = VTo + "; " + rsClient!jrlien2_email
End If
If Not IsNull(rsClient!jrlien3_email) Then
VTo = VTo + "; " + rsClient!jrlien3_email
End If
If Not IsNull(rsClient!jrlien4_email) Then
VTo = VTo + "; " + rsClient!jrlien4_email
End If
End If

MyMail.To = VTo

If Vprompt Like "Citi*" And Forms![foreclosure database screen]!Client <> "CitiMortgage, Inc." Then
If BrowseTitle() <> "" Then
MyMail.Attachments.ADD BrowseTitle()
End If
End If


MyMail.Subject = "Sale Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & ", " & debtorsFORE() & ", Property: " & PropertyAddress()
MyMail.body = emailmessage + SigEmail()
MyMail.Display
rsClient.Close





Set MyMail = Nothing

Set MyOutlook = Nothing



End Function
Public Function emailblankDM()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
emailsubject = debtorsFORE()
Else
emailsubject = debtorsFORE() & " BWW#: " & Forms![foreclosure database screen]![filenum]
End If

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "dmorgan@alexcooper.com"
MyMail.Subject = emailsubject
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
MyMail.body = "LOAN#: " & Forms![foreclosure database screen]![ClientRefNumber] & SigEmail()

End If

MyMail.Display


End Function

Public Function EmailBLANKTE()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String
Dim FrmName As String

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


MyMail.body = "LOAN#: " & Forms![titleform]![ClientRefNumber] & SigEmail()
emailsubject = "BWW#: " & Forms![titleform]!filenum & " : " & debtorsFORETExam()
MyMail.Subject = emailsubject

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function

Public Function EmailBLANKFC()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String
Dim FrmName As String

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


emailsubject = "BWW#: " & Forms![FeesCosts]!filenum & "/ Borrower(s): " & Forms!FeesCosts!LastNameDebtor1



MyMail.Subject = emailsubject
MyMail.body = "Client: " & Forms!FeesCosts!Client & vbCr & "LOAN#: " & Forms![FeesCosts]![ClientRefNumber] & SigEmail()

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function


Public Function EmailBLANK()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String
Dim FrmName As String

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)


emailsubject = "BWW#: " & Forms![foreclosure database screen]!filenum & "/ Borrower(s): " & debtorsFORE()



MyMail.Subject = emailsubject
MyMail.body = "Client: " & Client() & vbCr & "LOAN#: " & Forms![foreclosure database screen]![ClientRefNumber] & SigEmail()

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function
Public Function DeedReminder()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String
Dim deedassignto  As String: deedassignto = Trim(Nz(DLookup("dprepared_by", "postsale", "[subfilenum]=" & Forms![foreclosure database screen]!filenum), ""))
Dim emailrecipient As String: emailrecipient = _
    IIf(Len(deedassignto) > 0, DLookup("emailname", "employees", "[employeeid]=" & """" & deedassignto & """"), "")

'MsgBox emailrecipient: Exit Function

Set MyOutlook = New Outlook.Application

emailsubject = "Deed Reminder: BWW#" & Forms![foreclosure database screen]!filenum & ", Borrower: " & Forms![foreclosure database screen]!LastNameDebtor1 & ", Sale Date: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
If Forms![foreclosure database screen]!PropertyState = "MD" Then
'MyMail.To = "seth.berman@bww-law.com;kathy.lin@bww-law.com;brandon.thomas@bww-law.com;Carlene.assing@bww-law.com; Melissa.Beahm@bww-law.com;"
MyMail.To = emailrecipient
Else
MyMail.To = "Abegail.Saliente@bww-law.com; Monica.Lee@bww-law.com"
End If

MyMail.body = "Please forward the Trustees' Deed to record at your earliest convenience."

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function BillReminder()

Dim emailsubject As String
Dim emailmessage As String
Dim varsendemail, varappend As String
Dim MyMail As Outlook.MailItem
Dim MyOutlook As Outlook.Application

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

emailsubject = "Bill Reminder: BWW#" & Forms![foreclosure database screen]!filenum & ", Borrower: " & Forms![foreclosure database screen]!LastNameDebtor1 & ", Ratification Date: " & Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD
emailmessage = "Client: " & Client() & vbCr & "Property: " & PROP() & vbCr & "County: " & Forms![foreclosure database screen]!Propertycounty & vbCr & vbCr & "Please review this case and prepare an invoice for all recording costs" + SigEmail()


If Forms![foreclosure database screen]!PropertyState <> "MD" Then
MyMail.To = "Adriana.Maldonado@bww-law.com; Brandin.Jordon@bww-law.com; Sasha.Wharton@bww-law.com"
Else
MyMail.To = "Derick.Long@bww-law.com; Seth.Berman@bww-law.com; Kathy.Lin@bww-law.com"
End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function
Public Function EmailChkReqTI()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

VConvRpt = "VATitleInsuranceChkReq"
Call ConvertPDFALL


Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "VA Title Insurance Check Request Email " & Date
MyMail.To = "Lucy.Poblete@bww-law.com"
MyMail.Attachments.ADD pathuser() & "\VATitleInsuranceChkReq.PDF"

MyMail.body = "See attached Report"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function

Public Function EmailChkReq()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application

VConvRpt = "VACheckReq"
Call ConvertPDFALL

'DoCmd.OutputTo acOutputReport, "VACheckReq", acFormatSNP, pathuser() & "\VACheckReq.snp"

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = "VA Check Request Email " & Date
MyMail.To = "Lucy.Poblete@bww-law.com"
MyMail.Attachments.ADD pathuser() & "\VACheckReq.PDF"

MyMail.body = "See attached Report"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End Function
Public Function EmailChkReqDC()

Dim emailsubject As String

DoCmd.OutputTo acOutputReport, "DCCheckReq", acFormatSNP, pathuser() & "\DCCheckReq.snp"

GSubject = "DC Check Request Email " & Date
gRecipients = "Lucy.Poblete@bww-law.com"
gAttachment1 = pathuser() & "\DCCheckReq.snp"
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""
gBody = "See attached Report"
gCCRecipients = ""

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function
Public Function UrgentCCDOT()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, VReferral, E1, E2, E3, e4, e5 As String

Set MyOutlook = New Outlook.Application
Dim VRun As String
If Forms![foreclosure database screen]!Status <> "Foreclosure" Then
VRun = MsgBox("File is not in Foreclosure status this email is suppose to run only for Foreclosure files, continue?", vbYesNo)

If VRun = vbNo Then
Exit Function

Else

emailsubject = "URGENT REQUEST FOR CERTIFIED COPY OF DEED OF TRUST" & ", BORROWERS: " & debtorsFORE()

If IsNull(Forms![foreclosure database screen]!resume_recd) Then
VReferral = Forms![foreclosure database screen]![Date Recieved]
Else
VReferral = Forms![foreclosure database screen]![resume_recd]
End If

Set MyMail = MyOutlook.CreateItem(olMailItem)
If Client() Like "Bank of Am*" Then
MyMail.To = "Raslin_Hooker@bankofamerica.com"
End If

MyMail.CC = "Lucinda.Shepard@bww-law.com"

MyMail.Subject = emailsubject

E1 = "LOAN#: " & Forms![foreclosure database screen]![ClientRefNumber] & vbCr & vbCr
E2 = "We received the above referenced account on " & VReferral & " and we are still waiting for the certified copy of the DOT in order to docket the case.  "
E3 = "We are in need of this certified by tomorrow " & Date + 1 & " in order to keep the sale set for " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate & ".  "
e4 = "Can you please let me know if your abstractor will be able to have it to us by tomorrow.  If not, do you want us to have our abstractor pull the cert and bill in order to keep the sale date "
e5 = "because the 1st ad runs on " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![1st_ad] & "?  Thanks for your help with this urgent matter."

MyMail.body = E1 + E2 + E3 + e4 + e5 & SigEmail()



MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End If

End If

End Function
Public Function Email4close2nd()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject As String

Set MyOutlook = New Outlook.Application
Dim VFirst, emailbody

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!Client_Jr_Name) Then
VFirst = InputBox("WHO HOLDS FIRST?")
Else
VFirst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Client_Jr_Name
End If

emailbody = "Please be advised that this office represents " _
& "the second lien holder in reference to the above referenced matter and according " _
& "to our title work, " & VFirst & " may hold the 1st.  Kindly provide our office with " _
& "a PAYOFF STATEMENT GOOD THROUGH OUR FORECLOSURE, SALE DATE OF " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate & " ALONG " _
& "WITH YOUR PER DIEM RATE OF INTEREST to my attention as soon as possible via telecopier " _
& "at 775-458-5593.  Please note, that since we are the junior lien holder, by law " _
& "we are entitled to a payoff without the consent of the mortgagors and this amount " _
& "is needed to announce at the foreclosure sale and inasmuch as we do not " _
& "represent " & VFirst & " I am unable to provide you with your loan number." & vbCr & vbCr & "Borrower(s): " & debtorsFORE() & vbCr & "Property: " & PROP()


emailsubject = debtorsFORE() & " BWW#: " & Forms![foreclosure database screen]![filenum]
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
MyMail.body = emailbody & SigEmail()


MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing
End Function
Public Function SendEmailCasesToCourt()
Dim strsql, varDocket, VarClient As String
Dim varDocsToCourt As String
Dim rs As RecordSet
Dim emailsubject, emailmessage, varborrower, E1, E2, E3, e4 As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
varDocsToCourt = InputBox("Enter Docket Date")
varDocket = InputBox("Docket as of What Date")
VarClient = InputBox("Enter Client")

strsql = "Select cases.lastnamedebtor1, cases.resume_recd, cases.typeofloan, cases.clientrefnumber, cases.propertystate, " & _
" cases.client, jurisdiction.fees_costs, foreclosure.noi_sent, foreclosure.TitleReportRecieved, foreclosure.update_recd, foreclosure.[1st_ad], foreclosure.saledate, cases.[date recieved], cases.propertycounty, foreclosure.docssentcourt " & _
" from ((Cases inner join foreclosure on cases.filenum = foreclosure.subfilenum) " & _
" INNER JOIN jurisdiction ON (Cases.PropertyState = jurisdiction.State) " & _
" AND (Cases.PropertyCounty = jurisdiction.County))" & _
" where cases.client like " & """" & VarClient & "*""" & " and cases.propertystate = " & """" & "MD" & """" & " and " & _
" cases.status = " & """" & "Foreclosure" & """" & " and ((foreclosure.[docssentcourt]= #" & varDocsToCourt & "#" & "))" & _
" ORDER BY foreclosure.saledate, CASES.LASTNAMEDEBTOR1;"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim vNOI

If VarClient Like "Bank of Am*" Then
Do Until rs.EOF
emailmessage = rs!LastNameDebtor1 & " - " & rs!ClientRefNumber & " - Type of Loan: " & rs!TypeOfLoan & vbCr _
& "Docket Date: " & varDocket & vbCr _
& "********************************" & vbCr & vbCr + emailmessage
rs.MoveNext
Loop
Else
Do Until rs.EOF
If rs!Client Like "suntrust*" Then
vNOI = "NOI Sent: " & Format(rs!noi_sent, "mmmm dd, yyyy") & vbCr & "NOI Expires: " & Format(rs!noi_sent + 45, "mmmm dd, yyyy") & vbCr
Else
vNOI = ""
End If

emailmessage = emailmessage + rs!LastNameDebtor1 & " - " & rs!ClientRefNumber & " - " & rs!Propertycounty & vbCr _
& "Type of Loan: " & rs!TypeOfLoan & vbCr _
& "Referral Rec'd: " & Format(rs![Date Recieved], "mmmm dd, yyyy") & vbCr _
& "Date Reset: " & Format(rs!resume_recd, "mmmm dd, yyyy") & vbCr _
& "Title Rec'd: " & Format(rs!TitleReportRecieved, "mmmm dd, yyyy") & vbCr _
& "Title Update Rec'd: " & Format(rs!update_recd, "mmmm dd, yyyy") & vbCr _
& "Docket Date: " & varDocket & vbCr & vNOI & vbCr
'& "Estimated Fees/Costs: " & Format(rs!fees_costs, "$###,##0.00") & vbcr _
& "********************************" & vbcr & vbcr + emailmessage
rs.MoveNext
Loop
End If


emailsubject = "CONFIRMED DOCKETS"
Set MyMail = MyOutlook.CreateItem(olMailItem)
If VarClient Like "Ocwen*" Then
MyMail.To = "bww-md@ocwen.com"
ElseIf VarClient Like "Bayview*" Then
MyMail.To = "Michaelparrish@bayviewloanservicing.com"
End If
MyMail.Subject = emailsubject
MyMail.body = emailmessage & SigEmail()

MyMail.Display


Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function EmailSeniorLien() As String

Dim messagebox As String
Dim emailsubject As String
Dim emailmessage As String
Dim EM1, emailCC As String
Dim EM2 As String
Dim EM3 As String
Dim em4 As String
Dim holder As String
Dim strsql As String
Dim rs As RecordSet
Dim SOD As String
Dim strsqlAff  As String
Dim rsPL, rsAff As RecordSet

strsql = "select * from foreclosure where subfilenum = " & Forms![foreclosure database screen]![filenum] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


strsqlAff = "select * from affdebt where subfilenum = " & Forms![foreclosure database screen]![filenum] & ";"
Set rsAff = CurrentDb.OpenRecordset(strsqlAff, dbOpenSnapshot)



If IsNull(SOD) Then
MsgBox "There is No Information on the Affidavit of Debt Screen, this will leave the Statement of Debt figure blank", vbOKOnly
SOD = ""
Else
SOD = Format(rs![Principal Balance] + rsAff![interest amt] + rsAff![Late charge] + rsAff![lender advance] + rsAff![interest on advance] + rsAff![nsf charge] + rsAff![foreb] + rsAff![escbal] + rsAff![miscm1] + rsAff![miscm2] + rsAff![Mism3] + rsAff![Mism4] + rsAff![Rec_bal], "$###,##0.00")
End If

holder = InputBox("Holder of Deed of Trust")

emailsubject = "Sr. Lien Sale - " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![SaleDate] & " - " & PropertyAddress()

EM1 = "Please be advised that the Senior Lien Holder, " & _
Forms![foreclosure database screen]!Client & _
", has scheduled a foreclosure sale on the property located at " & PropertyAddress() _
& " on " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![SaleDate] _
& ".  According to our title " & holder & _
" holds the 2nd deed of trust.  Please note our office has sent official" & _
" notice to the address on the deed of trust but we just wanted to give you heads" & _
" up on the sale date a little sooner.   Also, since we do NOT represent " _
& holder & " I am unable to provide your loan number." & vbCr & vbCr

EM2 = debtorsFORE() & vbCr & PropertyAddress() & vbCr + vbCr
EM3 = "Statement of Debt Amount: " & SOD & " g/t " & rsAff![interest thru] & ". (Please note that amount does not represent the official payoff nor does it include our attorney fees and costs)." + vbCr + vbCr
em4 = "Please note that the sale date is " & rs!SaleDate & " and that if " & holder & " fails to bid at the sale (either by our office or other counsel) and the sale goes through then your lien will be extinguished and no longer attach to the property.   If you would like for us to bid on your behalf, please provide your bidding instructions prior to the sale and have the deposit amount of $" & rs!vadeposit & " sent to our office at the address listed below prior to the foreclosure sale."

emailmessage = EM1 + EM2 + EM3 + em4
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
varsendemail = MsgBox("Sending Email, Continue?", vbYesNo)
If varsendemail = vbYes Then
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
MyMail.body = emailmessage + SigEmail()

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing
Else
Exit Function

End If

End Function


Public Function SendEmailFMCBill()

Dim from, varemailto As String
Dim emailsubject, emailmessage, varborrower, E1, E2, E3, e4, e5 As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application

varborrower = Forms![foreclosure database screen]!LastNameDebtor1 & " " & Forms![foreclosure database screen]!FirstNameDebtor1
E1 = "Borrower:" & varborrower
E2 = "Loan #: " & Forms![foreclosure database screen]!ClientRefNumber
E3 = "Address: " & Forms![foreclosure database screen]!PropAddress & ", " & Forms![foreclosure database screen]!PropertyState
e5 = "Part 1 Filed: " & Forms![foreclosure database screen]!ForeclosureSubForm.Form![1ST Legal]
e4 = "ATTENTION!  FMC/MD Please Bill for Attorney Fees, Filing Fees and Appointment of Sub Trustees."
emailmessage = e4 + vbCr + E1 + vbCr + E2 + vbCr + E3 + vbCr & e5
emailsubject = "FMC/MD Part 1 Filed: BWW#: " & Forms![foreclosure database screen]!filenum
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Evangeline.Tubilla@bww-law.com"
MyMail.BCC = "ccurley@bozmangroup.com"
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Send
Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function SB123Email()
Dim vFile
Dim VTo
Dim VFROM
Dim VCCTo
Dim rs As RecordSet
Dim emailsubject
Dim emailmessage
Dim vCounty
Dim f, f2, fs
Dim fldr, VDt, vFName
Dim Val_Open, xlApp
Dim vmessage

Dim strsql

vCounty = InputBox("Enter County")

strsql = "SELECT Cases.PropertyCounty, Cases.FileNum, Cases.Client, Cases.ClientRefNumber, Cases.PropAddress, cases.propzip, cases.propertycity, cases.propertystate, postsale.taxid, Cases.PropertyState, PostSale.sb123_recd " _
& " FROM Cases INNER JOIN (Foreclosure INNER JOIN PostSale ON Foreclosure.SubFileNum = PostSale.SubFileNum) ON Cases.FileNum = Foreclosure.SubFileNum " _
& " WHERE Cases.PropertyCounty Like " & """" & vCounty & "*""" & " And Cases.PropertyState = " & """" & "MD" & """" & " And PostSale.SB123_sent Is Not Null And PostSale.sb123_recd Is Null "

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
rs.MoveFirst

Do While Not rs.EOF

VTo = ""
vCounty = ""
vmessage = ""

Dim sqlcounty
Dim rsCounty As RecordSet
sqlcounty = "select * from jurisdiction where county = " & """" & rs!Propertycounty & """" & ";"
Set rsCounty = CurrentDb.OpenRecordset(sqlcounty, dbOpenSnapshot)
If rsCounty.EOF Then
MsgBox ("County is not in drop down list please check!")
Exit Function
ElseIf Not IsNull(rsCounty!treasurer_email) Then
VTo = rsCounty!treasurer_email
Else
VTo = ""
rsCounty.Close
End If


'Browse for File
vFile = ""
vFName = ""

fldr = GetDocPath(rs!filenum)
vFile = rs!filenum & "_SB123Ltr_*"
Set fs = CreateObject("Scripting.FileSystemObject")
Set f = fs.GetFolder(fldr)
For Each f2 In f.Files
If f2.name Like vFile And f2.DateLastModified > VDt Then
vFName = f2.name
VDt = f2.DateLastModified
End If
Next
If vFName = "" Then
vFile = ""
Else
vFile = fldr & vFName
End If
'End of Browse Code

VFROM = "bgw@bww-law.com"
VCCTo = ""

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = VTo
MyMail.Subject = "BWW#: " & rs!filenum & " Property: " & rs!PropAddress & ", " & rs!PropertyCity & ", " & rs!PropertyState & " " & rs!propzip & " Tax ID#: " & rs!taxid & " County: " & rs!Propertycounty
MyMail.body = "Dear Sir or Madam Supervisor: " & vbCr & vbCr & "Attached please find a copy of letter sent pursuant to SB 123 for which no receipt has been received.  Could you kindly review this letter and confirm that your office has received said notice.  Please fill out the attached receipt which is on the last page of each attachment and return back to our office via  mail, fax or email."

If vFile <> "" Then
MyMail.Attachments.ADD vFile
Else
MsgBox ("No SB letter in Imaged Docs for BWW#: " & rs!filenum)
End If
MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing

rs.MoveNext
Call Wait(10, False)     ' wait 3 second


Loop

Else
MsgBox ("No Files")

End If

End Function
Public Function SendEmailBAC()
Dim from, varemailto As String
Dim emailsubject, emailmessage, varborrower, E1, E2, E3, e4 As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application

varborrower = Forms![foreclosure database screen]!LastNameDebtor1 & " " & Forms![foreclosure database screen]!FirstNameDebtor1
E1 = "Borrower:" & varborrower
E2 = "Loan #: " & Forms![foreclosure database screen]!ClientRefNumber
E3 = "Address: " & Forms![foreclosure database screen]!PropAddress & ", " & Forms![foreclosure database screen]!PropertyState
e4 = "ATTENTION!  A new BAC referral has been received secured by a VA insured loan.  Please be sure to abide by BAC guidelines."
emailmessage = E1 + vbCr + E2 + vbCr + E3 + vbCr + vbCr + e4
emailsubject = "BAC: VA"
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Rachel.Bayard@bww-law.com"
MyMail.BCC = "Carrie.Ward@bww-law.com"
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Send

Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function SendEmailDateAck()
Dim from, varemailto As String
Dim emailsubject, emailmessage, varborrower, E1, E2, E3, e4 As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem



Set MyOutlook = New Outlook.Application

varborrower = Forms![foreclosure database screen]!LastNameDebtor1 & " " & Forms![foreclosure database screen]!FirstNameDebtor1
E1 = "Borrower:" & varborrower
E2 = "Loan #: " & Forms![foreclosure database screen]!ClientRefNumber
E3 = "Address: " & Forms![foreclosure database screen]!PropAddress & ", " & Forms![foreclosure database screen]!PropertyState
e4 = "We have received a letter from the title company acknowledging receipt of the title claim on the above-referenced loan.  This acknowledgment only serves as a notification that the title company will begin its investigation of the claim.  Please note that the title company reserves the right upon investigation to deny the claim. We will provide you with an update when we learn more from the title company."
emailmessage = E1 + vbCr + E2 + vbCr + E3 + vbCr + vbCr + e4
emailsubject = "Title Claim"
Set MyMail = MyOutlook.CreateItem(olMailItem)
'MyMail.To = """"
MyMail.To = "MTorres1@ocwen.com"
MyMail.BCC = """"
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Send

Set MyMail = Nothing

Set MyOutlook = Nothing

End Function
Public Function EmailCooperSales()
Dim strsql, vARDate, varemailto, VarClient, varborrower, VarLoan, VarParaLegal, VarDocsSent As String
Dim emailsubject, emailmessage, E1, E2, E3, e4, e5 As String
Dim rs As RecordSet
vARDate = Date


strsql = "SELECT cases.LastNameDebtor1, cases.firstnamedebtor1, cases.propertystate, " _
& " cases.propertycounty, cases.status, cases.Client, cases.ClientRefNumber, " _
& " Foreclosure.saledate, cases.filenum, cases.status " _
& " FROM cases INNER JOIN Foreclosure ON cases.FileNum = Foreclosure.SubFileNum " _
& " WHERE ((cases.status = " & """" & "Postsale" & """" & " or cases.status = " & """" & "Foreclosure" & """" & ") and cases.propertystate = " & """" & "MD" & """" & " and " _
& " (Foreclosure.[saledate] = #" & vARDate & "#));"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do Until rs.EOF
varemailto = "Rebecca.Delaney@bww-law.com"
If (rs!Propertycounty = "Allegany" _
Or rs!Propertycounty = "Dorchester" _
Or rs!Propertycounty = "Garrett" _
Or rs!Propertycounty = "Somerset" _
Or rs!Propertycounty = "Wicomico" _
Or rs!Propertycounty = "Worcester") Then
varborrower = rs!LastNameDebtor1 & " " & rs!FirstNameDebtor1
VarParaLegal = "Rebecca Delaney"
emailsubject = "***URGENT REPORT SALES RESULTS TO CLIENT TODAY!***"
E1 = "Please Report Sales Results on : " & vbCr & vbCr & "BWW#: " & rs!filenum & vbCr
E2 = "Client: " & rs!Client & " / Loan #: " & rs!ClientRefNumber & vbCr & "Borrower: " & varborrower & vbCr & "County: " & rs!Propertycounty

emailmessage = E1 + E2


gRecipients = varemailto
GSubject = emailsubject
gBody = emailmessage
gCCRecipients = ""
gAttachment1 = ""
gAttachment2 = ""
gAttachment3 = ""
gattachment4 = ""

End If
rs.MoveNext
Loop

Call SendEmail(gRecipients, gCCRecipients, GSubject, gBody, gAttachment1, gAttachment2, gAttachment3, gattachment4)

End Function
Public Function SixtyNotice()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailmessage, VSD
Dim vClient As String
Dim varborrower As String

Set MyOutlook = New Outlook.Application
'VSD = Forms![titleform]!SaleDate - 27
vClient = Forms![titleform]!clientname

varborrower = Forms![titleform]!LastNameDebtor1 & " " & Forms![titleform]!FirstNameDebtor1

emailsubject = "60 Day Notice"
emailmessage = "Please be advised that a 60 Day Notice is needed." & vbCr & vbCr & _
"Client:" & vClient & vbCr & _
"Borrowers:" & varborrower & vbCr & _
"Loan#: " & Forms![titleform]!ClientRefNumber & vbCr & _
"Sale Date: " & Forms!titleform!SaleDate


Set MyMail = MyOutlook.CreateItem(olMailItem)
'If Forms![titleform]!PropertyState = "VA" Then
MyMail.To = "Stephanie.Cothern@bww-law.com; Crystal.Hines@bww-law.com"
'; Michele.Smith@bww-law.com; Maryam.Ndiaye@bww-law.com; Reese.Lesko@bww-law.com"
'Else
'MyMail.To = "Reese.Lesko@bww-law.com"
'End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage & SigEmail()
MyMail.Display


Set MyMail = Nothing
Set MyOutlook = Nothing
End Function

Public Function USGOVTLienNeeded()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailmessage, VSD
Dim vClient As String
Dim varborrower As String

Set MyOutlook = New Outlook.Application
VSD = Forms![titleform]!SaleDate - 27
vClient = Forms![titleform]!clientname

varborrower = Forms![titleform]!LastNameDebtor1 & " " & Forms![titleform]!FirstNameDebtor1

emailsubject = "US Govt Lien"
emailmessage = "Please be advised that an US Govt lien is needed by : " & VSD & "." & vbCr & vbCr & _
"Client:" & vClient & vbCr & _
"Borrowers:" & varborrower & vbCr & _
"Loan#: " & Forms![titleform]!ClientRefNumber & vbCr & _
"Sale Date: " & Forms!titleform!SaleDate


Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms![titleform]!PropertyState = "VA" Then
MyMail.To = "Merlene.Marcano@bww-law.com; Michele.Smith@bww-law.com; Maryam.Ndiaye@bww-law.com; Reese.Lesko@bww-law.com"
Else
MyMail.To = "Reese.Lesko@bww-law.com"
End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage & SigEmail()
MyMail.Display


Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function IRSLienNeeded()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailmessage, VSD, varborrower As String

Set MyOutlook = New Outlook.Application
VSD = Forms![titleform]!SaleDate - 27

varborrower = Forms![titleform]!LastNameDebtor1 & " " & Forms![titleform]!FirstNameDebtor1

emailsubject = "IRS Lien Needed"
emailmessage = "Please be advised that an IRS lien is needed by : " & VSD & "." & vbCr & vbCr & _
"Client:" & Forms![titleform]!clientname & vbCr & _
"Borrowers:" & varborrower & vbCr & _
"Loan#: " & Forms![titleform]!ClientRefNumber & vbCr & _
"Sale Date: " & Forms!titleform!SaleDate


Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms!titleform!PropertyState = "VA" Then
MyMail.To = "Drew.Brown@bww-law.com; Jared.Slater@bww-law.com; Laurie.Welt@bww-law.com; Reese.Lesko@bww-law.com"
Else
MyMail.To = "Reese.Lesko@bww-law.com"
End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage & SigEmail()
MyMail.Display


Set MyMail = Nothing
Set MyOutlook = Nothing
End Function

Public Function IRSLienNeededTE()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailmessage, VSD, varborrower As String

Set MyOutlook = New Outlook.Application
VSD = Forms![titleform]!SaleDate - 27

varborrower = Forms![titleform]!LastNameDebtor1 & " " & Forms![titleform]!FirstNameDebtor1

emailsubject = "IRS Lien Needed"
emailmessage = "Please be advised that an IRS lien is needed by : " & VSD & "." & vbCr & vbCr & _
"Client:" & Forms![titleform]!clientname & vbCr & _
"Borrowers:" & varborrower & vbCr & _
"Loan#: " & Forms![titleform]!ClientRefNumber & vbCr & _
"Sale Date: " & Forms!titleform!SaleDate


Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms!titleform!PropertyState = "VA" Then
MyMail.To = "Drew.Brown@bww-law.com; Jared.Slater@bww-law.com; Laurie.Welt@bww-law.com; Reese.Lesko@bww-law.com"
Else
MyMail.To = "Reese.Lesko@bww-law.com"
End If

MyMail.Subject = emailsubject
MyMail.body = emailmessage & SigEmail()
MyMail.Display


Set MyMail = Nothing
Set MyOutlook = Nothing
End Function

Public Function SendEmailTitleRecd()

Dim db As DAO.Database
Dim MailList As DAO.RecordSet
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim Subjectline As String
Dim BodyFile As String
Dim attachment As String
Dim MyBody As TextStream
Dim MyBodyText As String
Dim strsql, vARDate, varemailto, VarClient, varborrower, VarLoan, VarParaLegal As String
Dim emailsubject, emailmessage, E1, E2, E3, e4, e5, e6 As String
Dim rs As RecordSet

If Forms![foreclosure database screen]!PropertyState = "MD" Then
vARDate = Forms![foreclosure database screen]![ForeclosureSubForm].Form![TitleReportRecieved]
End If
If Forms![foreclosure database screen]!PropertyState = "DC" Then
vARDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form![TitleReportRecieved]
End If
If Forms![foreclosure database screen]!PropertyState = "VA" Then
vARDate = Forms![foreclosure database screen]![ForeclosureSubForm].Form![TitleReportRecieved]
End If

Set MyOutlook = New Outlook.Application
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
varemailto = "Elijha.Marcano@bww-law.com"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
varemailto = "Stefanie.Krzeminski@bww-law.com; Takiya.Adair-Knox@bww-law.com"
ElseIf Forms![foreclosure database screen]![PropertyState] = "VA" Then
varemailto = "Adriana.Maldonado@bww-law.com"

End If

emailsubject = "Title Rec'd"
varborrower = Forms![foreclosure database screen]!LastNameDebtor1 & " " & Forms![foreclosure database screen]!FirstNameDebtor1
E2 = "Client/Borrower:" & Forms![foreclosure database screen]!Client & "/" & varborrower
E3 = "Loan #: " & Forms![foreclosure database screen]!ClientRefNumber
e4 = "Address: " & Forms![foreclosure database screen]!PropAddress & ", " & Forms![foreclosure database screen]!PropertyState
e5 = "Sale Date: " & Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate
E1 = "The following Title was Received on " & vARDate
emailmessage = E1 + vbCr + E2 + vbCr + E3 + vbCr + e4 + vbCr + e5 & vbCr + e6

DoCmd.SendObject acSendNoObject, , , varemailto, , , emailsubject, emailmessage

' MyMail = MyOutlook.CreateItem(olMailItem)
'MyMail.To = VarEmailto
'MyMail.CC = "Lucinda.Shepard@bww-law.com"
'MyMail.Subject = emailsubject
'MyMail.Body = emailmessage
'MyMail.Send
'Set MyMail = Nothing
'Set MyOutlook = Nothing

End Function
Public Function EmailSaleResults()

Dim emailsubject As String
Dim emailmessage As String
Dim Buyer As String
Dim SaleDate, Client, Padd, Pcsz, Pphone, ThirdParty, SalePrice, info1, info2, info3, Info, VarFid As String
Dim VBuyerL As String
Dim VOcwenMd As String

If Forms![foreclosure database screen]!Client Like "Ocwen*" And _
Forms![foreclosure database screen]!PropertyState = "MD" Then
VOcwenMd = "Please complete event in Real Resolution as soon as possible. Thanks."
End If


SalePrice = Format([Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![SalePrice], "$###,##0.00")
ThirdParty = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![3rd_party]
Buyer = Purchaser()
Padd = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![buyer_add]
Pcsz = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![buyer_csz]
Pphone = [Forms]![foreclosure database screen]![PostsaleSubForm].[Form]![buyer_phone]
Client = Forms![foreclosure database screen]!Client

If IsNull([Forms]![foreclosure database screen]![Fidelity]) Then
VarFid = 0
Else
VarFid = [Forms]![foreclosure database screen]![Fidelity]
End If

SaleDate = [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]

'Dim rsbid As Recordset
Dim strBid, LenderBid As String

'strBid = "select * from bidtable where filenum = " & Forms![foreclosure database screen]![FIleNum] & ";"
'Set rsbid = CurrentDb.OpenRecordset(strBid, dbopensnapshot)


'If Not rsbid.EOF Then
'If IsNull(rsbid!lender_bid) Or rsbid!lender_bid = 0 Then
'If IsNull(SalePrice) Then
'LenderBid = ""
'Else
'LenderBid = SalePrice
'End If
'Else
'LenderBid = Format(rsbid!lender_bid, "$###,###.00")
'End If
'Else
LenderBid = SalePrice
'End If

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
emailsubject = debtorsFORE() & " - **SALES RESULT for : " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
Else
emailsubject = debtorsFORE() & " - **SALES RESULT for : " & Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If

Dim VRat
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VRat = "Ratification Date expires 60 Days After Sale Date"
Else
VRat = ""
End If


 
If VarFid = -1 Then

If ThirdParty = -1 Then

If Forms![foreclosure database screen]!Client Like "Citi*" Then

Dim VDays As String
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VDays = "60 to 90 Days"
Else
VDays = "30 Days"
End If


emailmessage = _
"Sale Date: " & SaleDate & vbCr & _
"Mortgagor(s): " & debtorsFORE() & vbCr & _
"Property Address: " & PROP() & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
"Investor: " & Client & vbCr & _
"Sold To: " & Buyer & vbCr & _
"3rd Party Info: Property sold to " & Buyer & " for " & SalePrice & ".  Citifinancial Mortgage Co., Inc. should receive the proceeds of the sale (or full loan payoff) within " & VDays & " ." & vbCr & _
"Bid Amount: " & LenderBid & vbCr & _
VRat

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then

emailmessage = _
"Foreclosed in the name of: " & LSecured() & vbCr & _
"Sold To 3rd Party Purchaser" & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Property Address: " & PROP() & _
"Sale Date: " & SaleDate & vbCr & _
"Bid Amount: " & SalePrice & vbCr & _
"Purchaser: " & Buyer & vbCr & _
"Address: " & Padd & vbCr & _
"City/State/zip: " & Pcsz & vbCr & _
"Contact: " & BGW3rdContact() & vbCr & _
"Phone#: " & Pphone & vbCr & vbCr & _
VOcwenMd



Else

emailmessage = _
"Sale Date: " & SaleDate & vbCr & _
"Mortgagor(s): " & debtorsFORE() & vbCr & _
"Property Address: " & PROP() & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
"Investor: " & Client & vbCr & _
"Sold To: " & Buyer & vbCr & _
"3rd Party Info: " & Padd & ", " & Pcsz & "; " & Pphone & vbCr & _
"Bid Amount: " & LenderBid & vbCr & _
"3rd Party Bid Amount: " & SalePrice & vbCr & _
VRat
End If


ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then

emailmessage = _
"BID AMOUNT ACCEPTED AT FORECLOSURE SALE" & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Property Address: " & PROP() & _
"Sale Date: " & SaleDate & vbCr & _
"Bid Amount: " & LenderBid & vbCr & _
"Sold To REO" & vbCr & _
"Foreclosed in the name of: " & Buyer & vbCr & vbCr & _
VOcwenMd

Else
emailmessage = _
"Sale Date: " & SaleDate & vbCr & _
"Mortgagor(s): " & debtorsFORE() & vbCr & _
"Property Address: " & PROP() & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"State: " & Forms![foreclosure database screen]!PropertyState & vbCr & _
"Investor: " & Client & vbCr & _
"Sold To: " & Buyer & vbCr & _
"Bid Amount: " & LenderBid & vbCr & _
VRat




End If


Else

If ThirdParty = -1 Then

If Forms![foreclosure database screen]!PropertyState = "MD" Then
VDays = "60 to 90 Days"
Else
VDays = "30 Days"
End If

If Forms![foreclosure database screen]!Client Like "Citi*" Then
emailmessage = "3rd Party Info: Property sold to a Third Party Purchaser for " & SalePrice & ".  Citifinancial Mortgage Co., Inc. should receive the proceeds of the sale (or full loan payoff) within " & VDays & " ." & vbCr & vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property Address: " & PROP() & vbCr & vbCr & "Sales in Maryland take between 30-90 days for the ratification process to be completed."

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then

emailmessage = _
"Foreclosed in the name of: " & LSecured() & vbCr & _
"Sold To 3rd Party Purchaser" & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Property Address: " & PROP() & _
"Sale Date: " & SaleDate & vbCr & _
"Bid Amount: " & SalePrice & vbCr & _
"Purchaser: " & Buyer & vbCr & _
"Address: " & Padd & vbCr & _
"City/State/zip: " & Pcsz & vbCr & _
"Contact: " & BGW3rdContact() & vbCr & _
"Phone#: " & Pphone & vbCr & vbCr & _
VOcwenMd


Else
emailmessage = "The foreclosure auction resulted in a 3rd party sale in the amount of " & Format(SalePrice, "$###,##0.00") & ".  The property was purchased by: " & vbCr & Buyer & vbCr & Padd & ", " & Pcsz & vbCr & Pphone & vbCr & vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property Address: " & PROP() & vbCr & vbCr & "Sales in Maryland take between 30-90 days for the ratification process to be completed."
End If

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then

emailmessage = _
"BID AMOUNT ACCEPTED AT FORECLOSURE SALE" & vbCr & _
"BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & _
"Loan #: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & _
"Property Address: " & PROP() & _
"Sale Date: " & SaleDate & vbCr & _
"Bid Amount: " & LenderBid & vbCr & _
"Sold To REO" & vbCr & _
"Foreclosed in the name of: " & Buyer & vbCr & vbCr & _
VOcwenMd


Else
emailmessage = "Foreclosure sale reverted back to " & Buyer & " in the amount of " & Format(SalePrice, "$###,##0.00") & "." & vbCr & vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property Address: " & PROP() & vbCr & vbCr & "Sales in Maryland take between 30-90 days for the ratification process to be completed."
End If
End If

emailmessage = emailmessage + SigEmail()

Dim varsendemail As String
Dim VTo As String
VTo = InputBox("Email addressed to " & vbCr & "{for more than one email address separate by semi-colon ; }")

varsendemail = MsgBox("Sending Email to " & VTo & vbCr & vbCr & "DISPLAY EMAIL, Continue?" + vbCr & vbCr + emailmessage, vbYesNo)
If varsendemail = vbYes Then

'SendEmails VTo, VCCTo, VCCTo, emailsubject, emailmessage
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = VTo
MyMail.CC = VCCTo
MyMail.body = emailmessage
MyMail.Subject = emailsubject
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

MsgBox ("Email Sent")
Else
MsgBox ("No Email Sent")

End If

End Function
Public Function EmailBillVer()
Dim rs As RecordSet
Dim emailsubject As String, emailmessage As String, VTo As String, varsendemail As String
Dim strsql As String
Dim VINv#
Dim VtitleD
Dim Vattorney, VDocket, vtitle, VRecording, Vauct, Vnotice, vad, VDism, VTClaim
Dim VNotes As String

VINv# = InputBox("Enter Invoice #")
VNotes = InputBox("Enter any additional text for Email")

strsql = "SELECT Billing.CustomerID, Billing.BillingDate, Billing.[Attorney Fee], CASES.[Date Recieved], " _
& " Billing.d_titlesearch, Foreclosure.TitleReportOrdered, Foreclosure.TitleClaimSent, Foreclosure.update_ord, Billing.d_recording, " _
& " Foreclosure.DocsSentCourt, Billing.l_preptitle, billing.d_servbymail, billing.cert_cpy_dot, Cases.clientrefnumber, Billing.d_auctfee, Foreclosure.fc_cooper, Billing.d_filing, Billing.d_process, " _
& " Foreclosure.NoticeSent, Billing.d_adv, Foreclosure.[1st_ad], Foreclosure.sale_cancelled, Billing.fee_DismCase " _
& " FROM ((CASES INNER JOIN Billing ON CASES.FileNum = Billing.FileNum) " _
& " INNER JOIN Foreclosure ON CASES.FileNum = Foreclosure.SubFileNum) " _
& " WHERE Billing.CustomerID =  " & VINv# & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
MsgBox ("No Inv# in System")
Exit Function
End If

If rs!d_titlesearch > 0 Then
If Not IsNull(rs!update_ord) Then
VtitleD = Format(rs!update_ord, "mm/dd/yy")
Else
VtitleD = Format(rs!TitleReportOrdered, "mm/dd/yy")
End If
vtitle = "Title: " & Format(rs!d_titlesearch, "$###,##0.00") & "/ Date: " & vtitle & vbCr
End If
If rs![Attorney Fee] > 0 Then
Vattorney = "Foreclosure Fee: " & Format(rs![Attorney Fee], "$###,##0.00") & "/ Date: " & Format(rs![Date Recieved], "mm/dd/yy") & vbCr
End If
If rs![d_filing] > 0 Then
VDocket = "Docket Date: " & Format(rs!d_filing, "$###,##0.00") & "/ Date: " & Format(rs!DocsSentCourt, "mm/dd/yy") & vbCr
End If
If rs![d_recording] > 0 Then
VRecording = "Recording Fee: " & Format(rs!d_recording, "$###,##0.00") & "/ Date: " & Format(rs!DocsSentCourt, "mm/dd/yy") & vbCr
End If
If rs![d_auctfee] > 0 Then
Vauct = "Auctioneer: " & Format(rs!d_auctfee, "$###,##0.00") & "/ Date: " & Format(rs!fc_cooper, "mm/dd/yy") & vbCr
End If

If rs![d_adv] > 0 Then
vad = "Advertising: " & Format(rs!d_adv, "$###,##0.00") & "/ Date: " & Format(rs![1st_ad], "mm/dd/yy") & vbCr
End If
If rs![fee_dismcase] > 0 Then
VDism = "Dismissal: " & Format(rs!fee_dismcase, "$###,##0.00") & "/ Date: " & Format(rs!sale_cancelled, "mm/dd/yy") & vbCr
End If
If rs![l_preptitle] > 0 Then
VTClaim = "Title Claim: " & Format(rs!l_preptitle, "$###,##0.00") & "/ Date: " & Format(rs!TitleClaimSent, "mm/dd/yy") & vbCr
End If
If rs![d_servbymail] > 0 Then
VTClaim = "Mailing: " & Format(rs!d_servbymail, "$###,##0.00") & vbCr
End If
If rs![cert_cpy_dot] > 0 Then
VTClaim = "Certified Copy of DOT: " & Format(rs!cert_cpy_dot, "$###,##0.00") & vbCr
End If
emailsubject = "PRIORITY ADDITIONAL FORECLOSURE INVOICE INFORMATION"
emailmessage = Vattorney + vtitle + VDocket + VRecording + Vauct + Vnotice + vad + VDism + VTClaim + vbCr + vbCr + VNotes + vbCr + vbCr + SigEmail()

VTo = InputBox("Email addressed to " & vbCr & "{for more than one email address separate by semi-colon ; }")

varsendemail = MsgBox("EMAIL WILL NOT DISPLAY AUTOMATICALLY SENDS EMAIL, Continue?" & vbCr & vbCr & "Sending Email to: " & VTo & vbCr & "cc: " & VCCTo & vbCr & "Subject: " & emailsubject & vbCr & "Body: " & vbCr & emailmessage, vbYesNo)
If varsendemail = vbYes Then

SendEmails VTo, VCCTo, VCCTo, emailsubject, emailmessage
MsgBox ("Email Sent")
Else
MsgBox ("No Email Sent")

End If
End Function
Public Function EmailTitleExamSub()

Dim emailsubject As String
Dim emailmessage As String, Purchaser As String
Dim superiorliens, serioustitle, Property, position, OrgAmount, CountyAtt, countyadd1, countyadd2, countyadd3, countyadd4, countyadd5 As String
Dim parcel, TaxYears, TaxAmts, juniorliens, Other, resolution, Assignments As String

If IsNull([Forms]![titleform]![juniorliens]) Then
juniorliens = ""
Else
juniorliens = [Forms]![titleform]!juniorliens
End If

If IsNull([Forms]![titleform]![superiorliens]) Then
superiorliens = "The Title Search does not reveal any superior interests."
Else
superiorliens = "Superior Liens: " & [Forms]![titleform]![superiorliens]
End If

Property = PROP()

If IsNull(Forms!titleform!position) Then
position = 0
Else
position = [Forms]![titleform]!position
End If

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount]) Then
OrgAmount = 0
Else
OrgAmount = Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount], "$###,##0.00")
End If

Assignments = [Forms]![titleform]!beneficiary & " shows as beneficiary of record."

If IsNull([Forms]![titleform]![county att]) Then
CountyAtt = ""
Else
CountyAtt = [Forms]![titleform]![county att]
End If
If IsNull([Forms]![titleform]![countyadd1]) Then
countyadd1 = ""
Else
countyadd1 = [Forms]![titleform]!countyadd1
End If
If IsNull([Forms]![titleform]![countyadd2]) Then
countyadd2 = ""
Else
countyadd2 = [Forms]![titleform]!countyadd2
End If
If IsNull([Forms]![titleform]![countyadd3]) Then
countyadd3 = ""
Else
countyadd3 = vbCr & [Forms]![titleform]!countyadd3
End If
If IsNull([Forms]![titleform]![countyadd4]) Then
countyadd4 = ""
Else
countyadd4 = vbCr & [Forms]![titleform]!countyadd4
End If

If IsNull(Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]) Then
parcel = ""
Else
parcel = Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]
End If
If IsNull([Forms]![titleform]!TaxYears) Then
TaxYears = ""
Else
Dim VPdDue
If Forms![titleform]!PdDue = 1 Then
VPdDue = "Taxes Due for "
ElseIf Forms![titleform]!PdDue = 2 Then
VPdDue = "Taxes Paid for "
Else
VPdDue = ""
End If

TaxYears = VPdDue + [Forms]![titleform]!TaxYears
End If
If IsNull([Forms]![titleform]!TaxAmts) Then
TaxAmts = ""
Else
TaxAmts = [Forms]![titleform]!TaxAmts
End If
If IsNull([Forms]![titleform]!Other) Then
Other = ""
Else
Other = [Forms]![titleform]!Other
End If
If IsNull([Forms]![titleform]!resolution) And (Forms!titleform!titleneeded = 0 Or IsNull(Forms!titleform!titleneeded)) Then
resolution = "No Title Resolution Work Needed."
Else
resolution = "TITLE CURATIVE NEEDED: " & [Forms]![titleform]!resolution
End If

Dim rsCL As RecordSet
Dim strsqlCL, NTNote As String
NTNote = ""


strsqlCL = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsCL = CurrentDb.OpenRecordset(strsqlCL, dbOpenSnapshot)
If rsCL!NewTrak = 1 And (Forms!titleform!titleneeded = -1 Or Forms!titleform!titleneeded = 1) And (Forms!titleform!serioustitle = 0 Or IsNull(Forms!titleform!serioustitle)) Then
NTNote = "Despite the Issues Raised, as long as a title policy is provided that does not take exception to any of the issues raised above, we are proceeding to sale unless otherwise directed by Fidelity."
End If
rsCL.Close


emailsubject = debtorsFORE() & " - **TITLE INFORMATION**"
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
emailmessage = _
"FORECLOSURE TITLE WORKSHEET: " & vbCr & vbCr & _
"Period of Title Examination: From: To:" & _
"Loan No.: " & Forms![foreclosure database screen]!ClientRefNumber & _
"Borrower(s): " & debtorsFORE() & _
superiorliens & vbCr & vbCr & _
"Property Address: " & Property & vbCr & vbCr & _
"Your Deed of Trust is reflected in " & position & " position; subject deed is in the amount of " & OrgAmount & vbCr & vbCr & _
Assignments & vbCr & vbCr & _
"Delinquent Taxes: " & vbCr & CountyAtt & vbCr & countyadd1 & vbCr & countyadd2 & countyadd3 & countyadd4 & countyadd5 & _
vbCr & vbCr & "County: " & County() & vbCr & vbCr & _
"Tax ID#: " & parcel & vbCr & vbCr & _
"Tax Amounts: " & TaxAmts & vbCr & vbCr & _
 TaxYears & vbCr & vbCr & _
"Junior Liens: " & juniorliens & vbCr & vbCr & _
"Other Issues: " & Other & vbCr & vbCr & _
resolution & vbCr & vbCr & _
NTNote

Else
emailmessage = _
"TITLE INFORMATION: " & vbCr & vbCr & _
superiorliens & vbCr & vbCr & _
"Property Address: " & Property & vbCr & vbCr & _
"Your Deed of Trust is reflected in " & position & " position; subject deed is in the amount of " & OrgAmount & vbCr & vbCr & _
Assignments & vbCr & vbCr & _
"Delinquent Taxes: " & vbCr & CountyAtt & vbCr & countyadd1 & vbCr & countyadd2 & countyadd3 & countyadd4 & countyadd5 & _
vbCr & vbCr & "County: " & County() & vbCr & vbCr & _
"Tax ID#: " & parcel & vbCr & vbCr & _
"Tax Amounts: " & TaxAmts & vbCr & vbCr & _
 TaxYears & vbCr & vbCr & _
"Junior Liens: " & juniorliens & vbCr & vbCr & _
"Other Issues: " & Other & vbCr & vbCr & _
resolution & vbCr & vbCr & _
NTNote & vbCr & vbCr & _
"Please be advised that this title is being reported based on no more than a 2 owner search which is the max search allowable under the applicable GSE cost reimbursement schedule).  As a result " _
& "certain financial encumbrances running with the land may not be reported on our search and such financial encumbrances " _
& "may be required to be paid by the lender/servicer in order to record the foreclosure Deed even if the foreclosure sale is sold to a third party.  " _
& "This law firm disclaims any responsibility or liability for such charges."

End If

Dim VSend
VSend = InputBox("Send (E)mail or (A)ppend Memo ONLY. Type in E or A")

If VSend = "E" Then

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
'MyMail.Body = emailmessage + vbcr + vbcr + sig1 + vbcr + "Paralegal" + vbcr + "BWW Law Group, LLC" + vbcr + "Phone: 301-961-6555" & vbcr + "Main Fax: 301-961-6545" + vbcr + "Fax: 301-961-6545"
MyMail.body = emailmessage + SigEmail()

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing

varappend = MsgBox("Append Memo Section?", vbYesNo)
If varappend = vbYes Then
Dim rsapp As RecordSet
Dim strsqlapp, VMemo As String
VMemo = Forms!titleform!comments
Call AddJournalEntry(Forms![foreclosure database screen]!filenum, emailmessage)
End If

Else
Call AddJournalEntry(Forms![foreclosure database screen]!filenum, emailmessage)
End If


DoCmd.Close acForm, "titleform"

End Function

Public Function EmailCiti()

Dim emailsubject As String
Dim emailmessage As String, Purchaser As String
Dim superiorliens, serioustitle, Property, position, OrgAmount, CountyAtt, countyadd1, countyadd2, countyadd3, countyadd4, countyadd5 As String
Dim parcel, TaxYears, TaxAmts, juniorliens, Other, resolution, Assignments As String


If IsNull([Forms]![citisubform]![juniorliens]) Then
juniorliens = ""
Else
juniorliens = [Forms]![citisubform]!juniorliens
End If

If IsNull([Forms]![citisubform]![superiorliens]) Then
superiorliens = "The Title Search does not reveal any superior interests."
Else
superiorliens = "Superior Liens: " & [Forms]![citisubform]![superiorliens]
End If

Property = PROP()

If IsNull(Forms!citisubform!position) Then
position = 0
Else
position = [Forms]![citisubform]!position
End If

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount]) Then
OrgAmount = 0
Else
OrgAmount = Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount], "$###,##0.00")
End If

'If IsNull([Forms]![citisubform]![assignments]) Then
Assignments = [Forms]![citisubform]!beneficiary & " shows as beneficiary of record."
'Else
'assignments = "Assignments Needed: " & [Forms]![citisubform]![assignments]
'End If

If IsNull([Forms]![citisubform]![county att]) Then
CountyAtt = ""
Else
CountyAtt = [Forms]![citisubform]![county att]
End If
If IsNull([Forms]![citisubform]![countyadd1]) Then
countyadd1 = ""
Else
countyadd1 = [Forms]![citisubform]!countyadd1
End If
If IsNull([Forms]![citisubform]![countyadd2]) Then
countyadd2 = ""
Else
countyadd2 = [Forms]![citisubform]!countyadd2
End If
If IsNull([Forms]![citisubform]![countyadd3]) Then
countyadd3 = ""
Else
countyadd3 = vbCr & [Forms]![citisubform]!countyadd3
End If
If IsNull([Forms]![citisubform]![countyadd4]) Then
countyadd4 = ""
Else
countyadd4 = vbCr & [Forms]![citisubform]!countyadd4
End If

If IsNull(Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]) Then
parcel = ""
Else
parcel = Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]
End If
If IsNull([Forms]![citisubform]!TaxYears) Then
TaxYears = ""
Else
Dim VPdDue
If Forms![citisubform]!PdDue = 1 Then
VPdDue = "Taxes Due for "
ElseIf Forms![citisubform]!PdDue = 2 Then
VPdDue = "Taxes Paid for "
Else
VPdDue = ""
End If

TaxYears = VPdDue + [Forms]![citisubform]!TaxYears
End If
If IsNull([Forms]![citisubform]!TaxAmts) Then
TaxAmts = ""
Else
TaxAmts = [Forms]![citisubform]!TaxAmts
End If

If IsNull([Forms]![citisubform]!Other) Then
Other = ""
Else
Other = [Forms]![citisubform]!Other
End If

If IsNull([Forms]![citisubform]!resolution) And (Forms!citisubform!titleneeded = 0 Or IsNull(Forms!citisubform!titleneeded)) Then
resolution = "No Title Resolution Work Needed."
Else
resolution = "TITLE CURATIVE NEEDED: " & [Forms]![citisubform]!resolution
End If



Dim rsCL As RecordSet
Dim strsqlCL, NTNote As String
NTNote = ""


strsqlCL = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsCL = CurrentDb.OpenRecordset(strsqlCL, dbOpenSnapshot)
If rsCL!NewTrak = 1 And (Forms!citisubform!titleneeded = -1 Or Forms!citisubform!titleneeded = 1) And (Forms!citisubform!serioustitle = 0 Or IsNull(Forms!citisubform!serioustitle)) Then
NTNote = "Despite the Issues Raised, as long as a title policy is provided that does not take exception to any of the issues raised above, we are proceeding to sale unless otherwise directed by Fidelity."
End If
rsCL.Close


emailsubject = debtorsFORE() & " - **TITLE INFORMATION**"
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
emailmessage = _
"FORECLOSURE TITLE WORKSHEET: " & vbCr & vbCr & _
"Period of Title Examination: From: To:" & _
"Loan No.: " & Forms![foreclosure database screen]!ClientRefNumber & _
"Borrower(s): " & debtorsFORE() & _
superiorliens & vbCr & vbCr & _
"Property Address: " & Property & vbCr & vbCr & _
"Your Deed of Trust is reflected in " & position & " position; subject deed is in the amount of " & OrgAmount & vbCr & vbCr & _
Assignments & vbCr & vbCr & _
"Delinquent Taxes: " & vbCr & CountyAtt & vbCr & countyadd1 & vbCr & countyadd2 & countyadd3 & countyadd4 & countyadd5 & _
vbCr & vbCr & "County: " & County() & vbCr & vbCr & _
"Tax ID#: " & parcel & vbCr & vbCr & _
"Tax Amounts: " & TaxAmts & vbCr & vbCr & _
 TaxYears & vbCr & vbCr & _
"Junior Liens: " & juniorliens & vbCr & vbCr & _
"Other Issues: " & Other & vbCr & vbCr & _
resolution & vbCr & vbCr & _
NTNote

Else
emailmessage = _
"TITLE INFORMATION: " & vbCr & vbCr & _
superiorliens & vbCr & vbCr & _
"Property Address: " & Property & vbCr & vbCr & _
"Your Deed of Trust is reflected in " & position & " position; subject deed is in the amount of " & OrgAmount & vbCr & vbCr & _
Assignments & vbCr & vbCr & _
"Delinquent Taxes: " & vbCr & CountyAtt & vbCr & countyadd1 & vbCr & countyadd2 & countyadd3 & countyadd4 & countyadd5 & _
vbCr & vbCr & "County: " & County() & vbCr & vbCr & _
"Tax ID#: " & parcel & vbCr & vbCr & _
"Tax Amounts: " & TaxAmts & vbCr & vbCr & _
 TaxYears & vbCr & vbCr & _
"Junior Liens: " & juniorliens & vbCr & vbCr & _
"Other Issues: " & Other & vbCr & vbCr & _
resolution & vbCr & vbCr & _
NTNote & vbCr & vbCr & _
"Please be advised that this title is being reported based on no more than a 2 owner search (which is the max search allowable under the applicable GSE cost reimbursement schedule).  As a result certain financial encumbrances running with the land may not be reported on our search and such financial encumbrances may be required to be paid by the lender/servicer in order to record the foreclosure Deed even if the foreclosure sale is sold to a third party.  This law firm disclaims any responsibility or liability for such charges."

End If

Dim VSend
VSend = InputBox("Send (E)mail or (A)ppend Memo ONLY. Type in E or A")

If VSend = "E" Then

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
'MyMail.Body = emailmessage + vbcr + vbcr + sig1 + vbcr + "Paralegal" + vbcr + "BWW Law Group, LLC" + vbcr + "Phone: 301-961-6555" & vbcr + "Main Fax: 301-961-6545" + vbcr + "Fax: 301-961-6545"
MyMail.body = emailmessage + SigEmail()

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing

varappend = MsgBox("Append Memo Section?", vbYesNo)
If varappend = vbYes Then
Dim rsapp As RecordSet
Dim strsqlapp, VMemo As String
VMemo = Forms!citisubform!comments
Call AddJournalEntry(Forms![foreclosure database screen]!filenum, emailmessage)
End If

Else
Call AddJournalEntry(Forms![foreclosure database screen]!filenum, emailmessage)
End If


DoCmd.Close acForm, "Citisubform"

End Function
Public Function EmailTitleAbs()

Dim emailsubject As String
Dim emailmessage As String, Purchaser As String
Dim superiorliens, Property, position, OrgAmount, CountyAtt, countyadd1, countyadd2, countyadd3, countyadd4, countyadd5 As String
Dim parcel, TaxYears, TaxAmts, juniorliens, Other, resolution, Assignments As String

Dim strsql, VLiens As String
Dim rs As RecordSet

strsql = "select * from tblbeneficiary where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
rs.MoveFirst

Do While Not rs.EOF
VLiens = rs!ta_lender & ": " + VLiens
rs.MoveNext
Loop
rs.Close

superiorliens = "Liens: " & VLiens
Else
superiorliens = "The Title Search does not reveal any superior interests."
End If
'MsgBox (superiorliens)


Property = [Forms]![foreclosure database screen]![PropAddress]
If IsNull(Forms![trio title abstract]!position) Then
position = 0
Else
position = [Forms]![[trio title abstract]]!position
End If

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount]) Then
OrgAmount = 0
Else
OrgAmount = Format([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgAmount], "$###,##0.00")
End If

If IsNull([Forms]![[trio title abstract]]![Assignments]) Then
Assignments = "No Assignments(s) are needed.  " & [Forms]![[trio title abstract]]!beneficiary & " shows as beneficiary of record."
Else
Assignments = "Assignments Needed: " & [Forms]![[trio title abstract]]![Assignments]
End If
If IsNull([Forms]![[trio title abstract]]![county att]) Then
CountyAtt = ""
Else
CountyAtt = [Forms]![[trio title abstract]]![county att]
End If
If IsNull([Forms]![[trio title abstract]]![countyadd1]) Then
countyadd1 = ""
Else
countyadd1 = [Forms]![[trio title abstract]]!countyadd1
End If
If IsNull([Forms]![[trio title abstract]]![countyadd2]) Then
countyadd2 = ""
Else
countyadd2 = [Forms]![[trio title abstract]]!countyadd2
End If
If IsNull([Forms]![[trio title abstract]]![countyadd3]) Then
countyadd3 = ""
Else
countyadd3 = vbCr & [Forms]![[trio title abstract]]!countyadd3
End If
If IsNull([Forms]![[trio title abstract]]![countyadd4]) Then
countyadd4 = ""
Else
countyadd4 = vbCr & [Forms]![[trio title abstract]]!countyadd4
End If
If IsNull([Forms]![[trio title abstract]]![countyadd5]) Then
countyadd5 = ""
Else
countyadd5 = vbCr & [Forms]![[trio title abstract]]!countyadd5
End If


If IsNull(Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]) Then
parcel = ""
Else
parcel = Forms![foreclosure database screen]![PostsaleSubForm].[Form]![taxid]
End If
If IsNull([Forms]![[trio title abstract]]!TaxYears) Then
TaxYears = ""
Else
TaxYears = [Forms]![[trio title abstract]]!TaxYears
End If
If IsNull([Forms]![[trio title abstract]]!TaxAmts) Then
TaxAmts = ""
Else
TaxAmts = [Forms]![[trio title abstract]]!TaxAmts
End If
If IsNull([Forms]![[trio title abstract]]!Other) Then
Other = ""
Else
Other = [Forms]![[trio title abstract]]!Other
End If
If IsNull([Forms]![[trio title abstract]]!resolution) And Forms![trio title abstract]!titleneeded = 0 Then
resolution = "No Title Resolution Work Needed."
Else
resolution = "TITLE CURATIVE NEEDED: " & [Forms]![[trio title abstract]]!resolution
End If

emailsubject = debtorsFORE() & " - **TITLE INFORMATION**"
emailmessage = _
"TITLE INFORMATION: " & vbCr & vbCr & _
superiorliens & vbCr & vbCr & _
"Property Address: " & Property & vbCr & vbCr & _
"Your Deed of Trust is reflected in " & position & " position; subject deed is in the amount of " & OrgAmount & vbCr & vbCr & _
Assignments & vbCr & vbCr & _
"Delinquent Taxes: " & vbCr & CountyAtt & vbCr & countyadd1 & vbCr & countyadd2 & countyadd3 & countyadd4 & countyadd5 & _
vbCr & vbCr & "County: " & County() & vbCr & vbCr & _
"Tax ID#: " & parcel & vbCr & vbCr & _
"Tax Amounts: " & TaxAmts & vbCr & vbCr & _
"Tax Years Due: " & TaxYears & vbCr & vbCr & _
"Other Issues: " & Other & vbCr & vbCr & _
resolution

'"Junior Liens: " & juniorliens & vbcr & vbcr & _

Dim varsendemail, varappend As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application

Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Subject = emailsubject
'MyMail.Body = emailmessage + vbcr + vbcr + sig1 + vbcr + "Paralegal" + vbcr + "BWW Law Group, LLC" + vbcr + "Phone: 301-961-6555" & vbcr + "Main Fax: 301-961-6545" + vbcr + "Fax: 301-961-6545"
MyMail.body = emailmessage + vbCr + vbCr & "BWW Law Group, LLC" + vbCr + "Phone: 301-961-6555" & vbCr + "Main Fax: 301-961-6545" + vbCr + "Fax: 301-961-6545"

MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing

varappend = MsgBox("Append Memo Section?", vbYesNo)
If varappend = vbYes Then

Dim rsapp As RecordSet
Dim strsqlapp, VMemo As String

' !!!! BROKEN: Forms![trio title abstract]!Comments doesn't exist
VMemo = Forms![trio title abstract]!comments
'strsqlapp = "select comments from cases where filenum = " & Forms![foreclosure database screen]!FIleNum & ";"
'Set rsapp = CurrentDb.OpenRecordset(strsqlapp, dbOpenDynaset, dbSeeChanges)
'
'With rsapp
'.Edit
'!Comments = VMemo & "                                                                             " & vbCr & Date & "     " & emailmessage
'.Update
'End With
Call AddJournalEntry(Forms![foreclosure database screen]!filenum, emailmessage)

End If

DoCmd.Close acForm, "[trio title abstract]"

End Function
Public Function EmailPrintADVA()

Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim EM1 As String
Dim EM2 As String
Dim EM3 As String

Dim pub1 As String
Dim pub2 As String
Dim pub3 As String
Dim pub4 As String
Dim pub5 As String
Dim Pub As String

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![1st_ad]) Then
pub1 = "0"
Else
pub1 = Forms![foreclosure database screen]![ForeclosureSubForm].Form![1st_ad]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub2]) Then
pub2 = "0"
Else
pub2 = Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub2]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub3]) Then
pub3 = "0"
Else
pub3 = Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub3]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub4]) Then
pub4 = "0"
Else
pub4 = Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub4]
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub5]) Then
pub5 = "0"
Else
pub5 = Forms![foreclosure database screen]![ForeclosureSubForm].Form![pub5]
End If

If pub2 = "0" Then
Pub = pub1
ElseIf pub3 = "0" Then
Pub = pub1 & " and " & pub2
ElseIf pub4 = "0" Then
Pub = pub1 & ", " & pub2 & " and " & pub3
ElseIf pub5 = "0" Then
Pub = pub1 & ", " & pub2 & ", " & pub3 & " and " & pub4
ElseIf pub5 <> "0" Then
Pub = pub1 & ", " & pub2 & ", " & pub3 & ", " & pub4 & " and " & pub5
End If

Email = InputBox("""" & "E" & """" & "mail Document or " & """" & "F" & """" & "ax?")

If Email = "e" Then

Call EmailPrintADVAASAP

Else
DoCmd.OpenReport ("Adv-VA"), acViewPreview
DoCmd.OpenReport ("NewspaperFax"), acViewPreview

End If


End Function

