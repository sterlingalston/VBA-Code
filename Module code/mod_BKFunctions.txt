Attribute VB_Name = "BKFunctions"
Option Compare Database


Public Function BKCaseNumber()


Dim rs As RecordSet
strsql = "select * from bankruptcy where counter = " & GblBKNo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
If Not IsNull(rs![BKY Case Number]) Then
BKCaseNumber = rs![BKY Case Number]
Else
BKCaseNumber = 0
End If

End If
rs.Close

End Function
Public Function BKJurisdiction()


Dim rs As RecordSet
strsql = "select * from bankruptcy where counter = " & GblBKNo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
If Not IsNull(rs![Jurisdiction]) Then
BKJurisdiction = rs![Jurisdiction]
Else
BKJurisdiction = 0
End If

End If
rs.Close
End Function
Public Function BKRelief()

Dim rs As RecordSet
strsql = "select * from bankruptcy where counter = " & GblBKNo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
If Not IsNull(rs![Relief]) Then
BKRelief = rs![Relief]
Else
BKRelief = 0
End If

End If
rs.Close

End Function
Public Function BKChapter()


Dim rs As RecordSet
strsql = "select * from bankruptcy where counter = " & GblBKNo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
If Not IsNull(rs![chapter]) Then
BKChapter = rs![chapter]
Else
BKChapter = 0
End If

End If
rs.Close



End Function
Public Function NoticeTermBKLang()
Dim VSel

VSel = InputBox("How to Proceed: " & vbCr & vbCr & "1. be re-opened and active" & vbCr & "2. proceed in its normal course" & _
vbCr & "3. proceed - issue NiSi" & vbCr & "4. proceed - ratify sale" & vbCr & "Other (Enter text here)" & vbCr & vbCr & "enter 1, 2, 3, 4 or enter text")


If VSel = 1 Then
NoticeTermBKLang = "The Substitute Trustees submit that this case is ripe to be re-opened and active."
ElseIf VSel = 2 Then
NoticeTermBKLang = "The Substitute Trustees submit that this case is ripe to proceed in its normal course."
ElseIf VSel = 3 Then
NoticeTermBKLang = "The Substitute Trustees submit that this case is ripe to proceed and request that the court issue the Notice of Sale (proposed Order NiSi attached)."
ElseIf VSel = 4 Then
NoticeTermBKLang = "The Substitute Trustees submit that this case is ripe to proceed and request that the court ratify the foreclosure sale (proposed Order of Ratification attached)."
Else
NoticeTermBKLang = VSel
End If

End Function
Public Function BKMovant()

If Not IsNull(Forms![foreclosure database screen]!bk_Movant) And _
((Forms![foreclosure database screen]!TypeOfLoan Like "FNMA*" Or _
Forms![foreclosure database screen]!longsecured Like "Federal National Mortgage Association*") Or _
(Forms![foreclosure database screen]!TypeOfLoan Like "FHLMC*" Or _
Forms![foreclosure database screen]!longsecured Like "Federal Home Loan Mortgage*")) Then
BKMovant = Forms![foreclosure database screen]![bk_Movant]

ElseIf Forms![foreclosure database screen]![longsecured] Like "Citifinancial Mortgage Co*" Then
BKMovant = "CitiMortgage, Inc. successor by reason of merger with " & Forms![foreclosure database screen]![longsecured]
Else
BKMovant = Forms![foreclosure database screen]![longsecured]
End If


End Function

Public Function BillEditBK()
MsgBox ("BILL HAS BEEN PAID CAN NOT EDIT")
DoCmd.Close acForm, "BillingMainEdit-BK"

End Function
Public Function BKHearingRptTotals()

Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Dim AmtTotal
Dim LateTotal
Dim NumTotal

Vtotal = 0
Dim rsHrg As RecordSet

Set rsHrg = CurrentDb.OpenRecordset("TempHearing", dbOpenDynaset, dbSeeChanges)

Do While Not rsHrg.EOF

strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & rsHrg![counter] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

LateTotal = 0
AmtTotal = 0
NumTotal = 0

Do While Not rs.EOF

If rs![co #payments] > 0 Then
AmtTotal = (rs![co #payments] * rs![co Amt]) + AmtTotal
NumTotal = rs![co #payments] + NumTotal
LateTotal = rs![co #latecharges] + LateTotal
End If
rs.MoveNext
Loop
rs.Close

If AmtTotal > 0 Then
With rsHrg
.Edit
!TotalLate = LateTotal
!TotalPayment = AmtTotal
!TotalNumber = NumTotal
.Update
End With
End If

rsHrg.MoveNext
Loop




End Function
Public Function BKPayTotalAmt() As Currency
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) And (Forms![foreclosure database screen]!Status = "BK-Hold" Or Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then
strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs![co #payments] > 0 Then
Vtotal = (rs![co #payments] * rs![co Amt]) + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
BKPayTotalAmt = Format(Vtotal, "$###,##0.00")
Else
BKPayTotalAmt = 0
End If
End If


End Function

Public Function ReferralBK()
Dim rs As RecordSet
Dim strsql As String
Dim rsRef As RecordSet

Dim VBeg, VEnd, vClient, VState
CurrentDb.Execute "Delete * from ReferralTable"

VBeg = InputBox("Enter Beginning Date")
VEnd = InputBox("Enter Ending Date")
vClient = InputBox("Enter Client")
VState = InputBox("Enter State")

Set rsRef = CurrentDb.OpenRecordset("ReferralTable", dbOpenDynaset, dbSeeChanges)


strsql = "SELECT Cases.FileNum, Bankruptcy.Mfr_requested, Cases.Client, " _
& " Cases.ClientRefNumber, Cases.resume_recd, Cases.Status, Cases.fob, Cases.imported_date, " _
& " Cases.imported_via, Cases.PropertyState " _
& " FROM Bankruptcy INNER JOIN Cases ON Bankruptcy.SubFileNum = Cases.FileNum " _
& " WHERE Bankruptcy.Mfr_requested >= #" & VBeg & "# And bankruptcy.mfr_requested <= #" & VEnd & "# " _
& " AND cases.Client Like " & """" & vClient & "*" & """" & " AND Cases.PropertyState Like " & """" & VState & "*" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF

With rsRef
.AddNew
!filenum = rs!filenum
![Date Recieved] = rs!Mfr_requested
!Client = rs!Client
!PropertyState = rs!PropertyState
.Update
End With
rs.MoveNext
Loop


strsql = "SELECT Cases.FileNum, Bankruptcy.poc_requested, Cases.Client, " _
& " Cases.ClientRefNumber, Cases.resume_recd, Cases.Status, Cases.fob, Cases.imported_date, " _
& " Cases.imported_via, Cases.PropertyState " _
& " FROM Bankruptcy INNER JOIN Cases ON Bankruptcy.SubFileNum = Cases.FileNum " _
& " WHERE Bankruptcy.poc_requested >= #" & VBeg & "# And bankruptcy.mfr_requested <= #" & VEnd & "# " _
& " AND cases.Client Like " & """" & vClient & "*" & """" & " AND Cases.PropertyState Like " & """" & VState & "*" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF

With rsRef
.AddNew
!filenum = rs!filenum
![Date Recieved] = rs!Poc_requested
!Client = rs!Client
!PropertyState = rs!PropertyState
.Update
End With
rs.MoveNext
Loop

strsql = "SELECT Cases.FileNum, Bankruptcy.plan_obj_req, Cases.Client, " _
& " Cases.ClientRefNumber, Cases.resume_recd, Cases.Status, Cases.fob, Cases.imported_date, " _
& " Cases.imported_via, Cases.PropertyState " _
& " FROM Bankruptcy INNER JOIN Cases ON Bankruptcy.SubFileNum = Cases.FileNum " _
& " WHERE Bankruptcy.plan_obj_req >= #" & VBeg & "# And bankruptcy.mfr_requested <= #" & VEnd & "# " _
& " AND cases.Client Like " & """" & vClient & "*" & """" & " AND Cases.PropertyState Like " & """" & VState & "*" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF

With rsRef
.AddNew
!filenum = rs!filenum
![Date Recieved] = rs!plan_obj_req
!Client = rs!Client
!PropertyState = rs!PropertyState
.Update
End With
rs.MoveNext
Loop










End Function
Public Function PropCountyBK() As String
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


If Forms![foreclosure database screen]!PropertyState <> "MD" And _
Forms![foreclosure database screen]!PropertyState <> "DC" And _
Forms![foreclosure database screen]!PropertyState <> "VA" Then

If IsNull(Forms![foreclosure database screen]!Propertycounty) Or _
Forms![foreclosure database screen]!Propertycounty = "" Then
vpco = InputBox("No county is input.  Please type the name of the county or city in which the Property is located.  (make sure to type in the word """"" & "County" & """" & " or " & """" & "City" & """" & " as necessary.)")
Else
vpco = Forms![foreclosure database screen]!Propertycounty
End If

PropCountyBK = vpco & ", " & Forms![foreclosure database screen]!PropertyState

ElseIf Forms![foreclosure database screen]![Propertycounty] Like "*City" Or _
Forms![foreclosure database screen]![Propertycounty] Like "City*" Or _
Forms![foreclosure database screen]![Propertycounty] Like "District*" Then

If Forms![foreclosure database screen]![Propertycounty] Like "*City" Then

PropCountyBK = Forms![foreclosure database screen]![Propertycounty] & ", Virginia"

ElseIf Forms![foreclosure database screen]![Propertycounty] Like "District*" Then
PropCountyBK = Forms![foreclosure database screen]![Propertycounty]

Else

PropCountyBK = "the " & Forms![foreclosure database screen]![Propertycounty] & ", Virginia"
End If

Else
PropCountyBK = Forms![foreclosure database screen]![Propertycounty] & " County, Virginia"

End If


End Function
Public Function BACMFRFields()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


vFile = Forms!bankruptcymain!BankruptcySubForm.Form.Form!counter
strsql = "select bacdesc1, bacdesc2, bacdesc3, bacdesc4, bacdesc5, bacfee1, bacfee2, bacfee3, bacfee4, bacfee5 from bkarrearages where counter = " & vFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then

If rs!BACFee1 > 0 Then
BACMFRFields = "(i) " & Format(rs!BACFee1, "$###,##0.00") & " (" & Trim(rs!BACDesc1) & ")"
End If

If rs!BACFee2 > 0 Then
Vcnt = Vcnt + 1
BACMFRFields = BACMFRFields & " and (ii) " & Format(rs!BACFee2, "$###,##0.00") & " (" & Trim(rs!BACDesc2) & ")"
End If


If rs!BACFee3 > 0 Then
Vcnt = Vcnt + 1
BACMFRFields = BACMFRFields & " and (iii) " & Format(rs!BACFee3, "$###,##0.00") & " (" & Trim(rs!BACDesc3) & ")"
End If


If rs!BACFee4 > 0 Then
Vcnt = Vcnt + 1
BACMFRFields = BACMFRFields & " and (iv) " & Format(rs!BACFee4, "$###,##0.00") & " (" & Trim(rs!BACDesc4) & ")"
End If

If rs!BACFee5 > 0 Then
Vcnt = Vcnt + 1
BACMFRFields = BACMFRFields & " and (v) " & Format(rs!BACFee5, "$###,##0.00") & " (" & Trim(rs!BACDesc5) & ")"
End If
End If

rs.Close



End Function
Public Function OtherCounty()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


If Forms![foreclosure database screen]!PropertyState <> "MD" And _
Forms![foreclosure database screen]!PropertyState <> "DC" And _
Forms![foreclosure database screen]!PropertyState <> "VA" Then
OtherCounty = InputBox("Enter complete County name for this file")

Else

OtherCounty = County()

End If



End Function
Public Function InterestTotalPOC()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Dim VBKId

If Forms![foreclosure database screen]!Status = "Bankruptcy" Or Forms![foreclosure database screen]!Status = "BK-Hold" Or _
Forms![foreclosure database screen]!Screen_Change = "Bankruptcy" Then
Vtotal = 0
GblFilenum = Forms![foreclosure database screen]!filenum
VBKId = Forms!bankruptcymain!BankruptcySubForm.Form!counter

If Not IsNull(VBKId) Then
strsql = "SELECT * FROM pocinterest WHERE Filenum = " & GblFilenum & " and bkid = " & VBKId & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If Not IsNull(rs!Int_Amt) Then

Vtotal = rs!Int_Amt + Vtotal
End If

rs.MoveNext
Loop

rs.Close
If IsNull(Vtotal) Then
InterestTotalPOC = 0
Else
InterestTotalPOC = Format(Vtotal, "$###,##0.00")

End If

End If

End If


End Function

Public Function InterestFromBK()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Dim VBKId

If Forms![foreclosure database screen]!Status = "Bankruptcy" Or Forms![foreclosure database screen]!Status = "BK-Hold" Or _
Forms![foreclosure database screen]!Screen_Change = "Bankruptcy" Then

GblFilenum = Forms![foreclosure database screen]!filenum
VBKId = Forms!bankruptcymain!BankruptcySubForm.Form!counter

If Not IsNull(VBKId) Then
strsql = "SELECT * FROM fcinterest WHERE Filenum = " & GblFilenum & " and bkid = " & VBKId & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
rs.MoveFirst

If Not IsNull(rs!Int_from) Then
InterestFromBK = rs!Int_from
Else
InterestFromBK = [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![dfrom1]
End If

End If
End If


End Function


Public Function InterestTotalBK()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Dim VBKId

If Forms![foreclosure database screen]!Status = "Bk-Hold" Or Forms![foreclosure database screen]!Status = "Bankruptcy" Or _
Forms![foreclosure database screen]!Screen_Change = "Bankruptcy" Then
Vtotal = 0
GblFilenum = Forms![foreclosure database screen]!filenum
VBKId = Forms!bankruptcymain!BankruptcySubForm.Form!counter

If Not IsNull(VBKId) Then
strsql = "SELECT * FROM fcinterest WHERE Filenum = " & GblFilenum & " and bkid = " & VBKId & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If Not IsNull(rs!Int_Amt) Then

Vtotal = rs!Int_Amt + Vtotal
End If

rs.MoveNext
Loop

rs.Close
If IsNull(Vtotal) Then
InterestTotalBK = 0
Else
InterestTotalBK = Format(Vtotal, "$###,##0.00")

End If

End If

End If


End Function
Public Function BKppsubtbl()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim rsBKPP As RecordSet

CurrentDb.Execute "DELETE * FROM BKPPSubTBL;", dbFailOnError
Dim VCount
DoCmd.OpenQuery "BKPPCreateTbl"

strsql = "Select * from BKPPSub where counter = " & Forms![foreclosure database screen].BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
Set rsBKPP = CurrentDb.OpenRecordset("BKPPSubTbl", dbOpenDynaset, dbSeeChanges)
VCount = 10
rs.MoveFirst

Do While Not rs.EOF
    With rsBKPP
    .Edit
    VCount = VCount + 1
    !Vcnt = VCount
    .Update
    End With
     rs.MoveNext
     Loop
     
rs.Close
rsBKPP.Close

End If



End Function

Public Function POCSubTbl()

Dim rs As RecordSet
Dim strsql As String
Dim rsPOC As RecordSet

CurrentDb.Execute "DELETE * FROM POCSubTBL;", dbFailOnError
Dim VCount
DoCmd.OpenQuery "POCCreateTbl"

strsql = "Select * from pocsub where counter = " & Forms![proofofclaimmain]!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
Set rsPOC = CurrentDb.OpenRecordset("POCSubTbl", dbOpenDynaset, dbSeeChanges)
VCount = 9
rsPOC.MoveFirst

Do While Not rsPOC.EOF
    With rsPOC
    .Edit
    VCount = VCount + 1
    !Vcnt = VCount
    .Update
    End With
     rsPOC.MoveNext
     Loop
     
rsPOC.Close
End If

rs.Close


End Function
Public Function POCCnt()
Dim rs As RecordSet
Dim strsql As String
Dim rsPOC As RecordSet
Dim VCount
strsql = "Select * from pocsub where counter = " & Forms![proofofclaimmain]!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

VCount = 14

If Not rs.EOF Then

Do While Not rs.EOF
   VCount = VCount + 1
   rs.MoveNext
   Loop
End If

rs.Close

POCCnt = VCount + 1


End Function
Public Function TotalPPArrears()
Dim rs As RecordSet
Dim strsql As String

strsql = "select * from proofofclaim where bkno = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
Dim Vtotalpayments
Dim VEsc
VEsc = IIf(rs![esc_amt1] > 1, rs![poc_no1] * rs![esc_amt1], 0) + IIf(rs![esc_amt2] > 0, rs![poc_no2] * rs![esc_amt2], 0) + IIf(rs![esc_amt3] > 0, rs![poc_no3] * rs![esc_amt3], 0) + IIf(rs![esc_amt4] > 0, rs![poc_no4] * rs![esc_amt4], 0)
Vtotalpayments = IIf((rs![pi_amt1] + rs!esc_amt1) > 1, rs![poc_no1] * (rs![pi_amt1] + rs!esc_amt1), 0) + IIf((rs![pi_amt2] + rs!esc_amt2) > 0, rs![poc_no2] * (rs![pi_amt2] + rs!esc_amt2), 0) + IIf((rs![pi_amt3] + rs!esc_amt3) > 0, rs![poc_no3] * (rs![pi_amt3] + rs!esc_amt3), 0) + IIf((rs![pi_amt4] + rs!esc_amt4) > 0, rs![poc_no4] * (rs![pi_amt4] + rs!esc_amt4), 0)
VtotalPPFees = rs![pp_late_charges] + rs![nsf] + rs![affes] + rs![ffees] + rs![AdCosts] + rs![Sheriff] + rs![Title] + rs![recording] + rs![appraisal] + rs![propinsp] + rs![taxadv] + rs![insurance] + (rs![esc_total] - VEsc) + rs![proppress]
vtotalsub = POCArrTotal()
TotalPPArrears = Format(Vtotalpayments + VtotalPPFees + vtotalsub + rs!uaf, "$###,##0.00")
Else
TotalPPArrears = 0
End If


End Function
Public Function TotalFinalCurePre()

' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String

strsql = "select * from bkfinalcure where fcgrp = " & """" & "Pre-Petition" & """" & " and counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
Vtotal = rs!payment_amt + Vtotal
rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
TotalFinalCurePre = Format(Vtotal, "$###,##0.00")
Else
TotalFinalCurePre = "$0.00"
End If




End Function
Public Function TotalFinalCurePost()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function



Dim rs As RecordSet
Dim strsql As String

strsql = "select * from bkfinalcure where fcgrp = " & """" & "PostPetition" & """" & " and counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
Vtotal = rs!payment_amt + Vtotal
rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
TotalFinalCurePost = Format(Vtotal, "$###,##0.00")
Else
TotalFinalCurePost = "$0.00"
End If




End Function


Public Function AddBKRecords()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim rsbkar As RecordSet
Dim Vcnt
Dim strsqlreaff As String
Dim rsReaff As RecordSet


If Forms![foreclosure database screen]!Screen_Change = "Bankruptcy" Or Forms![foreclosure database screen]!Status = "BK-Hold" Or _
Forms![foreclosure database screen]!Status = "Bankruptcy" Then

Vcnt = Forms!bankruptcymain!BankruptcySubForm.Form!counter
GblFilenum = Forms![foreclosure database screen]!filenum

If IsNull(Vcnt) Then
Exit Function

Else

strsql = "select * from bkmort where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("bkmort", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing
End If

strsql = "select * from bkppfees where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("bkppfees", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing
End If

strsql = "select * from nodresolution where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("nodresolution", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!SubFileNum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing
End If


strsql = "select * from bkmisc where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("bkmisc", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!SubFileNum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing
End If


strsql = "select * from BKPostPetition where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("BKPostPetition", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing
End If


strsql = "select * from pocpayments where counter = " & Vcnt & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Set rs = CurrentDb.OpenRecordset("pocpayments", dbOpenDynaset, dbSeeChanges)
With rs
.AddNew
!filenum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rs = Nothing

End If

strsql = "select * from BKarrearages where counter = " & Vcnt & ";"
Set rsbkar = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsbkar.EOF Then
rsbkar.Close
Set rsbkar = CurrentDb.OpenRecordset("BKArrearages", dbOpenDynaset, dbSeeChanges)
With rsbkar
.AddNew
!SubFileNum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rsbkar = Nothing

End If

strsqlreaff = "select * from bk_Reaffirmation where counter = " & Vcnt & ";"
Set rsReaff = CurrentDb.OpenRecordset(strsqlreaff, dbOpenSnapshot)

If rsReaff.EOF Then
rsReaff.Close
Set rsReaff = CurrentDb.OpenRecordset("bk_reaffirmation", dbOpenDynaset, dbSeeChanges)
With rsReaff
.AddNew
!SubFileNum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rsReaff = Nothing

End If

Dim strsqlLM
Dim rsLM As RecordSet

strsqlLM = "select * from bkloanmod where counter = " & Vcnt & ";"
Set rsLM = CurrentDb.OpenRecordset(strsqlreaff, dbOpenSnapshot)

If rsLM.EOF Then
rsLM.Close
Set rsLM = CurrentDb.OpenRecordset("bkloanmod", dbOpenDynaset, dbSeeChanges)
With rsLM
.AddNew
!SubFileNum = GblFilenum
!counter = Vcnt
.Update
.Close
End With
Set rsLM = Nothing

End If


End If
End If


End Function
Public Function totalsecuredclaim()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim VUPB
Dim strsql As String
Dim rs As RecordSet
strsql = "select * from bkarrearages where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
VUPB = rs!bk_upb + InterestTotalPOC()
Else
VUPB = 0
End If
rs.Close

strsql = "select * from proofofclaim where bkno = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
vespays = IIf(rs![esc_amt1] > 1, rs![poc_no1] * rs![esc_amt1], 0) + IIf(rs![esc_amt2] > 0, rs![poc_no2] * rs![esc_amt2], 0) + IIf(rs![esc_amt3] > 0, rs![poc_no3] * rs![esc_amt3], 0) + IIf(rs![esc_amt4] > 0, rs![poc_no4] * rs![esc_amt4], 0)

totalsecuredclaim = VUPB + rs![pp_late_charges] + rs![nsf] + rs![affes] + rs![ffees] + rs![AdCosts] + rs![Sheriff] + rs![Title] + rs![recording] + rs![appraisal] + rs![propinsp] + rs![taxadv] + rs![insurance] + rs!esc_total + rs![proppress] - (rs!esc_total - vespays)
Else
totalsecuredclaim = 0
End If

End Function

Public Function POCArrFORM()

Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

strsql = "SELECT * FROM POCsub WHERE pocsub.counter = " & [Forms]![pocform]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

Do While Not rs.EOF
Vtotal = rs!payment_amt + Vtotal
rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
POCArrFORM = Format(Vtotal, "$###,##0.00")
Else
POCArrFORM = 0
End If


End Function


Public Function BKPPArrTotal()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) And (Forms![foreclosure database screen]!Status = "BK-Hold" Or Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then

strsql = "SELECT BKPPSub.* from BKPPsub WHERE BKPPSub.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs!payment_amt > 0 Then
Vtotal = rs!payment_amt + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
BKPPArrTotal = Format(Vtotal, "$###,##0.00")
Else
BKPPArrTotal = 0
End If

End If



End Function

Public Function BKPayTotalPayments() As Integer
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![counter]) And (Forms![foreclosure database screen]!Status = "BK-Hold" Or Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then

strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs![co #payments] > 0 Then
Vtotal = rs![co #payments] + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
BKPayTotalPayments = Format(Vtotal, "$###,##0.00")
Else
BKPayTotalPayments = 0
End If
End If

'MsgBox (Forms!bankruptcymain!BankruptcySubform.Form!Counter & ": " & BKPayTotalPayments)

End Function


Public Function RMP()
Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) And _
(Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Status = "BK-Hold" Or _
Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then
strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & " order by dthru ASC;"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs![co Amt] > 0 Then
Vtotal = rs![co Amt]
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment] = Format(Vtotal, "$###,##0.00")
Else
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment] = 0
End If
End If



End Function

Public Function BKPayTotalLatecharges() As Integer
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function

Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) And (Forms![foreclosure database screen]!Status = "BK-Hold" Or Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then

strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs![co #latecharges] > 0 Then
Vtotal = rs![co #latecharges] + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
BKPayTotalLatecharges = Format(Vtotal, "$###,##0.00")
Else
BKPayTotalLatecharges = 0
End If
End If

End Function
Public Function BKHearingDateRPT()

End Function

Public Function BKPayTotalLate() As Currency
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function

Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) And (Forms![foreclosure database screen]!Status = "BK-Hold" Or Forms![foreclosure database screen]!Status = "bankruptcy" Or Forms![foreclosure database screen]!Screen_Change = "bankruptcy") Then

strsql = "SELECT BKArrpayments.* from bkarrpayments WHERE bkarrpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs![co #latecharges] > 0 Then
Vtotal = (rs![co #latecharges] * rs![co Latecharge]) + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
BKPayTotalLate = Format(Vtotal, "$###,##0.00")
Else
BKPayTotalLate = 0
End If
End If

End Function
Public Function POCArrTotal()
Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0



strsql = "SELECT POCSub.* from pocsub WHERE POCSub.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs!payment_amt > 0 Then
Vtotal = rs!payment_amt + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
POCArrTotal = Format(Vtotal, "$###,##0.00")
Else
POCArrTotal = 0
End If




End Function
Public Function pocpaymentsTotal() As Currency


pocpaymentsTotal = POCPITotal + POCEscTotal



End Function

Public Function POCPITotal() As Currency
Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

strsql = "SELECT pocpayments.* from pocpayments WHERE pocpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs!pi_amt > 0 Then
Vtotal = (rs!poc_no * rs!pi_amt) + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
POCPITotal = Format(Vtotal, "$###,##0.00")
Else
POCPITotal = 0
End If




End Function

Public Function POCEscTotal() As Currency
Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

strsql = "SELECT pocpayments.* from pocpayments WHERE pocpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs!esc_amt > 0 Then
Vtotal = (rs!poc_no * rs!esc_amt) + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
POCEscTotal = Format(Vtotal, "$###,##0.00")
Else
POCEscTotal = 0
End If




End Function
Public Function POCNoTotal()
Dim rs As RecordSet
Dim strsql As String
Dim Vtotal
Vtotal = 0

strsql = "SELECT pocpayments.* from pocpayments WHERE pocpayments.counter = " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter] & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Do While Not rs.EOF
If rs!poc_no > 0 Then
Vtotal = rs!poc_no + Vtotal
End If

rs.MoveNext
Loop
rs.Close

If Vtotal > 0 Then
POCNoTotal = Format(Vtotal, "$###,##0.00")
Else
POCNoTotal = 0
End If




End Function


Public Function BKCapAdd()


If Not IsNull(mailadd()) And Not IsNull(mailaddb()) Then
VSelAdd = InputBox("Select:" & vbCr & "1. Property: " & propadd() & vbCr & "2. Mailing Address #1: " & mailadd() & vbCr & "3. Mailing Address #2:" & mailaddb() & vbCr & vbCr & "type in 1, 2 or 3")
ElseIf Not IsNull(mailadd()) And IsNull(mailaddb()) Then
VSelAdd = InputBox("Select:" & vbCr & "1. Property: " & propadd() & vbCr & "2. Mailing Address #1: " & mailadd() & vbCr & vbCr & "type in 1 or 2")
Else
VSelAdd = 1
End If


If VSelAdd = 1 Then
BKCapAdd = propadd()
ElseIf VSelAdd = 2 Then
BKCapAdd = mailadd()
ElseIf VSelAdd = 3 Then
BKCapAdd = mailaddb()
Else
BKCapAdd = propadd()
End If


End Function
Public Function bkCAPAdd2()
If VSelAdd = 1 Then
bkCAPAdd2 = propadd2()
ElseIf VSelAdd = 2 Then
bkCAPAdd2 = mailadd2()
ElseIf VSelAdd = 3 Then
bkCAPAdd2 = mailadd2b()
Else
bkCAPAdd2 = propadd2()
End If

End Function
Public Function bkCAPAdd3()
If VSelAdd = 1 Then
bkCAPAdd3 = propadd3()
ElseIf VSelAdd = 2 Then
bkCAPAdd3 = mailadd3()
ElseIf VSelAdd = 3 Then
bkCAPAdd3 = mailadd3B()
Else
bkCAPAdd3 = propadd3()
End If

End Function

Public Function NODAttFee() As String

Dim strsql As String
Dim rs As RecordSet

NODAttFee = ""
strsql = "select * from affs where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & " and aff_filed = " & _
[Forms]![bankruptcymain]![BankruptcySubForm].[Form]![noticedefault].[Form]![PrtNotice] & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then
rs.MoveFirst
End If

Do While Not rs.EOF
If rs!payment_txt Like "Attorney*" Then
NODAttFee = ", which includes " & Format(rs!payment_amt, "$###,##0.00") & " for attorney's fees associated with the filing of this Notice of Default"
End If

rs.MoveNext
Loop


End Function

Public Function BkTitleClaimNeeded()
Dim emailsubject As String
Dim emailmessage As String

emailsubject = "Title Claim Needed for Bankruptcy File#: " & Forms![foreclosure database screen]!filenum

Dim Msg1, Msg2, Msg3, Msg4
Dim msg5, msg6


Msg1 = MsgBox("Has an Adversary Complaint been filed?", vbYesNo)
If Msg1 = vbYes Then
Msg2 = InputBox("What Date?")
Msg3 = InputBox("When are the responses due?")
msg5 = "Has an Adversary Complaint been filed?  YES" & vbCr & "What date? " & Msg2 & vbCr & "When are the responses due? " & Msg3
Else
msg5 = "Has an Adversary Complaint been filed?  NO"
End If

Msg4 = MsgBox("Do you have Relief from Stay?", vbYesNo)

If Msg4 = vbYes Then
msg6 = "Do you have Relief from Stay?  YES"
Else
msg6 = "Do you have Relief from Stay?  NO"
End If




emailmessage = "Filed BK: " & bkdebtorfiled() & vbCr & "Date Filed: " & Forms!bankruptcymain!BankruptcySubForm.Form![DateFiled] & _
vbCr & "Case#: " & BKCaseNumber() & _
vbCr & "Chapter: " & BKChapter() & _
vbCr & "Lender: " & Trim(Client()) & _
vbCr & "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & _
vbCr & vbCr & "Issues and Special instructions: " & vbCr & msg5 & vbCr & msg6

Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "Reese.Lesko@bww-law.com; Priscilla.Upperman@bww-law.com; Jennifer.Rice@bww-law.com; Brittney.Taylor@bww-law.com"
MyMail.CC = ""
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing

End Function

Public Function BkMfrResultsToClient()
Dim emailsubject As String
Dim emailmessage As String

emailsubject = "Hearing Results"
emailmessage = ""

Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

DoCmd.OutputTo acOutputReport, "BK MFR Hearing Results (WorkSheet) Report", acFormatXLS, pathuser() & "\HearingResults.xls"

Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = ""
MyMail.CC = ""
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Attachments.ADD pathuser() & "\HearingResults.xls"
MyMail.Display

Set MyMail = Nothing
Set MyOutlook = Nothing
End Function
Public Function BKCo()



End Function
Public Function BKCoCap()



End Function
Public Function CalcPaymentsNOD()
'[Forms]![BankruptcyMain]![BankruptcySubForm].Form!nodresolution.[Form]![AOD Filed] = 2
Dim vdateM
Dim VPayments
Dim VtotalDebt As Currency
Dim VTotalDebt2 As Currency
Dim VTotalDebt3 As Currency
Dim Vlump As Currency

Dim rs As RecordSet
Dim strsql As String
Dim VAttFee
Dim VAttFee2
Dim VAttFee3

strsql = "select * from Affs where counter = " & Forms![bankruptcymain]!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
VtotalDebt = 0
VAttFee = 0
VTotalDebt2 = 0
VAttFee2 = 0
VTotalDebt3 = 0
VAttFee3 = 0



Do While Not rs.EOF

With rs

If rs!Aff_Filed = 1 Then
VtotalDebt = rs!payment_amt + VtotalDebt
ElseIf rs!Aff_Filed = 2 Then
VTotalDebt2 = rs!payment_amt + VTotalDebt2
ElseIf rs!Aff_Filed = 3 Then
VTotalDebt3 = rs!payment_amt + VTotalDebt3

End If

End With

rs.MoveNext
Loop

'1st NOD

Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt] = VtotalDebt
If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees) Then
VAttFee = 0
Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees = 0
Else
VAttFee = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees
End If

VtotalDebt = VtotalDebt + VAttFee

'2nd NOD

Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt2] = VTotalDebt2
If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Attorney_Fees2) Then
VAttFee2 = 0
Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Attorney_Fees2 = 0
Else
VAttFee2 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Attorney_Fees2
End If

VTotalDebt2 = VTotalDebt2 + VAttFee2

'3rd NOD

Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt3] = VTotalDebt3
If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees3) Then
VAttFee3 = 0
Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees3 = 0
Else
VAttFee3 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!attorney_fees3
End If

VTotalDebt3 = VTotalDebt3 + VAttFee3


If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Lumpsum_Amt) And IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!lumpsum_amt2) Then
Vlump = 0
ElseIf Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Lumpsum_Amt) And IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!lumpsum_amt2) Then
Vlump = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Lumpsum_Amt
Else
Vlump = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!Lumpsum_Amt + Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!lumpsum_amt2

End If

If Vlump > 0 Then

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 1 Then
VtotalDebt = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt] - Vlump
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 2 Then
VTotalDebt2 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt2] - Vlump
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 3 Then
VTotalDebt3 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt3] - Vlump
End If

Else

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 1 Then
VtotalDebt = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt]
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 2 Then
VTotalDebt2 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt2]
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 3 Then
VTotalDebt3 = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt3]
End If

End If

VPayments = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form!stip_no
vpaymentsdate = VPayments - 1

If Not IsNull(vpaymentsdate) Then
vdateM = DateAdd("m", vpaymentsdate, Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![pp payment date])
End If

Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![pp thru] = vdateM

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 1 Then
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![post petition payments] = VtotalDebt / VPayments
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 2 Then
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![post petition payments] = VTotalDebt2 / VPayments
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!NODResolution.[Form]![aod filed] = 3 Then
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![post petition payments] = VTotalDebt3 / VPayments
End If



End Function

Public Function CalcPayments()

Dim vdateM
Dim VPayments
Dim VTotalArrearages As Currency
Dim Vlump As Currency

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt) And IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_amt2) Then
Vlump = 0
ElseIf Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt) And IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_amt2) Then
Vlump = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt
Else
Vlump = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt + Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_amt2

End If

If Vlump > 0 Then
VTotalArrearages = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage] - Vlump
Else
VTotalArrearages = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage]
End If

VPayments = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!stip_no
vpaymentsdate = VPayments - 1

vdateM = DateAdd("m", vpaymentsdate, Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pp payment date])

Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pp thru] = vdateM

Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![post petition payments] = VTotalArrearages / VPayments



End Function

Public Function ModFormOrder()

Dim rs As RecordSet
Dim VDateDue As String
Dim VMonths, VAdd As Integer
Dim VDateDueAdd As Date
Dim VDateLast As Date
Dim VNoMon As Integer
Dim VDateAdd2 As Date
Dim VFinal As Currency
Dim Vtotal As Currency
Dim VPartial As Currency
Dim Vlump As Currency
Dim VLumpdate As Date
Dim strsql As String
Dim vdateM
Dim VPayments

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt) Then
Vlump = 0
Else
Vlump = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt
VLumpdate = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_date

End If


CurrentDb.Execute "DELETE * FROM MotionRGM;", dbFailOnError

Set rs = CurrentDb.OpenRecordset("MotionRGM", dbOpenDynaset, dbSeeChanges)
'-------------

VNoMon = InputBox("# of Payments")
VDateDueAdd = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pp payment date]

vdateM = DateAdd("m", VPayments, Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pp payment date])

VDateAdd2 = VDateDueAdd

Dim VPkey As Integer

Dim VAmt
Dim VTot

If Vlump > 0 Then
VAmt = ((Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage]) - Vlump) / VNoMon
VTot = ((Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage]) - Vlump)

Else
VAmt = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage] / VNoMon
VTot = (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![total arrearage])

End If


VPartial = Round(VAmt, 2) * (VNoMon - 1)
Vtotal = VTot
VFinal = Vtotal - Round(VPartial, 2)
Dim Valpha

'MsgBox ("Partial: " & Round(VPartial, 2) & "/Total: " & Round(VTotal, 2) & "/Final: " & Round(Vfinal, 2))

VPkey = 1

With rs
.AddNew
!PKey = VPkey
!DateDue = VDateDueAdd
If Vlump > 0 Then
!Alpha = "b"
Else
!Alpha = "a"
End If
!AmtDue = VAmt
!counter = Forms!bankruptcymain!BankruptcySubForm.Form!counter
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With

VNoMon = VNoMon - 1
VPkey = VPkey + 1

If Vlump > 0 Then
With rs
.AddNew
!PKey = VPkey
!Alpha = "a"
!DateDue = VLumpdate
!AmtDue = Vlump
!counter = Forms!bankruptcymain!BankruptcySubForm.Form!counter
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
VPkey = VPkey + 1

End If

If Vlump > 0 Then
Valpha = "c"
Else
Valpha = "b"
End If


VPkey = VPkey + 1


While VNoMon > 0
VDateLast = DateAdd("m", 1, VDateAdd2)
VDateAdd2 = VDateLast
VNoMon = VNoMon - 1


With rs
.AddNew
!PKey = VPkey
!Alpha = Valpha
!DateDue = VDateAdd2
If VNoMon = 0 Then
!AmtDue = VFinal
Else
!AmtDue = VAmt
End If

!counter = Forms!bankruptcymain!BankruptcySubForm.Form!counter
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With

VPkey = VPkey + 1

If Valpha = "b" Then
Valpha = "c"
ElseIf Valpha = "c" Then
Valpha = "d"
ElseIf Valpha = "d" Then
Valpha = "e"
ElseIf Valpha = "e" Then
Valpha = "f"
ElseIf Valpha = "f" Then
Valpha = "g"
ElseIf Valpha = "g" Then
Valpha = "h"
ElseIf Valpha = "h" Then
Valpha = "i"
ElseIf Valpha = "i" Then
Valpha = "j"
ElseIf Valpha = "j" Then
Valpha = "k"
ElseIf Valpha = "k" Then
Valpha = "l"
ElseIf Valpha = "l" Then
Valpha = "m"
ElseIf Valpha = "m" Then
Valpha = "n"
ElseIf Valpha = "n" Then
Valpha = "o"
ElseIf Valpha = "o" Then
Valpha = "p"
ElseIf Valpha = "p" Then
Valpha = "q"
ElseIf Valpha = "q" Then
Valpha = "r"
ElseIf Valpha = "r" Then
Valpha = "s"
ElseIf Valpha = "s" Then
Valpha = "t"
ElseIf Valpha = "t" Then
Valpha = "u"
ElseIf Valpha = "u" Then
Valpha = "v"
ElseIf Valpha = "v" Then
Valpha = "w"
ElseIf Valpha = "w" Then
Valpha = "x"
ElseIf Valpha = "x" Then
Valpha = "y"
ElseIf Valpha = "y" Then
Valpha = "z"
End If



Wend



DoCmd.OutputTo acOutputReport, "MotionRGM", acFormatRTF, "c:\4closure\ModFormOrder.rtf"

'DoCmd.OpenReport "MotionRGM", acViewPreview

End Function
Public Function MotionRich()
Dim Venter

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Or _
 Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norfol*" Or _
  Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newport*" Then

MotionRich = ". The Property is more particularly described as follows: "

Else
MotionRich = "."

End If

End Function
Public Function ExhMPS1()

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 Then
ExhMPS1 = 1
Else
ExhMPS1 = 0
End If


End Function
Public Function ExhMPS2()

If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1) Or _
([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![orgNoteholder] = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![orgNoteholder] = 1) Then
ExhMPS2 = ExhMPS1 + 1
Else
ExhMPS2 = ExhMPS1
End If

End Function

Public Function ExhMPS3()

ExhMPS3 = gVExh + 1

End Function

Public Function ExhLMA()
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!loanMod = -1 Or _
 Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!loanMod = 1 Then

ExhLMA = gVExh + 1
Else
ExhLMA = gVExh
End If



End Function
Public Function ExhTDW()
If BKChapter() = "7" Then
ExhTDW = ExhLMA + 1
Else
ExhTDW = ExhLMA
End If

End Function
Public Function ExhArr()
If BKChapter() = "13" Then
ExhArr = ExhTDW + 1
Else
ExhArr = ExhTDW
End If

End Function
Public Function BKArrFrom()

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then
rs.MoveFirst
BKArrFrom = rs!Chain_From
Else
BKArrFrom = "Movant"
End If

rs.Close





End Function


Public Function MotionNorNNPS()
gVAssign = 0
gVExh = ExhMPS2()



If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Or _
Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newp*" Then


Dim rs As RecordSet
Dim strsql As String
Dim VEndLoc
Dim Vcnt
Dim VPrevChainFrom
Dim VPrevChainTo
VAssign = 0

Vcnt = 0
MotionNorNNPS = ""
VPrevChainFrom = ""
VPrevChainTo = ""

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Motion1
Dim Motion2
Motion2 = ""
Motion1 = ""
Dim Vcopy

'count assignment
Do While Not rs.EOF

If rs!MeansTransfer Like "Assig*" Then
VAssign = VAssign + 1
End If

rs.MoveNext
Loop
'end of count assignments

rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1

If rs!EndorsementLocation Like "allon*" Then
VEndLoc = "an allonge affixed to the Note"
ElseIf rs!backofpage = 1 Or rs!backofpage = -1 Then
VEndLoc = "the back of " & Trim(rs!EndorsementLocation) & " of the Note"
Else
VEndLoc = Trim(rs!EndorsementLocation) & " of the Note"
End If

If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 1) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then

If rs!MeansTransfer Like "blank*" Then
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & ExhMPS2() & """" & ")."
gVExh = ExhMPS2()
ElseIf VAssign > 0 Then
If VAssign > 1 Then
Vcopy = "(Copies of the Note and Assignments are attached hereto and filed as  Exhibits " & """" & ExhMPS2() & """" & " and " & """" & ExhMPS2() + 1 & "-" & VAssign + 3 & "," & """" & " respectively" & """" & ")."
gVExh = VAssign + ExhMPS2() + 1
Else
Vcopy = "(Copies of the Note and Assignment are attached hereto and filed as  Exhibits " & """" & ExhMPS2() & """" & " and " & """" & ExhMPS2() + 1 & """" & ", respectively" & """" & ")."
gVExh = ExhMPS2() + 1
End If
Else
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & ExhMPS2() & """" & ")."
gVExh = ExhMPS2()
End If


ElseIf (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached])) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
If rs!MeansTransfer Like "blank*" Then
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
Else
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
End If
End If


If rs!MeansTransfer Like "blank*" Then
If Vcnt = 1 Then

Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant became the holder of the original Note indorsed in blank.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant became the holder of the original Note indorsed in blank.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If


ElseIf rs!MeansTransfer Like "spec*" Then

If Vcnt = 1 Then
Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To
End If

ElseIf rs!MeansTransfer Like "assign*" Then
gVAssign = gVAssign + 1

If Vcnt = 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment 1" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment " & gVAssign & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If

End If


rs.MoveNext
Loop


MotionNorNNPS = Motion1 + Vcopy

Else


If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 1) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
MotionNorNNPS = "(A copy of the Note is attached hereto and filed as Exhibit " & """" & "2" & """" & ")."
gVExh = 2

ElseIf (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached])) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
MotionNorNNPS = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
End If

End If


End Function



Public Function MotionNorNN()
gVAssign = 0
gVExh = ExhMPS2()


If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Or _
Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newp*" Then


Dim rs As RecordSet
Dim strsql As String
Dim VEndLoc
Dim Vcnt
Dim VPrevChainFrom
Dim VPrevChainTo
VAssign = 0

Vcnt = 0
MotionNorNN = ""
VPrevChainFrom = ""
VPrevChainTo = ""

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Motion1
Dim Motion2
Motion2 = ""
Motion1 = ""
Dim Vcopy

'count assignment
Do While Not rs.EOF

If rs!MeansTransfer Like "Assig*" Then
VAssign = VAssign + 1
End If

rs.MoveNext
Loop
'end of count assignments

'If Not rs.EOF Then

rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1

If rs!EndorsementLocation Like "allon*" Then
VEndLoc = "an allonge affixed to the Note"
ElseIf rs!backofpage = 1 Or rs!backofpage = -1 Then
VEndLoc = "the back of " & Trim(rs!EndorsementLocation) & " of the Note"
Else
VEndLoc = Trim(rs!EndorsementLocation) & " of the Note"
End If

If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 1) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then

If rs!MeansTransfer Like "blank*" Then
Vcopy = "(A copy of the original Note is attached hereto and filed as  Exhibit " & """" & "2" & """" & ")."
gVExh = ExhMPS2()
ElseIf VAssign > 0 Then
If VAssign > 1 Then
Vcopy = "(Copies of the Note and Assignments are attached hereto and filed as  Exhibits " & """" & ExhMPS2() & """" & " and " & """" & ExhMPS2() + 1 & "-" & VAssign + 3 & "," & """" & " respectively" & """" & ")."
gVExh = VAssign + 3
Else
Vcopy = "(Copies of the Note and Assignment are attached hereto and filed as  Exhibits " & """" & ExhMPS2() & """" & " and " & """" & ExhMPS2() + 1 & """" & ", respectively" & """" & ")."
gVExh = ExhMPS2() + 1
End If
Else
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & ExhMPS2() & """" & ")."
gVExh = ExhMPS2()
End If


ElseIf (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached])) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
If rs!MeansTransfer Like "blank*" Then
Vcopy = "(A copy of the original Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
Else
Vcopy = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
End If
End If




If rs!MeansTransfer Like "blank*" Then
If Vcnt = 1 Then

Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If


ElseIf rs!MeansTransfer Like "spec*" Then

If Vcnt = 1 Then
Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To
End If

ElseIf rs!MeansTransfer Like "assign*" Then
gVAssign = gVAssign + 1

If Vcnt = 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment 1" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment " & gVAssign & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If

End If


rs.MoveNext
Loop


MotionNorNN = Motion1 + "  The Movant is the current holder of the Note secured by the Deed of Trust.  " + Vcopy

Else


If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 1) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
MotionNorNN = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "2" & """" & ")."
gVExh = 2

ElseIf (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached])) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 1) Then
MotionNorNN = "(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ")."
gVExh = 1
End If

End If


'& IIf(([dot_attached]=-1 Or [dot_attached]=1) And ([note_attached]=-1 Or [note_attached]=1),"(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "2" & """" & ").") & IIf(([dot_attached]=0 Or [dot_attached] Is Null) And ([note_attached]=-1 Or [note_attached]=1),"(A copy of the Note is attached hereto and filed as  Exhibit " & """" & "1" & """" & ").")


End Function
Public Function lastendorsed()

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & " and lastendorsed = " & -1 & " or lastendorsed = " & 1 & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If Not rs.EOF Then

vsent1 = "The Note is a negotiable instrument under Va. Code 8.3A-104.  "
vsent2 = """" & "Deeds of trust and mortgages are regarded in equity as mere securities for the debt, and whenever the debt is assigned the deed of trust or mortgage is assigned or transferred with it." & """" & "  Horvath v. Bank of New York, N.A., 641 F.3d 617, 623 (2011)(quoting Williams v. Gifford, 139 Va. 779 (1924)."

If rs!MeansTransfer Like "blank*" Then
lastendorsed = vsent1 + "When " & rs!Chain_From & " endorsed the Note in blank, it became payable to bearer and enforceable by the holder of the Note.  The entity in possession of the Note as of the date of this Motion is " & rs!Chain_To & ", as agent and/or custodian for and on behalf of Movant.  " + vsent2

ElseIf rs!MeansTransfer Like "Spec*" Then
lastendorsed = vsent1 + "When " & rs!Chain_From & " endorsed the Note to Movant it became payable to Movant, and Movant obtained the right to enforce the Note.  See Va. Code  8.3A-203 - 205.  " & vsent2

End If

Else

MsgBox ("No Data in Chain")

End If


End Function

Public Function MotionNorNNPOC()
gVAssign = 0
gVExh = 0

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Or _
Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newp*" Then


Dim rs As RecordSet
Dim strsql As String
Dim VEndLoc
Dim Vcnt
Dim VPrevChainFrom
Dim VPrevChainTo
VAssign = 0

Vcnt = 0
MotionNorNNPOC = ""
VPrevChainFrom = ""
VPrevChainTo = ""

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then

Dim Motion1
Dim Motion2
Motion2 = ""
Motion1 = ""
Dim Vcopy

'count assignment
Do While Not rs.EOF

If rs!MeansTransfer Like "Assig*" Then
VAssign = VAssign + 1
End If

rs.MoveNext
Loop
'end of count assignments

rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1

If rs!EndorsementLocation Like "allon*" Then
VEndLoc = "an allonge affixed to the Note"
ElseIf rs!backofpage = 1 Or rs!backofpage = -1 Then
VEndLoc = "the back of " & Trim(rs!EndorsementLocation) & " of the Note"
Else
VEndLoc = Trim(rs!EndorsementLocation) & " of the Note"
End If


If rs!MeansTransfer Like "blank*" Then
If Vcnt = 1 Then
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LoanDocsReceived) Then

Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Claimant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "

Else
Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Claimant is currently in possession of the original Note indorsed in blank.  "

End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LoanDocsReceived) Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Claimant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "

Else
Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Claimant is currently in possession of the original Note indorsed in blank.  "

End If


VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If


ElseIf rs!MeansTransfer Like "spec*" Then

If Vcnt = 1 Then
Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To
End If

ElseIf rs!MeansTransfer Like "assign*" Then
gVAssign = gVAssign + 1

If Vcnt = 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment 1" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment " & gVAssign & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If

End If


rs.MoveNext
Loop


MotionNorNNPOC = Motion1 + "  The Claimant is the current holder of the Note secured by the Deed of Trust.  " + Vcopy


End If

End If

End Function


Public Function MotionNorNNBAC()
gVAssign = 0
gVExh = 0

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Or _
Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newp*" Then


Dim rs As RecordSet
Dim strsql As String
Dim VEndLoc
Dim Vcnt
Dim VPrevChainFrom
Dim VPrevChainTo
VAssign = 0

Vcnt = 0
MotionNorNNBAC = ""
VPrevChainFrom = ""
VPrevChainTo = ""

strsql = "select * from bkchain where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim Motion1
Dim Motion2
Motion2 = ""
Motion1 = ""
Dim Vcopy

'count assignment
Do While Not rs.EOF

If rs!MeansTransfer Like "Assig*" Then
VAssign = VAssign + 1
End If

rs.MoveNext
Loop
'end of count assignments

rs.MoveFirst

Do While Not rs.EOF
Vcnt = Vcnt + 1

If rs!EndorsementLocation Like "allon*" Then
VEndLoc = "an allonge affixed to the Note"
ElseIf rs!backofpage = 1 Or rs!backofpage = -1 Then
VEndLoc = "the back of " & Trim(rs!EndorsementLocation) & " of the Note"
Else
VEndLoc = Trim(rs!EndorsementLocation) & " of the Note"
End If


If rs!MeansTransfer Like "blank*" Then
If Vcnt = 1 Then

Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a blank indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to the bearer.  The Movant is currently in possession of the original Note indorsed in blank, and has provided the original Note to its counsel.  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If


ElseIf rs!MeansTransfer Like "spec*" Then

If Vcnt = 1 Then
Motion1 = Motion1 + "The original holder of the Note, " & rs!Chain_From & ", by and through its " & rs!BankRep & ", executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

Motion1 = Motion1 + VPrevChainTo & ", by and through its " & rs!BankRep & ", subsequently executed a special indorsement of the Note, which indorsement is located on " & VEndLoc & _
", making the Note payable to " & rs!Chain_To & ".  "
VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To
End If

ElseIf rs!MeansTransfer Like "assign*" Then
gVAssign = gVAssign + 1

If Vcnt = 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment 1" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + "The original beneficiary under the Deed of Trust, " & rs!Chain_From & ", executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

ElseIf Vcnt > 1 Then

If VAssign > 1 Then
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (" & """" & "Assignment " & gVAssign & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
Else
Motion1 = Motion1 + VPrevChainTo & ", subsequently executed an assignment dated " & _
Format(rs!docdate, "mmmm dd, yyyy") & " (the " & """" & "Assignment" & """" & _
"), assigning its beneficial interest in the Deed of Trust securing payment of the Note to " & rs!Chain_To & ".  "
End If

VPrevChainFrom = rs!Chain_From
VPrevChainTo = rs!Chain_To

End If

End If


rs.MoveNext
Loop


MotionNorNNBAC = Motion1 + "  The Movant is the current holder of the Note secured by the Deed of Trust.  " + Vcopy


End If


End Function

Public Function ConsentWSheet()
CurrentDb.Execute "DELETE * FROM Consent;", dbFailOnError

Dim rs, rsConsent As RecordSet
Dim strsql, VNewYear, VMonth, VYear As String
Dim Vnumpayments, VDueFrom As Integer


vFile = Forms!bankruptcymain!BankruptcySubForm.Form.Form!counter
strsql = "select * from bkarrpayments where counter = " & vFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsConsent = CurrentDb.OpenRecordset("Consent", dbOpenDynaset, dbSeeChanges)


Vnumpayments = rs![co #payments]
VMonth = Format(rs![dfrom], "mmmm")
VYear = Format(rs![dfrom], "yyyy")

If IsNull(rs![dfrom]) Then
MsgBox ("To run listing, due from date HAS to be input")
Exit Function
End If

If Vnumpayments = 0 Then
MsgBox ("To run listing for Consent Worksheet, number of payments HAS to be input")
Exit Function
Else
VDueFrom = 1

Do While Vnumpayments <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![co Amt]
.Update
End With
Vnumpayments = Vnumpayments - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![dfrom]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![dfrom], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![dfrom]), "mmmm")
VDueFrom = VDueFrom + 1


Loop
End If

rs.Close

'Late Charges...

strsql = "select * from bkarrpayments where [co #latecharges] > " & 0 & " and counter = " & vFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then

Vnumpayments = rs![co #latecharges]
VMonth = Format(rs![dfrom], "mmmm")
VYear = Format(rs![dfrom], "yyyy")

VDueFrom = 1

Do While Vnumpayments <> 0

With rsConsent
.AddNew
!Cmonth = "Late Charge: " & VMonth
!Cyear = VYear
!Cpayment = rs![co Latecharge]
.Update
End With
Vnumpayments = Vnumpayments - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![dfrom]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![dfrom], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![dfrom]), "mmmm")
VDueFrom = VDueFrom + 1


Loop
End If
rs.Close






End Function
Public Function BKPPStip()

CurrentDb.Execute "DELETE * FROM Consent;", dbFailOnError

CurrentDb.Execute "DELETE * FROM BKStip;", dbFailOnError

Dim rs, rsConsent As RecordSet
Dim strsql, VNewYear, VMonth, VYear As String
Dim Vnumpayments, VDueFrom As Integer
Dim VDay
DoCmd.OpenQuery ("BKArrearageRGM")
Set rs = CurrentDb.OpenRecordset("BKStip", dbOpenSnapshot)

Set rsConsent = CurrentDb.OpenRecordset("Consent", dbOpenDynaset, dbSeeChanges)

Vnumpayments = rs![MonthsDue]
VMonth = Format(rs![cfrom], "mmmm")
VYear = Format(rs![cto], "yyyy")
VDay = Format(rs![cday], "dd")

If IsNull(rs![cfrom]) Then
MsgBox ("To run listing for PP Stipulation, due from date HAS to be input")
Exit Function
End If

If Vnumpayments = 0 Then
MsgBox ("To run listing for Consent Worksheet, number of payments HAS to be input")
Exit Function

Else
VDueFrom = 1

Do While Vnumpayments <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![ONESIXTH]
!cday = rs!cday
!CALpha = Format(rs!ONESIXTH, "$###,##0.00") & " on or before " & VMonth & " " & rs!cday & ", " & VYear & "."

.Update
End With
Vnumpayments = Vnumpayments - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![cfrom]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![cfrom], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![cfrom]), "mmmm")
VDueFrom = VDueFrom + 1


Loop
End If
End Function
Public Function BKConsentPayments()
CurrentDb.Execute "DELETE * FROM Consent;", dbFailOnError

Dim rs, rsConsent As RecordSet
Dim strsql, VNewYear, VMonth, VYear As String
Dim Vnumpayments, VDueFrom As Integer
Dim VDay

vFile = Forms!bankruptcymain!BankruptcySubForm.Form.Form!counter
strsql = "select [due from], coamt2, coamt3, coamt4, copayments2, copayments3, copayments4, [due through], [CO #payments], [co amt], [Regular Monthly Payment] from bankruptcy where counter = " & vFile & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsConsent = CurrentDb.OpenRecordset("Consent", dbOpenDynaset, dbSeeChanges)
Vnumpayments = rs![co #payments]
VMonth = Format(rs![Due From], "mmmm")
VYear = Format(rs![Due From], "yyyy")
VDay = Format(rs![Due From], "dd")
Vnumpayments2 = rs![copayments2]
Vnumpayments3 = rs![copayments3]
Vnumpayments4 = rs![copayments4]

If IsNull(rs![Due From]) Then
MsgBox ("To run listing for Consent Worksheet, due from date HAS to be input")
Exit Function
End If

If Vnumpayments = 0 Then
MsgBox ("To run listing for Consent Worksheet, number of payments HAS to be input")
Exit Function

Else
VDueFrom = 1

Do While Vnumpayments <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![co Amt]
!cday = VDay
.Update
End With
Vnumpayments = Vnumpayments - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![Due From]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![Due From], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![Due From]), "mmmm")
VDueFrom = VDueFrom + 1


Loop


Do While Vnumpayments2 <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![coamt2]
!cday = VDay

.Update
End With
Vnumpayments2 = Vnumpayments2 - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![Due From]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![Due From], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![Due From]), "mmmm")
VDueFrom = VDueFrom + 1


Loop

Do While Vnumpayments3 <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![coamt3]
!cday = VDay

.Update
End With
Vnumpayments3 = Vnumpayments3 - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![Due From]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![Due From], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![Due From]), "mmmm")
VDueFrom = VDueFrom + 1


Loop

Do While Vnumpayments4 <> 0

With rsConsent
.AddNew
!Cmonth = VMonth
!Cyear = VYear
!Cpayment = rs![coamt4]
!cday = VDay

.Update
End With
Vnumpayments4 = Vnumpayments4 - 1

If VMonth Like "Dec*" Or VNewYear = "YES" Then
VYear = Format(DateAdd("y", 365, rs![Due From]), "yyyy")
VNewYear = "YES"
Else
VYear = Format(rs![Due From], "yyyy")
End If


VMonth = Format(DateAdd("m", VDueFrom, rs![Due From]), "mmmm")
VDueFrom = VDueFrom + 1


Loop

End If


End Function
Public Function BKMiniScr()

DoCmd.Close acForm, "BKHearingsScreen", acSaveYes

DoCmd.OpenReport "BK Hearing Date Mini ReportScreen", acViewPreview

End Function
Public Function bkCertName()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertName = ""
Else
bkCertName = rsCreditors!OrganizationName
End If


End Function
Public Function bkCertAdd()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertAdd = ""
Else
If rsCreditors!Address2 <> "" Then
bkCertAdd = rsCreditors!Address & ", " & rsCreditors!Address2
Else
bkCertAdd = rsCreditors!Address
End If
End If


End Function
Public Function bkCertCSZ()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertCSZ = ""
Else
bkCertCSZ = rsCreditors!City & ", " & rsCreditors!State & " " & rsCreditors!PostalCode
End If


End Function
Public Function bkCertNamePOC()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![proofofclaimmain]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertNamePOC = ""
Else
bkCertNamePOC = rsCreditors!OrganizationName
End If


End Function
Public Function bkCertAddPOC()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![proofofclaimmain]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertAddPOC = ""
Else
If rsCreditors!Address2 <> "" Then
bkCertAddPOC = rsCreditors!Address & ", " & rsCreditors!Address2
Else
bkCertAddPOC = rsCreditors!Address
End If
End If


End Function
Public Function bkCertCSZPOC()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![proofofclaimmain]!filenum & " and bk_cert = " & -1 & " or bk_cert = " & 1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkCertCSZPOC = ""
Else
bkCertCSZPOC = rsCreditors!City & ", " & rsCreditors!State & " " & rsCreditors!PostalCode
End If


End Function
Public Function bkowner1()
Dim strsql As String

If Not IsNull(Forms![foreclosure database screen]!lastnameo1) Then
bkowner1 = owner1()

Else
Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and filed_bk = " & -1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkowner1 = ""
Else
bkowner1 = rsCreditors!OrganizationName
End If

End If

End Function
Public Function bkownerPOC1()
Dim strsql As String

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms!bankruptcymain!BankruptcySubForm.Form!SubFileNum & " and filed_bk = " & -1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rsCreditors.EOF Then
bkownerPOC1 = ""
Else
bkownerPOC1 = rsCreditors!OrganizationName
End If


End Function
Public Function bkownerPOC2()
Dim strsql As String
Dim VNo
Dim VBKO

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms!bankruptcymain!BankruptcySubForm.Form!SubFileNum & " and filed_bk = " & -1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsCreditors.EOF Then
bkowner2 = ""
Else
Do While Not rsCreditors.EOF
VNo = VNo + 1
VBKO = rsCreditors!OrganizationName
rsCreditors.MoveNext
Loop

If VNo = 2 Then
bkownerPOC2 = VBKO
Else
bkownerPOC2 = ""
End If


End If
End Function

Public Function bkowner2()
If Not IsNull(Forms![foreclosure database screen]!lastnameo2) Then

bkowner2 = owner2()
Else

Dim strsql As String
Dim VNo
Dim VBKO

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and filed_bk = " & -1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsCreditors.EOF Then
bkowner2 = ""
Else
Do While Not rsCreditors.EOF
VNo = VNo + 1
VBKO = rsCreditors!OrganizationName
rsCreditors.MoveNext
Loop

If VNo = 2 Then
bkowner2 = VBKO
Else
bkowner2 = ""
End If

End If

End If
End Function

Public Function bkowner3()
If Not IsNull(Forms![foreclosure database screen]!lastnameo3) Then

bkowner3 = owner3()
Else

Dim strsql As String
Dim VNo
Dim VBKO

Dim rsCreditors As RecordSet
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " and filed_bk = " & -1
Set rsCreditors = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsCreditors.EOF Then
bkowner3 = ""
Else
Do While Not rsCreditors.EOF
VNo = VNo + 1
VBKO = rsCreditors!OrganizationName
rsCreditors.MoveNext
Loop

If VNo = 2 Then
bkowner3 = VBKO
Else
bkowner3 = ""
End If

End If

End If
End Function


Public Function ClientLoanX()

ClientLoanX = "xxxxx" & Right(Forms![proofofclaimmain]!ClientRefNumber, 4)

End Function
Public Function LSecuredBK()
Dim VCo As String

If BKJurisdiction() Like "*MD" Or _
 BKJurisdiction() = "D.C." Then
If Forms![foreclosure database screen]!SPsameasCl = -1 Or Forms![foreclosure database screen]!SPsameasCl = 1 Then
VCo = ""
Else
VCo = ", c/o " & Client()
End If
End If

'If Forms![foreclosure database screen]![LongSecured] Like "Citifinancial Mortgage Co*" Then
'LSecuredBK = "CitiMortgage, Inc. successor by reason of merger with " & Forms![foreclosure database screen]![LongSecured] & VCo
'Else
LSecuredBK = Forms![foreclosure database screen]![longsecured] & VCo
'End If

End Function
Public Function BKNote()
BKNote = "This message is intended only for the use of the individual or entity to which it is " _
& "addressed and may contain information that is privileged, confidential and exempt from disclosure " _
& "under applicable law.  If the reader of this message is not the intended recipient, or the employee or " _
& "agent responsible for delivering the message to the intended recipient, you are hereby notified " _
& "that any dissemination, distribution or copying of this communication is strictly prohibited.  If you have received " _
& "this communication in error, please notify us immediately by telephone and return the original message " _
& "to us at the above address via the U.S. Postal Service.  Thank You."

End Function
Public Function MFRParaMd1()
Dim TotalA
Dim VNum
Dim VMdLiens
Dim VBPO
Dim Vtax

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "Tax Assm" Then
Vtax = "A copy of the Tax Assessment is attached hereto."
Else
Vtax = ""
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "BPO" Or Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "Appr" Then
Dim VBpAp
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "BPO" Then
VBpAp = "Broker's Price Opinion"
Else
VBpAp = "Appraisal"
End If

VBPO = "Based on a recent " & VBpAp & ", the current value of the Property is " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value], "$###,##0.00") & ".  A copy of the " & VBpAp & " is attached hereto."
Else
VBPO = ""
End If

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens]) Then
VMdLiens = 0
Else
VMdLiens = Format([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens], "$###,##0.00")
End If
Dim VTA

If VMdLiens = 0 And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "Tax Assm" Then
VTA = "The current year tax assessed value of the Property is " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value], "$###,##0.00") & ".  " & Vtax

ElseIf VMdLiens > 0 And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] Like "Sch*" Then
VTA = "  The " & bk() & " have scheduled the amount of the secured claims against the property as " & Format([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens], "$###,##0.00") & ".  " & Vtax

ElseIf VMdLiens > 0 And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "Tax Assm" Then
VTA = "The current year tax assessed value of the Property is " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages![property_value], "$###,##0.00") & ", and the " & bk() & " have scheduled the amount of the secured claims against the property as " & Format([Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens], "$###,##0.00") & ". " & Vtax


ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "BPO" Or Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "Appr" Then
VTA = VBPO

End If

'MsgBox (VTA)

TotalA = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt

If TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
[Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens] > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

If (TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
[Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![total_liens]) And _
(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent])) Then

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "schedule" Then
MFRParaMd1 = VNum & "The Movant avers that there is no equity in the Property because the total liens against the Property exceed its fair market value. The " & IIf(bk() = "Debtors", "Debtors have", "Debtor has") & " scheduled the Property with a market value of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value], "$###,##0.00") & " in " & IIf(bk() = "Debtors", "their", "his/her") & " filed Schedules." & VTA
Else
MFRParaMd1 = VNum & "The Movant avers that there is no equity in the Property because the total liens against the Property exceed its fair market value.  " & VTA
End If

ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value_text] = "schedule" Then
MFRParaMd1 = VNum & "The Movant avers that there is no equity in the Property because the total liens against the Property exceed its fair market value less costs associated with a private sale (assuming a 10% cost of sale). The " & IIf(bk() = "Debtors", "Debtors have", "Debtor has") & " scheduled the Property with a market value of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value], "$###,##0.00") & " in " & IIf(bk() = "Debtors", "their", "his/her") & " filed Schedules." & VTA
Else
MFRParaMd1 = VNum & "The Movant avers that there is no equity in the Property because the total liens against the Property exceed its fair market value less costs associated with a private sale (assuming a 10% cost of sale).  " & VTA

End If

End If

Else
MFRParaMd1 = ""

End If

'MsgBox (MFRParaMd1)
End Function
Public Function MRP1()



End Function
Public Function Mot1213()

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1213 = "          12.  "
Else
Mot1213 = "          13.  "
End If


End Function

Public Function Mot1314()

If ([Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = -1 Or _
[Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = 1) Then

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1314 = "          13.  "
Else
Mot1314 = "          14.  "
End If

End If

End Function

Public Function Mot1415()

If ([Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = -1 Or _
[Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = 1) Then

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1415 = "          14.  "
Else
Mot1415 = "          15.  "
End If

ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1415 = "          13.  "
Else
Mot1415 = "          14.  "
End If


End Function
Public Function MotLM()
If ([Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = -1 Or _
[Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = 1) Then

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
MotLM = "          15.  "
Else
MotLM = "          16.  "
End If

ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
MotLM = "          14.  "
Else
MotLM = "          15.  "
End If
End Function
Public Function Mot1516()
If ([Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = -1 Or _
[Forms]!bankruptcymain!BankruptcySubForm.Form.bkarrearages.Form!rule4001 = 1) Then

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1516 = "          15.  "
Else
Mot1516 = "          16.  "
End If

ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![payoff_amt] < [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![bkarrearages].[Form]![property_value] Then
Mot1516 = "          14.  "
Else
Mot1516 = "          15.  "
End If
End Function


Public Function mrp2()
Dim TotalA

TotalA = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt

If TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
mrp2 = "          13.  "
Else
mrp2 = "          14.  "
End If


If codebtorsbk() = "" Then
mrp2 = "          12.  "
Else
mrp2 = "          13.  "
End If


Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
mrp2 = "          12.  "
Else
mrp2 = "          13.  "
End If


If codebtorsbk() = "" Then
mrp2 = "          11.  "
Else
mrp2 = "          12.  "
End If

End If

End Function
Public Function MRP3()

Dim TotalA

TotalA = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt

If TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

'IIf([pre_pet_amt]>0,IIf([codebtor]="","          13.  ","          14.  "),IIf([codebtor]="","          12.  ","          13.  "))

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP3 = "          14.  "
Else
MRP3 = "          15.  "
End If


If codebtorsbk() = "" Then
MRP3 = "          13.  "
Else
MRP3 = "          14.  "
End If


Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP3 = "          13.  "
Else
MRP3 = "          14.  "
End If


If codebtorsbk() = "" Then
MRP3 = "          12.  "
Else
MRP3 = "          13.  "
End If

End If


End Function

Public Function MRP4()

Dim TotalA

TotalA = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt

If TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

'IIf([pre_pet_amt]>0,IIf([codebtor]="","          13.  ","          14.  "),IIf([codebtor]="","          12.  ","          13.  "))

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP4 = "          15.  "
Else
MRP4 = "          16.  "
End If


If codebtorsbk() = "" Then
MRP4 = "          14.  "
Else
MRP4 = "          15.  "
End If


Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP4 = "          14.  "
Else
MRP4 = "          15.  "
End If


If codebtorsbk() = "" Then
MRP4 = "          13.  "
Else
MRP4 = "          14.  "
End If

End If
End Function
Public Function MRP5()

MRP5 = Null

Dim TotalA

TotalA = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt

If TotalA > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![10percent] = 1 Then

'IIf([pre_pet_amt]>0,IIf([codebtor]="","          13.  ","          14.  "),IIf([codebtor]="","          12.  ","          13.  "))

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP5 = "          16.  "
Else
MRP5 = "          17.  "
End If


If codebtorsbk() = "" Then
MRP5 = "          15.  "
Else
MRP5 = "          16.  "
End If


Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!pre_pet_amt > 0 And _
codebtorsbk() = "" Then
MRP5 = "          15.  "
Else
MRP5 = "          16.  "
End If


If codebtorsbk() = "" Then
MRP5 = "          14.  "
Else
MRP5 = "          15.  "
End If

End If




End Function


Public Function MOTIONREF()
 
If Not CurrentProject.AllForms("BankruptcyMain").IsLoaded Then
DoCmd.OpenForm "BankruptcyMAIN", , , "[Filenum] = " & GblFilenum
End If


If BKJurisdiction() = "" Or _
IsNull(BKJurisdiction()) Then
MsgBox ("There is not a BK Jurisdiction input for this file no motion will print out!")
Else

If Client() Like "Bank of A*" Then
Call BACMfr
Else

DoCmd.RunMacro ("motion only")
End If

End If

End Function
Public Function EmailDebtorAttNOD()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim VarSend
Dim VContact
Dim VCc

VarSend = MsgBox("Sent Email to Debtors' Attorney regarding NOD?", vbYesNo)
If VarSend = vbYes Then

VContact = "Please be advised that a Notice of Default was filed in the above-referenced case.  Please contact Chris Shimizu at Chris.Shimizu@bww-law.com or call 240-482-0701 with any questions or should you wish to resolve this matter."
emailmessage = "Dear Counsel, " & vbCr & vbCr & _
VContact & vbCr & vbCr & _
vbCr & vbCr & "Note that this e-mail transmittal or other communication from our office does not in any way constitute a waiver of the requirement to file a responsive pleading within the allotted time.  If our office does not receive either a response/answer/objection or any other communication, we will conclude that the debtor has no objection to the relief sought." & _
vbCr & vbCr & BKNote()
VCc = "Chris.Shimizu@bww-law.com"



Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

emailsubject = "Notice of Default Filed/Case No. " & Forms!bankruptcymain!BankruptcySubForm.Form![BKY Case Number] & "/Debtor(s) Name:" & bkdebtorfiled()


Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = BKAttemail()
MyMail.CC = VCc
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing
End If



End Function

Public Function EmailDebtorAtt()
Dim Email As String
Dim emailsubject As String
Dim emailmessage As String
Dim VarSend
Dim VContact
Dim VCc
Dim VMfrAssigned

VarSend = MsgBox("Send Email to Debtors' Attorney?", vbYesNo)
If VarSend = vbYes Then

If BKJurisdiction() Like "*VA" Then

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to) Then
VMfrAssigned = ""
Else
VMfrAssigned = ", " & getEmployeeName(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to) & " at " & getEmployeeEmail(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to)
End If

VContact = "Please be advised that a Motion for Relief from Automatic Stay was filed in the above-referenced case.  Please contact " & VContact & VMfrAssigned & " or call 804-282-0463 with any questions or should you wish to resolve the Motion before the hearing date."

emailmessage = "Dear Counsel, " & vbCr & vbCr & _
VContact & vbCr & vbCr & _
vbCr & vbCr & "Note that this e-mail transmittal or other communication from our office does not in any way constitute a waiver of the requirement to file a responsive pleading within the allotted time.  If our office does not receive either a response/answer/objection or any other communication, we will conclude that the debtor has no objection to the relief sought." & _
vbCr & vbCr & BKNote()
VCc = "VAMFRFILED@bww-law.com"

Else

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to) Then
VMfrAssigned = ""
Else
VMfrAssigned = ", " & getEmployeeName(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to) & " at " & getEmployeeEmail(Forms!bankruptcymain!BankruptcySubForm.Form!Mfr_assigned_to)
End If


If Forms![foreclosure database screen]!PropertyState = "VA" Then
VContact = "Emmely Byrd at Emmely.Byrd@bww-law.com, Tyler Winstead at Tyler.Winstead@bww-law.com, Nicholas Porter at Nicholas.Porter@bww-law.com, Todd Rich at Todd.Rich@bww-law.com, James Flaherty at James.Flaherty@bww-law.com, Sheronda Peoples at Sheronda.peoples@bww-law.com"

Else

VContact = "Tyler Winstead at Tyler.Winstead@bww-law.com, Nicholas.Porter@bww-law.com or Matthew Kuspa at Matthew.Kuspa@bww-law.com"

End If

MsgBox (VContact)

emailmessage = "Dear Counsel, " & vbCr & vbCr & _
"Please be advised that a Motion for Relief from Automatic Stay was filed in the above-referenced case.  Please contact " & VContact & VMfrAssigned & " or call 804-282-0463 with any questions or should you wish to resolve the Motion before the hearing date." & _
vbCr & vbCr & _
vbCr & vbCr & "Note that this e-mail transmittal or other communication from our office does not in any way constitute a waiver of the requirement to file a responsive pleading within the allotted time.  If our office does not receive either a response/answer/objection or any other communication, we will conclude that the debtor has no objection to the relief sought." & _
vbCr & vbCr & BKNote()
VCc = ""
End If




Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem

emailsubject = "Motion for Relief Filed/Case No. " & Forms!bankruptcymain!BankruptcySubForm.Form![BKY Case Number] & "/Debtor(s) Name:" & bkdebtorfiled()


Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = BKAttemail()
MyMail.CC = VCc
MyMail.Subject = emailsubject
MyMail.body = emailmessage
MyMail.Display

Set MyMail = Nothing
End If


End Function
Public Function typerelief()
If BKRelief() = 1 Then
typerelief = "Terminate"
ElseIf BKRelief() = 2 Then
typerelief = "Modify"
ElseIf BKRelief() = 3 Then
typerelief = "Default"
ElseIf BKRelief() = 4 Then
typerelief = "Withdrawn"
ElseIf BKRelief() = 5 Then
typerelief = "Dismissed"
ElseIf BKRelief() = 6 Then
typerelief = "Continued"
End If

End Function

Public Function BKNotification()

Dim FEES, COSTS As Currency
Dim messagebox As String

Dim emailsubject As String
Dim emailmessage As String
Dim EM1, emailCC As String
Dim EM2 As String
Dim EM3 As String
Dim em4 As String
Dim add2 As String
Dim APhone As String
Dim AZip As String
Dim ACity As String
Dim AState As String
Dim add1  As String

MsgBox ("For " & Forms![foreclosure database screen]!Client & " files both the Fees and Costs MUST be entered, you will be prompted for both")

If Forms![foreclosure database screen]!Client Like "Homeward*" Then
Dim paidfees, paidcosts, titlecosts As Currency

FEES = InputBox("Outstanding Fees")
COSTS = InputBox("Outstanding Costs")
paidfees = InputBox("Paid Fees")
paidcosts = InputBox("Paid Costs")
ElseIf Forms![foreclosure database screen]!Client Like "Homecoming*" Then
FEES = InputBox("Enter Fees for this Sale")
COSTS = InputBox("Enter Costs for this Sale")
titlecosts = InputBox("Enter Title Costs for this Sale, needed for " & Forms![foreclosure database screen]!Client & " files.")
Else
FEES = InputBox("Enter Fees for this Sale")
COSTS = InputBox("Enter Costs for this Sale")
End If

If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
emailsubject = PROP() & " / " & debtorsbk() & " / " & "BK NOTIFICATION"
EM1 = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & vbCr & "Please be advised that " & debtorsbk() & ", Loan# " & Forms![foreclosure database screen]!ClientRefNumber & ", filed a Chapter " & Forms!bankruptcymain!BankruptcySubForm.Form![chapter]
Else
emailsubject = debtorsbk() & " / " & "BK NOTIFICATION"
EM1 = "Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & vbCr & "Please be advised that " & debtorsbk() & " filed a Chapter " & Forms!bankruptcymain!BankruptcySubForm.Form![chapter]

End If


EM2 = " petition in the U.S. Bankruptcy Court for the District of " & Forms![foreclosure database screen]!PropertyState & ", " _
& BKJuris() & " on " & Forms!bankruptcymain!BankruptcySubForm.Form![Date Filed] & " bearing Case # " _
& Forms!bankruptcymain!BankruptcySubForm.Form![BKY Case Number] & ".  "


If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
EM3 = ""
Else

If Forms!bankruptcymain!BankruptcySubForm.Form![att_add2] <> "" Then
add2 = Forms!bankruptcymain!BankruptcySubForm.Form![att_add2] & ", "
Else
add2 = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![att_add1] <> "" Then
add1 = " with offices located at " & Forms!bankruptcymain!BankruptcySubForm.Form![att_add1] & ", "
Else
add1 = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![att_city] <> "" Then
ACity = Forms!bankruptcymain!BankruptcySubForm.Form![att_city] & ", "
Else
ACity = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![att_state] <> "" Then
AState = Forms!bankruptcymain!BankruptcySubForm.Form![att_state] & "  "
Else
AState = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![att_zip] <> "" Then
AZip = Forms!bankruptcymain!BankruptcySubForm.Form![att_zip]
Else
AZip = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![att_phone] <> "" Then
APhone = ", Phone: " + Forms!bankruptcymain!BankruptcySubForm.Form![att_phone]
Else
APhone = ""
End If

EM3 = "The Attorney representing the debtor is " + Forms!bankruptcymain!BankruptcySubForm.Form![Attorney] + add1 + add2 + ACity + AState + AZip + APhone + ".  "
End If


If Forms![foreclosure database screen]!Client Like "Homeward*" Then
em4 = vbCr & "Our outstanding legal fees and costs for this sale are: " & Format(FEES + COSTS, "$###,##0.00") & " of which " & Format(FEES, "$###,##0.00") & " is our fee and " & Format(COSTS, "$###,##0.00") & " are costs."
ElseIf Forms![foreclosure database screen]!Client Like "Homecoming*" Then
em4 = "Our outstanding legal fees, title costs and costs for this sale are: " + Format(FEES + titlecosts + COSTS, "$###,##0.00") & " of which " & Format(FEES, "$###,##0.00") & " is our fee, " & Format(titlecosts, "$###,##0.00") & " is our title costs and " + Format(COSTS, "$###,##0.00") & " are costs. "
Else
em4 = "Our outstanding legal fees and costs for this sale are: " + Format(FEES + COSTS, "$###,##0.00") & " of which " & Format(FEES, "$###,##0.00") & " is our fee and " + Format(COSTS, "$###,##0.00") & " are costs. "
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!judge) Then
Dim vJudge As String
vJudge = InputBox("Citi(RL) file needs Judges' initials, please enter: ")
End If

emailmessage = EM1 + EM2 + EM3 + em4 + vbCr + "Please be advised that the Judge assigned to this case is " & bkjudgeNAME() + vbCr + SigEmail()
Else
emailmessage = EM1 + EM2 + EM3 + em4 + SigEmail()
End If


'Dim emailCC As String
'If Forms![foreclosure database screen]![Client] = "BAC Home Loans, Inc." Then
'emailCC = "Mayra_Ramirez@bankofamerica.com; Johnny_Gill@bankofamerica.com; Cheryl_McCutchan@bankofamerica.com; Maria_Leckenby@bankofamerica.com"
'Else
'emailCC = ""
'End If

Dim varsendemail As String
varsendemail = MsgBox("Sending Email, Continue?" + vbCr + emailmessage, vbYesNo)
If varsendemail = vbYes Then
MsgBox ("Please check the validity before sending email.")

DoCmd.SendObject acSendNoObject, , , , emailCC, , emailsubject, emailmessage
End If

End Function

Public Function BKCutPaste()
If IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![judge]) Then
vJudge = ""
Else
vJudge = [Forms]!bankruptcymain!BankruptcySubForm.[Form]![judge]
End If

BKCutPaste = Forms![foreclosure database screen]!filenum & "    " & bkdebtorfiled() & "    " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![BKY Case Number] & "    " & [Forms]!bankruptcymain!BankruptcySubForm.[Form]![Jurisdiction] & "    " & [Forms]![foreclosure database screen]![ClientRefNumber]


End Function

Public Function AddBillBK()
Dim varaddbill As String

varaddbill = MsgBox("You are Adding a New Bill.  Todays Date and an Invoice Number will be assigned.  The screen will refresh.  Please input information in box with date and assigned Inv#.  Do you Want to Continue?", vbYesNo)
If varaddbill = vbYes Then
Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("Billing", dbOpenDynaset, dbSeeChanges)

With rs
    .AddNew
    !CustomerID = GetAutoNumber("NextBillNum")
    !filenum = Forms![foreclosure database screen]![filenum]
    !billingdate = Date
    !bkfileno = Forms!bankruptcymain!BankruptcySubForm.Form!counter
    !Category = "Bankruptcy"
!estate_adm = 0#
!estate_cost = 0#
!dod_search = 0#
    If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![362Hearing]) Then
    !bill_MFRHearing = Forms!bankruptcymain!BankruptcySubForm.Form![362Hearing]
    End If
    
     .Update
     .Close
      End With


DoCmd.Close acForm, "BillingMainEdit-BK"
DoCmd.OpenForm "BillingMainEdit-BK"
DoCmd.Maximize
End If

End Function
Function countyBK()
If Forms![proofofclaimmain]![Propertycounty] = "James City" Then
countyBK = "City of Williamsburg and County of James City"
Else

If Forms![proofofclaimmain]![Propertycounty] Like "*City" Or _
Forms![proofofclaimmain]![Propertycounty] Like "City*" Then
countyBK = Forms![proofofclaimmain]![Propertycounty]
Else
countyBK = Forms![proofofclaimmain]![Propertycounty] & " County"
End If

End If
End Function

Function currentfilePOC()

    Dim linkcriteria As String
    Dim bkno As String
    
    
If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) Then
VarBKNo = [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]
End If
   
    If Forms![foreclosure database screen].Dirty = True Then
    DoCmd.RunCommand acCmdRefresh
    End If
    'DoCmd.Close acForm, "foreclosure database screen"
    
    Dim rs As RecordSet
    Dim strsql As String

strsql = "Select * from proofofclaim where BKNO = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rs.EOF Then
With rs
.AddNew
!filenum = Forms![foreclosure database screen]![filenum]
!bkno = VarBKNo
![pp_late_charges] = 0
![nsf] = 0
![affes] = 0
![ffees] = 0
![AdCosts] = 0
![Sheriff] = 0
![Title] = 0
![recording] = 0
![appraisal] = 0
![propinsp] = 0
![taxadv] = 0
![insurance] = 0
![esc_total] = 0
!esc_pays = 0
![proppress] = 0
.Update
End With
rs.Close
End If

    
    linkcriteria = "counter = " & VarBKNo
    
    DoCmd.OpenForm "ProofofClaimMain", , , linkcriteria
   
End Function
Public Function POCFormOPEN()
 Dim linkcriteria As String
    Dim bkno As String
    
    
If Not IsNull([Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]) Then
VarBKNo = [Forms]!bankruptcymain!BankruptcySubForm.[Form]![counter]
End If
   
    If Forms![foreclosure database screen].Dirty = True Then
    DoCmd.RunCommand acCmdRefresh
    End If
    'DoCmd.Close acForm, "foreclosure database screen"
    
    Dim rs As RecordSet
    Dim strsql As String

strsql = "Select * from proofofclaim where BKNO = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rs.EOF Then
With rs
.AddNew
!filenum = Forms![foreclosure database screen]![filenum]
!bkno = VarBKNo
![pp_late_charges] = 0
![nsf] = 0
![affes] = 0
![ffees] = 0
![AdCosts] = 0
![Sheriff] = 0
![Title] = 0
![recording] = 0
![appraisal] = 0
![propinsp] = 0
![taxadv] = 0
![insurance] = 0
![escshortage] = 0
![proppress] = 0
.Update
End With
rs.Close
End If

    
    linkcriteria = "counter = " & VarBKNo
    
    DoCmd.OpenForm "POCForm", , , linkcriteria
   
End Function

Public Function BKAttSalutation()
Dim rs As RecordSet
Dim strsql, VarSalutation As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
MsgBox ("Bankruptcy Attorney Name is Not Filled in and is needed for this Letter, Please Input")
Exit Function
Else
strsql = "Select attorney,att_salutation from dba_bkdebtorsattorneys where attorney = '" & [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] & "'"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If IsNull(rs!att_salutation) Then
VarSalutation = InputBox("Please Enter Salutation for Attorney: " & rs!Attorney)
With rs
.Edit
!att_salutation = VarSalutation
.Update
End With
Else
VarSalutation = rs!att_salutation
End If
rs.Close

BKAttSalutation = VarSalutation
End If

End Function
Public Function BKAttemail()
Dim rs As RecordSet
Dim strsql, Varemail As String
Dim vatt As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Or _
[Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] = "" Then
MsgBox ("Bankruptcy Attorney Name is Not Filled in and is needed for this email, Please Input")
Exit Function
Else
vatt = [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]
strsql = "Select * from dba_bkdebtorsattorneys where attorney = " & """" & vatt & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If rs.EOF Then
MsgBox ("BK Attorney Name not listed in database.  Attorney has to be in drop down selection box!")
Exit Function
Else

If IsNull(rs!att_Email) Or rs!att_Email = "" Then
Varemail = InputBox("Please Enter Email Address for Attorney: " & rs!Attorney)
With rs
.Edit
!att_Email = Varemail
.Update
End With

Else

Varemail = rs!att_Email
End If
rs.Close

BKAttemail = Varemail
End If

End If

End Function
Public Function BKAtt()
Dim rs As RecordSet
Dim strsql, Varemail As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
Exit Function
Else
strsql = "Select * from dba_bkdebtorsattorneys where attorney = '" & [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] & "'"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then

BKAtt = rs!Attorney
Else
BKAtt = ""
End If

rs.Close
End If

End Function
Public Function BKAttAdd1()
Dim rs As RecordSet
Dim strsql, Varemail As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
Exit Function
Else
strsql = "Select * from dba_bkdebtorsattorneys where attorney = '" & [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] & "'"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then

BKAttAdd1 = rs!att_add1
Else
BKAttAdd1 = ""
End If

rs.Close
End If

End Function

Public Function BKAttAdd2()
Dim rs As RecordSet
Dim strsql, Varemail As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
Exit Function

Else
strsql = "Select * from dba_bkdebtorsattorneys where attorney = '" & [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] & "'"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
If Not rs.EOF Then

If Not IsNull(rs!att_add2) Or rs!att_add2 = "" Then
BKAttAdd2 = rs!att_add2
Else
BKAttAdd2 = ""
End If
Else
BKAttAdd2 = ""
End If


rs.Close
End If

End Function
Public Function BKAttCSZ()
Dim rs As RecordSet
Dim strsql, Varemail As String

If IsNull([Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney]) Then
Exit Function
Else
strsql = "Select * from dba_bkdebtorsattorneys where attorney = '" & [Forms]!bankruptcymain!BankruptcySubForm.Form![Attorney] & "'"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then

If IsNull(rs!att_city) Or IsNull(rs!att_state) Or IsNull(rs!att_zip) Then
MsgBox ("City, State or Zipcode is not input for the BK Debtor(s) Attorney")
End If

If IsNull(rs!att_zip) And (Not IsNull(rs!att_city) And Not IsNull(rs!att_state)) Then
BKAttCSZ = rs!att_city & ", " & rs!att_state
Else
BKAttCSZ = rs!att_city & ", " & rs!att_state & " " & rs!att_zip
End If

Else
BKAttCSZ = ""
End If

rs.Close
End If

End Function
Public Function attorneysigns2POC() As String
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att1] = -1 _
And attorneysignsPOC <> att!Attorney1 Then
attorneysigns2POC = att![Attorney1]

ElseIf [Forms]!proofofclaimmain![att2] = -1 _
And attorneysignsPOC <> att!Attorney2 Then
attorneysigns2POC = att![Attorney2]

ElseIf [Forms]!proofofclaimmain![att3] = -1 _
And attorneysignsPOC <> att!Attorney3 Then
attorneysigns2POC = att![Attorney3]

ElseIf [Forms]!proofofclaimmain![att4] = -1 _
And attorneysignsPOC <> att!Attorney34 Then
attorneysigns2POC = att![Attorney4]

ElseIf [Forms]!proofofclaimmain![att5] = -1 _
And attorneysignsPOC <> att!attorney17 Then
attorneysigns2POC = att![attorney17]

ElseIf [Forms]!proofofclaimmain![att6] = -1 _
And attorneysignsPOC <> att!Attorney6 Then
attorneysigns2POC = att![Attorney6]

ElseIf [Forms]!proofofclaimmain![att7] = -1 _
And attorneysignsPOC <> att!Attorney7 Then
attorneysigns2POC = att![Attorney7]

ElseIf [Forms]!proofofclaimmain![att8] = -1 _
And attorneysignsPOC <> att!attorney24 Then
attorneysigns2POC = att![attorney24]

ElseIf [Forms]!proofofclaimmain![att9] = -1 _
And attorneysignsPOC <> att!Attorney9 Then
attorneysigns2POC = att![Attorney9]

ElseIf [Forms]!proofofclaimmain![att10] = -1 _
And attorneysignsPOC <> att!attorney12 Then
attorneysigns2POC = att![attorney12]

ElseIf [Forms]!proofofclaimmain![att11] = -1 _
And attorneysignsPOC <> att!Attorney10 Then
attorneysigns2POC = att![Attorney10]

ElseIf [Forms]!proofofclaimmain![att12] = -1 _
And attorneysignsPOC <> att!attorney18 Then
attorneysigns2POC = att![attorney18]

ElseIf [Forms]!proofofclaimmain![att13] = -1 _
And attorneysignsPOC <> att!attorney14 Then
attorneysigns2POC = att![attorney14]

Else
attorneysigns2POC = ""
End If
'MsgBox (attorneysigns2)
att.Close
End Function
Public Function mdfedbar2POC()
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att9] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar9
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att8] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar24
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att7] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar7
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att6] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar6
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att5] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar17
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att4] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar4
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att3] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar3
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att2] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar2
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att10] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar12
Else
mdfedbar2POC = ""
End If

ElseIf [Forms]!proofofclaimmain![att1] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
mdfedbar2POC = ", MD Fed. Bar No. " & att!MDBar1
Else
mdfedbar2POC = ""
End If


End If
'MsgBox (attorneysigns)

att.Close

End Function
Public Function MDFedBarPOC()
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att9] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar9
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att8] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar24
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att7] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar7
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att6] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar6
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att10] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar12
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att5] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar17
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att4] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar4
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att3] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar3
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att2] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar2
Else
MDFedBarPOC = ""
End If

ElseIf [Forms]!proofofclaimmain![att1] = -1 Then
If [Forms]!proofofclaimmain!Jurisdiction Like "*MD" Then
MDFedBarPOC = ", MD Fed. Bar No. " & att!MDBar1
Else
MDFedBarPOC = ""
End If


End If
'MsgBox (attorneysigns)

att.Close

End Function

Public Function attorneyemail2POC()
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att1] = -1 _
And attorneysignsPOC <> att!Attorney1 Then
attorneyemail2POC = att![att1email]
ElseIf [Forms]!proofofclaimmain![att2] = -1 _
And attorneysignsPOC <> att!Attorney2 Then
attorneyemail2POC = att![att2email]
ElseIf [Forms]!proofofclaimmain![att3] = -1 _
And attorneysignsPOC <> att!Attorney3 Then
attorneyemail2POC = att![att3email]
ElseIf [Forms]!proofofclaimmain![att4] = -1 _
And attorneysignsPOC <> att!Attorney34 Then
attorneyemail2POC = att![att34email]
ElseIf [Forms]!proofofclaimmain![att5] = -1 _
And attorneysignsPOC <> att!attorney17 Then
attorneyemail2POC = att![att17email]
ElseIf [Forms]!proofofclaimmain![att6] = -1 _
And attorneysignsPOC <> att!Attorney6 Then
attorneyemail2POC = att![att6email]
ElseIf [Forms]!proofofclaimmain![att7] = -1 _
And attorneysignsPOC <> att!Attorney7 Then
attorneyemail2POC = att![att7email]
ElseIf [Forms]!proofofclaimmain![att8] = -1 _
And attorneysignsPOC <> att!attorney24 Then
attorneyemail2POC = att![att24email]
ElseIf [Forms]!proofofclaimmain![att9] = -1 _
And attorneysignsPOC <> att!Attorney9 Then
attorneyemail2POC = att![att9email]
ElseIf [Forms]!proofofclaimmain![att13] = -1 _
And attorneysignsPOC <> att!attorney14 Then
attorneyemail2POC = att![att14email]
Else
attorneyemail2POC = ""
End If
'MsgBox (attorneyemail2)
att.Close

End Function
Public Function attorneybar2POC() As String
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)
'MsgBox (attorneysignsPOC() & " Attorney2: " & attorneysigns2)

If Forms!proofofclaimmain![att1] = -1 _
And attorneysignsPOC <> att!Attorney1 Then
If IsNull(att![Attorney1_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney1_Bar#]
End If
ElseIf Forms!proofofclaimmain![att2] = -1 _
And attorneysignsPOC <> att!Attorney2 Then
If IsNull(att![Attorney2_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney2_Bar#]
End If
ElseIf Forms!proofofclaimmain![att3] = -1 _
And attorneysignsPOC <> att!Attorney3 Then
If IsNull(att![Attorney3_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney3_Bar#]
End If
ElseIf Forms!proofofclaimmain![att4] = -1 _
And attorneysignsPOC <> att!Attorney34 Then
If IsNull(att![Attorney34_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney34_Bar#]
End If
ElseIf Forms!proofofclaimmain![att5] = -1 _
And attorneysignsPOC <> att!attorney17 Then
If IsNull(att![Attorney17_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney5_Bar#]
End If
ElseIf Forms!proofofclaimmain![att6] = -1 _
And attorneysignsPOC <> att!Attorney6 Then
If IsNull(att![Attorney6_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney6_Bar#]
End If
ElseIf Forms!proofofclaimmain![att7] = -1 _
And attorneysignsPOC <> att!Attorney7 Then
If IsNull(att![Attorney7_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney7_Bar#]
End If
ElseIf Forms!proofofclaimmain![att8 signs] = -1 _
And attorneysignsPOC <> att!attorney24 Then
If IsNull(att![attorney24_bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![attorney24_bar#]
End If
ElseIf Forms!proofofclaimmain![att9] = -1 _
And attorneysignsPOC <> att!Attorney9 Then
If IsNull(att![Attorney9_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney9_Bar#]
End If
ElseIf Forms!proofofclaimmain![att13] = -1 _
And attorneysignsPOC <> att!attorney14 Then
If IsNull(att![Attorney14_Bar#]) Then
attorneybar2POC = ""
Else
attorneybar2POC = att![Attorney14_Bar#]
End If
End If
att.Close
End Function
Public Function attorneyPhonePOC()
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att9] = -1 Then
attorneyfaxPOC = att![att5fax]
ElseIf [Forms]!proofofclaimmain![att8] = -1 Then
attorneyfaxPOC = att![att24fax]
ElseIf [Forms]!proofofclaimmain![att7] = -1 Then
attorneyfaxPOC = att![att15fax]
ElseIf [Forms]!proofofclaimmain![att6] = -1 Then
attorneyfaxPOC = att![att6fax]
ElseIf [Forms]!proofofclaimmain![att5] = -1 Then
attorneyfaxPOC = att![att17fax]
ElseIf [Forms]!proofofclaimmain![att4] = -1 Then
attorneyfaxPOC = att![att34fax]
ElseIf [Forms]!proofofclaimmain![att3] = -1 Then
attorneyfaxPOC = att![att3fax]
ElseIf [Forms]!proofofclaimmain![att2] = -1 Then
attorneyfaxPOC = att![att14fax]
ElseIf [Forms]!proofofclaimmain![att1] = -1 Then
attorneyfaxPOC = att![att1fax]

End If
'MsgBox (attorneyfax)

att.Close
End Function
Public Function attorneyfax2POC()
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att1] = -1 _
And attorneysignsPOC <> att!Attorney1 Then
attorneyfax2POC = att![att1fax]
ElseIf [Forms]!proofofclaimmain![att2] = -1 _
And attorneysignsPOC <> att!Attorney2 Then
attorneyfax2POC = att![att2fax]
ElseIf [Forms]!proofofclaimmain![att3] = -1 _
And attorneysignsPOC <> att!Attorney3 Then
attorneyfax2POC = att![att3fax]
ElseIf [Forms]!proofofclaimmain![att4] = -1 _
And attorneysignsPOC <> att!Attorney34 Then
attorneyfax2POC = att![att34fax]
ElseIf [Forms]!proofofclaimmain![att5] = -1 _
And attorneysignsPOC <> att!attorney17 Then
attorneyfax2POC = att![att17fax]
ElseIf [Forms]!proofofclaimmain![att6] = -1 _
And attorneysignsPOC <> att!Attorney6 Then
attorneyfax2POC = att![att6fax]
ElseIf [Forms]!proofofclaimmain![att7] = -1 _
And attorneysignsPOC <> att!Attorney7 Then
attorneyfax2POC = att![att7fax]
ElseIf [Forms]!proofofclaimmain![att8] = -1 _
And attorneysignsPOC <> att!attorney24 Then
attorneyfax2POC = att![att24fax]
ElseIf [Forms]!proofofclaimmain![att9] = -1 _
And attorneysignsPOC <> att!Attorney9 Then
attorneyfax2POC = att![att9fax]

Else
attorneyfax2POC = ""
End If
'MsgBox (attorneyfax2)
att.Close
End Function
Public Function attorneyemailPOC()
Dim att As RecordSet

Set att = CurrentDb.OpenRecordset("attorneys", dbOpenSnapshot)

If [Forms]!proofofclaimmain![att9] = -1 Then
attorneyemailPOC = att![att5email]
ElseIf [Forms]!proofofclaimmain![att8] = -1 Then
attorneyemailPOC = att![att24email]
ElseIf [Forms]!proofofclaimmain![att7] = -1 Then
attorneyemailPOC = att![att15email]
ElseIf [Forms]!proofofclaimmain![att6] = -1 Then
attorneyemailPOC = att![att6email]
ElseIf [Forms]!proofofclaimmain![att5] = -1 Then
attorneyemailPOC = att![att17email]
ElseIf [Forms]!proofofclaimmain![att4] = -1 Then
attorneyemailPOC = att![att34email]
ElseIf [Forms]!proofofclaimmain![att3] = -1 Then
attorneyemailPOC = att![att3email]
ElseIf [Forms]!proofofclaimmain![att2] = -1 Then
attorneyemailPOC = att![att14email]
ElseIf [Forms]!proofofclaimmain![att1] = -1 Then
attorneyemailPOC = att![att1email]

End If
'MsgBox (attorneyemail)

att.Close
End Function
Public Function ClosePOC()
 Dim DocName As String
GblFilenum = Forms!proofofclaimmain!filenum

    Dim linkcriteria As String
    Dim Figures As String
    DocName = "Foreclosure Database Screen"
    DoCmd.Close acForm, "proofofclaimmain"
    linkcriteria = "[FileNum] = " & GblFilenum
    'linkcriteria = "counter = " & VarBKNo
    
    DoCmd.OpenForm DocName, , , linkcriteria
 '  DoCmd.RunMacro ("proofofclaim")
   
End Function
Public Function bkApos() As String

gnodebtors = 0

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If gnodebtors > 1 Then
bkApos = "Debtors'"
Else
bkApos = "Debtor's"
End If
End Function

Public Function bk() As String

gnodebtors = 0

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = -1 Then
gnodebtors = 1 + gnodebtors
End If

If gnodebtors > 1 Then
bk = "Debtors"
Else
bk = "Debtor"
End If

'MsgBox (bk)

End Function
Public Function bkPOC() As String

gnodebtors = 0

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Or Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 1 Then
gnodebtors = 1 + gnodebtors
End If

If gnodebtors > 1 Then
bkPOC = "Debtors"
Else
bkPOC = "Debtor"
End If



End Function
Public Function attorneybarPOC() As String
Dim att As RecordSet

Set att = CurrentDb.OpenRecordset("attorneys", dbOpenSnapshot)

If attorneysignsPOC = att!Attorney1 Then
If IsNull(att![Attorney1_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney1_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney25 Then
If IsNull(att![attorney25_bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![attorney25_bar#]
End If
ElseIf attorneysignsPOC = att!Attorney3 Then
If IsNull(att![Attorney3_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney3_Bar#]
End If
ElseIf attorneysignsPOC = att!Attorney34 Then
If IsNull(att![Attorney34_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney34_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney17 Then
If IsNull(att![Attorney17_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney17_Bar#]
End If
ElseIf attorneybarPOC = att!Attorney6 Then
If IsNull(att![Attorney6_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney6_Bar#]
End If
ElseIf attorneybarPOC = att!attorney15 Then
If IsNull(att![Attorney15_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney15_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney24 Then
If IsNull(att![attorney24_bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![attorney24_bar#]
End If
ElseIf attorneysignsPOC = att!Attorney5 Then
If IsNull(att![Attorney5_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney5_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney12 Then
If IsNull(att![Attorney12_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney12_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney13 Then
If IsNull(att![Attorney13_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney13_Bar#]
End If
ElseIf attorneysignsPOC = att!attorney14 Then
If IsNull(att![Attorney14_Bar#]) Then
attorneybarPOC = ""
Else
attorneybarPOC = att![Attorney14_Bar#]
End If
End If
att.Close

End Function

Public Function attorneysignsPOC() As String
Dim db As Database
Dim att As RecordSet

Set db = CurrentDb()
Set att = db.OpenRecordset("attorneys", dbOpenSnapshot)

If Forms!bankruptcymain!BankruptcySubForm.Form![att9] = -1 Then

attorneysignsPOC = att![Attorney5]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att8] = -1 Then

attorneysignsPOC = att![attorney24]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att7] = -1 Then

attorneysignsPOC = att![attorney15]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att6] = -1 Then

attorneysignsPOC = att![Attorney6]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att5] = -1 Then

attorneysignsPOC = att![attorney17]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att4] = -1 Then

attorneysignsPOC = att![Attorney4]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att3] = -1 Then
attorneysignsPOC = att![Attorney3]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att2] = -1 Then
attorneysignsPOC = att![attorney25]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att1] = -1 Then
attorneysignsPOC = att![Attorney1]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att10] = -1 Then
attorneysignsPOC = att![attorney12]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att11] = -1 Then
'MsgBox ("No attorney associated with this button")
attorneysignsPOC = att![Attorney10]


'attorneysignsPOC = att![attorney13]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att12] = -1 Then
attorneysignsPOC = att![attorney18]

ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![att13] = -1 Then
attorneysignsPOC = att![attorney14]


End If
'MsgBox (attorneysigns)

att.Close

End Function

Public Function cobk() As String

Dim NoDebtors As Integer

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Then
NoDebtors = 1 + NoDebtors
End If

If (Not IsNull(Forms![foreclosure database screen]![LastNameDebtor2]) Or Forms![foreclosure database screen]![LastNameDebtor2] <> "") And _
(IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed]) Or Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0) Then
NoDebtors = 1 + NoDebtors
End If

If (Not IsNull(Forms![foreclosure database screen]![LastNameDebtor3]) Or Forms![foreclosure database screen]![LastNameDebtor3] <> "") _
And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
NoDebtors = 1 + NoDebtors
End If

If (Not IsNull(Forms![foreclosure database screen]![lastnamedebtor4]) Or Forms![foreclosure database screen]![lastnamedebtor4] <> "") _
And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
NoDebtors = 1 + NoDebtors
End If

If (Not IsNull(Forms![foreclosure database screen]![lastnamedebtor5]) Or Forms![foreclosure database screen]![lastnamedebtor5] <> "") _
And (Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![5filed])) Then
NoDebtors = 1 + NoDebtors
End If

If (Forms![foreclosure database screen]![lastnameo1] <> "" Or Not IsNull(Forms![foreclosure database screen]![lastnameo1])) And _
(IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed]) Or Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 0) Then
NoDebtors = 1 + NoDebtors
End If

If (Forms![foreclosure database screen]![lastnameo2] <> "" Or Not IsNull(Forms![foreclosure database screen]![lastnameo2])) And _
(IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed]) Or Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 0) Then
NoDebtors = 1 + NoDebtors
End If


If (Forms![foreclosure database screen]![lastnameo3] <> "" Or Not IsNull(Forms![foreclosure database screen]![lastnameo3])) And _
(IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![o3filed]) Or Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = 0) Then
NoDebtors = 1 + NoDebtors
End If


If NoDebtors > 1 Then
cobk = "Co-Debtors"
ElseIf NoDebtors = 1 Then
cobk = "Co-Debtor"
Else
cobk = ""
End If



End Function
Public Function CoDebt()

If cobk = "Co-Debtors" Then
CoDebt = "YES"
Else
CoDebt = "NO"
End If

End Function
Public Function codebtors()

If cobk = "Co-Debtors" Then
codebtors = "YES"
Else
codebtors = "NO"
End If

End Function
Public Function cobk13()
cobk13 = ""
If cobk() <> "" Then
If BKChapter() = "13" Then
cobk13 = "YES"
Else
cobk13 = ""
End If
End If

End Function

Public Function debtorsbk() As String

Dim filed1 As String
Dim filed2 As String
Dim filed3 As String
Dim filed4 As String
Dim filed5 As String
Dim filed6 As String
Dim FiledD5 As String
Dim filed7 As String

Dim fs As String
Dim st As String
Dim tf As String
Dim FF As String
Dim fsix As String
Dim D5 As String
Dim O3 As String

fs = ""
st = ""
tf = ""
FF = ""
fsix = ""
D5 = ""
O3 = ""

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 1 Then
filed1 = Trim(Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]![MiddleNameDebtor1] & " " & Forms![foreclosure database screen]![LastNameDebtor1])
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 1 Then
filed2 = Trim(Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]![MiddleNameDebtor2] & " " & Forms![foreclosure database screen]![LastNameDebtor2])
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 1 Then
filed3 = Trim(Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]![MiddleNameDebtor3] & " " & Forms![foreclosure database screen]![LastNameDebtor3])
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 1 Then
filed4 = Trim(Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]![middlenamedebtor4] & " " & Forms![foreclosure database screen]![lastnamedebtor4])
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 1 Then
FiledD5 = Trim(Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]![middlenamedebtor5] & " " & Forms![foreclosure database screen]![lastnamedebtor5])
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 1 Then
filed5 = bkowner1()
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 1 Then
filed6 = bkowner2()
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = 1 Then
filed7 = bkowner3()
End If

If filed2 <> "" And filed1 <> "" Then
If filed3 <> "" Then
fs = ", "
Else
fs = " and "
End If
End If

If filed3 <> "" And (filed2 <> "" Or filed1 <> "") Then
If filed4 <> "" Then
st = ", "
Else
st = " and "
End If
End If

If filed4 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "") Then
If filed5 <> "" Then
tf = ", "
Else
tf = " and "
End If
End If

If filed4 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "") Then
If FiledD5 <> "" Then
D5 = ", "
Else
D5 = " and "
End If
End If

If FiledD5 <> "" And filed5 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "") Then
If filed6 <> "" Then
FF = ", "
Else
FF = " and "
End If
End If

If filed6 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "" Or filed5 <> "" Or FiledD5 <> "") Then
fsix = " and "
End If

If filed5 <> "" And FiledD5 = "" Then
If filed6 = "" Then
FF = " and "
Else
FF = ", "
End If
End If


debtorsbk = filed1 & fs & filed2 & st & filed3 & tf & filed4 & D5 & FiledD5 & FF & filed5 & fsix & filed6 & O3 & filed7



End Function
Public Function debtorsbkPOC() As String

Dim filed1 As String
Dim filed2 As String
Dim filed3 As String
Dim filed4 As String
Dim filed5 As String
Dim filed6 As String

Dim fs As String
Dim st As String
Dim tf As String
Dim FF As String
Dim fsix As String

fs = ""
st = ""
tf = ""
FF = ""
fsix = ""

If Forms!proofofclaimmain![1filed] = -1 Then
filed1 = Trim(Forms![proofofclaimmain]![FirstNameDebtor1] & " " & Forms![proofofclaimmain]![MiddleNameDebtor1] & " " & Forms![proofofclaimmain]![LastNameDebtor1])
End If

If Forms!proofofclaimmain![2filed] = -1 Then
filed2 = Trim(Forms![proofofclaimmain]![FirstNameDebtor2] & " " & Forms![proofofclaimmain]![MiddleNameDebtor2] & " " & Forms![proofofclaimmain]![LastNameDebtor2])
End If

If Forms!proofofclaimmain![3filed] = -1 Then
filed3 = Trim(Forms![proofofclaimmain]![FirstNameDebtor3] & " " & Forms![proofofclaimmain]![MiddleNameDebtor3] & " " & Forms![proofofclaimmain]![LastNameDebtor3])
End If

If Forms!proofofclaimmain![4filed] = -1 Then
filed4 = Trim(Forms![proofofclaimmain]![firstnamedebtor4] & " " & Forms![proofofclaimmain]![middlenamedebtor4] & " " & Forms![proofofclaimmain]![lastnamedebtor4])
End If

If Forms!proofofclaimmain![owner1filed] = -1 Then
filed5 = bkownerPOC1()
End If

If Forms!proofofclaimmain![owner2filed] = -1 Then
filed6 = bkownerPOC2()
End If

If filed2 <> "" And filed1 <> "" Then
If filed3 <> "" Then
fs = ", "
Else
fs = " and "
End If
End If

If filed3 <> "" And (filed2 <> "" Or filed1 <> "") Then
If filed4 <> "" Then
st = ", "
Else
st = " and "
End If
End If

If filed4 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "") Then
If filed5 <> "" Then
tf = ", "
Else
tf = " and "
End If
End If

If filed5 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "") Then
If filed6 <> "" Then
FF = ", "
Else
FF = " and "
End If
End If

If filed6 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "" Or filed5 <> "") Then
fsix = " and "
End If




debtorsbkPOC = filed1 & fs & filed2 & st & filed3 & tf & filed4 & FF & filed5 & fsix & filed6

End Function
Public Function codebtorsbk() As String

Dim filed1 As String
Dim filed2 As String
Dim filed3 As String
Dim filed4 As String
Dim filed5, filed6 As String
Dim fs As String
Dim st As String
Dim tf As String
Dim FF, fsix As String


fs = ""
st = ""
tf = ""
FF = ""
fsix = ""
codebtorsbk = ""

If BKChapter() = "7" Or _
BKChapter() = "11" Then
codebtorsbk = ""

Else

If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Then
filed1 = Trim(Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]![MiddleNameDebtor1] & " " & Forms![foreclosure database screen]![LastNameDebtor1])
End If

If Forms![foreclosure database screen]![LastNameDebtor2] <> "" And _
(IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed]) Or Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0) Then
filed2 = Trim(Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]![MiddleNameDebtor2] & " " & Forms![foreclosure database screen]![LastNameDebtor2])
End If

If Forms![foreclosure database screen]![LastNameDebtor3] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Then
filed3 = Trim(Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]![MiddleNameDebtor3] & " " & Forms![foreclosure database screen]![LastNameDebtor3])
End If

If Forms![foreclosure database screen]![lastnamedebtor4] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Then
filed4 = Trim(Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]![middlenamedebtor4] & " " & Forms![foreclosure database screen]![lastnamedebtor4])
End If

If Forms![foreclosure database screen]![lastnamedebtor5] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Then
filed5 = Trim(Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]![middlenamedebtor5] & " " & Forms![foreclosure database screen]![lastnamedebtor5])
End If

If Forms![foreclosure database screen]![lastnameo1] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 0 Then
filed6 = Trim(owner1())
End If

If Forms![foreclosure database screen]![lastnameo2] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 0 Then
filed6 = Trim(owner2())
End If

If Forms![foreclosure database screen]![lastnameo3] <> "" And Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = 0 Then
filed6 = Trim(owner3())
End If
If filed2 <> "" And filed1 <> "" Then
If filed3 <> "" Then
fs = ", "
Else
fs = " and "
End If
End If

If filed3 <> "" And (filed2 <> "" Or filed1 <> "") Then
If filed4 <> "" Then
st = ", "
Else
st = " and "
End If
End If

If filed4 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "") Then
If filed5 <> "" Then
tf = ", "
Else
tf = " and "
End If
End If

If filed5 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "") Then
If filed6 <> "" Then
FF = ", "
Else
FF = " and "
End If
End If

If filed6 <> "" And (filed1 <> "" Or filed2 <> "" Or filed3 <> "" Or filed4 <> "" Or filed5 <> "") Then
fsix = " and "
End If

codebtorsbk = filed1 & fs & filed2 & st & filed3 & tf & filed4 & FF & filed5 & fsix & filed6
'MsgBox (codebtorsbk)
End If

End Function

Public Function bkbillcase() As String

bkbillcase = "Case #: " & Forms!bankruptcymain!BankruptcySubForm.Form![BKY Case Number]


End Function
Public Function bkdatefiled() As String

If Client() Like "select*" Then
bkdatefiled = "Date Filed: " & Forms!bankruptcymain!BankruptcySubForm.Form![Date Filed]
End If


End Function
Public Function bkbilltypePOC()
Dim tloan As String

If [Forms]![proofofclaimmain]![Client] Like "EMC*" Or [Forms]![proofofclaimmain]![Client] Like "Superior*" Or [Forms]![proofofclaimmain]![Client] Like "JPMorgan*" Or Forms![proofofclaimmain]!Client Like "Washing*" Then

If Forms![proofofclaimmain]![TypeOfLoan] = "CONV" Then
tloan = "Conventional"
Else
If IsNull(Forms!proofofclaimmain![TypeOfLoan]) Then
MsgBox ("Type of Loan is NOT Input, please input and try Running Document again.")
Else

tloan = Forms![proofofclaimmain]![TypeOfLoan]
End If
bkbilltypePOC = "Type of Loan: " & tloan
End If

End If
End Function

Public Function bkbilltype() As String

Dim tloan As String

If Client() Like "EMC*" Or Client() Like "Superior*" Or Client() Like "JPMorgan*" Or Client() Like "Washington*" Then
If Forms![foreclosure database screen]![TypeOfLoan] = "CONV" Then
tloan = "Conventional"
Else
If IsNull(Forms![foreclosure database screen]![TypeOfLoan]) Then
MsgBox ("Type of Loan is NOT Input, please input and try Running Document again.")
Else

tloan = Forms![foreclosure database screen]![TypeOfLoan]
End If
bkbilltype = "Type of Loan: " & tloan
End If

End If


End Function
Public Function bkbillchap() As String

bkbillchap = "Chapter: " & Forms!bankruptcymain!BankruptcySubForm.Form![chapter]


End Function
Public Function BKCaption3() As String

Dim strsql As String
Dim rs As RecordSet

strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
BKCaption3 = "715 S. Metropolitan Avenue, Suite 150"
ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
BKCaption3 = "715 South Metropolitan"
Else

If IsNull(rs![bk_add1]) Or rs!bk_add1 = "" Then

If IsNull(rs!claddress2) Then
BKCaption3 = rs![Address]
Else
BKCaption3 = rs!Address & ", " & rs!claddress2
End If

Else

If IsNull(rs!bk_citystatezip) Then
BKCaption3 = rs![bk_add1]
Else
BKCaption3 = rs!bk_add1 & ", " & rs!bk_citystatezip
End If

End If
End If

rs.Close

End Function
Public Function BKCaption4() As String
Dim strsql As String
Dim rs As RecordSet


strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
BKCaption4 = "Oklahoma City, OK  73108"
ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
BKCaption4 = "Oklahoma City, OK  73108"

ElseIf IsNull(rs![bk_add1]) Or rs!bk_add1 = "" Then
BKCaption4 = rs!City & ", " & rs!cl_state & ", " & rs!PostalCode
Else
BKCaption4 = rs![bk_citystatezip]

End If

rs.Close

End Function
Public Function bkCONAdd4() As String
Dim strsql As String
Dim rs As RecordSet

strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs![bk_citystatezip]) Or rs!bk_citystatezip = "" Or IsNull(rs!bkp_citystatezip) Or rs!bkp_citystatezip = "" Then

If IsNull(rs!Address) Then
MsgBox ("NO address input for " & rs!OrganizationName)
Exit Function
End If
End If


If (IsNull(rs![bk_citystatezip]) And IsNull(rs!bkp_citystatezip)) Then
bkCONAdd4 = rs![Address]

ElseIf Not IsNull(rs!bkp_citystatezip) Then
bkCONAdd4 = rs!bkp_citystatezip
Else
bkCONAdd4 = rs![bk_citystatezip]
End If


'MsgBox (bkCONAdd4)

rs.Close

End Function
Public Function bkCONAdd5() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If (IsNull(rs!bk_add1) Or rs!bk_add1 = "") And (IsNull(rs!bkp_add1) Or rs!bkp_add1 = "") Then
bkCONAdd5 = rs!City & ", " & rs![cl_state] & " " & rs![PostalCode]
Else
bkCONAdd5 = ""
'End If
End If
rs.Close

End Function

Function BKCaseNo()

    Dim linkcriteria As String
    Dim findcase As String
           
    DoCmd.OpenForm "caseno"
    
    If Forms![CaseNo]![filenum] > 0 Then
    findcase = Forms![CaseNo]![filenum]
    DoCmd.Close acForm, "caseno"
    DoCmd.Close acForm, "Foreclosure Database Screen"
    linkcriteria = "[FileNum] = " & findcase
    DoCmd.OpenForm "Foreclosure Database Screen", , , linkcriteria
    Else
    DoCmd.Close acForm, "caseno"
    MsgBox "Bankruptcy Case Number Not Found"
    End If
       
      
    End Function
    Public Function bkCONAdd3() As String
Dim strsql As String
Dim rs As RecordSet

strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs![bk_add1]) Or rs!bk_add1 = "" Or IsNull(rs!bkp_add1) Or rs!bkp_add1 = "" Then

If IsNull(rs!Address) Then
MsgBox ("NO address input for " & rs!OrganizationName)
Exit Function
End If
End If


If (IsNull(rs![bk_add1]) And IsNull(rs!bkp_add1)) Then
bkCONAdd3 = rs![Address]

ElseIf Not IsNull(rs!bkp_add1) Then
bkCONAdd3 = rs!bkp_add1
Else
bkCONAdd3 = rs![bk_add1]
End If


'MsgBox (bkCONAdd3)


rs.Close


End Function
Public Function BKCount()

'Dim v1, v2, V3, V4, strsql As String
'Dim VCt As Integer
'Dim rs As Recordset
'strsql = "select subfilenum from bankruptcy where subfilenum = " & gblfilenum & ";"

'Set rs = CurrentDb.OpenRecordset(strsql, dbopensnapshot)
'VCt = 0
'If Not rs.EOF Then
'rs.MoveFirst
'Else
'rs.Close
'Exit Function
'End If

'Do While Not rs.EOF
'VCt = VCt + 1
'rs.MoveNext
'Loop
'rs.Close
'
'BKCount = VCt


End Function

Public Function BKLang()
' Verify that the referenced form is still there
If Not CurrentProject.AllForms("foreclosure database screen").IsLoaded Then Exit Function


GblFilenum = Forms![foreclosure database screen]!filenum

Dim v1, v2, V3, V4, strsql As String
Dim VCt As Integer
Dim rs As RecordSet
strsql = "select subfilenum from bankruptcy where subfilenum = " & GblFilenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
VCt = 0
If Not rs.EOF Then
rs.MoveFirst
Else
rs.Close
Exit Function
End If

Do While Not rs.EOF
VCt = VCt + 1
rs.MoveNext
Loop
rs.Close

v1 = "There "
If VCt = 1 Then
v2 = "is "
V3 = " Bankruptcy"
Else
v2 = "are "
V3 = " Bankruptcies"
End If


BKLang = v1 + v2 & VCt & V3 & " for this Loan #, click on Add Button to add a new BK"



End Function

Public Function bkcourt1() As String

Dim Jurisdiction As String

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]) Then
MsgBox ("Bankruptcy Jurisdiction is not filled in Please Return to screen and fill it in.")
Exit Function
Else

Jurisdiction = Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]

If Jurisdiction Like "D.C*" Then
bkcourt1 = "333 Constitution Avenue, NW"
ElseIf Jurisdiction Like "Greenb*" Then
bkcourt1 = "6500 Cherrywood Lane"
ElseIf Jurisdiction Like "Balti*" Then
bkcourt1 = "101 W. Lombard Street"
ElseIf Jurisdiction Like "Norf*" Then
bkcourt1 = "4th Floor"
ElseIf Jurisdiction Like "Lyn*" Or Jurisdiction Like "Charl*" Or Jurisdiction Like "Danv*" Then
bkcourt1 = "1100 Main Street"
ElseIf Jurisdiction Like "Alex*" Then
bkcourt1 = "Alexandria Division"
ElseIf Jurisdiction Like "Harr*" Or Jurisdiction Like "Staun*" Then
bkcourt1 = "Room 223"
ElseIf Jurisdiction Like "Newpo*" Then
bkcourt1 = "600 Granby Street, Room 400"
ElseIf Jurisdiction Like "Roa*" Then
bkcourt1 = "210 Church Avenue, S.W."
ElseIf Jurisdiction Like "Rich*" Then

bkcourt1 = "1100 E. Main Street"
ElseIf Jurisdiction Like "Big*" Then
bkcourt1 = "Second Floor"
End If
End If

End Function
Public Function bkcourt2() As String

Dim Jurisdiction As String

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]) Then
MsgBox ("Bankruptcy Jurisdiction is not filled in Please Return to screen and fill it in.")
Exit Function
Else

Jurisdiction = Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]

If Jurisdiction Like "D.C*" Then
bkcourt2 = "Room 4400"
ElseIf Jurisdiction Like "Greenb*" Then
bkcourt2 = "Suite 300"
ElseIf Jurisdiction Like "Balti*" Then
bkcourt2 = "Suite 8308"
ElseIf Jurisdiction Like "Norf*" Then
bkcourt2 = "600 Granby Street"
ElseIf Jurisdiction Like "Lyn*" Or Jurisdiction Like "Charl*" Or Jurisdiction Like "Danv*" Then
bkcourt2 = "P.O. Box 6400"
ElseIf Jurisdiction Like "Alex*" Then
bkcourt2 = "200 S. Washington Street"
ElseIf Jurisdiction Like "Harr*" Or Jurisdiction Like "Staun*" Then
bkcourt2 = "116 North Main Street"
ElseIf Jurisdiction Like "Newpo*" Then
bkcourt2 = "Norfolk, VA  23510"
ElseIf Jurisdiction Like "Roa*" Then
bkcourt2 = "P.O. Box 2390"
ElseIf Jurisdiction Like "Rich*" Then
bkcourt2 = "Room 310"
ElseIf Jurisdiction Like "Big*" Then
bkcourt2 = "Courtroom"
End If
End If

End Function
Public Function bkcourt3() As String

Dim Jurisdiction As String
If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]) Then
MsgBox ("Bankruptcy Jurisdiction is not filled in Please Return to screen and fill it in.")
Exit Function
Else

Jurisdiction = Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]

If Jurisdiction Like "D.C*" Then
bkcourt3 = "Washington, D.C.  20001"
ElseIf Jurisdiction Like "Greenb*" Then
bkcourt3 = "Greenbelt, MD  20770"
ElseIf Jurisdiction Like "Balti*" Then
bkcourt3 = "Baltimore, MD  21201"
ElseIf Jurisdiction Like "Norf*" Then
bkcourt3 = "Norfolk, VA  23510"
ElseIf Jurisdiction Like "Lyn*" Or Jurisdiction Like "Charl*" Or Jurisdiction Like "Danv*" Then
bkcourt3 = "Lynchburg, VA  24505-6400"
ElseIf Jurisdiction Like "Alex*" Then
bkcourt3 = "Alexandria, VA  22201"
ElseIf Jurisdiction Like "Harr*" Or Jurisdiction Like "Staun*" Then
bkcourt3 = "Harrisonburg, VA  22801"
ElseIf Jurisdiction Like "Roa*" Then
bkcourt3 = "Roanoke, VA  24011"
ElseIf Jurisdiction Like "Rich*" Then
bkcourt3 = "Richmond,  VA  23219"
ElseIf Jurisdiction Like "Big*" Then
bkcourt3 = "Big Stone Gap, VA 24219"
End If
End If

End Function

Public Function bkdebtorfiled() As String
Dim bknum As Long
Dim bkdebt1, bkdebt2, bkdebt3, bkdebt4, bkdebt5, bkdebt6, bkdebt7, bkdebt4a As String

bknum = 0

If [Forms]!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
bknum = 1 + bknum
bkdebt1 = "YES"
End If
If [Forms]!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
bknum = 1 + bknum
bkdebt2 = "YES"
End If
If [Forms]!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
bknum = 1 + bknum
bkdebt3 = "YES"
End If
If [Forms]!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
bknum = 1 + bknum
bkdebt4 = "YES"
End If

If [Forms]!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
bknum = 1 + bknum
bkdebt4a = "YES"
End If

If [Forms]!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Then
bknum = 1 + bknum
bkdebt5 = "YES"
End If

If [Forms]!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Then
bknum = 1 + bknum
bkdebt6 = "YES"
End If

If [Forms]!bankruptcymain!BankruptcySubForm.Form![o3filed] = -1 Then
bknum = 1 + bknum
bkdebt7 = "YES"
End If

If bknum = 1 And bkdebt1 = "YES" Then
bkdebtorfiled = firstdebtor()
End If
If bknum = 1 And bkdebt2 = "YES" Then
bkdebtorfiled = secondDebtor()
End If
If bknum = 1 And bkdebt3 = "YES" Then
bkdebtorfiled = thirddebtor()
End If
If bknum = 1 And bkdebt4 = "YES" Then
bkdebtorfiled = fourthdebtor()
End If
If bknum = 1 And bkdebt4a = "YES" Then
bkdebtorfiled = fifthdebtor()
End If
If bknum = 1 And bkdebt5 = "YES" Then
bkdebtorfiled = owner1()
End If
If bknum = 1 And bkdebt6 = "YES" Then
bkdebtorfiled = owner2()
End If
If bknum = 1 And bkdebt7 = "YES" Then
bkdebtorfiled = owner3()
End If

If bknum = 2 Then
If bkdebt1 = "YES" And bkdebt2 = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & secondDebtor()
End If
If bkdebt1 = "YES" And bkdebt3 = "YES" Then
bkdeborfiled = firstdebtor() & " and " & thirddebtor()
End If
If bkdebt1 = "YES" And bkdebt4 = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & fourthdebtor()
End If
If bkdebt1 = "YES" And bkdebt4a = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & fifthdebtor()
End If
If bkdebt1 = "YES" And bkdebt5 = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & owner1()
End If
If bkdebt1 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & owner2()
End If
If bkdebt1 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = firstdebtor() & " and " & owner3()
End If
If bkdebt2 = "YES" And bkdebt3 = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & thirddebtor()
End If
If bkdebt2 = "YES" And bkdebt4 = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & fourthdebtor()
End If
If bkdebt2 = "YES" And bkdebt4a = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & fifthdebtor()
End If
If bkdebt2 = "YES" And bkdebt5 = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & owner1()
End If
If bkdebt2 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & owner2()
End If
If bkdebt2 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = secondDebtor() & " and " & owner3()
End If
'Debt3
If bkdebt3 = "YES" And bkdebt4 = "YES" Then
bkdebtorfiled = thirddebtor() & " and " & fourthdebtor()
End If
If bkdebt3 = "YES" And bkdebt4a = "YES" Then
bkdebtorfiled = thirddebtor() & " and " & fifthdebtor()
End If
If bkdebt3 = "YES" And bkdebt5 = "YES" Then
bkdebtorfiled = thirddebtor() & " and " & owner1()
End If
If bkdebt3 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = thirddebtor() & " and " & owner2()
End If
If bkdebt3 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = thirddebtor() & " and " & owner3()
End If
'Debt4
If bkdebt4 = "YES" And bkdebt4a = "YES" Then
bkdebtorfiled = fourthdebtor() & " and " & fifthdebtor()
End If
If bkdebt4 = "YES" And bkdebt5 = "YES" Then
bkdebtorfiled = fourthdebtor() & " and " & owner1()
End If
If bkdebt4 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = fourthdebtor() & " and " & owner2()
End If
If bkdebt4 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = fourthdebtor() & " and " & owner3()
End If
'Debt5
If bkdebt5 = "YES" And bkdebt5 = "YES" Then
bkdebtorfiled = fifthdebtor() & " and " & owner1()
End If
If bkdebt5 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = fifthdebtor() & " and " & owner2()
End If
If bkdebt5 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = fifthdebtor() & " and " & owner3()
End If
'Owner1
If bkdebt6 = "YES" And bkdebt6 = "YES" Then
bkdebtorfiled = owner1() & " and " & owner2()
End If
If bkdebt6 = "YES" And bkdebt7 = "YES" Then
bkdebtorfiled = owner1() & " and " & owner3()
End If

End If

If bknum = 0 Then
Dim VWhoFiled As String
VWhoFiled = InputBox("There is not a selection of Who Filed the Bankruptcy. Please input who filed or return and go into screen and selected debtors who filed.")
If VWhoFiled = "" Then
Exit Function
Else
bkdebtorfiled = VWhoFiled
End If
End If





End Function

Public Function BKDistrict()
Dim Vpt1 As String

Vpt1 = "FOR THE "

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*MD" Then
BKDistrict = Vpt1 & "DISTRICT OF MARYLAND"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] = "D.C." Then
BKDistrict = Vpt1 & "DISTRICT OF COLUMBIA"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*VA" Then
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*EDVA" Then
BKDistrict = Vpt1 & "EASTERN DISTRICT OF VIRGINIA"
Else
BKDistrict = Vpt1 & "WESTERN DISTRICT OF VIRGINIA"
End If
End If

End Function
Public Function bkdotnoteA()

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 0 Then
bkdotnoteA = "."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Then
bkdotnoteA = ".  A copy of the Deed of Trust is attached hereto."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 0 Then
bkdotnoteA = ".  A copy of the Deed of Trust is attached hereto."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Then
bkdotnoteA = "."
End If


 


End Function
Public Function bkdotnoteB()
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 0 Then
bkdotnoteB = "."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Then
bkdotnoteB = ".  A copy of the Note is attached hereto."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = -1 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = 0 Then
bkdotnoteB = "."
End If
If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![dot_attached] = 0 _
And Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![note_attached] = -1 Then
bkdotnoteB = ".  A copy of the Note is attached hereto."
End If

End Function

Public Function bkjudge()
Dim VarJudge As String

Dim Line1, Line2, line3, line4 As String

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*VA" Then

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*WDVA" Then
Line1 = "at the United States Bankruptcy Court, Western District of Virginia, "

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction]) Then

If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Danv*" Then
bkjudge = Line1 + "United States Bankruptcy Court, 3rd Floor, Post Office Building, Danville, VA  24541"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Lynch*" Then
bkjudge = Line1 + "U.S. Bankruptcy Courtroom 210, U.S. Courthouse, 1101 Court St., Lynchburg, VA  24504"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Stau*" Then
bkjudge = Line1 + "Circuit Courtroom, 2nd Floor, 113 E. Beverley Street, Staunton, Virginia"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Charlo*" Then
bkjudge = Line1 + "Courtroom 200, U.S. Courthouse, 255 W. Main Street, Charlottesville, VA"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Big*" Then
bkjudge = Line1 + "U.S. Courthouse, Second Floor, Courtroom, Big Stone Gap, VA"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Abing*" Then
bkjudge = "Abingdon, U.S. District Courtroom, U.S. Courthouse, 180 W. Main Street, Abingdon, Va  24210"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Roa*" Then
bkjudge = Line1 + "Roanoke Division, U. S. Bankruptcy Courthouse, Commonwealth of Virginia Building, 210 Church Ave., S.W. 2nd Floor, Rm 212, Roanoke, VA 24011"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![hrg_jurisdiction] Like "Harri*" Then
bkjudge = Line1 + "116 North Main Street, 3rd Floor, Harrisonburg, VA 22802"
End If

Else

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Danv*" Then
bkjudge = Line1 + "United States Bankruptcy Court, 3rd Floor, Post Office Building, Danville, VA  24541"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Lynch*" Then
bkjudge = Line1 + "U.S. Bankruptcy Courtroom 210, U.S. Courthouse, 1101 Court St., Lynchburg, VA  24504"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Stau*" Then
bkjudge = Line1 + "Circuit Courtroom, 2nd Floor, 113 E. Beverley Street, Staunton, Virginia"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Charlo*" Then
bkjudge = Line1 + "Courtroom 200, U.S. Courthouse, 255 W. Main Street, Charlottesville, VA"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Big*" Then
bkjudge = Line1 + "U.S. Courthouse, Second Floor, Courtroom, Big Stone Gap, VA"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Abing*" Then
bkjudge = Line1 + "U.S. District Courtroom, 1st Floor, U.S. Courthouse & Federal Building, Abingdon, VA"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Roa*" Then
bkjudge = Line1 + "Roanoke Division, U. S. Bankruptcy Courthouse, Commonwealth of Virginia Building, 210 Church Ave., S.W. 2nd Floor, Rm 212, Roanoke, VA 24011"
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Harri*" Then
bkjudge = Line1 + "116 North Main Street, 3rd Floor, Harrisonburg, VA 22802"
End If
End If

End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*EDVA" Then

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Then

If VarJudge Like "DOT*" Then
bkjudge = "701 E. Broad Street, Room 5100, Richmond, VA  23219"
Else
bkjudge = "701 E. Broad Street, Room 4000, Richmond, VA  23219"
End If

End If

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![judge]) Then
VarJudge = Forms!bankruptcymain!BankruptcySubForm.Form![judge]
Else
VarJudge = InputBox("Enter Judges' Initials" & vbCr & _
"BFK, DHA, DOT, KRH, RGM, RWK" & vbCr & "SCS, SSM, WEA or WFS" & vbCr)
Forms!bankruptcymain!BankruptcySubForm.Form![judge] = VarJudge
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newpor*" Then
bkjudge = "U.S. Courthouse, 2400 West Ave, Newport News, VA  23607"
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norfol*" Then
If VarJudge = "SCS" Then
bkjudge = "U.S. Courthouse, Bankruptcy Courtroom One, 4th Floor, 600 Granby Street, Norfolk, VA  23510"
Else
bkjudge = "U.S. Courthouse, Bankruptcy Courtroom Two, 4th Floor, 600 Granby Street, Norfolk, VA  23510"
End If
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Alex*" Or _
Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Then
Dim Room As String



If VarJudge = "BNS" Then
Room = "335"
End If

If VarJudge = "KRH" Then
Room = "5000"
End If

If VarJudge = "KLP" Then
Room = "5100"
End If
 
If VarJudge = "SSM" Then
Room = "1"
End If

If VarJudge = "BFK" Then
Room = "3"
End If

If VarJudge = "RGM" Then
Room = "1"
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Then
Line2 = "in Courtroom " & Room & ", United States Bankruptcy Court, "

Else
Line2 = "in Courtroom " & Room & ", United States Bankruptcy Court, U.S. Courthouse Annex, "
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Alex*" Then
bkjudge = Line2 + "200 S. Washington Street, Alexandria, VA  22314"
Else
If VarJudge = "KLP" Or VarJudge = "KRH" Then
bkjudge = Line2 + "701 East Broad Street, Richmond, VA 23219"
ElseIf VarJudge Like "DOT*" Then
bkjudge = Line2 + "701 E. Broad Street, Room 5100, Richmond, VA  23219"
Else
bkjudge = Line2 + "1100 East Main Street, Richmond, VA  23219-3515"
End If
End If

End If
End If
End If



If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*MD" Then

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] <> "Salisbury-MD" Then

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![judge]) Then
VarJudge = Forms!bankruptcymain!BankruptcySubForm.Form![judge]

Else
VarJudge = InputBox("Enter Judges' Initials" & vbCr & vbCr & _
"DK - Duncan W. Keir" & vbCr & "DER - David E. Rice" & vbCr & "JFS = James F. Schneider" & vbCr & "NVA = Nancy V. Alquist" & vbCr & "PM = Paul Mannes" & vbCr & "RAG = Robert A. Gordon" & vbCr & "TJC = Thomas Catliota" & vbCr & "WIL = Wendelin Lipp")
Forms!bankruptcymain!BankruptcySubForm.Form![judge] = VarJudge

End If

Line1 = ", in Courtroom "

If VarJudge = "na" Or VarJudge = "nva" Then
Line2 = "2A"
End If

If VarJudge = "rag" Or VarJudge = "rg" Then
Line2 = "1B"
End If

If VarJudge = "tjc" Or VarJudge = "tc" Then
Line1 = ", "
Line2 = "in Courtroom 3-E"
End If


If VarJudge = "jfs" Or VarJudge = "js" Then
Line2 = "9C"
End If

If VarJudge = "pm" Then
Line2 = "3D"
End If

If VarJudge = "wil" Or VarJudge = "wl" Then
Line2 = "3C"
End If

If VarJudge = "pm" Or VarJudge = "wil" Or VarJudge = "wl" Or VarJudge = "tjc" Or VarJudge = "tc" Then
line3 = ", United States Bankruptcy Court, 6500 Cherrywood Lane, Greenbelt, MD  20770"
End If


If VarJudge = "na" Or VarJudge = "nva" Or VarJudge = "jfs" Or VarJudge = "js" Or VarJudge = "rag" Or VarJudge = "rg" Then
line3 = ", United States Bankruptcy Court, 101 W. Lombard Street, Baltimore, MD  21201"
End If

If VarJudge = "dk" Then
Line1 = ", United States Bankruptcy Court for the District of Maryland, Garmatz Federal Courthouse, Courtroom 3B, 101 West Lombard Street, Baltimore, MD  21201"
Line2 = ""
line3 = ""
End If

If VarJudge = "der" Then
Line1 = ", United States Bankruptcy Court for the District of Maryland, Garmatz Federal Courthouse, Courtroom 9D, 101 West Lombard Street, Baltimore, MD  21201"
Line2 = ""
line3 = ""
End If

bkjudge = Line1 + Line2 + line3


Else

bkjudge = ", U.S. Bankruptcy Court, U.S. Post Office Building, 129 Main Street, Room 104, Salisbury, MD 21801"

End If
End If

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "D.C." Then

bkjudge = " before the Honorable S. Martin Teel, Jr., United States Bankruptcy Judge, in Courtroom No. 1, United States Courthouse, 333 Constitution Avenue, N.W., Washington, D.C.  20001. "

End If

 
 
'MsgBox (bkjudge)

End Function
Public Function bkjudgeCHECK()
 

Dim VarJudge As String
Dim Room As String

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*VA" Then

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![judge]) Or _
Forms!bankruptcymain!BankruptcySubForm.Form![judge] <> "" Then
VarJudge = Forms!bankruptcymain!BankruptcySubForm.Form![judge]
If VarJudge <> "PMB" And VarJudge <> "BNS" And VarJudge <> "RBC" And VarJudge <> "BFK" And VarJudge <> "FJS" And VarJudge <> "DHA" And VarJudge <> "SCS" And _
VarJudge <> "KRH" And VarJudge <> "WFS" And VarJudge <> "KLP" And VarJudge <> "WEA" And VarJudge <> "SSM" And VarJudge <> "DOT" And VarJudge <> "RGM" And VarJudge <> "RWK" Then
MsgBox (Forms!bankruptcymain!BankruptcySubForm.Form![judge] & " are the initials coded in for this file.  This JUDGE is not coded in.  If Judge is correct need to notify Charlene with all relevant information for coding.")
VarJudge = InputBox("Enter Judges' Initials" & vbCr & "BFK" & vbCr & "BNS" & vbCr & "DOT = Judge Tice" & vbCr & "FJS = Frank J. Santoro" & vbCr & "KLP" & vbCr & "KRH" & vbCr & "RBC" & vbCr & "RGM" & vbCr & "RWK - Ross W. Krumm" & vbCr & "SCS" & vbCr & "SSM" & vbCr & "WEA - William Anderson" & vbCr & "WFS - William F. Stone")
Forms!bankruptcymain!BankruptcySubForm.Form![judge] = VarJudge
End If

Else
VarJudge = InputBox("Enter Judges' Initials" & vbCr & vbCr & _
"DK - Duncan W. Keir" & vbCr & "JFS = James F. Schneider" & vbCr & "NVA = Nancy V. Alquist" & vbCr & "PM = Paul Mannes" & vbCr & "PMB = Paul M Black" & vbCr & "RAG = Robert A. Gordon" & vbCr & "TJC = Thomas Catliota" & vbCr & "WIL = Wendelin Lipp")
Forms!bankruptcymain!BankruptcySubForm.Form![judge] = VarJudge
End If

End If


If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*MD" Then

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![judge]) Then
VarJudge = Forms!bankruptcymain!BankruptcySubForm.Form![judge]
If VarJudge <> "pm" And VarJudge <> "tjc" And VarJudge <> "tc" And _
VarJudge <> "wil" And VarJudge <> "wl" And VarJudge <> "na" And VarJudge <> "nva" And _
VarJudge <> "jfs" And VarJudge <> "js" And VarJudge <> "rag" And VarJudge <> "rg" And _
VarJudge <> "dk" And VarJudge <> "der" Then
MsgBox (Forms!bankruptcymain!BankruptcySubForm.Form![judge] & " are the initials coded in for this file.  This JUDGE is not coded in.  If Judge is correct need to notify Charlene with all relevant information for coding.")
VarJudge = InputBox("Enter Judges' Initials" & vbCr & vbCr & _
"DK - Duncan W. Keir" & vbCr & "DER - David E. Rice" & vbCr & "JFS = James F. Schneider" & vbCr & "NVA = Nancy V. Alquist" & vbCr & "PM = Paul Mannes" & vbCr & "RAG = Robert A. Gordon" & vbCr & "TJC = Thomas Catliota" & vbCr & "WIL = Wendelin Lipp")
Forms!bankruptcymain!BankruptcySubForm.Form![judge] = VarJudge
End If
End If

End If

bkjudgeCHECK = VarJudge
End Function
Public Function bkjudgeNAME()
vabbr = Forms!bankruptcymain!BankruptcySubForm.Form!judge = vJudge
If vabbr = "DK" Then
bkjudgeNAME = "Duncan W. Keir"
ElseIf vabbr = "DER" Then
bkjudgeNAME = "David E. Rice"
ElseIf vabbr = "JFS" Then
bkjudgeNAME = "James F. Schneider"
ElseIf vabbr = "NVA" Then
bkjudgeNAME = "Nancy V. Alquist"
ElseIf vabbr = "PM" Then
bkjudgeNAME = "Paul Mannes"
ElseIf vabbr = "PMB" Then
bkjudgeNAME = "Paul M. Black"
ElseIf vabbr = "RAG" Then
bkjudgeNAME = "Robert A. Gordon"
ElseIf vabbr = "TJC" Then
bkjudgeNAME = "Thomas Catliota"
ElseIf vabbr = "WFS" Then
bkjudgeNAME = "William F. Stone"
ElseIf vabbr = "WIL" Then
bkjudgeNAME = "Wendelin Lipp"
ElseIf vabbr = "RBC" Then
bkjudgeNAME = "Rebecca B. Connelly"
Else
bkjudgeNAME = InputBox("Initials not found in System for Judge, please input Judges' Name for input in email.")
'bkjudgeNAME = vabbr
End If


End Function


Public Function BKJuris()
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] = "D.C." Then
BKJuris = ""
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Big*" Then
BKJuris = "Big Stone Gap Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Alex*" Then
BKJuris = "Alexandria Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Lynch*" Then
BKJuris = "Lynchburg Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Then
BKJuris = "Norfolk Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Roan*" Then
BKJuris = "Roanoke Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newpor*" Then
BKJuris = "Newport News Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Harris*" Then
BKJuris = "Harrisonburg Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Then
BKJuris = "Richmond Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Staun*" Then
BKJuris = "Staunton Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Danvil*" Then
BKJuris = "Danville Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Abing*" Then
BKJuris = "Abingdon Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Charlot*" Then
BKJuris = "Charlottesville"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Sal*" Then
BKJuris = "Salisbury Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Green*" Then
BKJuris = "Greenbelt Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Balt*" Then
BKJuris = "Baltimore Division"
End If



End Function
Public Function bkjurisPOC()

If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] = "D.C." Then
bkjurisPOC = ""
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Big*" Then
bkjurisPOC = "Big Stone Gap Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Alex*" Then
bkjurisPOC = "Alexandria Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Lynch*" Then
bkjurisPOC = "Lynchburg Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Norf*" Then
bkjurisPOC = "Norfolk Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Roan*" Then
bkjurisPOC = "Roanoke Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Newpor*" Then
bkjurisPOC = "Newport News Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Harris*" Then
bkjurisPOC = "Harrisonburg Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Rich*" Then
bkjurisPOC = "Richmond Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Staun*" Then
bkjurisPOC = "Staunton Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Danvil*" Then
bkjurisPOC = "Danville Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Abing*" Then
bkjurisPOC = "Abingdon Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Charlot*" Then
bkjurisPOC = "Charlottesville"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Sal*" Then
bkjurisPOC = "Salisbury Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Green*" Then
bkjurisPOC = "Greenbelt Division"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "Balt*" Then
bkjurisPOC = "Baltimore Division"
End If
End Function

Public Function BKDistrictPOC()
Dim Vpt1 As String

If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Vpt1 = ""
Else
Vpt1 = "FOR THE "
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*MD" Then
BKDistrictPOC = Vpt1 & "DISTRICT OF MARYLAND"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] = "D.C." Then
BKDistrictPOC = Vpt1 & "DISTRICT OF COLUMBIA"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*VA" Then
If Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction] Like "*EDVA" Then
BKDistrictPOC = Vpt1 & "EASTERN DISTRICT OF VIRGINIA"
Else
BKDistrictPOC = Vpt1 & "WESTERN DISTRICT OF VIRGINIA"
End If
End If

End Function
Public Function bkhearing()
Dim VPO As String

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![hearing_time]) Then
VPO = InputBox("No Hearing Time input in BK screen. Enter Hearing Time, screen will be updated.")
Forms!bankruptcymain!BankruptcySubForm.Form![hearing_time] = VPO
bkhearing = Format(VPO, "mmmm dd, yyyy")
Else
bkhearing = Format(Forms!bankruptcymain!BankruptcySubForm.Form![hearing_time], "hh:nn am/pm")
End If
End Function
Public Function bkMISChearing()
Dim VPO As String

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![misc_hearing_time]) Then
VPO = InputBox("No Hearing Time input in BK screen. Enter Hearing Time, screen will be updated.")
Forms!bankruptcymain!BankruptcySubForm.Form![misc_hearing_time] = VPO
bkNISChearing = Format(Forms!bankruptcymain!BankruptcySubForm.Form!misc_hearing, "mmmm dd, yyyy") & " at " & Format(VPO, "mmmm dd, yyyy")
Else
bkMISChearing = Format(Forms!bankruptcymain!BankruptcySubForm.Form!misc_hearing, "mmmm dd, yyyy") & " at " & Format(Forms!bankruptcymain!BankruptcySubForm.Form![misc_hearing_time], "hh:nn am/pm")
End If
End Function

Public Function bkppdue()

Dim VPP As String

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due From]) Then
VPP = InputBox("No From Date Due Post Petition input in BK screen. Enter From Date Due Post Petition Date, screen will be updated.")
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due From] = VPP
bkppdue = Format(VPP, "mmmm dd, yyyy")
Else
bkppdue = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due From], "mmmm dd, yyyy")
End If


End Function
Public Function bkppthru()

Dim VPP As String

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through]) Then
VPP = InputBox("No Through Date is input in the PP BK screen. Enter Through Date, screen will be updated.")
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through] = VPP
bkppthru = Format(VPP, "mmmm dd, yyyy")
Else
bkppthru = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy")
End If


End Function
Public Function bkpayoffamt()
Dim vpoamt As String

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt) Then
vpoamt = InputBox("No Payoff Amount input in BK screen. Enter Payoff Amount, screen will be updated.")
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt = vpoamt
bkpayoffamt = Format(vpoamt, "$###,##0.00")
Else
bkpayoffamt = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt, "$###,##0.00")
End If

End Function

Public Function bkpayoffdate()
Dim VPO As String

If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date]) Then
VPO = InputBox("No Payoff Date input in BK screen. Enter Payoff Date, screen will be updated.")
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date] = VPO
bkpayoffdate = Format(VPO, "mmmm dd, yyyy")
Else
bkpayoffdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date], "mmmm dd, yyyy")
End If

End Function

Public Function UpdateBKCase()

Dim strsql As String
Dim rs As RecordSet

strsql = "SELECT Bankruptcy.[BKY Case Number], Cases.Status " _
& " FROM Cases INNER JOIN Bankruptcy ON Cases.FileNum = Bankruptcy.SubFileNum " _
& " WHERE Bankruptcy.[BKY Case Number] Like " & """" & "*DK" & """" & " AND Cases.Status = " & """" & "Bankruptcy" & """" & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
rs.Close
Else

While Not rs.EOF
rs.MoveNext
Wend
rs.Close

End If



End Function
Public Function bkPOCAdd1() As String

If Client() Like "Citi Res*" Then
bkPOCAdd1 = ""
ElseIf (Client() Like "Citi*" And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*") Or _
Client() Like "Ocwen*" Then
bkPOCAdd1 = Client()
ElseIf Forms![foreclosure database screen]![Client] Like "Wells*" Then
bkPOCAdd1 = "Wells Fargo Bank, N.A."

Else

If (Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]!SecuredParty Like "*CIT*") _
Or (Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl)) Then
If IsNull(Forms![foreclosure database screen]!SecuredParty) Then
bkPOCAdd1 = ""
Else
bkPOCAdd1 = Forms![foreclosure database screen]!SecuredParty
End If

Else
bkPOCAdd1 = ""
End If

End If

End Function
Public Function bkPOCAdd1poc() As String


If Forms!proofofclaimmain!Client Like "Citi Res*" Then
bkPOCAdd1poc = ""
ElseIf (Forms!proofofclaimmain!Client Like "Citi*" And Forms![proofofclaimmain]!ClientRefNumber Like "20-0051*") Or _
Forms!proofofclaimmain!Client Like "Ocwen*" Then
bkPOCAdd1poc = Forms!proofofclaimmain!Client
ElseIf Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd1poc = "Wells Fargo Bank, N.A."

Else

If (Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]!SecuredParty Like "*CIT*") _
Or (Forms![proofofclaimmain]!SPsameasCl = 0 Or IsNull(Forms![proofofclaimmain]!SPsameasCl)) Then
If IsNull(Forms![proofofclaimmain]!SecuredParty) Then
bkPOCAdd1poc = ""
Else
bkPOCAdd1poc = Forms![proofofclaimmain]!SecuredParty
End If

Else
bkPOCAdd1poc = ""
End If

End If

End Function
Public Function bkPOCAdd2() As String

If Client() Like "Citi Res*" Then
bkPOCAdd2 = "Citi(RL) Mortgage Services, Inc."
ElseIf Client() Like "Citi*" And Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
bkPOCAdd2 = "ATTENTION: PAYMENT PROCESSING"
ElseIf Client() Like "Ocwen*" Then
bkPOCAdd2 = "Attn: Bankruptcy Department"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPOCAdd2 = "3476 Stateview Blvd."


Else


If (Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]!SecuredParty Like "*CIT*") Then
bkPOCAdd2 = ""
ElseIf Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl) Then
bkPOCAdd2 = "c/o " & Client()
Else
If IsNull(Forms![foreclosure database screen]!SecuredParty) Then
bkPOCAdd2 = Forms![foreclosure database screen]!Client
Else
bkPOCAdd2 = Forms![foreclosure database screen]!SecuredParty
End If
End If

End If


End Function

Public Function bkPOCAdd2POC()

If Forms![proofofclaimmain]!Client Like "Citi Res*" Then
bkPOCAdd2POC = "Citi Residential Lending Inc. "
ElseIf Forms![proofofclaimmain]!Client Like "Citi*" And Forms![proofofclaimmain]!ClientRefNumber Like "20-0051*" Then
bkPOCAdd2POC = "ATTENTION: PAYMENT PROCESSING"
ElseIf Forms!proofofclaimmain!Client Like "Ocwen*" Then
bkPOCAdd2POC = "Attn: Bankruptcy Department"
ElseIf Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd2POC = "3476 Stateview Blvd."

Else

If (Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]!SecuredParty Like "*CIT*") Then
bkPOCAdd2POC = ""
ElseIf Forms![proofofclaimmain]!SPsameasCl = 0 Or IsNull(Forms![proofofclaimmain]!SPsameasCl) Then
If Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd2POC = "c/o Wells Fargo Bank, N.A."
Else
bkPOCAdd2POC = "c/o " & Forms![proofofclaimmain]!Client
End If

Else
If IsNull(Forms![proofofclaimmain]!SecuredParty) Then
bkPOCAdd2POC = Forms![proofofclaimmain]!Client
Else
bkPOCAdd2POC = Forms![proofofclaimmain]!SecuredParty
End If
End If

End If


End Function

Public Function bkPaymentAdd3() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Client() Like "Homecoming*" Then
bkPaymentAdd3 = "ATTN: Bankruptcy Dept."
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPaymentAdd3 = "MAC X7801-014"
ElseIf Client() Like "Citi*" Then
If Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
bkPaymentAdd3 = "P.O. Box 220745"
Else
bkPaymentAdd3 = "P.O. Box 183040"
End If

ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
bkPaymentAdd3 = "715 S. Metropolitan Avenue, Suite 150"
ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
bkPaymentAdd3 = "715 S. Metropolitan Avenue"

ElseIf Client() Like "select*" Then
bkPaymentAdd3 = rs![Address]

ElseIf IsNull(rs![bk_add1]) And IsNull(rs!bkp_add1) Then
bkPaymentAdd3 = rs![Address]
ElseIf Not IsNull(rs!bkp_add1) Then
bkPaymentAdd3 = rs!bkp_add1
Else
bkPaymentAdd3 = rs![bk_add1]
End If


rs.Close

End Function
Public Function bkPaymentAdd4() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Client() Like "Homecoming*" Then
bkPaymentAdd4 = "P.O. Box 939072"

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPaymentAdd4 = "Fort Mill, SC 29715"

ElseIf Client() Like "Citi*" Then
If Forms![foreclosure database screen]!ClientRefNumber Like "20-0051*" Then
bkPaymentAdd4 = "Charlotte, NC  28222-0745"
Else
bkPaymentAdd4 = "Columbua, OH  43218-3040"
End If

ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
bkPaymentAdd4 = "Oklahoma City, OK  73108"

ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
bkPaymentAdd4 = "Oklahoma City, OK  73108"

ElseIf Client() Like "select*" Or IsNull(rs!bk_add1) Then
If IsNull(rs!claddress2) Then
bkPaymentAdd4 = ""
Else
bkPaymentAdd4 = rs![claddress2]
End If

ElseIf IsNull(rs!bk_citystatezip) And IsNull(rs!bkp_citystatezip) Then
bkPaymentAdd4 = ""
ElseIf Not IsNull(rs!bkp_citystatezip) Then
bkPaymentAdd4 = rs!bkp_citystatezip
Else
bkPaymentAdd4 = rs![bk_citystatezip]
End If
rs.Close


End Function


Public Function bkPOCAdd3() As String
Dim strsql As String
Dim rs As RecordSet

strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Client() Like "Homecoming*" Then
bkPOCAdd3 = "ATTN: Bankruptcy Dept."
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPOCAdd3 = "MAC X7801-014"


ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
bkPOCAdd3 = "715 S. Metropolitan Avenue, Suite 150"

ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
bkPOCAdd3 = "715 S. Metropolitan Avenue"


ElseIf Client() Like "select*" Or (IsNull(rs![bk_add1]) And IsNull(rs!bkp_add1)) Then
bkPOCAdd3 = rs![Address]

ElseIf Not IsNull(rs!bkp_add1) Then
bkPOCAdd3 = rs!bkp_add1
Else
bkPOCAdd3 = rs![bk_add1]
End If



rs.Close

End Function
Public Function bkPOCnotice1()

bkPOCnotice1 = Forms![foreclosure database screen]!Client

End Function
Public Function bkPOCNotice2()
Dim strsql As String
Dim rs As RecordSet
Dim vClient

vClient = Forms![foreclosure database screen]!Client

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not IsNull(rs!bkn_attn) Then

If Client() Like "JPM*" Then
bkPOCNotice2 = rs!bkn_attn
Else
bkPOCNotice2 = "Attn: " & rs!bkn_attn
End If

Else
bkPOCNotice2 = ""
End If

rs.Close


End Function
Public Function bkPOCNoticeemail()
Dim strsql As String
Dim rs As RecordSet
Dim vClient

vClient = Forms![foreclosure database screen]!Client

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not IsNull(rs!bkn_fax) Then
bkPOCNoticeemail = rs!bkn_fax
Else
bkPOCNoticeemail = ""
End If

rs.Close

End Function

Public Function bkPOCNoticePhone()
Dim strsql As String
Dim rs As RecordSet
Dim vClient

vClient = Forms![foreclosure database screen]!Client

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not IsNull(rs!bkn_phone) Then
If vClient Like "Wells*" And Forms![foreclosure database screen]!Asc_wff = 1 Then
bkPOCNoticePhone = "1-888-381-7953"
Else
bkPOCNoticePhone = rs!bkn_phone
End If

Else
bkPOCNoticePhone = ""
End If

rs.Close

End Function
Public Function bkPOCNotice3() As String
Dim strsql As String
Dim rs As RecordSet
Dim vClient

vClient = Forms![foreclosure database screen]!Client

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs![bk_add1]) And IsNull(rs!bkn_add1) Then
bkPOCNotice3 = rs![Address]
ElseIf IsNull(rs!bkn_add1) Then
bkPOCNotice3 = rs![bk_add1]
Else
bkPOCNotice3 = rs!bkn_add1
End If

rs.Close


End Function
Public Function bkPOCNotice4() As String
Dim strsql As String
Dim rs As RecordSet

Dim vClient

vClient = Forms![foreclosure database screen]!Client

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_citystatezip]) And IsNull(rs!bkn_citystatezip) Then

If IsNull(rs!claddress2) Then
bkPOCNotice4 = rs!City & ", " & rs!cl_state & " " & rs!PostalCode
Else
bkPOCNotice4 = rs![claddress2]
End If

ElseIf IsNull(rs!bkn_citystatezip) Then
bkPOCNotice4 = rs![bk_citystatezip]
Else
bkPOCNotice4 = rs!bkn_citystatezip
End If

rs.Close


End Function
Public Function bkPOCNotice5()
Dim strsql As String
Dim rs As RecordSet

Dim vClient

If AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else
vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs!bkn_add1) And Not IsNull(rs!claddress2) Then
bkPOCNotice5 = rs!City & ", " & rs!cl_state & "  " & rs!PostalCode
Else
bkPOCNotice5 = ""
End If

rs.Close

End Function
Public Function BKPOCPayemail()
Dim strsql As String
Dim rs As RecordSet

Dim vClient

If IsNull(AppType) Or AppType = "" Or AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else

vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_fax]) And IsNull(rs!bkp_fax) Then
BKPOCPayemail = ""
ElseIf Not IsNull(rs!bkp_fax) Then
BKPOCPayemail = rs!bkp_fax
ElseIf Not IsNull(rs!bk_fax) Then
BKPOCPayemail = rs!bk_fax
End If

rs.Close

End Function

Public Function BKPOCPayPhone()
Dim strsql As String
Dim rs As RecordSet

Dim vClient

If IsNull(AppType) Or AppType = "" Or AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else

vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_phone]) And IsNull(rs!bkp_phone) Then
BKPOCPayPhone = ""
ElseIf Not IsNull(rs!bkp_phone) Then
BKPOCPayPhone = rs!bkp_phone
ElseIf Not IsNull(rs!bk_attn) Then
If vClient Like "Wells*" And Forms![foreclosure database screen]!Asc_wff = 1 Then
BKPOCPayPhone = "1-888-381-7953"
Else
BKPOCPayPhone = rs!bk_phone
End If

End If

rs.Close

End Function

Public Function BKPOCPay2()
Dim strsql As String
Dim rs As RecordSet

Dim vClient

If IsNull(AppType) Or AppType = "" Or AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else

vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_attn]) And IsNull(rs!bkp_attn) Then
BKPOCPay2 = ""
ElseIf Not IsNull(rs!bkp_attn) Then
BKPOCPay2 = "Attn: " & rs!bkp_attn
ElseIf Not IsNull(rs!bk_attn) Then
BKPOCPay2 = "Attn: " & rs!bk_attn
End If

rs.Close



End Function
Public Function BKPOCPay3() As String
Dim strsql As String
Dim rs As RecordSet

Dim vClient

If IsNull(AppType) Or AppType = "" Or AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else

vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_add1]) And IsNull(rs!bkp_add1) Then
BKPOCPay3 = rs![Address]
ElseIf IsNull(rs!bkp_add1) Then
BKPOCPay3 = rs![bk_add1]
Else
BKPOCPay3 = rs!bkp_add1


End If

rs.Close
'MsgBox (BKPOCPay3)


End Function
Public Function BKPOCPay4() As String
Dim strsql As String
Dim rs As RecordSet
Dim vClient

If AppType = "POCForm" Or AppType = "Foreclosure database screen" Or AppType = "BKFinalCure" Then
vClient = Forms![foreclosure database screen]!Client
Else
vClient = Forms![proofofclaimmain]!Client
End If

strsql = "Select * from clients where organizationname = " & """" & vClient & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If IsNull(rs![bk_citystatezip]) And IsNull(rs!bkp_citystatezip) Then

If IsNull(rs!claddress2) Then
BKPOCPay4 = rs!City & ", " & rs!cl_state & "  " & rs!PostalCode
Else
BKPOCPay4 = rs![claddress2]
End If

ElseIf IsNull(rs!bkp_citystatezip) Then
BKPOCPay4 = rs![bk_citystatezip]
Else
BKPOCPay4 = rs!bkp_citystatezip
End If

rs.Close


End Function
Public Function BKPOCPay5()
Dim strsql As String
Dim rs As RecordSet

strsql = "Select * from clients where organizationname = " & """" & Forms![proofofclaimmain]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If IsNull(rs!bkp_add1) And Not IsNull(rs!claddress2) Then
BKPOCPay5 = ""
ElseIf Not IsNull(rs!claddress2) Then
BKPOCPay5 = rs!City & ", " & rs!cl_state & "  " & rs!PostalCode
Else
BKPOCPay5 = ""
End If

rs.Close

End Function


Public Function bkPOCAdd3POC() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![proofofclaimmain]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Forms!proofofclaimmain!Client Like "Homecoming*" Then
bkPOCAdd3POC = "ATTN: Bankruptcy Dept."
ElseIf Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd3POC = "MAC X7801-014"
ElseIf Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]![SecuredParty] Like "*CIT*Consumer*" Then
bkPOCAdd3POC = "715 S. Metropolitan Avenue, Suite 150"
ElseIf Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]![SecuredParty] Like "*CIT*Sales*" Then
bkPOCAdd3POC = "715 S. Metropolitan Avenue"
ElseIf Forms!proofofclaimmain!Client Like "EMC*" Then
bkPOCAdd3POC = "P.O. Box 660753"
ElseIf Forms!proofofclaimmain!Client Like "select*" Then
bkPOCAdd3POC = rs![Address]
ElseIf IsNull(rs![bk_add1]) Then
bkPOCAdd3POC = rs![Address]
Else
bkPOCAdd3POC = rs![bk_add1]
End If

rs.Close


End Function
Public Function bkPOCAdd4POC() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![proofofclaimmain]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Forms!proofofclaimmain!Client Like "Homecoming*" Then
bkPOCAdd4POC = "P.O. Box 939072"
ElseIf Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd4POC = "Fort Mill, SC 29715"
ElseIf Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]![SecuredParty] Like "*CIT*Consumer*" Then
bkPOCAdd4POC = "Oklahoma City, OK  73108"
ElseIf Forms![proofofclaimmain]![Client] Like "Nations Defaul*" And _
Forms![proofofclaimmain]![SecuredParty] Like "*CIT*Sales*" Then
bkPOCAdd4POC = "Oklahoma City, OK  73108"
ElseIf Forms!proofofclaimmain!Client Like "EMC*" Then
bkPOCAdd4POC = "Dallas, TX  75266-0753"
ElseIf Forms!proofofclaimmain!Client Like "select*" Or IsNull(rs!bk_add1) Then
If IsNull(rs!claddress2) Then
bkPOCAdd4POC = ""
Else
bkPOCAdd4POC = rs![claddress2]
End If
ElseIf IsNull(rs!bk_citystatezip) Then
bkPOCAdd4POC = ""
Else
bkPOCAdd4POC = rs![bk_citystatezip]
End If
rs.Close


End Function
Public Function bkPOCAdd4() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Client() Like "Homecoming*" Then
bkPOCAdd4 = "P.O. Box 939072"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPOCAdd4 = "Fort Mill, SC 29715"
ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Consumer*" Then
bkPOCAdd4 = "Oklahoma City, OK  73108"
ElseIf Forms![foreclosure database screen]![Client] Like "Nations Defaul*" And _
Forms![foreclosure database screen]![SecuredParty] Like "*CIT*Sales*" Then
bkPOCAdd4 = "Oklahoma City, OK  73108"


ElseIf Client() Like "select*" Or (IsNull(rs!bk_add1) And IsNull(rs!bkp_add1)) Then
If IsNull(rs!claddress2) Then
bkPOCAdd4 = ""
Else
bkPOCAdd4 = rs![claddress2]
End If

ElseIf IsNull(rs!bkp_citystatezip) And IsNull(rs!bk_citystatezip) Then
bkPOCAdd4 = ""
ElseIf Not IsNull(rs!bkp_citystatezip) Then
bkPOCAdd4 = rs!bkp_citystatezip
Else
bkPOCAdd4 = rs![bk_citystatezip]
End If
rs.Close


End Function
Public Function bkPOCAdd5() As String

Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Client() Like "Homecoming*" Then
bkPOCAdd5 = "San Diego, CA  92193-9072"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
bkPOCAdd5 = ""

ElseIf (Forms![foreclosure database screen]![SecuredParty] Like "*CIT*" And _
Forms![foreclosure database screen]![Client] Like "Nations Def*") Then
bkPOCAdd5 = ""

ElseIf IsNull(rs!bk_add1) And Client() <> "select portfolio servicing, Inc." Then
bkPOCAdd5 = rs!City & ", " & rs![cl_state] & "  " & rs![PostalCode]
If Not IsNull(rs!bkp_citystatezip) Then
bkPOCAdd5 = rs!bkp_citystatezip
Else
bkPOCAdd5 = rs![bk_citystatezip]
End If



End If

rs.Close

End Function
Public Function bkPOCAdd5POC() As String
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![proofofclaimmain]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Forms!proofofclaimmain!Client Like "Homecoming*" Then
bkPOCAdd5POC = "San Diego, CA  92193-9072"
ElseIf Forms![proofofclaimmain]!Client Like "Wells*" Then
bkPOCAdd5POC = ""
ElseIf (Forms![proofofclaimmain]![SecuredParty] Like "*CIT*" And Forms![proofofclaimmain]![Client] Like "Nations Def*") Then
bkPOCAdd5POC = ""
ElseIf IsNull(rs!bk_add1) And Forms!proofofclaimmain!Client <> "select portfolio servicing, Inc." Then
bkPOCAdd5POC = rs!City & ", " & rs![cl_state] & "  " & rs![PostalCode]
ElseIf bkPOCAdd4POC() <> rs!bk_citystatezip Then
If IsNull(rs!bk_citystatezip) Then
bkPOCAdd5POC = ""
Else
bkPOCAdd5POC = rs![bk_citystatezip]
End If

End If
rs.Close


End Function
Public Function bkPhone()
Dim strsql As String
Dim rs As RecordSet
strsql = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rs!bk_phone) Then
bkPhone = rs!PhoneNumber
Else
bkPhone = rs![bk_phone]
End If

rs.Close
End Function

Public Function ClientBK() As String

Dim formname As String
Dim clientname, VarSP As String

formname = Application.CurrentObjectName
If formname Like "dem*" Or formname = "Breech Bill" Then
clientname = Forms![demand letter screen]![Client]
If IsNull(Forms![demand letter screen]![abbrsec]) Then
VarSP = ""
Else
VarSP = Forms![demand letter screen]![SecuredParty]
End If
Else
clientname = Forms![foreclosure database screen]![Client]
If IsNull(Forms![foreclosure database screen]![abbrsec]) Then
VarSP = ""
Else
VarSP = Forms![foreclosure database screen]![abbrsec]
End If
End If

If clientname Like "JPMorgan*" Or clientname Like "CHASE" Then
ClientBK = "JPMorgan Chase Bank, National Association"
ElseIf clientname Like "select portfolio servicing*" Then
ClientBK = clientname & " f/k/a Fairbanks Capital Corp."
ElseIf clientname Like "Foreclosur*" Or clientname Like "McCalla*" Then
ClientBK = VarSP
Else
ClientBK = clientname
End If


End Function

Function currentfileBKPlan()

    Dim DocName As String
    Dim linkcriteria As String
    Dim Figures As String

    DocName = "Bankruptcy Plan Review"
    'linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]and forms![proofofclaimMain]![counter]=Forms!BankruptcyMain!BankruptcySubForm.Form![counter]"
    linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]"
    DoCmd.OpenForm DocName, , , linkcriteria
   
End Function
Function currentfileBKReview()

    Dim DocName As String
    Dim linkcriteria As String
    Dim Figures As String

    DocName = "Bankruptcy Review of Chapter 13 Plan"
    'linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]and forms![proofofclaimMain]![counter]=Forms!BankruptcyMain!BankruptcySubForm.Form![counter]"
    linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]"
    DoCmd.OpenForm DocName, , , linkcriteria
   
End Function
Function currentfileMFR()

    Dim DocName As String
    Dim linkcriteria As String
    Dim Figures As String

    DocName = "Bankruptcy MFR Hearing"
    'linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]and forms![proofofclaimMain]![counter]=Forms!BankruptcyMain!BankruptcySubForm.Form![counter]"
    linkcriteria = "[FileNum] = Forms![Foreclosure Database Screen]![FileNum]"
    DoCmd.OpenForm DocName, , , linkcriteria
   
End Function
Public Function firstdebtorPOC() As String

If IsNull(Forms![proofofclaimmain]![MiddleNameDebtor1]) Then
firstdebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor1] & " " & Forms![proofofclaimmain]![LastNameDebtor1])
Else
firstdebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor1] & " " & Forms![proofofclaimmain]![MiddleNameDebtor1] & " " & Forms![proofofclaimmain]![LastNameDebtor1])
End If


End Function
Public Function owner1POC() As String


If IsNull(Forms![proofofclaimmain]![lastnameo1]) Then
owner1POC = ""
Else
If IsNull(Forms![proofofclaimmain]![mnameo1]) Then
owner1POC = Trim(Forms![proofofclaimmain]![firstnameo1] & " " & Forms![proofofclaimmain]![lastnameo1])
Else
owner1POC = Trim(Forms![proofofclaimmain]![firstnameo1] & " " & Forms![proofofclaimmain]![mnameo1] & " " & Forms![proofofclaimmain]![lastnameo1])
End If
End If


End Function
Public Function owner2POC() As String
If IsNull(Forms![proofofclaimmain]![lastnameo2]) Then
owner2POC = ""
Else
If IsNull(Forms![proofofclaimmain]![mnameo2]) Then
owner2POC = Trim(Forms![proofofclaimmain]![firstnameo2] & " " & Forms![proofofclaimmain]![lastnameo2])
Else
owner2POC = Trim(Forms![proofofclaimmain]![firstnameo2] & " " & Forms![proofofclaimmain]![mnameo2] & " " & Forms![proofofclaimmain]![lastnameo2])
End If
End If

End Function
Public Function owner3POC()
If IsNull(Forms![proofofclaimmain]![lastnameo3]) Then
owner3POC = ""
Else
If IsNull(Forms![proofofclaimmain]![mnameo3]) Then
owner3POC = Trim(Forms![proofofclaimmain]![firstnameo3] & " " & Forms![proofofclaimmain]![lastnameo3])
Else
owner3POC = Trim(Forms![proofofclaimmain]![firstnameo3] & " " & Forms![proofofclaimmain]![mnameo3] & " " & Forms![proofofclaimmain]![lastnameo3])
End If
End If
End Function
Public Function seconddebtorPOC() As String

If IsNull(Forms![proofofclaimmain]![LastNameDebtor2]) Then
seconddebtorPOC = ""
Else
If IsNull(Forms![proofofclaimmain]![MiddleNameDebtor2]) Then
seconddebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor2] & " " & Forms![proofofclaimmain]![LastNameDebtor2])
Else
seconddebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor2] & " " & Forms![proofofclaimmain]![MiddleNameDebtor2] & " " & Forms![proofofclaimmain]![LastNameDebtor2])
End If
End If

End Function

Public Function thirddebtorPOC() As String

If IsNull(Forms![proofofclaimmain]![LastNameDebtor3]) Then
thirddebtorPOC = ""
Else

If IsNull(Forms![proofofclaimmain]![MiddleNameDebtor3]) Then
thirddebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor3] & " " & Forms![proofofclaimmain]![LastNameDebtor3])
Else
thirddebtorPOC = Trim(Forms![proofofclaimmain]![FirstNameDebtor3] & " " & Forms![proofofclaimmain]![MiddleNameDebtor3] & " " & Forms![proofofclaimmain]![LastNameDebtor3])
End If

End If

End Function
Public Function fourthdebtorPOC() As String

If IsNull(Forms![proofofclaimmain]![lastnamedebtor4]) Then
fourthdebtorPOC = ""
Else

If IsNull(Forms![proofofclaimmain]![middlenamedebtor4]) Then
fourthdebtorPOC = Trim(Forms![proofofclaimmain]![firstnamedebtor4] & " " & Forms![proofofclaimmain]![lastnamedebtor4])
Else
fourthdebtorPOC = Trim(Forms![proofofclaimmain]![firstnamedebtor4] & " " & Forms![proofofclaimmain]![middlenamedebtor4] & " " & Forms![proofofclaimmain]![lastnamedebtor4])
End If
End If

End Function
Public Function fifthdebtorPOC()
If IsNull(Forms![proofofclaimmain]![lastnamedebtor5]) Then
fifthdebtorPOC = ""
Else

If IsNull(Forms![proofofclaimmain]![middlenamedebtor5]) Then
fifthdebtorPOC = Trim(Forms![proofofclaimmain]![firstnamedebtor5] & " " & Forms![proofofclaimmain]![lastnamedebtor5])
Else
fifthdebtorPOC = Trim(Forms![proofofclaimmain]![firstnamedebtor5] & " " & Forms![proofofclaimmain]![middlenamedebtor5] & " " & Forms![proofofclaimmain]![lastnamedebtor5])
End If
End If
End Function
Public Function firstownerPOC() As String

firstownerPOC = bkownerPOC1()
End Function
Public Function secondownerPOC() As String

secondownerPOC = bkownerPOC2()
End Function
Public Function propadd2POC() As String

If IsNull(Forms![proofofclaimmain]![propaddress2]) Then
propadd2POC = Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
Else
propadd2POC = Forms![proofofclaimmain]![propaddress2]
End If

End Function
Public Function propaddPOC() As String
If IsNull(Forms![proofofclaimmain]![unit_no]) Or Forms![proofofclaimmain]![unit_no] = "" Then
propaddPOC = Forms![proofofclaimmain]![PropAddress]
Else
propaddPOC = Forms![proofofclaimmain]![PropAddress] & ", Unit # " & Forms![proofofclaimmain]![unit_no]
End If

End Function
Public Function mailaddPOC() As String
If IsNull(Forms![proofofclaimmain]![Mailing Address]) Then
mailaddPOC = ""
Else

mailaddPOC = Forms![proofofclaimmain]![Mailing Address]
End If

End Function
Public Function propPOC() As String

If IsNull(Forms![proofofclaimmain]![propaddress2]) Then
If IsNull(Forms![proofofclaimmain]![unit_no]) Or Forms![proofofclaimmain]![unit_no] = "" Then
propPOC = Forms![proofofclaimmain]![PropAddress] & ", " & Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
Else
propPOC = Forms![proofofclaimmain]![PropAddress] & ", Unit # " & Forms![proofofclaimmain]![unit_no] & ", " & Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
End If

Else
If IsNull(Forms![proofofclaimmain]![unit_no]) Or Forms![proofofclaimmain]![unit_no] = "" Then
propPOC = Forms![proofofclaimmain]![PropAddress] & ", " & Forms![proofofclaimmain]![propaddress2] & ", " & Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
Else
propPOC = Forms![proofofclaimmain]![PropAddress] & ", Unit # " & Forms![proofofclaimmain]![unit_no] & ", " & Forms![proofofclaimmain]![propaddress2] & ", " & Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
End If
End If

End Function
Public Function propadd3POC() As String

If IsNull(Forms![proofofclaimmain]![propaddress2]) Then
propadd3POC = ""
Else
propadd3POC = Forms![proofofclaimmain]![PropertyCity] & ", " & Forms![proofofclaimmain]![PropertyState] & "  " & Forms![proofofclaimmain]![propzip]
End If
End Function
Public Function mailadd2POC() As String
If IsNull(Forms![proofofclaimmain]![Mailing Address]) Then
mailadd2POC = ""
Else

If IsNull(Forms![proofofclaimmain]![Mailing Address2]) Then
mailadd2POC = Forms![proofofclaimmain]![Mailing City] & ", " & Forms![proofofclaimmain]![Mailing State] & "  " & Forms![proofofclaimmain]![Mailing Zip]
Else
mailadd2POC = Forms![proofofclaimmain]![Mailing Address2]
End If
End If

End Function
Public Function mailadd3POC() As String
If IsNull(Forms![proofofclaimmain]![Mailing Address]) Then
mailadd3POC = ""
Else

If IsNull(Forms![proofofclaimmain]![Mailing Address2]) Then
mailadd3POC = ""
Else
mailadd3POC = Forms![proofofclaimmain]![Mailing City] & ", " & Forms![proofofclaimmain]![Mailing State] & "  " & Forms![proofofclaimmain]![Mailing Zip]
End If
End If

End Function
Public Function trusteesPOC() As String
Dim Jurisdiction As String

Jurisdiction = Forms!proofofclaimmain![Jurisdiction]

If IsNull(Forms!proofofclaimmain![trustee_name]) Then

If Jurisdiction Like "Alex*" Then
trusteesPOC = "Thomas P. Gorman"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteesPOC = "Lucinda B. Connelly"
ElseIf Jurisdiction Like "Roan*" Then
trusteesPOC = "J. Glenwood Strickler"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
trusteesPOC = "Debera F. Conlon"
ElseIf Jurisdiction Like "Rich*" Then
trusteesPOC = "Robert E. Hyman"
ElseIf Jurisdiction = "D.C." Then
trusteesPOC = "Cynthia Niklas"
ElseIf Jurisdiction Like "Charlot*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Harris*" Then
trusteesPOC = "Helen P. Parrish"
ElseIf Jurisdiction Like "Abing*" Then
trusteesPOC = "Jo S. Widener"
ElseIf Jurisdiction Like "Greenbe*" Then
trusteesPOC = "Thomas L. Lackey"
ElseIf Jurisdiction Like "Balti*" Then
trusteesPOC = "Ellen W. Cosby"
End If

Else
trusteesPOC = Forms!proofofclaimmain!trustee_name
End If


End Function
Public Function Trustees() As String
Dim Jurisdiction As String
If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]) Then

Jurisdiction = Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![trusteename]) Then

If Jurisdiction Like "Alex*" Then
Trustees = "Thomas P. Gorman"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
Trustees = "Lucinda B. Connelly"
ElseIf Jurisdiction Like "Roan*" Then
Trustees = "J. Glenwood Strickler"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
Trustees = "Debera F. Conlon"
ElseIf Jurisdiction Like "Rich*" Then
Trustees = "Robert E. Hyman"
ElseIf Jurisdiction = "D.C." Then
Trustees = "Cynthia Niklas"
ElseIf Jurisdiction Like "Charlot*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Harris*" Then
Trustees = "Helen P. Parrish"
ElseIf Jurisdiction Like "Abing*" Then
Trustees = "Jo S. Widener"
ElseIf Jurisdiction Like "Greenbe*" Then
Trustees = "Thomas L. Lackey"
ElseIf Jurisdiction Like "Balti*" Then
Trustees = "Ellen W. Cosby"
End If

Else
Trustees = Forms!bankruptcymain!BankruptcySubForm.Form![trusteename]
End If
Else
Trustees = ""
End If

End Function
Public Function bktrusteefax() As String

Dim Jurisdiction As String

If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]) Then
Jurisdiction = Forms!bankruptcymain!BankruptcySubForm.Form![Jurisdiction]
Else
MsgBox ("No Jurisdiction Selected")
Exit Function
End If

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![trusteename]) Then
bktrusteefax = ""
Else
Dim rs As RecordSet
Dim strsql As String
strsql = "select * from bktrustees where trustee_name = " & """" & Forms!bankruptcymain!BankruptcySubForm.Form![trusteename] & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
Else
If rs!Trustee_fax = "" Or IsNull(rs!Trustee_fax) Then
MsgBox ("No Fax Number input for " & Forms!bankruptcymain!BankruptcySubForm.Form![trusteename])
Else
bktrusteefax = rs!Trustee_fax
End If

End If

End If


End Function
Public Function trusteeaddPOC() As String
Dim Jurisdiction As String

Jurisdiction = Forms!proofofclaimmain![Jurisdiction]

If IsNull(Forms!proofofclaimmain![trustee_name]) Then

If Jurisdiction Like "Alex*" Then
trusteeaddPOC = "201 N. Union Street, Suite 240"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteeaddPOC = "P.O. Box 1001"
ElseIf Jurisdiction Like "Roan*" Then
trusteeaddPOC = "P.O. Box 1001"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
trusteeaddPOC = "P.O. Drawer 1455"
ElseIf Jurisdiction Like "Rich*" Then
trusteeaddPOC = "P.O. Box 1780"
ElseIf Jurisdiction Like "Harris*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Charlot*" Then
trusteeaddPOC = "Lewis & Clark Square, 250 West Main St., #102"
ElseIf Jurisdiction = "D.C." Then
trusteeaddPOC = "4545 42nd St., N.W."
ElseIf Jurisdiction Like "Abing*" Then
trusteeaddPOC = "52 Piedmont St."
ElseIf Jurisdiction Like "Greenb*" Then
trusteeaddPOC = "P.O. Box 958"
ElseIf Jurisdiction Like "Balti*" Then
trusteeaddPOC = "P.O. Box 20016"
End If

Else
trusteeaddPOC = Forms!proofofclaimmain![trustee_add]
End If


End Function
Public Function trusteecszPOC() As String
Dim Jurisdiction As String

Jurisdiction = Forms!proofofclaimmain![Jurisdiction]
If IsNull(Forms!proofofclaimmain![trustee_name]) Then
If Jurisdiction Like "Alex*" Then
trusteecszPOC = "Alexandria, VA  22314"
ElseIf Jurisdiction Like "Lynch*" Or Jurisdiction Like "Danv*" Then
trusteecszPOC = "Roanoke, VA 24005"
ElseIf Jurisdiction Like "Roan*" Then
trusteecszPOC = "Roanoke, VA  24005"
ElseIf Jurisdiction Like "Newpor*" Or Jurisdiction Like "Norf*" Then
trusteecszPOC = "Portsmouth, VA  23705"
ElseIf Jurisdiction Like "Rich*" Then
trusteecszPOC = "Richmond, VA  23218-1780"
ElseIf Jurisdiction Like "Harris*" Or Jurisdiction Like "Stau*" Or Jurisdiction Like "Charlot*" Then
trusteecszPOC = "Charlottesville, VA  22902"
ElseIf Jurisdiction = "D.C." Then
trusteecszPOC = "Washington, D.C.  20016"
ElseIf Jurisdiction Like "Abing*" Then
trusteecszPOC = "Bristol, VA  24201"
ElseIf Jurisdiction Like "Greenb*" Then
trusteecszPOC = "Bowie, MD  20718"
ElseIf Jurisdiction Like "Balti*" Then
trusteecszPOC = "Baltimore, MD  21284"
End If
Else
trusteecszPOC = Forms!proofofclaimmain![trustee_citystatezip]
End If

End Function



