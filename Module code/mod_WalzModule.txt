Attribute VB_Name = "WalzModule"
Option Compare Database
Public Function NoticeSaleCounty()
'County Letter for MD-----------------------
If Forms![foreclosure database screen]!PropertyState = "MD" Then
CurrentDb.Execute "DELETE * FROM walzxml;"

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "Notice of Sale - County"
Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenReport VConvRpt, acViewPreview

vWalzPDF = vWalzPDF + 1

'Imaged Docs Start

Dim Vyes3
Dim Vyes4

Vyes3 = MsgBox("Send to Imaged Docs?", vbYesNo)

If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of Sale - County", "NtcOfSale", "COUNTY_NtcofSaleCty.PDF"
End If
'Imaged Docs End

Vyes4 = MsgBox("Send to Walz?", vbYesNo)

If Vyes4 = vbYes Then

'Ad Attachment------------------------------
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VConvRpt = "Ad"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VConvRpt = "Addc"
End If

vadattach = dumpname & "_" & VConvRpt & ".pdf"
Call ConvertPDF

VPDF = VPDF & ";" & vadattach
VLtr = "CTY"

Call ExportCountyXML

Call CreateWalzXMLCTY

Call CreateCompleteFile

End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!NOS) Then
Forms![foreclosure database screen]!ForeclosureSubForm.Form!NOS = Date
End If

Else
MsgBox ("THIS IS NOT A Maryland file.  No County Letter will be sent")

End If


End Function

Public Function CreateWalzXMLCTY()
Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0

Set rs = CurrentDb.OpenRecordset("WalzXML", dbOpenSnapshot)
Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
'MsgBox (vWalzPDF)

'pdf Count
Dim tempPDFCnt As Variant
Dim cnt
tempPDFCnt = Split(rs!pdffile, ";")
cnt = Split(rs!pdffile, ";")

Dim VBd
VBd = UBound(tempPDFCnt)
'MsgBox (VBd)

If VBd = 0 Then
vWalzPDF = 1
Else
vWalzPDF = vWalzPDF + VBd + 1
End If


A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")
rs.MoveFirst

Do While Not rs.EOF

If Not IsNull(rs!NoticeTo) Then
If InStr(rs!NoticeTo, "&") Then
tostringupdate = Replace(rs!NoticeTo, "&", "&amp;")
ElseIf InStr(rs!NoticeTo, "'") Then
tostringupdate = Replace(rs!NoticeTo, "'", "'")
Else
tostringupdate = rs!NoticeTo
End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
Else
add2stringupdate = ""
End If

If Not IsNull(rs!Name2) Then
If InStr(rs!Name2, "&") Then
name2stringupdate = Replace(rs!Name2, "&", "&amp;")
Else
name2stringupdate = rs!Name2
End If
Else
name2stringupdate = ""
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
Else
citystringupdate = ""
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")


A.WriteLine ("<Inserts>")

Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")
'MsgBox ("BELOW: " & UBound(tempPDF))


pdf_file = StrConv(C(0), vbProperCase)
'MsgBox (pdf_file)

A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
A.WriteLine ("</Insert>")


pdf_file = StrConv(C(1), vbProperCase)
'MsgBox (pdf_file)

A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
A.WriteLine ("</Insert>")

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")


rs.MoveNext

Loop
rs.Close
Set rs = Nothing

A.WriteLine ("</WalzImportFile>")

End Function

Public Function NoticesDebtors() As String
 
gOcc = 0

If Forms![foreclosure database screen]!PropertyState = "VA" And _
Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!sbl_sent) Then
If Forms![foreclosure database screen]!ForeclosureSubForm.Form!sbl_sent + 14 > Date Then
Dim VSb As String
VSb = InputBox("LNL Hold has NOT Ended, please input password to continue.")
If VSb = "continue" Then
Else
Exit Function
End If
End If
End If


If Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 14 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If
End If

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] = "" Then
MsgBox "PLEASE FILL IN DATE OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
Exit Function
End If
End If

'MsgBox ("Date: " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![NoticeSent])

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent]) Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] = "" Then
MsgBox "PLEASE FILL IN NOTICE SENT FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

Dim VSend, VEmail As String
VEmail = MsgBox("Email Notice of Sale Letters?", vbYesNo)

If VEmail = vbYes Then
Call NoticesDebtorsEmail

Else
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
Call ExportNotices
'Call ExportLienholderNoticesVA

Dim VPrt
VPrt = MsgBox("Print Notices Directly to Printer?", vbYesNo)
If VPrt = vbYes Then

DoCmd.OpenReport ("Adv-VA"), acViewNormal

If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Or (Forms![foreclosure database screen]!ForeclosureSubForm.Form!TypeOfLoan.Form!VA = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!TypeOfLoan.Form!VA = 1) Then
DoCmd.OpenReport ("Notice of SaleVA"), acViewNormal
End If

If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
DoCmd.OpenReport ("Notice of SaleHUD"), acViewNormal
End If

DoCmd.OpenReport ("Notice of Sale - Virginia"), acViewNormal

Call ImageVAIEmail

FollowHyperlink ("c:\4closure\" & Forms![foreclosure database screen]!filenum & "_DOA.pdf")


Else

If VEmail = vbYes Then
Else
DoCmd.OpenReport ("Notice of Sale - Virginia"), acViewPreview
End If

DoCmd.OpenReport ("Adv-VA"), acViewPreview
If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Then
DoCmd.OpenReport ("Notice of SaleVA"), acViewPreview
End If

If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
DoCmd.OpenReport ("Notice of SaleHUD"), acViewPreview
End If

End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then

If Forms![foreclosure database screen]!PropertyState = "MD" Then
gOcc = 1
End If

Call ExportNotices

DoCmd.OpenReport ("Notice of Sale"), acViewPreview

If Forms![foreclosure database screen]![PropertyState] = "DC" Then
Else
DoCmd.OpenReport "Notice of Sale - County", acViewPreview
End If

If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!PropertyCity = "Allen" Or _
Forms![foreclosure database screen]!PropertyCity = "Bivalve" Or _
Forms![foreclosure database screen]!PropertyCity = "Nanticoke" Or _
Forms![foreclosure database screen]!PropertyCity = "Parsonburg" Or _
Forms![foreclosure database screen]!PropertyCity = "Powellville" Or _
Forms![foreclosure database screen]!PropertyCity = "Quantico" Or _
Forms![foreclosure database screen]!PropertyCity = "Tyaskin" Then
Else
DoCmd.OpenReport ("Notice of Sale - City"), acViewPreview
End If
End If


If Forms![foreclosure database screen]!PropertyState = "MD" Then
DoCmd.OpenReport ("Ad"), acViewPreview
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
DoCmd.OpenReport ("Addc"), acViewPreview
End If


If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Then
DoCmd.OpenReport ("Notice of SaleVA"), acViewPreview
End If

If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
DoCmd.OpenReport ("Notice of SaleHUD"), acViewPreview
End If

End If

End If

MsgBox ("This is only the preview of letters.  To send Letters to Walz for the Borrowers you must select the menu item Notices Borrowers (To Walz)")



End Function

Public Function BorrowersWalz()

If (Forms![foreclosure database screen]!PropertyState = "MD" And IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!Notice_reviewed)) Or _
(Forms![foreclosure database screen]!PropertyState = "VA" And IsNull(Forms![foreclosure database screen]!ForeclosureSubFormVA.Form!notice_reviewedDATE)) Then
VPsswd = InputBox("Notices have not been reviewed.")

If VPsswd <> "SendWalz" Then
MsgBox ("incorrect password, exiting...")

Exit Function
End If

Else

If Forms![foreclosure database screen]!PropertyState = "VA" And [Forms]![foreclosure database screen]![ForeclosureSubFormVA].[Form]![vasublps].[Form]![notice_hold] > Date Then

MsgBox ("Notice is on Hold, exiting...")

Exit Function
End If

VSend = InputBox("Send Notice of Sale Letters to Walz for Mailing?")
If VSend <> "Yes" Then
Exit Function

Else

'If VSend = "YES" Then
If Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 32 Then
MsgBox "WALZ INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Thirteen (13) Days or More Than 32 From Sale Date.  MUST DO LETTERS MANUALLY.", vbOKOnly
fVaroverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "Walz" Then
Else
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noticesent] + 14 Then
MsgBox "WALZ INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days From Sale Date.  MUST DO LETTERS MANUALLY.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "Walz" Then
Else
Exit Function
End If
End If
End If

'WO Call NOS
VCancelDump = 0

 Call NOSCheck
 
If VCancelDump = 1 Then
    MsgBox ("LETTERS NOT SENT TO WALZ!!!")
    Exit Function
      Else
     'MsgBox ("Letters Sent to Walz")
     End If

End If


End If


End Function
Public Function WalzLienPDF()
Dim VCred
Dim strsql As String
Dim rscred As RecordSet

If VLtr = "lnva" Or VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "VASB" Or VLtr Like "ACL*" Then

If VFdlLnl = 2 Then

strsql = "select * from creditors where (MD_Letter = " & -1 & " or MD_Letter = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

Else
strsql = "select * from creditors where (fdl = " & -1 & " or fdl = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
End If

If Not rscred.EOF Then
VCred = "YES"
Else
VCred = "NO"
End If


End If


End Function
Public Function WalzLienPDFNOTICES()

'VCred = InputBox("RUN Lienholder Letters? Type YES")

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rscred.EOF Then

MsgBox ("No Lienholders addresses for this BWW#")
Exit Function
rscred.Close
Set rscred = Nothing

Else
rscred.Close
Set rscred = Nothing

If Forms![foreclosure database screen]!PropertyState = "VA" Then
'If vimageXML = "Yes" Then
VLtr = "NOSCredVAI"
'Else
'VLtr = "NOSCredVA"
'End If
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOSCredDC"
Else
VLtr = "NOSCredMD"
End If
End If


If Forms![foreclosure database screen]!PropertyState = "VA" Then
VConvRpt = "CreditorsVA"
Else
VConvRpt = "CreditorsWalz"
End If

DoCmd.OpenReport VConvRpt, acViewPreview


'End If


'End If



Vyes3 = MsgBox("Send Lienholder(s)Notice of Sale Letter(s) to BWW Docs", vbYesNo)

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs VConvRpt, "NtcOfSale", "_NtcofSaleLien.PDF"
End If
'Imaged Docs end




MsgBox ("This is only the preview of letters.  To send Letters to Walz for the Lienholders you must select the menu item Notices Lienholders (To Walz)")


End Function
Public Function LienholdersWALZ()

If (Forms![foreclosure database screen]!PropertyState = "MD" And IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!Notice_reviewed)) Or _
(Forms![foreclosure database screen]!PropertyState = "VA" And IsNull(Forms![foreclosure database screen]!ForeclosureSubFormVA.Form!notice_reviewedDATE)) Then

VPsswd = InputBox("Notices have not been reviewed. To continue enter password.")
If VPsswd <> "SendWalz" Then

MsgBox ("Incorrect Password exiting...")
Exit Function
End If


Else

If Forms![foreclosure database screen]!PropertyState = "VA" And [Forms]![foreclosure database screen]![ForeclosureSubFormVA].[Form]![vasublps].[Form]![notice_hold] > Date Then

MsgBox ("Notice is on Hold, exiting...")

Exit Function
End If



VSend = InputBox("Send Notice of Sale Letters for Lienholders to Walz for Mailing?")
If VSend <> "Yes" Then
Exit Function

Else


CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VConvRpt = "CreditorsVA"
Else
VConvRpt = "CreditorsWalz"
End If
Call ConvertPDF


Vyes3 = MsgBox("Send Lienholder(s)Notice of Sale Letter(s) to BWW Docs", vbYesNo)

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs VConvRpt, "NtcOfSale", "_NtcofSaleLien.PDF"
End If
'Imaged Docs end


If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "NOSCREDVAI"
Call ImageVAI

ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOSCREDDC"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "NOSCREDMD"
End If




If Forms![foreclosure database screen]!PropertyState = "VA" And vimageXML = "yes" Then
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & VPDFxml
Else
VPDF = dumpname & "_" & VConvRpt & ".pdf"
End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VConvRpt = "Adv-VA"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VConvRpt = "Ad"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VConvRpt = "addc"
End If
Call ConvertPDF

VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"

'====================



Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

Do While Not rscred.EOF
'Set rsLienholders = CurrentDb.OpenRecordset(strsqlLien, dbopensnapshot)

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "fdl*" Or VLtr = "lnva" Or VLtr Like "OOM*" Then
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Or _
Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rscred!OrganizationName
If rscred!Address Like "Attn*" Or _
rscred!Address Like "For*" Or _
rscred!Address Like "c/o*" Or _
rscred!Address Like "Atten*" Then
!Name2 = rscred!Address
If rscred!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rscred!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rscred!Address
If rscred!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rscred!Address2
End If
!address3 = ""
End If
!citystatezip = rscred!City & ", " & rscred!State & "  " & rscred!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update

End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum

!NoticeTo = rscred!OrganizationName
If rscred!Address Like "Attn*" Or _
rscred!Address Like "For*" Or _
rscred!Address Like "c/o*" Or _
rscred!Address Like "Atten*" Then
!Name2 = rscred!Address

If rscred!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rscred!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rscred!Address
If rscred!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rscred!Address2
End If
End If
!NoticeCITY = rscred!City
!NoticeSTATE = rscred!State
!NoticeZIP = rscred!PostalCode
!reference = VIDNo
!pdffile = VPDF
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VNo
!PageCount = "1"
End If

.Update

End With


With rscred
.Edit
!Walz_Ref = VIDNo
!noticesent = Date

.Update
End With
'====================
rscred.MoveNext
Loop

rscred.Close
rs.Close
rsWalz.Close

Set rscred = Nothing
Set rs = Nothing
Set rsWalz = Nothing

Call CreateWalzXMLLIEN
Call CreateCompleteFile

If VLtr = "lnva" Or VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "VASB" Or VLtr Like "ACL*" Then
Else
Forms![foreclosure database screen]!Walz_Mailed_NOS = Date
mySendKeys ("{F9}"), True ': DoEvents
End If
End If

End If

End Function
Public Function NoticeIndLienPRSL()

strsql = "Select * from litigation where subfilenum = " & GblFilenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not IsNull(rs!fdcpa_recd) And (IsNull(rs!fdcpa_sent) And IsNull(rs!NoDebtReq)) Then
MsgBox ("This task cannot be completed at this time because there is an outstanding FDCPA dispute of the debt. Please contact the assigned attorney on the litigation screen?s QWR/FDCPA tab to check the status of the response.")
rs.Close
Set rs = Nothing
Exit Function
Else
rs.Close
Set rs = Nothing



ContactID = Forms![fairdebt]!Creditor.Form!ContactID


strsql = "select * from creditors where [contactid] = " & ContactID
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
MsgBox ("Incorrect#")
rs.Close
Exit Function
End If

'MsgBox (Forms![foreclosure database screen]!ForeclosureSubForm.Form!pogoodthru)


Dim DocName As String

VConvRpt = "indcredPRSL"

DoCmd.OpenReport VConvRpt, acViewPreview



VWalz = InputBox("Type YES to send to Walz")
If VWalz Like "y*" Then
MsgBox ("PLEASE WAIT UNTIL YOU RECEIVE THE PROMPT LETTER SENT TO WALZ BEFORE PROCEEDING TO THE NEXT INDIVIDUAL LIENHOLDER LETTER!!!!")

 Call PRSLIndPDF
 
 MsgBox ("Letter Sent to Walz")
 Exit Function
Else
DoCmd.OpenReport VConvRpt, acViewPreview
End If

End If

End Function

Public Function NoticeIndLienFDL()

If AppType = "Creditors" Then
ContactID = Forms!creditors!Creditor.Form!ContactID
ElseIf AppType = "fairdebt" Then
ContactID = Forms![fairdebt]!Creditor.Form!ContactID

strsql = "Select * from litigation where subfilenum = " & GblFilenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not IsNull(rs!fdcpa_recd) And (IsNull(rs!fdcpa_sent) And IsNull(rs!NoDebtReq)) Then
MsgBox ("This task cannot be completed at this time because there is an outstanding FDCPA dispute of the debt. Please contact the assigned attorney on the litigation screen?s QWR/FDCPA tab to check the status of the response.")
rs.Close
Set rs = Nothing
Exit Function
Else
rs.Close
Set rs = Nothing
End If
End If


strsql = "select * from creditors where [contactid] = " & ContactID
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
If rs.EOF Then
MsgBox ("Incorrect#")
rs.Close
Exit Function
End If

'MsgBox (Forms![foreclosure database screen]!ForeclosureSubForm.Form!pogoodthru)

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!POGoodThru > Date Then
Dim VPsd
VPsd = InputBox("The payoff good through date is in the future. A  fair debt letter should not be sent in this instance and you should wait until the good through date arrives before sending the fair debt letter. " & vbCr & "A password must be entered to override this popup and send the letter before the good through date. Consult a managing attorney for help if you think this should occur.")
If VPsd <> "FDCPAOR" Then
Exit Function
End If
End If

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!fdl_sent) Then
Dim VSel
VSel = InputBox("It appears that the FDL has already been sent on this file. Typically FDLs should not be sent again if it has already been done once. To confirm that you are intending to re-send the FDL, type yes and make sure that you update the FDL Sent field accordingly and document why you did this in the memo section. TYPE YES to proceed.")
If VSel = "No" Or IsNull(VSel) Then
Exit Function
End If
End If



Dim DocName As String

VConvRpt = "indcredFDL"

DoCmd.OpenReport VConvRpt, acViewPreview

If Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "JPM*" Or _
Forms![foreclosure database screen]!Client Like "Suntrust Bank*" Or _
((Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC") And _
[Forms]![foreclosure database screen]![Client] Like "Specializ*") Then
DoCmd.OpenReport "AttachmentPRSL", acViewPreview
End If

VWalz = InputBox("Type YES to send to Walz")
If VWalz Like "y*" Then
MsgBox ("PLEASE WAIT UNTIL YOU RECEIVE THE PROMPT LETTER SENT TO WALZ BEFORE PROCEEDING TO THE NEXT INDIVIDUAL LIENHOLDER LETTER!!!!")

 Call FDLIndPDF
 
 MsgBox ("Letter Sent to Walz")
 Exit Function
Else
DoCmd.OpenReport VConvRpt, acViewPreview
End If

End Function

Public Function NoticeIndLienScr()

ContactID = Forms![creditors]![Creditor].[Form]!ContactID

strsql = "select * from creditors where [contactid] = " & ContactID
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


Dim DocName As String

If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] > #6:00:00 PM# Or _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime] < #8:00:00 AM# Then
MsgBox "Invalid Sale Time!!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "PLEASE FILL IN DATE OF SALE DATE FIELD ON THE FORECLOSURE SCREEN!", vbOKOnly
rs.Close
Exit Function
End If


If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE TIME FIELD ON FORECLOSURE SCREEN!", vbOKOnly
rs.Close

Exit Function
End If

If ([Forms]![creditors]![Creditor].[Form]![noticesent] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Or _
([Forms]![creditors]![noticesent_lien] > _
[Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate]) Then
MsgBox "INSUFFICIENT NOTICE! Notice Date AFTER Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close
Exit Function
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 10 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Maryland File and the Notice Date is Less Than Ten (10) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close
Exit Function
End If
End If
End If

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] < _
rs!noticesent + 14 _
Or [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleDate] > _
rs!noticesent + 30 Then
MsgBox "INSUFFICIENT NOTICE! This is a Virginia File and the Notice Date is Less Than Fourteen (14) Days or More Than 30 From Sale Date.", vbOKOnly
Varoverride = InputBox("To OverRide this Insufficient Notice Please input Password")
If Varoverride = "HNB" Then
Else
rs.Close

Exit Function
End If
End If
End If

rs.Close


If Forms![foreclosure database screen]![PropertyState] Like "VA*" Then
VConvRpt = "indcredva"
Else
VConvRpt = "indcred"
End If


DoCmd.OpenReport VConvRpt, acViewPreview

Wait 5

VWalz = MsgBox("Dump to Walz?", vbYesNo)
If VWalz = vbYes Then
MsgBox ("PLEASE WAIT UNTIL YOU RECEIVE THE PROMPT LETTER SENT TO WALZ BEFORE PROCEEDING TO THE NEXT INDIVIDUAL LIENHOLDER LETTER!!!!")

 Call WalzLienInd
 MsgBox ("Letter Sent to Walz")
 Exit Function
Else
DoCmd.OpenReport VConvRpt, acViewPreview
End If

End Function

Public Function CreateWalzXMLPGReg()
Dim VPkg As String
Dim rsWalz As RecordSet

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = "099999" & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "PGRegLetter"
Call ConvertPDF
VPDF = dumpname & "_PGRegLetter.pdf"
VIDNo = GetAutoNumber("NextWalz")

Set rs = CurrentDb.OpenRecordset("walzxml")
Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & "P1Pkg" & "</RecordType>")
A.WriteLine ("<Reference>" & 99999 & "</Reference>")
A.WriteLine ("<FileNum>" & VIDNo & "</FileNum>")
A.WriteLine ("<IDCode>" & "PGRegLtr" & "</IDCode>")
A.WriteLine ("<Name1>" & "Department of Environmental Resources" & "</Name1>")
A.WriteLine ("<Name2>" & "Property Standards Group, Foreclosure Registration Unit" & "</Name2>")
A.WriteLine ("<Address1>" & "1220 Caraway Court, Suite 1050" & "</Address1>")
A.WriteLine ("<City>" & "Largo" & "</City>")
A.WriteLine ("<State>" & "MD" & "</State>")
A.WriteLine ("<Zip>" & "20744" & "</Zip>")
A.WriteLine ("<Inserts>")
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & VPDF & "</Name>")
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
A.WriteLine ("</Insert>")
A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
A.WriteLine ("</WalzImportFile>")

End Function
Public Function noticeOcc()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
VConvRpt = "NoticeDocket"
Call ConvertPDF
VLtr = "NOC"

VPDF = dumpname & "_" & VConvRpt & ".pdf"

Call Wait(5, False)     ' wait 5 seconds

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call ExportXMLOccupants
Call CreateWalzXML
Call CreateCompleteFile


MsgBox ("Letter was Sent to Walz and NOC Sent to Walz Date input")



End If

End Function
Public Function noticeJOP()
dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
VConvRpt = "NoticeDocketJOP"
Call ConvertPDF
VLtr = "NOJ"
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = dumpname & "_" & VConvRpt & ".pdf"
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call ExportXMLOccupants
Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letter was Sent to Walz")

End If
End Function
Public Function noticeNOF()
Dim VSel

VSel = MsgBox("Send NOF to Walz?", vbYesNo)

If VSel <> vbYes Then

DoCmd.OpenReport "NoticeDocketImpending", acViewPreview

Exit Function

Else

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
VConvRpt = "NoticeDocketImpending"
Call ConvertPDF
VLtr = "NOF"

DoCmd.OpenReport "NoticeDocketImpending", acViewPreview

VPDF = dumpname & "_" & VConvRpt & ".pdf"

Call Wait(5, False)     ' wait 5 seconds


Vyes3 = MsgBox("Send NOF Letter to BWW Docs", vbYesNo)

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs VConvRpt, "NtcImpFcSL", "_NOF.PDF"
End If
'Imaged Docs end


CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call ExportXMLOccupants
Call CreateWalzXML
txtname = dumpname & ".complete"
sourcefile = DTLocation & "\CompleteWalz.txt"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.
End If

Call Wait(5, False)     ' wait 5 seconds

MsgBox ("Letter was Sent to Walz")


End If

End Function
Public Function ExportXMLOccupants()

Dim rsnotice As RecordSet
Dim rsWalz As RecordSet
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = "All Occupants"
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

rsnotice.Close

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "NOC" Then
!Notes = "NOS Occupant"
Else
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "All Occupants"
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With

End Function

Public Function ExportXMLOccupantsEvic()
Dim rsnotice As RecordSet
Dim rsWalz As RecordSet
Dim VCStart
Dim VEnd
VCStart = 0
VEnd = 0

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)


GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If rsE!Occ_Last1 <> "" Or _
Not IsNull(rsE!Occ_Last1) Then

With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = Occupant1()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCStart + 1
If VLtr = "P1Pkg" Then
VCStart = VCStart + 1
!PageCount = 1
ElseIf VLtr = "NTQVAO" Then
!PageCount = "-1"
Else
VCStart = VCStart + 3
!PageCount = 3
End If
.Update
End With

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "P1Pkg" Then
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = Occupant1()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With
End If

If rsE!Occ_Last2 <> "" Or _
Not IsNull(rsE!Occ_Last2) Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = Occupant2()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "P1Pkg" Then
VCStart = VCStart + 1
!PageCount = 1
ElseIf VLtr = "NTQVAO" Then
!PageCount = "-1"
Else
VCStart = VCStart + 3
!PageCount = 3
End If
.Update
End With


Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "P1Pkg" Then
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = Occupant2()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With
End If

If rsE!Occ_Last3 <> "" Or _
Not IsNull(rsE!Occ_Last3) Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = Occupant3()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "P1Pkg" Then
VCStart = VCStart + 1
!PageCount = 1
ElseIf VLtr = "NTQVAO" Then
!PageCount = "-1"
Else
VCStart = VCStart + 3
!PageCount = 3
End If
.Update
End With

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "P1Pkg" Then
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = Occupant3()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With
End If

If rsE!Occ_Last4 <> "" Or _
Not IsNull(rsE!Occ_Last4) Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = Occupant4()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "P1Pkg" Then
VCStart = VCStart + 1
!PageCount = 1
ElseIf VLtr = "NTQVAO" Then
!PageCount = "-1"
Else
VCStart = VCStart + 3
!PageCount = 3
End If
.Update
End With

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "P1Pkg" Then
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = Occupant4()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With
End If


With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = "All Occupants"
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCStart + 1
If VLtr = "P1Pkg" Then
VCStart = VCStart + 1
!PageCount = 1
ElseIf VLtr = "NTQVAO" Then
!PageCount = "-1"
Else
VCStart = VCStart + 3
!PageCount = 3
End If
.Update
End With

With rsWalz
.AddNew
!ID_No = VIDNo
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
If VLtr = "P1Pkg" Then
!Notes = "Eviction Package"
End If

!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "All Occupants"
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = Forms![foreclosure database screen]!propaddress2
!citystatezip = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With




rsnotice.Close
rsE.Close



End Function

Public Function CreateWalzInv()
Dim rs As RecordSet, rsW As RecordSet
Dim VBGw
Dim VStart As Date
Dim VEnd As Date

VWLtrs = 0


DoCmd.OpenQuery ("WalzInvoiceCreate")
Set rs = CurrentDb.OpenRecordset("WalzInvData")
'Set rsW = CurrentDb.OpenRecordset("WalzInvReq", dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then

VBGw = rs![BGWW#]

If Not IsNull(rs!WalzDateUploaded) Then
VStart = rs!WalzDateUploaded
VEnd = rs!WalzDateUploaded
End If

Do While Not rs.EOF
If Not IsNull(rs!WalzDateUploaded) And _
rs!WalzDateUploaded > VEnd Then
VEnd = rs!WalzDateUploaded
End If

rs.MoveNext
Loop

'If VStart = #12:00:00 AM# Then
'MsgBox ("No Letters Sent to Walz Yet.  Uploaded and Received")
'Else
'With rsW
'.AddNew
'!ID_No = GetAutoNumber("NextWalzInv")
'![BGWW#] = VBGW
'!startdate = VStart
'!EndDate = VEnd + 3
'.Update
'.Close
'End With
'End If

MsgBox ("Sent to Walz." & vbCr & "No email individually sent anymore, will compile group email end of the day.")

Else
MsgBox ("No Walz Letters for current sale date." & vbCr & "IF THERE IS AN OLD SALE DATE PLEASE use prompt in Walz menu to Request Invoice for Previous Sale.")
VWLtrs = 1

End If


End Function
Public Function CreateWalzInvRESUME()
Dim rs As RecordSet, rsW As RecordSet
Dim VBGw
Dim VStart As Date
Dim VEnd As Date

VWLtrs = 0

CurrentDb.Execute "DELETE * FROM WalzInvData;", dbFailOnError

DoCmd.OpenQuery ("WalzInvoiceCreateRESUME")
Set rs = CurrentDb.OpenRecordset("WalzInvData")
Set rsW = CurrentDb.OpenRecordset("WalzInvReq", dbOpenDynaset, dbSeeChanges)

If Not rs.EOF Then

VBGw = rs![BGWW#]

If Not IsNull(rs!WalzDateUploaded) Then
VStart = rs!WalzDateUploaded
VEnd = rs!WalzDateUploaded
End If

Do While Not rs.EOF
If Not IsNull(rs!WalzDateUploaded) And _
rs!WalzDateUploaded > VEnd Then
VEnd = rs!WalzDateUploaded
End If

rs.MoveNext
Loop

If VStart = #12:00:00 AM# Then
MsgBox ("No Letters Sent to Walz Yet.  Uploaded and Received")
Else
With rsW
.AddNew
!ID_No = GetAutoNumber("NextWalzInv")
![BGWW#] = VBGw
!startdate = VStart
!EndDate = VEnd + 3
.Update
.Close
End With
End If

Else
MsgBox ("No Walz Letters for previous sale date/resume parameter input.")
VWLtrs = 1

End If
End Function
Public Function ViaWalzNOS()
'If Not IsNull(Forms![foreclosure database screen]!Walz_Mailed_NOS) Then
'ViaWalzNOS = "(W)"
'ElseIf IsNull(Forms![foreclosure database screen]!Walz_Mailed_NOS) And _
'Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!NoticeSent) Then
'ViaWalzNOS = "(M)"
'End If

End Function
Public Function EmailWalzInvRequest()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim rs As RecordSet
'Call CreateWalzInv
End Function
Public Function EmailWalzInvRequestRESUME()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim rs As RecordSet

'Call CreateWalzInvRESUME


Set MyOutlook = New Outlook.Application
Dim strsql
strsql = "select * from walzinfo where filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql)
If rs.EOF Then
rs.Close
MsgBox ("No Walz Monies listed for this file.  Check the Resume Screen")
Else
MsgBox ("Requests for Invoices will now go to bgw@bww-law.com and accumulate to be sent at the end of the day")
DoCmd.OutputTo acOutputQuery, "WalzInvoice", acFormatXLS, pathuser() & "\WalzInvoice" & ".xls"
emailsubject = "Requesting Invoice for Attached Spreadsheet (RESUME)"
emailbody = "BWW#: " & Forms![foreclosure database screen]!filenum
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Attachments.ADD pathuser() & "\WalzInvoice.xls"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.To = "bgw@bww-law.com"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing
End If


End Function
Public Function EmailWalzInvALL()
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim rs As RecordSet

'Call CreateWalzInv

Set MyOutlook = New Outlook.Application

Dim strsql
strsql = "select * from walzinfo where filenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql)

If rs.EOF Then
rs.Close
MsgBox ("No Walz Monies listed for this file.  Check the Resume Screen")

Else
DoCmd.OutputTo acOutputQuery, "WalzInvoiceAll", acFormatXLS, pathuser() & "\WalzInvoice" & ".xls"
emailsubject = "Requesting Invoice for Attached Spreadsheet"
emailbody = "BWW#: " & Forms![foreclosure database screen]!filenum
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.Attachments.ADD pathuser() & "\WalzInvoice.xls"
MyMail.Subject = emailsubject
MyMail.body = emailbody + SigEmail()
MyMail.To = "clientcare@walzgroup.com; prothacker@walzgroup.com"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

End If
End Function


Public Function LNLDocs()

Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)
If Vyes3 = vbYes Then
CopyDocToBGWWDocs "LostNoteVAWalz", "lstnoteltr", "_LNL.PDF"
End If


End Function
Public Function FDLDocs()

Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)

If Vyes3 = vbYes Then
Call ExportFDLLetters


CopyDocToBGWWDocs "Fairdebt Letter", "FairDebLtr", "_FDL.PDF"

If Forms![foreclosure database screen]!PropertyState <> "MD" And Forms![foreclosure database screen]!Client <> "Champion Mortgage Company" And _
((Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or (Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1)) _
Or (Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1)) Then
If (Forms![foreclosure database screen]!Client <> "Financial Freedom Acquisition, LLC" And _
(Forms![foreclosure database screen]!Client <> "OneWest Bank, FSB" And _
(Forms![foreclosure database screen]!FF = -1 Or Forms![foreclosure database screen]!FF = 1))) Then

If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
CopyDocToBGWWDocs "Fairdebt-HUD-VA", "FairDebLtr", "_FDLHud.PDF"
Else
CopyDocToBGWWDocs "Fairdebt-HUD", "FairDebLtr", "_FDLHud.PDF"
End If

End If
End If



If Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "JPM*" Or _
Forms![foreclosure database screen]!Client Like "Suntrust Bank*" Or _
((Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC") And _
[Forms]![foreclosure database screen]![Client] Like "Specializ*") Then
CopyDocToBGWWDocs "AttachmentPRSL", "FairDebLtr", "_FDLPRSL.PDF"
End If
Else
DoCmd.RunMacro "FairDebtRunLettersWalz"
End If

End Function
Public Function NOSPDF()
vWalzPDF = 0

Vyes3 = MsgBox("Send Notice of Sale Letter(s) to BWW Docs", vbYesNo)
'Virginia NOS Letter---------------------------------

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
VConvRpt = "Notice of Sale - Virginia"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = dumpname & "_" & VConvRpt & ".pdf"

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of Sale - Virginia", "NtcOfSale", "_NtcofSale.PDF"
End If
'Imaged Docs end

'Ad Attachment------------------------------
VConvRpt = "Adv-VA"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
vadattach = dumpname & "_" & VConvRpt & ".pdf"
'DOA Attachment------------------------------------
VPDF = VPDF & ";" & VPDFxml
'Dump Borrowers---------------------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

DoCmd.OpenQuery ("WalzAppendXMLTable")

Call exportXMLNotices

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Or _
Forms![foreclosure database screen]![PropertyState] = "DC" Then
VConvRpt = "Notice of Sale"
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"


'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of Sale", "NtcOfSale", "_NtcofSale.PDF"
End If
'Imaged Docs End

'Ad Attachment------------------------------
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VConvRpt = "Ad"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VConvRpt = "Addc"
End If
vadattach = dumpname & "_" & VConvRpt & ".pdf"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview


If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
'Append to Borrowers------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
DoCmd.OpenQuery ("WalzAppendXMLTable")

Call exportXMLNotices

'County Letter for MD-----------------------
If Forms![foreclosure database screen]!PropertyState = "MD" Then

VConvRpt = "Notice of Sale - County"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

vWalzPDF = vWalzPDF + 1

'Imaged Docs Start


If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of Sale - County", "NtcOfSale", "_NtcofSaleCty.PDF"
End If
'Imaged Docs End

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vadattach
VLtr = "CTY"
Call ExportCountyXML
End If

'City Letter --------------------------
If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!PropertyCity = "Allen" Or _
Forms![foreclosure database screen]!PropertyCity = "Bivalve" Or _
Forms![foreclosure database screen]!PropertyCity = "Nanticoke" Or _
Forms![foreclosure database screen]!PropertyCity = "Parsonburg" Or _
Forms![foreclosure database screen]!PropertyCity = "Powellville" Or _
Forms![foreclosure database screen]!PropertyCity = "Quantico" Or _
Forms![foreclosure database screen]!PropertyCity = "Tyaskin" Then
Else
VConvRpt = "Notice of Sale - City"
Call ConvertPDF
vWalzPDF = vWalzPDF + 1

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of Sale - City", "NtcOfSale", "_NtcofSaleCITY.PDF"
End If
'Imaged Docs End

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vadattach
VLtr = "CITY"
Call ExportScreenDataXML
End If
End If
End If

'VA Letter-------------------------
If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Then

VConvRpt = "Notice of SaleVA"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

vWalzPDF = vWalzPDF + 1

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of SaleVA", "NtcOfSale", "_NtcofSaleVA.PDF"
End If
'Imaged Docs End

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vadattach

If vimageXML = "Yes" And Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "NOTHUDVETVAI"
VPDF = VPDF & ";" & VPDFxml
Else
VLtr = "NOTHUDVETVA"
End If
If Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOTHUDVETDC"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "NOTHUDVETMD"
End If

Call ExportVAxml


End If
'FHA Letter---------------

If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
VConvRpt = "Notice of SaleHUD1st"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

vWalzPDF = vWalzPDF + 1

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of SaleHUD1st", "NtcOfSale", "_NtcofSaleHUD1.PDF"
End If
'Imaged Docs End

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vadattach

If Forms![foreclosure database screen]!PropertyState = "VA" Then
If vimageXML = "Yes" Then
VLtr = "NOTHUDVETVAI"
VPDF = VPDF & ";" & VPDFxml
Else
VLtr = "NOTHUDVETVA"
End If
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOTHUDVETDC"
Else
VLtr = "NOTHUDVETMD"
End If
Call ExportHUDxml

'2nd FHA Letter Files--------------------

VConvRpt = "Notice of SaleHUD2nd"
Call ConvertPDF
'DoCmd.OpenReport VConvRpt, acViewPreview

vWalzPDF = vWalzPDF + 1

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs "Notice of SaleHUD2nd", "NtcOfSale", "_NtcofSaleHUD2.PDF"
End If
'Imaged Docs End

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vadattach

If Forms![foreclosure database screen]!PropertyState = "VA" Then
If vimageXML = "Yes" Then
VLtr = "NOTHUDVETVAI"
VPDF = VPDF & ";" & VPDFxml
Else
VLtr = "NOTHUDVETVA"
End If
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOTHUDVETDC"
Else
VLtr = "NOTHUDVETMD"
End If

Call ExportHUD2xml

End If


Call CreateWalzXML
Call CreateCompleteFile


End Function
Public Function ImageNOTICES()
Dim Vyes3
Vyes3 = MsgBox("Send all Notice Letters to Imaged Documents?", vbYesNo)


If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum

'Imaged Docs Start
VConvRpt = "Notice of Sale"
CopyDocToBGWWDocs "Notice of Sale", "NtcOfSale", "_NtcofSale.PDF"
'Imaged Docs End

If Forms![foreclosure database screen]!PropertyState <> "VA" Then
VConvRpt = "Notice of Sale - County"
Call ConvertPDF
'Imaged Docs Start
CopyDocToBGWWDocs "Notice of Sale - County", "NtcOfSale", "_NtcofSaleCty.PDF"
End If
'Imaged Docs End


'City Letter --------------------------
If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!PropertyCity = "Allen" Or _
Forms![foreclosure database screen]!PropertyCity = "Bivalve" Or _
Forms![foreclosure database screen]!PropertyCity = "Nanticoke" Or _
Forms![foreclosure database screen]!PropertyCity = "Parsonburg" Or _
Forms![foreclosure database screen]!PropertyCity = "Powellville" Or _
Forms![foreclosure database screen]!PropertyCity = "Quantico" Or _
Forms![foreclosure database screen]!PropertyCity = "Tyaskin" Then
Else

'Imaged Docs Start
VConvRpt = "Notice of Sale - City"
CopyDocToBGWWDocs "Notice of Sale - City", "NtcOfSale", "_NtcofSaleCITY.PDF"
End If
End If
End If


'VA Letter-------------------------
If [Forms]![foreclosure database screen]![TypeOfLoan] = "VA" Then
'Imaged Docs Start
VConvRpt = "Notice of SaleVA"
CopyDocToBGWWDocs "Notice of SaleVA", "NtcOfSale", "_NtcofSaleVA.PDF"
End If



'FHA Letter---------------
If [Forms]![foreclosure database screen]!fha = 1 Or [Forms]![foreclosure database screen]![fha] = -1 Or [Forms]![foreclosure database screen]![TypeOfLoan] Like "FHA*" Then
'Imaged Docs Start
VConvRpt = "Notice of SaleHUD1st"
CopyDocToBGWWDocs "Notice of SaleHUD1st", "NtcOfSale", "_NtcofSaleHUD1.PDF"
VConvRpt = "Notice of SaleHUD2nd"
CopyDocToBGWWDocs "Notice of SaleHUD2nd", "NtcOfSale", "_NtcofSaleHUD2.PDF"
End If
'Imaged Docs End

End If



End Function

Public Function WalzLienFDL()

VLtrID = ContactID

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "FDLVA"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "FDLDC"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "FDLMD"
End If

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

strsql = "SELECT Creditors.* from Creditors WHERE (((Creditors.contactid)= " & VLtrID & "));"
Set rsLienHolders = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then

MsgBox ("Incorrect ID#")

Else

'FIX


VConvRpt = "indcredFDL"


Vyes3 = MsgBox("Send Ind. Lienholder FDL Letter to BWW Docs", vbYesNo)

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs VConvRpt, "FairDebLtr", "_FDL.PDF"
End If
'Imaged Docs end

Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"


Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


With rsLienHolders
.Edit
!Walz_Ref = VIDNo
!noticesent = Date

.Update
End With

End If


Call CreateWalzXML
Call CreateCompleteFile
End Function

Public Function WalzLienInd()

If IsNull([Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![SaleTime]) Then
MsgBox "PLEASE FILL IN TIME OF SALE FIELD ON SCREEN!", vbOKOnly
Exit Function
End If

VLtrID = Forms![creditors]![Creditor].[Form]!ContactID

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "NOSCREDVAI"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOSCREDDC"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "NOSCREDMD"
End If

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

strsql = "SELECT Creditors.* from Creditors WHERE (((Creditors.contactid)= " & VLtrID & "));"
Set rsLienHolders = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then

MsgBox ("Incorrect ID#")

Else

'FIX


If Forms![foreclosure database screen]!PropertyState = "VA" Then
VConvRpt = "indcredva"
Else
VConvRpt = "indcred"
End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then
Call ImageVAI
End If

Vyes3 = MsgBox("Send Ind. Lienholder(s) Notice of Sale Letter(s) to BWW Docs", vbYesNo)

'Imaged Docs Start
If Vyes3 = vbYes Then
GblFilenum = Forms![foreclosure database screen]!filenum
CopyDocToBGWWDocs VConvRpt, "NtcOfSale", "_NtcofSaleLienInd.PDF"
End If
'Imaged Docs end

Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"

'msgbox (VPDF)

If Forms![foreclosure database screen]!PropertyState = "VA" And vimageXML = "yes" Then
VPDF = VPDF & ";" & VPDFxml
End If
'msgbox (VPDF)

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VConvRpt = "Adv-VA"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VConvRpt = "Ad"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VConvRpt = "addc"
End If
Call ConvertPDF

VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
'msgbox (VPDF)

'====================


Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


With rsLienHolders
.Edit
!Walz_Ref = VIDNo
!noticesent = Date

.Update
End With

End If


Call CreateWalzXML
Call CreateCompleteFile
End Function

Public Function NOSCheck()
Dim strsql As String
Dim rs As RecordSet

strsql = "select * from creditors where filenum = " & Forms![foreclosure database screen]!filenum & " order by organizationname;"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

Do While Not rs.EOF
If IsNull(rs!Address) Or rs!Address = "" Then
MsgBox ("Blank address for " & rs!OrganizationName & ".  No Notices will go please update lienholders and resend.")
VCancelDump = 1
Exit Function
ElseIf IsNull(rs!City) Or rs!City = "" Or IsNull(rs!State) Or rs!State = "" Or IsNull(rs!PostalCode) Or rs!PostalCode = "" Then
MsgBox ("Blank City/State or Zip for " & rs!OrganizationName & ".  No Notices will go please update lienholders and resend.")
VCancelDump = 1
Exit Function
End If
rs.MoveNext
Loop

If Forms![foreclosure database screen]![Mailing Address] = "" Then
Forms![foreclosure database screen]![Mailing Address] = Null
End If

If Not IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] <> "" Then
If (IsNull(Forms![foreclosure database screen]![Mailing City]) Or _
Forms![foreclosure database screen]![Mailing City] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing State]) Or _
Forms![foreclosure database screen]![Mailing State] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing Zip]) Or _
Forms![foreclosure database screen]![Mailing Zip] = "") Then
VMsg = "There is missing Mailing Address information ,City State or Zip, input in the Screen, no letter will print"
MsgBox (VMsg)

Exit Function

End If
End If

If Forms![foreclosure database screen]!PropertyState = "MD" And _
(IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Or _
IsNull(Forms![foreclosure database screen]!PropAddress) Or _
IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!propzip) Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime) Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!notice_processor)) Then

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
VMsg = "There is no Sale Date input in the Screen, no letter will dump"
End If

If IsNull(Forms![foreclosure database screen]!PropAddress) Then
VMsg = "There is no Property Address input in the Screen, no letter will dump"
End If


If IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!PropertyState) Or _
IsNull(Forms![foreclosure database screen]!propzip) Then
VMsg = "There is missing property information ,City State or Zip, input in the Screen, no letter will print"
End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!notice_processor) Then
VMsg = "There is not a Notice Processor selected letters will not dump, please go input your initials. Thanks"
End If

MsgBox (VMsg)

Exit Function



Else


'Create Name of all Files to Dump--------------------
dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
'Call Image check for DOA for Virginia files---------
If Forms![foreclosure database screen]!PropertyState = "VA" Then
Call ImageVAI
End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then
If vimageXML = "Yes" Then
VLtr = "NOSVAI"
Else
MsgBox ("THERE IS NOT A DOAX.PDF FILE IN THE IMAGED DOCUMENTS.  NOTICES WILL HAVE TO BE MANUALLY SENT.  PLEASE SEE HOWIE.")
Exit Function
End If
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "NOSDC"
Else
VLtr = "NOSMD"
End If


Forms![foreclosure database screen]!Walz_Mailed_NOS = Date
Call NOSPDF


End If

End Function

Public Function ExportCountyXML()

Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet


Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

strsqlCounty = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsqlCounty)

 
Dim VMsg As String

If IsNull(rspropertycounty![county att]) And _
(Forms![foreclosure database screen]!PropertyState = "MD") Then
If IsNull(rspropertycounty![county att]) Then
VMsg = "There is no County Attorney input in the Jurisdiction Screen, no letter will dump"
End If

MsgBox (VMsg)

rspropertycounty.Close

Exit Function
Else

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If

!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rspropertycounty![county att]
!Name2 = rspropertycounty![countyadd1]
!Address1 = rspropertycounty![countyadd2]
!citystatezip = rspropertycounty![countyadd4]
!reference = Forms![foreclosure database screen]!filenum & VLtr
!Address2 = rspropertycounty![countyadd3]
!citystatezip = rspropertycounty![countyadd4]

.Update
End With

With rs
.AddNew
!ri = VLtr
!NoticeTo = rspropertycounty![county att]
!Name2 = rspropertycounty![countyadd1]
!NoticeAdd = rspropertycounty![countyadd2]
!NoticeAdd2 = rspropertycounty!countyadd3

'!noticestate = "MD"


Dim tempCtySt As Variant
Dim d
Dim v1
Dim v2
Dim C

d = Split(rspropertycounty!countyadd4, ", ")
 
v1 = StrConv(d(0), vbProperCase)
v2 = StrConv(d(1), vbProperCase)

tempCtySt = Split(v2, " ")
C = Split(v2, " ")

'MsgBox (v2 & ":temp: " & UBound(tempCtySt))

!NoticeCITY = v1

If rspropertycounty!countyadd4 Like "washington, D*" Then
!NoticeSTATE = "D.C."
Else
!NoticeSTATE = "MD"
End If


If UBound(tempCtySt) = 2 Then
!NoticeZIP = StrConv(C(2), vbProperCase)
ElseIf UBound(tempCtySt) = 1 Then
!NoticeZIP = StrConv(C(1), vbProperCase)
End If


!filenum = Forms![foreclosure database screen]!filenum
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With

rspropertycounty.Close

End If

End Function
Public Function ExportScreenDataXML()
Dim strsqlCounty, strsqlClients As String
Dim rs, rsclients, rspropertycounty As RecordSet
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)
Dim strsqlw, VD As String
Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

VIDNo = GetAutoNumber("NextWalz")

If VLtr = "CITY" Then
With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = MDCityAdd1()
!Name2 = MDCityAttn()
!NoticeAdd = MDCityAdd2()
!NoticeCITY = MDCity()
!NoticeSTATE = "MD"
!NoticeZIP = MDZip()
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"

.Update
End With
End If


With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
If VLtr = "NOCity" Then
!reference = Forms![foreclosure database screen]!filenum & "NOCity"
ElseIf VLtr = "NOTHUDVETVAI" Then
!reference = Forms![foreclosure database screen]!filenum & "NOTHUDVETVAI"
ElseIf VLtr = "NOTHUDVETVA" Then
!reference = Forms![foreclosure database screen]!filenum & "NOTHUDVETVA"
ElseIf VLtr = "CITY" Then
!Name1 = MDCityAdd1()
!Name2 = MDCityAttn()
!Address1 = MDCityAdd2()
!citystatezip = MDCityCSZ()
!reference = Forms![foreclosure database screen]!filenum & "CITY"
End If
.Update
End With

End Function

Public Function ExportHUDxml()
Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "Department of Housing and Urban Development"
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!Address1 = "3600 West Broad Street"
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!Name2 = "Attention: Single Family Housing Division"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!Name2 = "Attn: Property Disposition/Acquisition"
End If
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!Address2 = ""
!citystatezip = "Richmond, VA  23230-0331"
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!Address1 = "10 South Howard Street"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!Address1 = "820 First Street, N.E."
End If
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!address3 = ""
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!address3 = ""
!citystatezip = "Baltimore, MD  21201"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!address3 = ""
!citystatezip = "Washington, D.C.  20002"
End If
!reference = Forms![foreclosure database screen]!filenum & "HUD"

.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = "Department of Housing and Urban Development"
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!NoticeAdd = "3600 West Broad Street"
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!Name2 = "Attention: Single Family Housing Division"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!Name2 = "Attn: Property Disposition/Acquisition"
End If
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!NoticeAdd2 = ""
!NoticeCITY = "Richmond"
!NoticeSTATE = "VA"
!NoticeZIP = "23230-0331"
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!NoticeAdd = "10 South Howard Street"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!NoticeAdd = "820 First Street, N.E."
End If
If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!NoticeAdd2 = ""
ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
!NoticeAdd2 = ""
!NoticeCITY = "Baltimore"
!NoticeSTATE = "MD"
!NoticeZIP = "21201"
ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then
!NoticeAdd2 = ""
!NoticeCITY = "Washington"
!NoticeSTATE = "D.C."
!NoticeZIP = "20002"
End If
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"

.Update
End With


End Function
Public Function ExportVAxml()
Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "The Department of Veterans Affairs Regional Office"
!Address1 = "Loan Guarantee Program"
!Name2 = "Attn: Loan Servicing and Claims (261)"
!Address2 = "210 Franklin Road, SW"
!citystatezip = "Roanoke, Virginia  24010"
!reference = Forms![foreclosure database screen]!filenum & "VA"

.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = "The Department of Veterans Affairs Regional Office"
!NoticeAdd = "Loan Guarantee Program"
!Name2 = "Attn: Loan Servicing and Claims (261)"
!NoticeAdd2 = "210 Franklin Road, SW"
!NoticeCITY = "Roanoke"
!NoticeSTATE = "VA"
!NoticeZIP = "24011"
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"

.Update
End With


End Function
Public Function ExportHUD2xml()
Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
If Forms![foreclosure database screen]!PropertyState = "MD" Then
!Name1 = "Home Source"
Else
!Name1 = "HMBI"
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
!Address1 = "8403 Colesville Rd."
Else
!Address1 = "1600 Wilson Blvd."
End If
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
!Address2 = ""
!citystatezip = "Silver Spring, MD  20910"
Else
!Address2 = "Suite 1250, Suite 600"
End If
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
!address3 = ""
Else
!address3 = ""
!citystatezip = "Arlington, VA  22209"
End If
!reference = Forms![foreclosure database screen]!filenum & "HUD2"

.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
If Forms![foreclosure database screen]!PropertyState = "MD" Then
!NoticeTo = "Home Source"
Else
!NoticeTo = "HMBI"
End If

If Forms![foreclosure database screen]![PropertyState] = "MD" Then
!NoticeAdd = "8403 Colesville Rd."
Else
!NoticeAdd = "1600 Wilson Blvd."
End If
If Forms![foreclosure database screen]![PropertyState] = "MD" Then
!NoticeAdd2 = ""
!NoticeCITY = "Silver Spring"
!NoticeSTATE = "MD"
!NoticeZIP = "20910"
Else
!NoticeAdd2 = "Suite 1250, Suite 600"
!NoticeCITY = "Arlington"
!NoticeSTATE = "VA"
!NoticeZIP = "22209"
End If
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"

.Update
End With


End Function
Public Sub WriteCompleteFile(dumpname As String, PDF_Count, XML_Count As Integer)
 
Dim fs As FileSystemObject, textfile As TextStream
 
Set fs = CreateObject("Scripting.FileSystemObject")
Set textfile = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & ".complete", True)
 
textfile.WriteLine ("PDF=" & PDF_Count)
textfile.WriteLine ("XML=" & XML_Count)
textfile.Close
 
End Sub


Public Function FileWALZexists()

Dim rs As RecordSet
Dim pathname As String
Dim WalzPDFName
Dim Vcnt As Integer
Dim A
Dim tempfields
Dim filewalzExists0, filewalzExists1, filewalzExists2, filewalzExists3, filewalzExists4, filewalzExists5

Dim vWalzPDF As String

vWalzPDF = ""

pathname = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\"

Set rs = CurrentDb.OpenRecordset("walzxml")

If Not rs.EOF Then

Do While Not rs.EOF
VWalzRI = rs!ri

tempfields = Split(rs!pdffile, ";")
Vcnt = UBound(tempfields)
A = Split(rs!pdffile, ";")

Do While Vcnt >= 0
If Vcnt = 4 Then
WalzPDFName = A(4)
Vcnt = Vcnt - 1
If FileOrDirExists(pathname & WalzPDFName) Then
filewalzExists4 = True
Else
filewalzExists4 = False
vWalzPDF = vWalzPDF + WalzPDFName & " has not been created for " & rs!ri
End If
Else
filewalzExists4 = True
End If

If Vcnt = 3 Then
WalzPDFName = A(3)
Vcnt = Vcnt - 1
If FileOrDirExists(pathname & WalzPDFName) Then
filewalzExists3 = True
Else
filewalzExists3 = False
vWalzPDF = vWalzPDF + WalzPDFName & " has not been created for " & rs!ri
End If
Else
filewalzExists3 = True
End If

If Vcnt = 2 Then
WalzPDFName = A(2)
Vcnt = Vcnt - 1
If FileOrDirExists(pathname & WalzPDFName) Then
filewalzExists2 = True
Else
filewalzExists2 = False
vWalzPDF = vWalzPDF + WalzPDFName & " has not been created for " & rs!ri
End If
Else
filewalzExists2 = True
End If

If Vcnt = 1 Then
WalzPDFName = A(1)
Vcnt = Vcnt - 1
If FileOrDirExists(pathname & WalzPDFName) Then
filewalzExists1 = True
Else
filewalzExists1 = False
vWalzPDF = vWalzPDF + WalzPDFName & " has not been created for " & rs!ri
End If
Else
filewalzExists1 = True
End If

If Vcnt = 0 Then
WalzPDFName = A(0)
Vcnt = Vcnt - 1
If FileOrDirExists(pathname & WalzPDFName) Then
filewalzExists0 = True
Else
filewalzExists0 = False
vWalzPDF = vWalzPDF + WalzPDFName & " has not been created for " & rs!ri
End If
Else
filewalzExists0 = True
End If

Loop

If filewalzExists0 = True And filewalzExists1 = True And filewalzExists2 = True And filewalzExists3 = True And filewalzExists4 = True Then
FileWALZexists = True
Else
FileWALZexists = False
'MsgBox (vWalzPDF)
End If

rs.MoveNext
Loop



End If

End Function

Public Function EmailCompleteIssue()

Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Dim emailsubject, emailbody As String
Dim rs As RecordSet

Set MyOutlook = New Outlook.Application
emailsubject = "WALZ PDF file not created for " & VWalzRI & " letter for BWW#: " & Forms![foreclosure database screen]!filenum
emailbody = "BWW#: " & Forms![foreclosure database screen]!filenum & vbCr & "User Creating Letters: " & username()
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.body = emailbody + SigEmail()
MyMail.To = "ccurley@bozmangroup.com; malston@bozmangroup.com"
MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing


End Function
Public Function CreateCompleteFile()

Call Wait(20, False)     ' wait 20 seconds

'Code for Delay and Walz PDF Count
If FileWALZexists = True Then
txtname = dumpname & ".complete"
MsgBox ("Letters sent to Walz")

sourcefile = DTLocation & "\CompleteWalz.txt"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.

Else
Call FileWALZexists
MsgBox ("Email will generate.  Letters NOT sent to Walz, retry")
Call EmailCompleteIssue
End If


'OLD CODE
'If VLtr Like "FDLM*" Or VLtr Like "FDLD*" Then
'Dim VDelayDte
'FDLDATE = Forms![foreclosure database screen]!ForeclosureSubForm.Form!pogoodthru
'VDelayDte = "D" & Format$(FDLDATE, "yyyymmdd")
'txtname = VDelayDte & "_" & Dumpname & ".complete"
'Else
'txtname = dumpname & ".complete"
'End If

'sourcefile = DTLocation & "\CompleteWalz.txt"
'Destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname

'If VLtr Like "NOS*" Then
'WriteCompleteFile Dumpname, vWalzPDF, 1
'Else
'FileCopy sourcefile, Destinationfile    ' Copy source to target.
'End If

End Function
Public Function ExportWalzLienholdersXML()
Dim strsql, strsqlClients As String
Dim rsLienHolders, rsclients As RecordSet
Dim VNo As Integer
VNo = 0

'strsql = "SELECT Creditors.* from Creditors WHERE (((Creditors.FileNum)= " & [Forms]![foreclosure database screen]![FIleNum] & "));"
'Set rslienholders = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

'
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)


If rsLienHolders.EOF Then

Else

rsLienHolders.MoveFirst
Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
While Not rsLienHolders.EOF

VNo = VNo + 1
If IsNull(rsLienHolders!Address) Then
MsgBox ("No Address for " & rsLienHolders!OrganizationName & ", letter will not dump")
Else
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
ElseIf VLtr Like "NO*" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf VLtr Like "AMCHOT" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address

If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"

.Update
End With
End If

With rsLienHolders
.Edit
!Walz_Uploaded_NOS = Date
.Update
End With


rsLienHolders.MoveNext

Wend

End If


rsLienHolders.Close
rs.Close


End Function
Public Function CreateWalzXMLBULK()

Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0


Set rs = CurrentDb.OpenRecordset("walzxml")
Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\BULK\" & dumpname & ".xml", True)
rs.MoveFirst

A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")

Do While Not rs.EOF

If Not IsNull(rs!NoticeTo) Then
'If InStr(rs!NoticeTo, "&") Then
'ToStringUpdate = Replace(rs!NoticeTo, "&", "&amp;")
'ToStringUpdate = Replace(rs!NoticeTo, "&", "&amp;")
'Else
tostringupdate = rs!NoticeTo
'End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
End If

If Not IsNull(rs!Name2) Then
'If InStr(rs!Name2, "&") Then
'name2stringupdate = Replace(rs!Name2, "&", "&amp;")
'Else
name2stringupdate = rs!Name2
'End If
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")
A.WriteLine ("<Inserts>")


Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")
vWalzPDF = UBound(tempPDF)


pdf_file = StrConv(C(0), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*_lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If

A.WriteLine ("</Insert>")


If UBound(tempPDF) >= 1 Then
pdf_file = StrConv(C(1), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 2 Then
pdf_file = StrConv(C(2), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 3 Then
pdf_file = StrConv(C(3), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 4 Then
pdf_file = StrConv(C(4), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 5 Then
pdf_file = StrConv(C(5), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) = 6 Then
pdf_file = StrConv(C(6), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
rs.MoveNext

Loop

A.WriteLine ("</WalzImportFile>")

End Function

Public Function CreateWalzXML()
Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0

If VLtr Like "FDL*" Or VLtr Like "NTQVa*" Then
Set rs = CurrentDb.OpenRecordset("WalzXMLQry", dbOpenSnapshot)
rs.MoveFirst
Else
Set rs = CurrentDb.OpenRecordset("WalzXML", dbOpenSnapshot)
End If


Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
'MsgBox (vWalzPDF)

'pdf Count
Dim tempPDFCnt As Variant
Dim cnt
tempPDFCnt = Split(rs!pdffile, ";")
cnt = Split(rs!pdffile, ";")

Dim VBd
VBd = UBound(tempPDFCnt)
'MsgBox (VBd)

If VBd = 0 Then
vWalzPDF = 1
Else
vWalzPDF = vWalzPDF + VBd + 1
End If

'MsgBox (vWalzPDF)


A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")
rs.MoveFirst

Do While Not rs.EOF

If Not IsNull(rs!NoticeTo) Then
If InStr(rs!NoticeTo, "&") Then
tostringupdate = Replace(rs!NoticeTo, "&", "&amp;")
ElseIf InStr(rs!NoticeTo, "'") Then
tostringupdate = Replace(rs!NoticeTo, "'", "'")
Else
tostringupdate = rs!NoticeTo
End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
Else
add2stringupdate = ""
End If

If Not IsNull(rs!Name2) Then
If InStr(rs!Name2, "&") Then
name2stringupdate = Replace(rs!Name2, "&", "&amp;")
Else
name2stringupdate = rs!Name2
End If
Else
name2stringupdate = ""
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
Else
citystringupdate = ""
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")

'Envelope for NOIFlat

If rs!ri = "NOIMDFlat" Then

Dim strsqlEnv As String
Dim rsEnv As RecordSet
Dim vClient
vClient = [Forms]![foreclosure database screen]![Client]

strsqlEnv = "SELECT Clients.OrganizationName, Clients.NOIMailing, Clients.NOIMailingAddress1, " _
& " Clients.NOIMailingAddress2, Clients.NOICity, Clients.NOIState, Clients.NOIZip " _
& " from Clients WHERE Clients.OrganizationName = " & """" & vClient & """" & ";"
Set rsEnv = CurrentDb.OpenRecordset(strsqlEnv, dbOpenDynaset, dbSeeChanges)

A.WriteLine ("<RetEnvName1>" & rsEnv!NOIMailing & "</RetEnvName1>")
A.WriteLine ("<RetEnvName2>" & "" & "</RetEnvName2>")
A.WriteLine ("<RetEnvAddress1>" & rsEnv!NOIMailingAddress1 & "</RetEnvAddress1>")
A.WriteLine ("<RetEnvAddress2>" & rsEnv!NOIMailingAddress2 & "</RetEnvAddress2>")
A.WriteLine ("<RetEnvCity>" & rsEnv!NOICity & "</RetEnvCity>")
A.WriteLine ("<RetEnvState>" & rsEnv!NOIState & "</RetEnvState>")
A.WriteLine ("<RetEnvZip>" & rsEnv!NOIZip & "</RetEnvZip>")
rsEnv.Close

End If

A.WriteLine ("<Inserts>")

Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")
'MsgBox ("BELOW: " & UBound(tempPDF))


pdf_file = StrConv(C(0), vbProperCase)

A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")

If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or _
pdf_file Like "*_occupantinformationfo*" Or _
pdf_file Like "*_fdlchamp*" Or _
pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or _
pdf_file Like "*_attachment*" Or _
pdf_file Like "*Notice to Quit Demand*" _
Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" _
Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*_lostnote*" Or pdf_file Like "*_chase*" _
Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If
Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_fdlchamp*" _
Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" _
Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" _
Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" _
Or pdf_file Like "*Notice to Quit Demand*" Or _
pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")


Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If

A.WriteLine ("</Insert>")


If UBound(tempPDF) >= 1 Then
pdf_file = StrConv(C(1), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")


End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")


Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")


End If


A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 2 Then
pdf_file = StrConv(C(2), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")


End If

If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 3 Then
pdf_file = StrConv(C(3), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 4 Then
pdf_file = StrConv(C(4), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 5 Then
pdf_file = StrConv(C(5), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) = 6 Then
pdf_file = StrConv(C(6), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_fdlchamp*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
rs.MoveNext

Loop
rs.Close
Set rs = Nothing

A.WriteLine ("</WalzImportFile>")

End Function


Public Function CreateWalzXMLFDL()

Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0


Set rs = CurrentDb.OpenRecordset("walzxml")
rs.MoveFirst

Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
'MsgBox (vWalzPDF)

'pdf Count
Dim tempPDFCnt As Variant
Dim cnt
tempPDFCnt = Split(rs!pdffile, ";")
cnt = Split(rs!pdffile, ";")

Dim VBd
VBd = UBound(tempPDFCnt)
'MsgBox (VBd)

If VBd = 0 Then
vWalzPDF = 1
Else
vWalzPDF = vWalzPDF + VBd + 1
End If

'MsgBox (vWalzPDF)


A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")
rs.MoveFirst

Do While Not rs.EOF

If Not IsNull(rs!NoticeTo) Then
If InStr(rs!NoticeTo, "&") Then
tostringupdate = Replace(rs!NoticeTo, "&", "&amp;")
Else
tostringupdate = rs!NoticeTo
End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
Else
add2stringupdate = ""
End If

If Not IsNull(rs!Name2) Then
If InStr(rs!Name2, "&") Then
name2stringupdate = Replace(rs!Name2, "&", "&amp;")
Else
name2stringupdate = rs!Name2
End If
Else
name2stringupdate = ""
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
Else
citystringupdate = ""
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")

'Envelope for NOIFlat

If rs!ri = "NOIMDFlat" Then

Dim strsqlEnv As String
Dim rsEnv As RecordSet
Dim vClient
vClient = [Forms]![foreclosure database screen]![Client]

strsqlEnv = "SELECT Clients.OrganizationName, Clients.NOIMailing, Clients.NOIMailingAddress1, " _
& " Clients.NOIMailingAddress2, Clients.NOICity, Clients.NOIState, Clients.NOIZip " _
& " from Clients WHERE Clients.OrganizationName = " & """" & vClient & """" & ";"
Set rsEnv = CurrentDb.OpenRecordset(strsqlEnv, dbOpenDynaset, dbSeeChanges)

A.WriteLine ("<RetEnvName1>" & rsEnv!NOIMailing & "</RetEnvName1>")
A.WriteLine ("<RetEnvName2>" & "" & "</RetEnvName2>")
A.WriteLine ("<RetEnvAddress1>" & rsEnv!NOIMailingAddress1 & "</RetEnvAddress1>")
A.WriteLine ("<RetEnvAddress2>" & rsEnv!NOIMailingAddress2 & "</RetEnvAddress2>")
A.WriteLine ("<RetEnvCity>" & rsEnv!NOICity & "</RetEnvCity>")
A.WriteLine ("<RetEnvState>" & rsEnv!NOIState & "</RetEnvState>")
A.WriteLine ("<RetEnvZip>" & rsEnv!NOIZip & "</RetEnvZip>")
rsEnv.Close

End If

A.WriteLine ("<Inserts>")

Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")
'MsgBox ("BELOW: " & UBound(tempPDF))


pdf_file = StrConv(C(0), vbProperCase)

A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*_lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If
Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")


Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If

A.WriteLine ("</Insert>")


If UBound(tempPDF) >= 1 Then
pdf_file = StrConv(C(1), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")


End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")


Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")


End If


A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 2 Then
pdf_file = StrConv(C(2), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")


ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")


End If

If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 3 Then
pdf_file = StrConv(C(3), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 4 Then
pdf_file = StrConv(C(4), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 5 Then
pdf_file = StrConv(C(5), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) = 6 Then
pdf_file = StrConv(C(6), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*Champi*" Or pdf_file Like "*_evictionscral*" Or pdf_file Like "*_occupantinformationfo*" Or pdf_file Like "*_ad*" Or pdf_file Like "*OrdRat*" Or pdf_file Like "*SPVR*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Or pdf_file Like "*Notice to Quit Demand*" Or pdf_file Like "*Notice to Quit-occupantwalz-ten*" Or pdf_file Like "*ntqvaattach*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Or pdf_file Like "*_chase*" Or pdf_file Like "*_fdlattach*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
rs.MoveNext

Loop
rs.Close
Set rs = Nothing

A.WriteLine ("</WalzImportFile>")

End Function
Public Function CreateWalzXMLLIEN()

Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0

strsql = "select * from walzxml order by noticeto"

Set rs = CurrentDb.OpenRecordset(strsql)
Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
rs.MoveFirst

A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")

Do While Not rs.EOF
name2stringupdate = ""
tostringupdate = ""
add1stringupdate = ""
add2stringupdate = ""
citystringupdate = ""

If Not IsNull(rs!NoticeTo) Then
If InStr(rs!NoticeTo, "&") Then
tostringupdate = Replace(rs!NoticeTo, "&", "&amp;")
Else
tostringupdate = rs!NoticeTo
End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
End If

If Not IsNull(rs!Name2) Then
If InStr(rs!Name2, "&") Then
name2stringupdate = Replace(rs!Name2, "&", "&amp;")
Else
name2stringupdate = rs!Name2
End If
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")
A.WriteLine ("<Inserts>")


Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")

vWalzPDF = UBound(tempPDF)

pdf_file = StrConv(C(0), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*_lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If

A.WriteLine ("</Insert>")


If UBound(tempPDF) >= 1 Then
pdf_file = StrConv(C(1), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 2 Then
pdf_file = StrConv(C(2), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 3 Then
pdf_file = StrConv(C(3), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 4 Then
pdf_file = StrConv(C(4), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 5 Then
pdf_file = StrConv(C(5), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) = 6 Then
pdf_file = StrConv(C(6), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
rs.MoveNext

Loop
rs.Close
Set rs = Nothing

A.WriteLine ("</WalzImportFile>")

End Function
Public Function CreateXMLTown()

Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim strsql As String

Dim rsWalz As RecordSet
Dim vlna
vlna = 1
VCntStart = 0

strsql = "select * from walzxml order by noticeto"

Set rs = CurrentDb.OpenRecordset(strsql)
Set fs = CreateObject("Scripting.FileSystemObject")

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\WALZ\ToWalz\" & dumpname & ".xml", True)
rs.MoveFirst

A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")

Do While Not rs.EOF

If Not IsNull(rs!NoticeTo) Then
If InStr(rs!NoticeTo, "&") Then
tostringupdate = Replace(rs!NoticeTo, "&", "&amp;")
Else
tostringupdate = rs!NoticeTo
End If
End If

If Not IsNull(rs!NoticeAdd) Then
If InStr(rs!NoticeAdd, "&") Then
add1stringupdate = Replace(rs!NoticeAdd, "&", "&amp;")
Else
add1stringupdate = rs!NoticeAdd
End If
End If

If Not IsNull(rs!NoticeAdd2) Then
If InStr(rs!NoticeAdd2, "&") Then
add2stringupdate = Replace(rs!NoticeAdd2, "&", "&amp;")
Else
add2stringupdate = rs!NoticeAdd2
End If
End If

If Not IsNull(rs!Name2) Then
If InStr(rs!Name2, "&") Then
name2stringupdate = Replace(rs!Name2, "&", "&amp;")
Else
name2stringupdate = rs!Name2
End If
End If

If Not IsNull(rs!NoticeCITY) Then
If InStr(rs!NoticeCITY, "&") Then
citystringupdate = Replace(rs!NoticeCITY, "&", "&amp;")
Else
citystringupdate = rs!NoticeCITY
End If
End If

VCntStart = VCntStart + 1
VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & rs!ri & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & rs!ri & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & tostringupdate & "</Name1>")
A.WriteLine ("<Name2>" & name2stringupdate & "</Name2>")
A.WriteLine ("<Address1>" & add1stringupdate & "</Address1>")
A.WriteLine ("<Address2>" & add2stringupdate & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")
A.WriteLine ("<Inserts>")


Dim tempPDF As Variant
Dim C
tempPDF = Split(rs!pdffile, ";")
C = Split(rs!pdffile, ";")

vWalzPDF = UBound(tempPDF)

pdf_file = StrConv(C(0), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*_lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If

A.WriteLine ("</Insert>")


If UBound(tempPDF) >= 1 Then
pdf_file = StrConv(C(1), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then


If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 2 Then
pdf_file = StrConv(C(2), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If

If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")

ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 3 Then
pdf_file = StrConv(C(3), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 4 Then
pdf_file = StrConv(C(4), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) >= 5 Then
pdf_file = StrConv(C(5), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")

ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

If UBound(tempPDF) = 6 Then
pdf_file = StrConv(C(6), vbProperCase)
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & pdf_file & "</Name>")
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<StartPage>" & 1 & "</StartPage>")
ElseIf pdf_file Like "*lostnote*" Then

If rs!StartPage = 1 Then
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
Else
vlna = vlna + 1
A.WriteLine ("<StartPage>" & vlna & "</StartPage>")
End If

Else
A.WriteLine ("<StartPage>" & rs!StartPage & "</StartPage>")
End If
If pdf_file Like "*_ad*" Or pdf_file Like "*DOA*" Or pdf_file Like "*_attachment*" Then
A.WriteLine ("<PageCount>" & -1 & "</PageCount>")
ElseIf pdf_file Like "*lostnote*" Then
A.WriteLine ("<PageCount>" & 1 & "</PageCount>")
Else
A.WriteLine ("<PageCount>" & rs!PageCount & "</PageCount>")
End If
A.WriteLine ("</Insert>")
End If

A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")
rs.MoveNext

Loop

A.WriteLine ("</WalzImportFile>")

End Function

Public Function exportXMLBorrowers()

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VCntStart = 1
Dim VcountLtr As Integer
VcountLtr = 0

Dim rsnotice As RecordSet

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With


If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then


'And (Forms![foreclosure database screen]!DNS1 = -1 Or Forms![foreclosure database screen]!DNS1 = 1)
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

'Mailing---------------------------

If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) _
Or Forms![foreclosure database screen]!LastNameDebtor2 <> "") Then
VIDNo = GetAutoNumber("nextwalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With


If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then

'And (Forms![foreclosure database screen]!DNS2 = -1 Or Forms![foreclosure database screen]!DNS2 = 1
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If
End If

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
'And (Forms![foreclosure database screen]!DNS3 = -1 Or Forms![foreclosure database screen]!DNS3 = 1)

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If
End If

If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then

'And (Forms![foreclosure database screen]!DNS4 = -1 Or Forms![foreclosure database screen]!DNS4 = 1)
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update

End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If
End If


'===============

If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then

'And (Forms![foreclosure database screen]!dns5 = -1 Or Forms![foreclosure database screen]!dns5 = 1)
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update

End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If
End If


If VLtr Like "NOSV*" Or VLtr = "NOSDC" Or VLtr = "NOSMD" Or VLtr = "NTQMd" Then
'Occupant Letter-----------------------
With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = "All Occupants"
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "Occupant"
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If
'===============
rsnotice.Close
Call NOIOwners

End Function


Public Function exportXMLNotices()

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

VCntStart = 0

Dim VcountLtr As Integer
VcountLtr = 0

Dim rsnotice As RecordSet
GblFilenum = Forms![foreclosure database screen]![filenum]
Dim strsql As String
strsql = "select * from Walzxml order by startpage Asc"

Set rsnotice = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

rsnotice.MoveFirst
Do While Not rsnotice.EOF

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.Edit
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr = "ACLVA" Then
!StartPage = VCntStart + 1
!PageCount = 3
ElseIf VLtr = "HUD" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart + 1
!PageCount = 2
ElseIf (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart + 1
!PageCount = 1
End If
VCntStart = VCntStart + 1
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsnotice!NoticeTo
!Name2 = ""
!Address1 = rsnotice!NoticeAdd
!Address2 = rsnotice!NoticeAdd2
!address3 = ""
!citystatezip = rsnotice!NoticeCITY & ", " & rsnotice!NoticeSTATE & "  " & rsnotice!NoticeZIP
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With

rsnotice.MoveNext
Loop

rsnotice.Close


End Function
Private Sub NOIOwners()

Dim rsnotice As RecordSet
Dim rsWalz As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)


If Forms![foreclosure database screen]!lastnameo1 <> "" Then

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo


If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner1()
!Name2 = ""

If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & "  " & Forms![foreclosure database screen]![propzip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With


If MailSDat = "Owner1" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner1()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If Forms![foreclosure database screen]![Mailing Address] <> "" And _
MailA = "All Owners" Or MailA = "Owner1" Or MailA = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner1()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If Forms![foreclosure database screen]![Mailing AddressB] <> "" And _
MailB = "All Owners" Or MailB = "Owner1" Or MailB = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies owner1 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner1()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If
End If

'===============
If Forms![foreclosure database screen]!lastnameo2 <> "" Then

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner2()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & "  " & Forms![foreclosure database screen]![propzip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With


If MailSDat = "Owner2" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner2()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If Forms![foreclosure database screen]![Mailing Address] <> "" And _
MailA = "All Owners" Or MailA = "Owner2" Or MailA = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner2()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If Forms![foreclosure database screen]![Mailing AddressB] <> "" And _
MailB = "All Owners" Or MailB = "Owner2" Or MailB = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies owner1 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner2()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

End If

If Forms![foreclosure database screen]!lastnameo3 <> "" Then

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner3()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]![PropertyState] & "  " & Forms![foreclosure database screen]![propzip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With


If MailSDat = "Owner3" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner3()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If Forms![foreclosure database screen]![Mailing Address] <> "" And _
MailA = "All Owners" Or MailA = "Owner3" Or MailA = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner3()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If


If Forms![foreclosure database screen]![Mailing AddressB] <> "" And _
MailB = "All Owners" Or MailB = "Owner3" Or MailB = "all" Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (VLtr = "NOIMDFlat" Or VLtr = "P1PKG" Or VLtr = "NTQMd") Then
!StartPage = 1
!PageCount = "-1"
ElseIf VLtr Like "FDL*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 3
VCntStart = VCntStart + 3
!PageCount = 3
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies owner1 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = owner3()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

End If
End Sub
Public Function NOIComm()

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Dim rsnotice As RecordSet
GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = "Commissioner of Financial Regulation"
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = "Foreclosure Unit"
!NoticeAdd2 = "500 N. Calvert St., 4th Floor"
!NoticeCITY = "Baltimore"
!NoticeSTATE = "MD"
!NoticeZIP = "21202"
!ri = "NOIComm"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "Commissioner of Financial Regulation"
!Name2 = ""
!Address1 = "Foreclosure Unit"
!Address2 = "500 N. Calvert St., 4th Floor"
!citystatezip = "Baltimore, MD 21202"
!PostageFees = 0
!reference = Forms![foreclosure database screen]!filenum & VLtr
.Update
End With

End Function
Public Function ExportXMLWalz()
Dim rsnotice As RecordSet
Dim rsWalz As RecordSet
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With




If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If


'HERE
If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) And _
(IsNull(Forms![foreclosure database screen]![MailA_To]) Or Forms![foreclosure database screen]![MailA_To] = "Grantor2" Or Forms![foreclosure database screen]![MailA_To] = "All Grantors" Or Forms![foreclosure database screen]![MailA_To] = "Grantors/Owners") Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If
End If

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"

.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If
End If

If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If
End If



If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If
End If
rsnotice.Close
End Function
Public Function ExportPart1XML()

VLtr = "P1PKG"
Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim rsWalz As RecordSet

strsqlw = "select * from walzinfo where filenum = " & Forms![foreclosure database screen]!filenum & " and RI = " & """" & "P1PKG" & """" & ";"
Set rsWalz = CurrentDb.OpenRecordset(strsqlw)

If Not rsWalz.EOF Then
Dim VPswd
VPswd = InputBox("There has already been a Part 1 Package Sent Via Walz Input Password to resend.")
If VPswd <> "OK" Then
MsgBox ("Not Sending Package")
Exit Function
End If
End If

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

VCntStart = 0

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

'Call ExportXMLWalz

Call exportXMLBorrowers
Call ROwnersLienholders

Set rs = CurrentDb.OpenRecordset("walzxml")

Set fs = CreateObject("Scripting.FileSystemObject")


Dim txtname As String

txtname = dumpname

sourcefile = BrowseFLDR()
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname & ".PDF"
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPkg = txtname & ".PDF"

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & ".xml", True)
rs.MoveFirst

A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")

Do While Not rs.EOF
VCntStart = VCntStart + 1
'VIDNo = GetAutoNumber("NextWalz")
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & "P1PKG" & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & "PKG" & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & rs!NoticeTo & "</Name1>")
A.WriteLine ("<Address1>" & rs!NoticeAdd & "</Address1>")
A.WriteLine ("<Address2>" & rs!NoticeAdd2 & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")
A.WriteLine ("<Inserts>")
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & VPkg & "</Name>")
A.WriteLine ("<StartPage>" & "1" & "</StartPage>")
A.WriteLine ("<PageCount>" & "-1" & "</PageCount>")
A.WriteLine ("</Insert>")
A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")


'With rswalz
'.AddNew
'!PostageFees = 0
'!ServiceFees = 9.06
'!postagefeesreg = 0
'!ID_No = VIDNo
'!WalzDateUploaded = Date
'!ri = "P1PKG"
'!FIleNum = Forms![foreclosure database screen]!FIleNum
'!Name1 = rs!NoticeTo
'!Name2 = ""
'!address1 = rs!NoticeAdd
'!Address2 = rs!NoticeAdd2
'!Address3 = ""
'!citystatezip = rs!noticecity & ", " & rs!noticestate & "  " & rs!noticezip
'!reference = Forms![foreclosure database screen]!FIleNum & "P1PKG"
'.Update
'End With

rs.MoveNext
Loop

A.WriteLine ("</WalzImportFile>")


Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & ".complete", True)

'TxtName = Dumpname & ".complete"
'sourcefile = pathuser() & "\exportWalz.txt"
'destinationfile = DTLocation & "\WALZ\ToWalz\" & TxtName
'FileCopy sourcefile, destinationfile    ' Copy source to target.


MsgBox ("Part One Package Sent to Walz")
End Function
Public Function ExportEvicXML()

VLtr = "P1PKG"
Dim rs As RecordSet
Dim VPkg As String

Dim strsqlw As String, VD As String
Dim rsWalz As RecordSet

strsqlw = "select * from walzinfo where filenum = " & Forms![foreclosure database screen]!filenum & " and RI = " & """" & "P1PKG" & """" & ";"
Set rsWalz = CurrentDb.OpenRecordset(strsqlw)

If Not rsWalz.EOF Then
Dim VPswd
VPswd = InputBox("There has already been a Eviction or Part 1 Package Sent Via Walz Input Password to resend.")
If VPswd <> "OK" Then
MsgBox ("Not Sending Package")
Exit Function
End If
End If

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

VCntStart = 0

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

Call ExportXMLOccupants

Set rs = CurrentDb.OpenRecordset("walzxml")

Set fs = CreateObject("Scripting.FileSystemObject")


Dim txtname As String

txtname = dumpname

sourcefile = BrowseFLDREvic()
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname & ".PDF"
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPkg = txtname & ".PDF"

Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & ".xml", True)
rs.MoveFirst

A.WriteLine ("<?xml version=" & """" & "1.0" & """" & " encoding=" & """" & "UTF-8" & """" & " standalone=" & """" & "no" & """" & "?>")
A.WriteLine ("<WalzImportFile>")

Do While Not rs.EOF
VCntStart = VCntStart + 1
A.WriteLine ("<WalzDataRecord>")
A.WriteLine ("<RecordType>" & "P1PKG" & "</RecordType>")
A.WriteLine ("<Reference>" & rs!filenum & "</Reference>")
A.WriteLine ("<FileNum>" & rs!reference & "</FileNum>")
A.WriteLine ("<IDCode>" & "PKGE" & VCntStart & "</IDCode>")
A.WriteLine ("<Name1>" & rs!NoticeTo & "</Name1>")
A.WriteLine ("<Address1>" & rs!NoticeAdd & "</Address1>")
A.WriteLine ("<Address2>" & rs!NoticeAdd2 & "</Address2>")
A.WriteLine ("<City>" & rs!NoticeCITY & "</City>")
A.WriteLine ("<State>" & rs!NoticeSTATE & "</State>")
A.WriteLine ("<Zip>" & rs!NoticeZIP & "</Zip>")
A.WriteLine ("<Inserts>")
A.WriteLine ("<Insert>")
A.WriteLine ("<Name>" & VPkg & "</Name>")
A.WriteLine ("<StartPage>" & "1" & "</StartPage>")
A.WriteLine ("<PageCount>" & "-1" & "</PageCount>")
A.WriteLine ("</Insert>")
A.WriteLine ("</Inserts>")
A.WriteLine ("</WalzDataRecord>")

rs.MoveNext
Loop

A.WriteLine ("</WalzImportFile>")


Set A = fs.CreateTextFile("\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & ".complete", True)

MsgBox ("Eviction Package Sent to Walz")
End Function


Public Function LNLPDF()

Call ExportLNLLetters

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

'Virginia Lost Note Letter------------------------------

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
VConvRpt = "LostNoteVAWalz"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"
End If

'Dump Borrowers---------------------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call exportXMLBorrowersFDL


Call CreateWalzXML
Call CreateCompleteFile
End Function

Public Function FDLIndPDF()
VLtrID = ContactID

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "FDLVA"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "FDLDC"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "FDLMD"
End If

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If


'Dump to Imaged Docs
Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)



'Fairdebt Letter---------------------------------
VConvRpt = "indcredfdl"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"


If Vyes3 = vbYes Then
CopyDocToBGWWDocs VConvRpt, "FairDebLtr", "_FDL.PDF"
End If


Dim txtname As String


'PRSL Letter for all other client....


If Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "JPM*" Or _
Forms![foreclosure database screen]!Client Like "Suntrust Bank*" Or _
((Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC") And _
[Forms]![foreclosure database screen]![Client] Like "Specializ*") Then
VConvRpt = "AttachmentPRSL"
Call ConvertPDF
VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
If Vyes3 = vbYes Then
CopyDocToBGWWDocs VConvRpt, "FairDebLtr", "_PRSL.PDF"
End If
End If


'Dump Borrowers---------------------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

strsql = "SELECT Creditors.* from Creditors WHERE contactid = " & ContactID & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then

MsgBox ("Incorrect ID#")

Else

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


With rsLienHolders
.Edit
!Walz_Ref = VIDNo
!noticesent = Date

.Update
End With



'End Dump Borrower

Call CreateWalzXML
Call CreateCompleteFile


End If





'Lienholder Letters------------------


End Function

Public Function PRSLIndPDF()
VLtrID = ContactID

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

DoCmd.OpenQuery ("WalzAppendXMLTableBULK1N1")

'Dump to Imaged Docs
Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)



'Fairdebt Letter---------------------------------
VConvRpt = "indcredprsl"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"


If Vyes3 = vbYes Then
CopyDocToBGWWDocs VConvRpt, "PSRL", "_PRSLLtr.PDF"
End If

'Dump Borrowers---------------------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

strsql = "SELECT Creditors.* from Creditors WHERE contactid = " & ContactID & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then

MsgBox ("Incorrect ID#")

Else

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = "BULK1N1"
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


With rsLienHolders
.Edit
!Walz_Ref = VIDNo
!noticesent = Date

.Update
End With

End If


'End Dump Borrower



Call CreateWalzXML
Call CreateCompleteFile






End Function
Public Function HudOccQueue()
'HUD Occupancy Letter Queue Screen-----------------------------------------
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = Format(Forms![HOC Queue]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![HOC Queue]!Client <> "Financial Freedom Acquisition, LLC" Or _
(Forms![HOC Queue]!Client <> "OneWest Bank, FSB" And _
(Forms![HOC Queue]!FF = -1 Or Forms![HOC Queue]!FF = 1)) Then

VConvRpt = "Fairdebt-HUD-Queue"
Call ImageHud
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vHUD1
VLtr = "HUD"
Call ExportHUDOccQueue

Call CreateWalzXML
Call CreateCompleteFile

End If

End Function

Public Function HudOcc()
'HUD Occupancy Letter-----------------------------------------

If Forms![foreclosure database screen]!TypeOfLoan = "FHA/REV" Then

Else
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")


If (Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1) And _
Forms![foreclosure database screen]!Client <> "Financial Freedom Acquisition, LLC" Or _
(Forms![foreclosure database screen]!Client <> "OneWest Bank, FSB" And _
(Forms![foreclosure database screen]!FF = -1 Or Forms![foreclosure database screen]!FF = 1)) Then

If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
VConvRpt = "Fairdebt-HUD-VA"
Else
VConvRpt = "Fairdebt-HUD"
End If

Call ImageHud
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vHUD1
VLtr = "HUD"
Call ExportHUDOcc


Call CreateWalzXML
Call CreateCompleteFile

End If
End If

End Function
Public Function ImageAttachments()

Dim VFileTimeDownload, vfiletime As Date
Dim vtime As String

Dim txtname As String

txtname = dumpname & "_Attachment.pdf"

If Forms![foreclosure database screen]!Client Like "JP*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\ChaseLossMit.pdf"
ElseIf Forms![foreclosure database screen]!Client Like "EMC*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\EMCLossMitt.pdf"
End If

destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.

VAttach = txtname

End Function

Public Function FDLCheck()

Dim strsqlCty
Dim rsCty As RecordSet

strsqlCty = "SELECT Jurisdiction.County, Cases.FileNum FROM Cases INNER JOIN Jurisdiction ON (Cases.PropertyState = Jurisdiction.State) AND (Cases.PropertyCounty = Jurisdiction.County) " _
& " WHERE Cases.FileNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsCty = CurrentDb.OpenRecordset(strsqlCty, dbOpenSnapshot)

If rsCty.EOF Then
VMsg = "The County in the Drop Down Box is incorrect, please fix, no letter will print"
rsCty.Close

MsgBox (VMsg)
VCancelDump = 1
Exit Function

End If

Dim VNoDNS
Dim checkDebtorsDNS

VNoDNS = 1
If Forms![foreclosure database screen]!LastNameDebtor2 <> "" And Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Then
VNoDNS = 2
End If
If Forms![foreclosure database screen]!LastNameDebtor3 <> "" And Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Then
VNoDNS = 3
End If
If Forms![foreclosure database screen]!lastnamedebtor4 <> "" And Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Then
VNoDNS = 4
End If

If VNoDNS = 1 And (Forms![foreclosure database screen]!DNS1 = -1 Or Forms![foreclosure database screen]!DNS1 = 1) Then
VMsg = ("Debtors has the do not sign buttons checked, LETTERS WILL NOT PRINT")
checkDebtorsDNS = "YES"
End If
If VNoDNS = 2 And (Forms![foreclosure database screen]!DNS1 = -1 Or Forms![foreclosure database screen]!DNS1 = 1) And _
(Forms![foreclosure database screen]!DNS2 = -1 Or (Forms![foreclosure database screen]!DNS2 = 1)) Then
VMsg = ("Both Debtors have the do not sign buttons checked, LETTERS WILL NOT PRINT")
checkDebtorsDNS = "YES"
End If
If VNoDNS = 3 And (Forms![foreclosure database screen]!DNS1 = -1 Or Forms![foreclosure database screen]!DNS1 = 1) And _
(Forms![foreclosure database screen]!DNS2 = -1 Or Forms![foreclosure database screen]!DNS2 = 1) And _
(Forms![foreclosure database screen]!DNS3 = -1 Or Forms![foreclosure database screen]!DNS3 = 1) Then
VMsg = ("All 3 Debtors have the do not sign buttons checked, LETTERS WILL NOT PRINT")
checkDebtorsDNS = "YES"
End If
If VNoDNS = 4 And (Forms![foreclosure database screen]!DNS1 = -1 Or Forms![foreclosure database screen]!DNS1 = 1) And _
(Forms![foreclosure database screen]!DNS2 = -1 Or Forms![foreclosure database screen]!DNS2 = 1) And _
(Forms![foreclosure database screen]!DNS4 = -1 Or Forms![foreclosure database screen]!DNS4 = 1) And _
(Forms![foreclosure database screen]!DNS3 = -1 Or Forms![foreclosure database screen]!DNS3 = 1) Then
VMsg = ("All 4 Debtors have the do not sign buttons checked, LETTERS WILL NOT PRINT")
checkDebtorsDNS = "YES"
End If

If checkDebtorsDNS = "YES" Then
MsgBox (VMsg)
VCancelDump = 1
Exit Function

End If


If Forms![foreclosure database screen]![Mailing Address] = "" Then
Forms![foreclosure database screen]![Mailing Address] = Null
End If

If Not IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] <> "" Then
If (IsNull(Forms![foreclosure database screen]![Mailing City]) Or _
Forms![foreclosure database screen]![Mailing City] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing State]) Or _
Forms![foreclosure database screen]![Mailing State] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing Zip]) Or _
Forms![foreclosure database screen]![Mailing Zip] = "") Then
VMsg = "There is missing Mailing Address information ,City State or Zip, input in the Screen, no letter will print"

MsgBox (VMsg)
VCancelDump = 1
Exit Function

End If
End If

If IsNull(Forms![foreclosure database screen]!PropAddress) Or _
IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!propzip) Then

If IsNull(Forms![foreclosure database screen]!PropAddress) Then
VMsg = "There is no Property Address input in the Screen, no letter will dump"
End If


If IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!PropertyState) Or _
IsNull(Forms![foreclosure database screen]!propzip) Then
VMsg = "There is missing property information ,City State or Zip, input in the Screen, no letter will print"
End If


MsgBox (VMsg)
VCancelDump = 1

Exit Function

Else

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

'-The Beginning of the Dump
'Check Data and create VLtr for FDL------------------

'Create Name of all Files to Dump--------------------
'Dim VFDLDate
'FDLDate = forms![foreclosure database screen]!POGoodThru

'Dumpname = "D" & format$(FDLDATE,"yyyymmdd") & "_" & Format(Forms![foreclosure database screen]!FileNum, "000000") & Format$(Now(), "yyyymmddhhnnss")

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "FDLVA"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "FDLDC"
Else
VLtr = "FDLMD"
End If


Call FDLPDF

End If

End Function


Public Function FDLPDF()
Dim RFD


If Forms![foreclosure database screen]!Client Like "Champion*" And _
Forms![foreclosure database screen]![ForeclosureSubFormVA].Form![VASubAss].Form!reason_default Like "Move Ou*" Then
RFD = 1
End If

Call ExportFDLLetters

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

'Dump to Imaged Docs
Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)

'Fairdebt Letter---------------------------------
VConvRpt = "Fairdebt Letter"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"


If Vyes3 = vbYes Then
CopyDocToBGWWDocs VConvRpt, "FairDebLtr", "_FDL.PDF"
End If

Dim txtname As String

'PRSL Letter for all other client....


If Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "JPM*" Or _
Forms![foreclosure database screen]!Client Like "Suntrust Bank*" Or _
((Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC") And _
[Forms]![foreclosure database screen]![Client] Like "Specializ*") Then
CopyDocToBGWWDocs "AttachmentPRSL", "FairDebLtr", "_FDLPRSL.PDF"
VConvRpt = "AttachmentPRSL"
Call ConvertPDF
VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
If Vyes3 = vbYes Then
CopyDocToBGWWDocs VConvRpt, "FairDebLtr", "_PRSL.PDF"
End If
End If


If RFD = 1 Then

VTypeMerge = "ChampionFDL"
Call LtrMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCReverseNon-occ.doc", , , True)

destinationfile = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & "_FDLChampion"
destinationfileview = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & "_FDLChampion.pdf"

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With

Call WordMerge3PDF(oapp, destinationfile)
VPDF = VPDF & ";" & dumpname & "_FDLChampion.PDF"
Application.FollowHyperlink (destinationfileview)

If Vyes3 = vbYes Then
CreateFldrType (VarSubFldr)
docsfldr = AutoIndexPathUser & username() & "\FairDebLtr\"
sourcefile = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & "_FDLChampion.PDF"
destinationfile = docsfldr & GblFilenum & "_FDL.pdf"
FileCopy sourcefile, destinationfile    ' Copy source to target.
End If

'FollowHyperlink (destinationfile)

End If


'Dump Borrowers---------------------------------------

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
If VFdlLnl = 0 Or VFdlLnl = 1 Then
Call exportXMLBorrowersFDL
Else
Call ExportWalzXML
End If

If VFdlLnl = 1 Or VFdlLnl = 0 Then
'Other FDL Letters--------------------------------------

Call CreateWalzXML
Call CreateCompleteFile

''HUD Occupancy Letter-----------------------------------------
If Forms![foreclosure database screen]!PropertyState <> "MD" And Forms![foreclosure database screen]!Client <> "Champion Mortgage Company" And _
(Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or (Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1)) Then

If (Forms![foreclosure database screen]!Client = "Financial Freedom Acquisition, LLC" Or _
(Forms![foreclosure database screen]!Client = "OneWest Bank, FSB" And _
(Forms![foreclosure database screen]!FF = -1 Or Forms![foreclosure database screen]!FF = 1))) Then
Else
Call hudoccltrs
End If
End If

End If



'Lienholder Letters------------------


End Function

Public Function HOAWalz()

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = Format(Forms![pud queue]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "CountyExective-VA-Queue"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenQuery ("WalzAppendXMLTableBULK1N1")

GblFilenum = Forms![pud queue]![filenum]
VCntStart = 0

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Do While Not rsnotice.EOF
With rsnotice
.Edit
VIDNo = GetAutoNumber("NextWalz")
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
.Update
End With
rsnotice.MoveNext
Loop

DoCmd.OpenQuery ("WalzupdatemoniesHOA")

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letters Sent to Walz")


End Function


Public Function PRSLWalz()

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError


dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "PRSL Letter"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenQuery ("WalzAppendXMLTableBULK1N1")

GblFilenum = Forms![foreclosure database screen]![filenum]
VCntStart = 0

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Do While Not rsnotice.EOF
With rsnotice
.Edit
VIDNo = GetAutoNumber("NextWalz")
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
.Update
End With
rsnotice.MoveNext
Loop

DoCmd.OpenQuery ("WalzupdatemoniesPRSL")

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letters Sent to Walz")
DoCmd.OpenReport ("PRSL Letter"), acViewPreview

'Call PRSLDocs








End Function


Public Function SCRAEvicWalz()

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
Call OccupantAllFields

VLtr = "SCRA"

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")


If Client() Like "Bank of A*" Then
VConvRpt = "EvictionSCRALetter-BOA"
Else
VConvRpt = "EvictionSCRALetter"
End If

Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenQuery ("WalzAppendXMLTableBULK1N1")

GblFilenum = Forms![foreclosure database screen]![filenum]
VCntStart = 0

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Do While Not rsnotice.EOF
With rsnotice
.Edit
VIDNo = GetAutoNumber("NextWalz")
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
.Update
End With
rsnotice.MoveNext
Loop

DoCmd.OpenQuery ("WalzupdatemoniesSCRA")

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letters Sent to Walz")


End Function
Public Function FNMAFHLMCWalz()


CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "FDLAttachmentFNMAFHLMC"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenQuery ("WalzAppendXMLTableBULK1N1")

GblFilenum = Forms![foreclosure database screen]![filenum]
VCntStart = 0

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Do While Not rsnotice.EOF
With rsnotice
.Edit
VIDNo = GetAutoNumber("NextWalz")
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
.Update
End With
rsnotice.MoveNext
Loop

DoCmd.OpenQuery ("WalzupdatemoniesFNMAFHLMC")

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letters Sent to Walz")



End Function
Public Function lnl()


strsql = "Select * from litigation where subfilenum = " & GblFilenum

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenDynaset, dbSeeChanges)

If Not IsNull(rs!fdcpa_recd) And (IsNull(rs!fdcpa_sent) And IsNull(rs!NoDebtReq)) Then
MsgBox ("This task cannot be completed at this time because there is an outstanding FDCPA dispute of the debt. Please contact the assigned attorney on the litigation screen?s QWR/FDCPA tab to check the status of the response.")
rs.Close
Set rs = Nothing
Exit Function


Else
rs.Close
Set rs = Nothing

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LoanDocsReceived) Then

MsgBox ("Original Note Rec'd date is filled in will not process Lost Note Letter")
Exit Function

Else
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Dim VSend As String
VSend = InputBox("Send Lost Note Letters to Walz for Mailing?")

If VSend = "Yes" Then
Call ExportLNLLetters

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "LostNoteVAWalz"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"

DoCmd.OpenQuery ("WalzAppendXMLTableBulkCN1")

GblFilenum = Forms![foreclosure database screen]![filenum]
VCntStart = 0

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)
Do While Not rsnotice.EOF
With rsnotice
.Edit
VIDNo = GetAutoNumber("NextWalz")
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
.Update
End With
rsnotice.MoveNext
Loop

DoCmd.OpenQuery ("WalzupdatemoniesLNL")

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Letters Sent to Walz")
DoCmd.OpenReport ("LostNoteVAWalz"), acViewPreview

Call LNLDocs


Else
DoCmd.OpenReport ("LostNoteVAWalz"), acViewPreview
Call LNLDocs
End If

End If



End If




End Function

Public Function exportXMLBorrowersFDL()
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
DoCmd.OpenQuery ("QueryUpdateXML")

Dim VcountLtr As Integer
VCntStart = 1
VcountLtr = 0

Dim rsnotice As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

Set rsnotice = CurrentDb.OpenRecordset("WalzXMLQry", dbOpenDynaset, dbSeeChanges)

If Not rsnotice.EOF Then

Do While Not rsnotice.EOF
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.Edit
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

!StartPage = VCntStart
!PageCount = 2

.Update
End With


'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
!ri = VLtr
!filenum = rsnotice!filenum
!Name1 = rsnotice!NoticeTo
!Name2 = ""
!Address1 = rsnotice!NoticeAdd
!Address2 = rsnotice!NoticeAdd2
!address3 = ""
!citystatezip = rsnotice!NoticeCITY & ", " & rsnotice!NoticeSTATE & " " & rsnotice!NoticeZIP
!reference = rsnotice!filenum & VLtr & VRecInd & VcountLtr
.Update
End With

rsnotice.MoveNext
VCntStart = VCntStart + 2
Loop


End If

rsnotice.Close


End Function


Public Function exportXMLBorrowersNTQ()
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
DoCmd.OpenQuery ("QueryUpdateXML")
DoCmd.OpenQuery ("NoticesOrderNTQ")
Dim VcountLtr As Integer
VCntStart = 1
VcountLtr = 0

Dim rsnotice As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

Set rsnotice = CurrentDb.OpenRecordset("WalzXMLQry", dbOpenDynaset, dbSeeChanges)

If Not rsnotice.EOF Then

Do While Not rsnotice.EOF
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.Edit
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
!StartPage = VCntStart
!PageCount = 1

.Update
End With


'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
!ri = VLtr
!filenum = rsnotice!filenum
!Name1 = rsnotice!NoticeTo
!Name2 = ""
!Address1 = rsnotice!NoticeAdd
!Address2 = rsnotice!NoticeAdd2
!address3 = ""
!citystatezip = rsnotice!NoticeCITY & ", " & rsnotice!NoticeSTATE & " " & rsnotice!NoticeZIP
!reference = rsnotice!filenum & VLtr & VRecInd & VcountLtr
.Update
End With

rsnotice.MoveNext
VCntStart = VCntStart + 1
Loop


End If

rsnotice.Close


End Function

Public Function exportXMLBorrowersFDLNEW()

Dim VcountLtr As Integer
VCntStart = 1
VcountLtr = 0
Dim VRecInd

If VLtr = "fdlva" And VFdlLnl = 2 Then
VRecInd = "-LNL"
Else
VRecInd = ""
End If

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

Dim rsnotice As RecordSet

GblFilenum = Forms![foreclosure database screen]![filenum]
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

If (Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1)) Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 2
Else
!StartPage = VCntStart
!PageCount = 1
End If


.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If

!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip

!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If

!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If
End If

If (Forms![foreclosure database screen]!DNS2 = 0 Or IsNull(Forms![foreclosure database screen]!DNS2)) Then

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 <> "") Then

'(IsNull(Forms![foreclosure database screen]![MailA_to]) Or _
'Forms![foreclosure database screen]![MailA_to] = "Grantor2" Or _
'Forms![foreclosure database screen]![MailA_to] = "All Grantors") Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If (Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1)) Then
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
Else
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 2
Else
!StartPage = VCntStart
!PageCount = 1
End If
End If

.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With
'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With
End If
End If
End If

If (Forms![foreclosure database screen]!DNS3 = 0 Or IsNull(Forms![foreclosure database screen]!DNS3)) Then


If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or Forms![foreclosure database screen]!LastNameDebtor3 <> "") Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If (Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1)) Or _
(Forms![foreclosure database screen]!DNS2 = 0 Or IsNull(Forms![foreclosure database screen]!DNS2)) Then
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
Else
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 2
Else
!StartPage = VCntStart
!PageCount = 1
End If
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If
End If
End If

If (Forms![foreclosure database screen]!DNS4 = 0 Or IsNull(Forms![foreclosure database screen]!DNS4)) Then

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or Forms![foreclosure database screen]!lastnamedebtor4 <> "") Then

VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With
End If
End If
End If


If (Forms![foreclosure database screen]!dns5 = 0 Or IsNull(Forms![foreclosure database screen]!dns5)) Then

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or Forms![foreclosure database screen]!lastnamedebtor5 <> "") Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]!SDatAddress2
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip
!extra = Forms![foreclosure database screen]![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr

!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0


.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VRecInd = "" And (VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC") Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
ElseIf VLtr = "ACLVA" Then
!StartPage = VCntStart + 2
VCntStart = VCntStart + 2
!PageCount = 2
Else
!StartPage = VCntStart + 1
VCntStart = VCntStart + 1
!PageCount = 1
End If
.Update
End With

'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VRecInd & VcountLtr
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With
End If
End If
End If



If VLtr <> "VASB" And VLtr <> "lnva" Then
Call WalzLienPDF
End If


'Call NOIOwners

rsnotice.Close

End Function



Public Function exportWalzMoniesLNL()

Dim VcountLtr As Integer
VCntStart = 1
VcountLtr = 0

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)

Dim rsnotice As RecordSet

GblFilenum = Forms![foreclosure database screen]![filenum]

If (Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1)) Then
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If

If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If

!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip

!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With


If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = firstdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If
.Update
End With
End If
End If

If (Forms![foreclosure database screen]!DNS2 = 0 Or IsNull(Forms![foreclosure database screen]!DNS2)) Then

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Then
'
VIDNo = GetAutoNumber("NextWalz")

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then


'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")



'Walz Monies 3rd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = secondDebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If
End If
End If

If (Forms![foreclosure database screen]!DNS3 = 0 Or IsNull(Forms![foreclosure database screen]!DNS3)) Then


If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then


'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If
.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = thirddebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If
.Update
End With
End If
End If
End If

If (Forms![foreclosure database screen]!DNS4 = 0 Or IsNull(Forms![foreclosure database screen]!DNS4)) Then

If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Then
VIDNo = GetAutoNumber("NextWalz")

'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then

VIDNo = GetAutoNumber("NextWalz")

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![SDatAddress]
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fourthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If
End If
End If


If (Forms![foreclosure database screen]!dns5 = 0 Or IsNull(Forms![foreclosure database screen]!dns5)) Then

If Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies Property---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
VIDNo = GetAutoNumber("NextWalz")

'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]!SDatAddress
!Address2 = Forms![foreclosure database screen]!SDatAddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]!SDatState & "  " & Forms![foreclosure database screen]!SDatZip
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
VcountLtr = VcountLtr + 1
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
.Update
End With
End If

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
VIDNo = GetAutoNumber("NextWalz")


'Walz Monies Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing Address]
!Address2 = Forms![foreclosure database screen]![Mailing Address2]
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
VIDNo = GetAutoNumber("NextWalz")



'Walz Monies 2nd Mailing---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = fifthdebtor()
!Name2 = ""
!Address1 = Forms![foreclosure database screen]![Mailing AddressB]
!Address2 = Forms![foreclosure database screen]![Mailing Address2B]
!citystatezip = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Or VLtr = "oomc" Or VLtr = "amchot" Or VLtr Like "ACL*" Or VLtr = "HUD" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
End If

.Update
End With
End If
End If
End If



If VLtr <> "VASB" And VLtr <> "lnva" Then
Call WalzLienPDF
End If


'Call NOIOwners

rsnotice.Close

End Function

Public Function ExportWalzXML()
Dim VcountLtr As Integer
VCntStart = 1
VcountLtr = 0
Dim rsnotices As RecordSet
Dim VProp
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rsnotices = CurrentDb.OpenRecordset("NoticesWalz", dbOpenSnapshot)

Dim rsnotice As RecordSet

Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

Do While Not rsnotices.EOF
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
VProp = Forms![foreclosure database screen]![PropAddress]
Else
VProp = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
!NoticeTo = rsnotices!NoticeTo
!filenum = rsnotices!filenum
!NoticeAdd = rsnotices!NoticeAdd
!NoticeAdd2 = rsnotices!NoticeAdd2
'-----------------------------
Dim tempCtySt As Variant
Dim C, d
Dim v1, v2, V3, V4, V5

d = Split(rsnotices!NoticeCSZ, ",")

v1 = StrConv(d(0), vbProperCase)
v2 = StrConv(d(1), vbProperCase)
tempCtySt = Split(v2, " ")
C = Split(v2, " ")
!NoticeCITY = v1

If UBound(tempCtySt) = 3 Then
!NoticeSTATE = StrConv(C(1), vbProperCase)
!NoticeZIP = StrConv(C(3), vbProperCase)
ElseIf UBound(tempCtySt) = 2 Then
!NoticeSTATE = StrConv(C(1), vbProperCase)
!NoticeZIP = StrConv(C(2), vbProperCase)
End If
'===============================
!extra = rsnotices![PropAddress]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo
If VLtr Like "ACLVA" Or VLtr Like "FDL*" Or VLtr Like "NOI*" Or VLtr = "AMCHOT" Or VLtr = "OOMC" Or VLtr = "ACLMD" Or VLtr = "VASB" Or VLtr = "ACLDC" Then
!StartPage = VCntStart
!PageCount = 2
VCntStart = VCntStart + 2
Else
!StartPage = VCntStart
!PageCount = 1
VCntStart = VCntStart + 1
End If
.Update
End With


'Walz Monies---------------------------
With rsWalz
.AddNew
!ID_No = VIDNo
!WalzDateUploaded = Date
If VLtr = "fdlva" And VFdlLnl = 2 Then
!ri = "LNL"
Else
!ri = VLtr
End If
!filenum = rsnotices!filenum
!Name1 = rsnotices!NoticeTo
!Name2 = ""
!Address1 = rsnotices!NoticeAdd
!Address2 = rsnotices!NoticeAdd2
!address3 = ""
!citystatezip = rsnotices!NoticeCSZ
!reference = rsnotices!filenum & VLtr & VcountLtr
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0

.Update
End With


rsnotices.MoveNext
Loop






rsnotice.Close

End Function
Public Function FDLLienholders()
Dim VCred
Dim strsql As String
Dim rscred As RecordSet

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VCntStart = 1

strsql = "select * from creditors where (fdl = " & -1 & " or fdl = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum & " order by organizationname;"
Set rscred = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rscred.EOF Then
Else
Do While Not rscred.EOF

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "FDLVA"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "FDLDC"
Else
VLtr = "FDLMD"
End If

Dim strsqlLIEN
Dim rsLienHolders As RecordSet

strsqlLIEN = "SELECT Cases.FirstNameDebtor1, Cases.MiddleNameDebtor1, Cases.LastNameDebtor1, " _
& " Cases.FirstNameDebtor2, Cases.MiddleNameDebtor2, Cases.LastNameDebtor2, Cases.PropAddress, Cases.PropertyCounty, " _
& " Cases.PropertyCity, Cases.PropertyState, Cases.PropZip, Cases.[Mailing Address], Cases.[Mailing Address2], " _
& " Cases.[Mailing City], Cases.[Mailing State], Cases.[Mailing Zip], Creditors.contactid, Cases.Mr_Mrs_Ms, Cases.Mr_Mrs_Ms2, " _
& " Cases.Mr_Mrs_Ms3, Cases.FirstNameDebtor3, Cases.MiddleNameDebtor3, Cases.LastNameDebtor3, Cases.TypeOfLoan, " _
& " Cases.[HUD/VANum], foreclosure.[principal balance], foreclosure.dotdate, foreclosure.orglender, foreclosure.orgamount, cases.[date recieved], foreclosure.[extra money], Cases.ClientRefNumber, Foreclosure.SaleDate, Foreclosure.SaleTime, Creditors.OrganizationName, " _
& " Creditors.Address, Creditors.City, Creditors.State, Creditors.PostalCode, Cases.FileNum, Creditors.NoticeSent, " _
& " Creditors.fdl, Creditors.dear, Creditors.Address2, Creditors.note, Jurisdiction.SaleHeld, " _
& " cases.securedparty, cases.client, Foreclosure.noticesent_lien " _
& " From ((Cases INNER JOIN Foreclosure ON Cases.FileNum = Foreclosure.SubFileNum) " _
& " INNER JOIN Creditors ON Cases.FileNum = Creditors.FileNum) " _
& " INNER JOIN Jurisdiction ON (Cases.PropertyState = Jurisdiction.State) " _
& " AND (Cases.PropertyCounty = Jurisdiction.County) where creditors.contactid = " & rscred!ContactID & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)
VCntStart = VCntStart + 1
'-------------------------------

'DoCmd.OpenReport "Fairdebt Letter", acViewDesign
'Reports![Fairdebt Letter].RecordSource = strsqlLIEN
'DoCmd.Close acReport, "Fairdebt Letter", acSaveYes

'-----------------------------
VConvRpt = "Fairdebt Letter"
Call ConvertPDF

txtname = dumpname & "_" & VConvRpt & ".pdf"
txtname2 = dumpname & "_" & VConvRpt & VCntStart & ".pdf"
VPDF = txtname2
sourcefile = DTLocation & "\WALZ\ToWalz\" & txtname
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
FileCopy sourcefile, destinationfile    ' Copy source to target.
Kill sourcefile

'If Forms![foreclosure database screen]!PropertyState = "VA" Then
'DoCmd.OpenReport "LostNoteVA-LienholdersWALZ", acViewDesign
'Reports![LostNoteVA-LienholdersWALZ].RecordSource = strsqlLIEN
'DoCmd.Close acReport, "LostNoteVA-LienholdersWALZ", acSaveYes
'VConvRpt = "LostNoteVA-LienholdersWALZ"
'Call ConvertPDF
'txtname = Dumpname & "_" & VConvRpt & ".pdf"
'txtname2 = Dumpname & "_" & VConvRpt & VCntStart & ".pdf"
'VPDF = VPDF & ";" & txtname2
'sourcefile = DTLocation & "\WALZ\ToWalz\" & txtname
'Destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
'FileCopy sourcefile, Destinationfile    ' Copy source to target.
'Kill sourcefile
'End If


Dim VNo As Integer
VNo = 0
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
Else
rsLienHolders.MoveFirst
Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
While Not rsLienHolders.EOF

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum

!NoticeTo = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address

If rsLienHolders!Address2 = "" Then
!NoticeAdd = ""
Else
!NoticeAdd = rsLienHolders!Address2
End If
!NoticeAdd2 = ""
Else
!Name2 = ""
!NoticeAdd = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!NoticeAdd2 = ""
Else
!NoticeAdd2 = rsLienHolders!Address2
End If
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


rsLienHolders.MoveNext

Wend

End If


rsLienHolders.Close
rs.Close

'====================

rscred.MoveNext
Loop

Call CreateWalzXMLLIEN
Call CreateCompleteFile


End If



End Function
Public Function ExportHUDOccHFO()

Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = hudocc1()
!Name2 = ""
!Address1 = hudocc2()
!Address2 = hudocc3()
!address3 = ""
!citystatezip = hudocc4()
!reference = Forms![foreclosure database screen]!filenum & "HUD"
.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = hudocc1()
!NoticeAdd = hudocc2()
!NoticeAdd2 = hudocc3()
!NoticeCITY = hudoccCITY()
!NoticeSTATE = hudoccSTATE()
!NoticeZIP = hudoccZIP()
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


End Function

Public Function ExportHUDOccQueue()

Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
!filenum = Forms![HOC Queue]!filenum
!Name1 = "Occupant(s)/Tenant(s)/Owner(s)"
!Name2 = ""
If IsNull(Forms![HOC Queue]![unit_no]) Or _
Forms![HOC Queue]![unit_no] = "" Then
!Address1 = Forms![HOC Queue]![PropAddress]
Else
!Address1 = Forms![HOC Queue]![PropAddress] & ", Unit # " & Forms![HOC Queue]![unit_no]
End If
!Address2 = Forms![HOC Queue]!propaddress2
!address3 = ""
!citystatezip = Forms![HOC Queue]![PropertyCity] & ", " & Forms![HOC Queue]!PropertyState & "  " & Forms![HOC Queue]!propzip
!reference = Forms![HOC Queue]!filenum & "HUD"
.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![HOC Queue]!filenum
!NoticeTo = "Occupant(s)/Tenant(s)/Owner(s)"
If IsNull(Forms![HOC Queue]![unit_no]) Or _
Forms![HOC Queue]![unit_no] = "" Then
!NoticeAdd = Forms![HOC Queue]![PropAddress]
Else
!NoticeAdd = Forms![HOC Queue]![PropAddress] & ", Unit # " & Forms![HOC Queue]![unit_no]
End If
!NoticeAdd2 = Forms![HOC Queue]!propaddress2
!NoticeCITY = Forms![HOC Queue]!PropertyCity
!NoticeSTATE = Forms![HOC Queue]!PropertyState
!NoticeZIP = Forms![HOC Queue]!propzip

!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


End Function

Public Function ExportHUDOcc()

Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet

Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "Occupant(s)/Tenant(s)/Owner(s)"
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!reference = Forms![foreclosure database screen]!filenum & "HUD"
.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = "Occupant(s)/Tenant(s)/Owner(s)"
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With


End Function
Public Function ExportSB123()

Dim strsqlCounty As String
Dim rs, rspropertycounty As RecordSet
Dim rsadd As RecordSet
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)
Dim Vadd1, Vadd2, Vadd3, VAdd4
Dim strsql

strsql = "SELECT Jurisdiction.State, Jurisdiction.County, Jurisdiction.treasurer, Jurisdiction.treasurer_add, " _
& "Jurisdiction.treasurer_csz, Jurisdiction.treasurer_add2, Jurisdiction.Treas_City, Jurisdiction.Treas_State, " _
& " Jurisdiction.Treas_Zip from Jurisdiction WHERE Jurisdiction.State = " _
& """" & [Forms]![foreclosure database screen]![PropertyState] & """" & " AND Jurisdiction.County = " & """" & [Forms]![foreclosure database screen]![Propertycounty] & """" & ";"

Set rsadd = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If IsNull(rsadd![treasurer_add]) Then
MsgBox ("NO ADDRESS FOR Supervisor.  Exiting....")
rsadd.Close
Exit Function
Else
Vadd1 = rsadd!treasurer_add
End If

If IsNull(rsadd![treasurer_add2]) Then
Vadd2 = rsadd!Treas_City & ", " & rsadd!Treas_State & " " & rsadd!Treas_Zip
Vadd3 = ""
Else
Vadd2 = rsadd!treasurer_add2
Vadd3 = rsadd!Treas_City & ", " & rsadd!Treas_State & " " & rsadd!Treas_Zip
End If

Dim rsWalz As RecordSet
Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!ri = VLtr
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = "Supervisor of Assessments for " & County()
!Name2 = ""
!Address1 = Vadd1
!Address2 = Vadd2
!address3 = ""
!citystatezip = Vadd3
!reference = Forms![foreclosure database screen]!filenum & "SB123"
.Update
End With


With rs
.AddNew
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = "Supervisor of Assessments for " & County()
!NoticeAdd = Vadd1
!NoticeAdd2 = Vadd2
!NoticeCITY = rsadd!Treas_City
!NoticeSTATE = rsadd!Treas_State
!NoticeZIP = rsadd!Treas_Zip
rsadd.Close
!reference = VIDNo
!pdffile = VPDF
!StartPage = 1
!PageCount = "-1"
.Update
End With



End Function
Public Function VASB797Walz()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "VA SB797 Notice"
VLtr = "VASB"
Call ConvertPDF
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf"
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call exportXMLBorrowersFDL

Call CreateWalzXML
Call CreateCompleteFile

End Function
Public Function SB123()

Dim VSel

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

vFile = BrowseFLDROrdRat()

If IsNull(vFile) Or vFile = "" Then
MsgBox ("There is not an Order Ratification in Imaged Docs, no SB123 letter will print or preview")
Exit Function
Else
vimageXML = "YES"
End If


VSel = InputBox("Send via WALZ? (type in Y or N)")
If VSel = "y" Or VSel = "Y" Then

Dim txtname As String

txtname = dumpname & "_OrdRat.pdf"
sourcefile = vFile
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPDFxml = txtname


If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VConvRpt = "SPVRofAssessments"
VLtr = "SB123"
Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & VPDFxml
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call ExportSB123
Call CreateWalzXML
Call CreateCompleteFile



Else

DoCmd.OpenReport "SPVRofAssessments", acViewPreview

FollowHyperlink (vFile)

End If

End Function
Public Function NTQVaOcc()
VPDF = ""

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

VConvRpt = "Notice to Quit-Occupant"
VLtr = "NTQVAO"
Call ConvertPDF

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = dumpname & "_" & VConvRpt & ".pdf"

GblFilenum = Forms![foreclosure database screen]!filenum
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If rsE!clientUpdatesVIA Like "Equato*" Then

If rsE!clientUpdatesVIA Like "Equato*" Then
VConvRpt = "evictionscraletter"
End If


VLtr = "NTQVAO"
Call ConvertPDF

VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"


End If

rsE.Close

'Occupant Information Form
Dim txtname5

txtname5 = dumpname & "_OccupantInformationForm.pdf"

If Forms![foreclosure database screen]!Client Like "Bank of Americ*" Then
'sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationFormBANA.pdf"
Else
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationForm.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname5
FileCopy sourcefile, destinationfile    ' Copy source to target.
VPDF = VPDF & ";" & txtname5
End If
'End Occupent Information Form

If Forms![foreclosure database screen]!Client Like "OneWes*" Or _
Forms![foreclosure database screen]!Client Like "Wells*" Then

txtname2 = dumpname & "_NTQVAAttach2.pdf"

If Forms![foreclosure database screen]!Client Like "OneWes*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OWBSCRANotice.pdf"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\WellsSCRANotice.pdf"
End If

destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
FileCopy sourcefile, destinationfile    ' Copy source to target.

'VPDFxml = VPDFxml & ";" & txtname2

VPDF = VPDF & ";" & txtname2
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call ExportXMLOccupantsEvic

Call CreateWalzXML
Call CreateCompleteFile
End Function
Public Function NTQVa()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

Call ExportNTQVa

VLtr = "NTQVA"
VConvRpt = "Notice To Quit"
Call ConvertPDF

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = dumpname & "_" & VConvRpt & ".pdf"

'------------------------


GblFilenum = Forms![foreclosure database screen]!filenum
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If rsE!clientUpdatesVIA Like "Equato*" Then
VConvRpt = "evictionscraletter"
Call ConvertPDF
VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
End If

rsE.Close


'------------------------
'Occupant Information Form
Dim txtname5
txtname5 = dumpname & "_OccupantInformationForm.pdf"

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > #1/1/2015# Then
'sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationFormBANA.pdf"
Else
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationForm.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname5
FileCopy sourcefile, destinationfile    ' Copy source to target.
VPDF = VPDF & ";" & txtname5
End If
'End Occupent Information Form

'Aldridge/OneWest
Dim txtname2

If Forms![foreclosure database screen]!Client Like "OneWes*" Or _
Forms![foreclosure database screen]!Client Like "Wells*" Then

txtname2 = dumpname & "_NTQVAAttach2.pdf"

If Forms![foreclosure database screen]!Client Like "OneWes*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OWBSCRANotice.pdf"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\WellsSCRANotice.pdf"
End If

destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPDF = VPDF & ";" & txtname2

End If
If Forms![foreclosure database screen]!Client Like "Homeward*" Then
Call ImageNTQVAHomeward
VPDF = VPDF & ";" & VPDFxml
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call exportXMLBorrowersNTQ
Call CreateWalzXML
Call CreateCompleteFile

Call NTQVaOcc

MsgBox ("Notices Sent to Walz")

End Function

Public Function NTQMd()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")


If Forms![foreclosure database screen]!EvictionSubFormMD.Form![eviction_company_name] = "Jackson and Associates" Then
VConvRpt = "Notice to Quit-MD-JA"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then

VConvRpt = "Notice to Vacate-MD-WELLS"
Else

VConvRpt = "Notice to Quit-MD"
End If


VLtr = "NTQMD"
Call ConvertPDF
VPDF = dumpname & "_" & VConvRpt & ".pdf"
'MsgBox (VPDF)

'-----------

GblFilenum = Forms![foreclosure database screen]!filenum
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If rsE!clientUpdatesVIA Like "Equato*" Then

If rsE!clientUpdatesVIA Like "Equato*" Then
VConvRpt = "evictionscraletter"
End If

rsE.Close

Call ConvertPDF
VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
'MsgBox (VPDF)

End If
'-----------

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

Call ImageNTQMd
VPDF = VPDF & ";" & VPDFxml

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call exportXMLBorrowers

Call CreateWalzXML
Call CreateCompleteFile

MsgBox ("Notice Sent to Walz")

End Function
Public Function ACLWalz()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
'CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
'    Call ExportNoticesNOOccupant
'    Call ExportLienholderNOI

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VLtr = "ACLVA"
VConvRpt = "ACL-Letter-VA"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
VLtr = "ACLDC"
VConvRpt = "ACL-Letter"
ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then
VLtr = "ACLMD"
VConvRpt = "ACL-Letter"
End If

Vyes3 = MsgBox("Send Letters to BWW Docs", vbYesNo)
If Vyes3 = vbYes Then

docsfldr = AutoIndexPath & "BrchDmdLtr\"

If Forms![foreclosure database screen]!PropertyState = "VA" Then
CopyDocToBGWWDocs "ACL-Letter-VA", "BrchDmdLtr", "_ACL.PDF"
Else
CopyDocToBGWWDocs "ACL-Letter", "BrchDmdLtr", "_ACL.PDF"
End If
End If


Call ConvertPDF
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf"
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call exportXMLBorrowersFDL

Call CreateWalzXML
Call CreateCompleteFile

End Function
Public Function ResumePDF()


If Forms![foreclosure database screen]![Mailing Address] = "" Then
Forms![foreclosure database screen]![Mailing Address] = Null
End If

If Not IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] <> "" Then
If (IsNull(Forms![foreclosure database screen]![Mailing City]) Or _
Forms![foreclosure database screen]![Mailing City] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing State]) Or _
Forms![foreclosure database screen]![Mailing State] = "") Or _
(IsNull(Forms![foreclosure database screen]![Mailing Zip]) Or _
Forms![foreclosure database screen]![Mailing Zip] = "") Then
VMsg = "There is missing Mailing Address information ,City State or Zip, input in the Screen, no letter will print"
MsgBox (VMsg)

Exit Function

End If
End If

If Forms![foreclosure database screen]!PropertyState = "MD" And IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Or _
IsNull(Forms![foreclosure database screen]!PropAddress) Or _
IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!propzip) Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime) Or _
IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!notice_processor) Then

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
VMsg = "There is no Sale Date input in the Screen, no letter will dump"
End If

If IsNull(Forms![foreclosure database screen]!PropAddress) Then
VMsg = "There is no Property Address input in the Screen, no letter will dump"
End If


If IsNull(Forms![foreclosure database screen]!PropertyCity) Or _
IsNull(Forms![foreclosure database screen]!PropertyState) Or _
IsNull(Forms![foreclosure database screen]!propzip) Then
VMsg = "There is missing property information ,City State or Zip, input in the Screen, no letter will print"
End If

MsgBox (VMsg)

Exit Function

Else
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError

Call ExportNotices
'-The Beginning of the Dump
'Create Name of all Files to Dump--------------------
dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

'County Letter for MD-----------------------
If Forms![foreclosure database screen]!PropertyState = "MD" Then
VConvRpt = "Notice of Sale - County"
Call ConvertPDF
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf"
VLtr = "CTY"
Call ExportCountyXML
End If

'City Letter --------------------------
If Forms![foreclosure database screen]!Propertycounty = "Wicomico" Then
If Forms![foreclosure database screen]!PropertyCity = "Allen" Or _
Forms![foreclosure database screen]!PropertyCity = "Bivalve" Or _
Forms![foreclosure database screen]!PropertyCity = "Nanticoke" Or _
Forms![foreclosure database screen]!PropertyCity = "Parsonburg" Or _
Forms![foreclosure database screen]!PropertyCity = "Powellville" Or _
Forms![foreclosure database screen]!PropertyCity = "Quantico" Or _
Forms![foreclosure database screen]!PropertyCity = "Tyaskin" Then
Else
VConvRpt = "Notice of Sale - City"
Call ConvertPDF

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

VPDF = dumpname & "_" & VConvRpt & ".pdf"
VLtr = "CITY"
Call ExportScreenDataXML

End If
End If


'HUD Occupancy Letter-----------------------------------------
If (Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or (Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1)) Then
If (Forms![foreclosure database screen]!PropertyState = "DC" Or Forms![foreclosure database screen]!PropertyState = "VA") Then
VConvRpt = "Fairdebt-Hud-VA"
Else
VConvRpt = "Fairdebt-HUD"
End If

Call ImageHud
Call ConvertPDF
If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If
VPDF = dumpname & "_" & VConvRpt & ".pdf" & ";" & vHUD1
VLtr = "HUD"
Call ExportHUDOcc
End If


Call CreateWalzXML
Call CreateCompleteFile

End If

End Function
Public Function NOIBulkCheckMONITOR()
dumpname = Format(Forms![noi-bulk]!LoanNo, "000000") & Format$(Now(), "yyyymmddhhnnss")
VConvRpt = "noi-bulk-monitor"
VLtr = "NOIMDFlat"
Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"
Call ExportNOIBULKXML
DoCmd.OpenQuery ("NOItoWalzMonitor")
Call CreateWalzXML
Call CreateCompleteFile
End Function
Public Function LODBulkCheck()
dumpname = Format(rs!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
VConvRpt = "linedismissbulkscreen"
VLtr = "LOD"
Call ConvertPDF

VPDF = dumpname & "_" & VConvRpt & ".pdf"
Call ExportLODBULKXML
'DoCmd.OpenQuery ("LODtoWalz")
Call CreateWalzXML
Call CreateCompleteFile
MsgBox ("LOD SENT TO WALZ FOR MAILING.  MARK BOX FOR PROCESSED!!!")
End Function
Public Function createcompleteFileBULK()
Call Wait(5, False)     ' wait 5 seconds

txtname = dumpname & ".complete"
sourcefile = DTLocation & "\CompleteWalz.txt"
destinationfile = DTLocation & "\WALZ\Bulk\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.

End Function
Public Function BulkAffCreation()
Dim rs As RecordSet
Dim f, f2, fs
Dim fldr, VDt, vFName, vFile
Dim Val_Open, xlApp
Dim VPDFDirectory
Dim RsNoFile As RecordSet
Dim RsFileSent As RecordSet
Dim VFile2

'On Error GoTo ErrDesc

Set rs = CurrentDb.OpenRecordset("bulkaffcorrectivewalz", dbOpenSnapshot)
Set RsNoFile = CurrentDb.OpenRecordset("bulkaffnofile", dbOpenDynaset, dbSeeChanges)
Set RsFileSent = CurrentDb.OpenRecordset("bulkaffsentwalz", dbOpenDynaset, dbSeeChanges)

Do While Not rs.EOF

dumpname = Format(rs!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
VConvRpt = "JakesAffCorrective"
'----Image Attachment

fldr = GetDocPath(rs!filenum)
vFile = rs!filenum & "_CortvAff_01.pdf"


VPDF = dumpname & "_" & VConvRpt & ".pdf"
VPDFDirectory = fldr & vFile
sourcefile = VPDFDirectory
destinationfile = "\\rvdv-fs01\datatransfer\Walz\BULK\" & VPDF
FileCopy sourcefile, destinationfile    ' Copy source to target.

With RsFileSent
.AddNew
![BGWW#] = rs!filenum
.Update
End With

VCntStart = 1
Dim VcountLtr As Integer
Dim rsnotice As RecordSet
CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

Dim Vadd1, Vadd2, Vadd3, VAdd4, VAdd5

If Not IsNull(rs!SDatAddress) Then
Vadd1 = rs!SDatAddress
Vadd2 = rs!SDatAddress2
Vadd3 = rs!SDatCity
VAdd4 = rs!SDatState
VAdd5 = rs!SDatZip
Else
Vadd1 = rs![PropAddress] & " " & rs!unit_no
Vadd2 = rs!propaddress2
Vadd3 = rs!PropertyCity
VAdd4 = rs!PropertyState
VAdd5 = rs!propzip
End If


With rsnotice
VIDNo = GetAutoNumber("NextWalz")
.AddNew
If Not IsNull(rs!MiddleNameDebtor1) Then
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!MiddleNameDebtor1 & " " & rs!LastNameDebtor1
Else
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!LastNameDebtor1
End If
If Not IsNull(rs!LastNameDebtor2) Then
If Not IsNull(rs!MiddleNameDebtor2) Then
!Name2 = rs!FirstNameDebtor2 & " " & rs!MiddleNameDebtor2 & " " & rs!LastNameDebtor2
Else
!Name2 = rs!FirstNameDebtor2 & " " & rs!LastNameDebtor2
End If
End If
!filenum = rs!filenum
!NoticeAdd = Vadd1
!NoticeAdd2 = Vadd2
!NoticeCITY = Vadd3
!NoticeSTATE = VAdd4
!NoticeZIP = VAdd5
!ri = "FDLDC"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If rs!LastNameDebtor3 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(rs!MiddleNameDebtor3) Then
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!MiddleNameDebtor3 & " " & rs!LastNameDebtor3
Else
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!LastNameDebtor3
End If
If Not IsNull(rs!lastnamedebtor4) Then
If Not IsNull(rs!middlenamedebtor4) Then
!Name2 = rs!firstnamedebtor4 & " " & rs!middlenamedebtor4 & " " & rs!lastnamedebtor4
Else
!Name2 = rs!firstnamedebtor4 & " " & rs!lastnamedebtor4
End If
End If
!filenum = rs!filenum
!NoticeAdd = Vadd1
!NoticeAdd2 = Vadd2
!NoticeCITY = Vadd3
!NoticeSTATE = VAdd4
!NoticeZIP = VAdd5
!ri = "FDLDC"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

If rs!lastnamedebtor5 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(rs!middlenamedebtor5) Then
!NoticeTo = rs!firstnamedebtor5 & " " & rs!middlenamedebtor5 & " " & rs!lastnamedebtor5
Else
!NoticeTo = rs!firstnamedebtor5 & " " & rs!lastnamedebtor5
End If
!filenum = rs!filenum
!NoticeAdd = Vadd1
!NoticeAdd2 = Vadd2
!NoticeCITY = Vadd3
!NoticeSTATE = VAdd4
!NoticeZIP = VAdd5
!ri = "FDLDC"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

Call CreateWalzXMLBULK
Call createcompleteFileBULK

rs.MoveNext
vFName = ""

Loop

MsgBox ("All Affs SENT TO WALZ FOR MAILING.  Don't Forget to Update the WalzInfo table for all BWW#s!!!")
End Function

Public Function ExportLODBULKXML()

VCntStart = 1
Dim VcountLtr As Integer
Dim VMail1
Dim VMail2

Dim rsnotice As RecordSet

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

With rsnotice

VIDNo = GetAutoNumber("NextWalz")
.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor1) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor1 & " " & Forms!dismissbulk!MiddleNameDebtor1 & " " & Forms!dismissbulk!LastNameDebtor1
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor1 & " " & Forms!dismissbulk!LastNameDebtor1
End If
!filenum = rs!filenum
!NoticeAdd = rs![PropAddress] & " " & Forms!dismissbulk!unit_no
!NoticeAdd2 = Forms!dismissbulk!propaddress2
!NoticeCITY = rs!PropertyCity
!NoticeSTATE = rs!PropertyState
!NoticeZIP = rs!propzip
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(rs![Mailing Address]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor1) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor1 & " " & Forms!dismissbulk!MiddleNameDebtor1 & " " & Forms!dismissbulk!LastNameDebtor1
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor1 & " " & Forms!dismissbulk!LastNameDebtor1
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = Forms!dismissbulk![Mailing Address2]
!NoticeCITY = rs![Mailing City]
!NoticeSTATE = rs![Mailing State]
!NoticeZIP = rs![Mailing Zip]
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If


If Forms!dismissbulk!LastNameDebtor2 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor2) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor2 & " " & Forms!dismissbulk!MiddleNameDebtor2 & " " & Forms!dismissbulk!LastNameDebtor2
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor2 & " " & Forms!dismissbulk!LastNameDebtor2
End If
!filenum = rs!filenum
!NoticeAdd = rs![PropAddress] & " " & Forms!dismissbulk!unit_no
!NoticeAdd2 = Forms!dismissbulk!propaddress2
!NoticeCITY = rs!PropertyCity
!NoticeSTATE = rs!PropertyState
!NoticeZIP = rs!propzip
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(rs![Mailing Address]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor2) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor2 & " " & Forms!dismissbulk!MiddleNameDebtor2 & " " & Forms!dismissbulk!LastNameDebtor2
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor2 & " " & Forms!dismissbulk!LastNameDebtor2
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = Forms!dismissbulk![Mailing Address2]
!NoticeCITY = rs![Mailing City]
!NoticeSTATE = rs![Mailing State]
!NoticeZIP = rs![Mailing Zip]
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

End If


If Forms!dismissbulk!LastNameDebtor3 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor3) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor3 & " " & Forms!dismissbulk!MiddleNameDebtor3 & " " & Forms!dismissbulk!LastNameDebtor3
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor3 & " " & Forms!dismissbulk!LastNameDebtor3
End If
!filenum = rs!filenum
!NoticeAdd = rs![PropAddress] & " " & Forms!dismissbulk!unit_no
!NoticeAdd2 = Forms!dismissbulk!propaddress2
!NoticeCITY = rs!PropertyCity
!NoticeSTATE = rs!PropertyState
!NoticeZIP = rs!propzip
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(rs![Mailing Address]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
If Not IsNull(Forms!dismissbulk!MiddleNameDebtor3) Then
!NoticeTo = Forms!dismissbulk!FirstNameDebtor3 & " " & Forms!dismissbulk!MiddleNameDebtor3 & " " & Forms!dismissbulk!LastNameDebtor3
Else
!NoticeTo = Forms!dismissbulk!FirstNameDebtor3 & " " & Forms!dismissbulk!LastNameDebtor3
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = Forms!dismissbulk![Mailing Address2]
!NoticeCITY = rs![Mailing City]
!NoticeSTATE = rs![Mailing State]
!NoticeZIP = rs![Mailing Zip]
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

End If

If Forms!dismissbulk!lastnamedebtor4 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(Forms!dismissbulk!middlenamedebtor4) Then
!NoticeTo = Forms!dismissbulk!firstnamedebtor4 & " " & Forms!dismissbulk!middlenamedebtor4 & " " & Forms!dismissbulk!lastnamedebtor4
Else
!NoticeTo = Forms!dismissbulk!firstnamedebtor4 & " " & Forms!dismissbulk!lastnamedebtor4
End If
!filenum = rs!filenum
!NoticeAdd = rs![PropAddress] & " " & Forms!dismissbulk!unit_no
!NoticeAdd2 = Forms!dismissbulk!propaddress2
!NoticeCITY = rs!PropertyCity
!NoticeSTATE = rs!PropertyState
!NoticeZIP = rs!propzip
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(rs![Mailing Address]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
If Not IsNull(Forms!dismissbulk!middlenamedebtor4) Then
!NoticeTo = Forms!dismissbulk!firstnamedebtor4 & " " & Forms!dismissbulk!middlenamedebtor4 & " " & Forms!dismissbulk!lastnamedebtor4
Else
!NoticeTo = Forms!dismissbulk!firstnamedebtor4 & " " & Forms!dismissbulk!lastnamedebtor4
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = Forms!dismissbulk![Mailing Address2]
!NoticeCITY = rs![Mailing City]
!NoticeSTATE = rs![Mailing State]
!NoticeZIP = rs![Mailing Zip]
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

End If

If Forms!dismissbulk!lastnamedebtor5 <> "" Then

VIDNo = GetAutoNumber("NextWalz")
With rsnotice

.AddNew
If Not IsNull(Forms!dismissbulk!middlenamedebtor5) Then
!NoticeTo = Forms!dismissbulk!firstnamedebtor5 & " " & Forms!dismissbulk!middlenamedebtor5 & " " & Forms!dismissbulk!lastnamedebtor5
Else
!NoticeTo = Forms!dismissbulk!firstnamedebtor5 & " " & Forms!dismissbulk!lastnamedebtor5
End If
!filenum = rs!filenum
!NoticeAdd = rs![PropAddress] & " " & Forms!dismissbulk!unit_no
!NoticeAdd2 = Forms!dismissbulk!propaddress2
!NoticeCITY = rs!PropertyCity
!NoticeSTATE = rs!PropertyState
!NoticeZIP = rs!propzip
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(rs![Mailing Address]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
If Not IsNull(Forms!dismissbulk!middlenamedebtor5) Then
!NoticeTo = Forms!dismissbulk!firstnamedebtor5 & " " & Forms!dismissbulk!middlenamedebtor5 & " " & Forms!dismissbulk!lastnamedebtor5
Else
!NoticeTo = Forms!dismissbulk!firstnamedebtor5 & " " & Forms!dismissbulk!lastnamedebtor5
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = Forms!dismissbulk![Mailing Address2]
!NoticeCITY = rs![Mailing City]
!NoticeSTATE = rs![Mailing State]
!NoticeZIP = rs![Mailing Zip]
!ri = "LOD"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With
End If

End If


End Function
Public Function ImagePDFOWB()

Dim VFileTimeDownload, vfiletime As Date
Dim vtime As String

Dim txtname As String

txtname = dumpname & "_Application.pdf"

sourcefile = "\\rvdv-fs01\datatransfer\NOI_Application\HAMP\OneWest.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile    ' Copy source to target.

VAttach = txtname


End Function
Public Function NOIBulkCheck()

dumpname = Format(Forms![noi-bulk]!LoanNo, "000000") & Format$(Now(), "yyyymmddhhnnss")
VConvRpt = "NOI-bulk"
VLtr = "NOIMDFlat"
Call ConvertPDF
'OneWest PDF attachment
Call ImagePDFOWB
VPDF = VAttach & ";" & dumpname & "_" & VConvRpt & ".pdf"
Call ExportNOIBULKXML
DoCmd.OpenQuery ("NOItoWalz")
Call CreateWalzXML
Call CreateCompleteFile
MsgBox ("NOI SENT TO WALZ FOR MAILING.  MARK BOX FOR PROCESSED!!!")

End Function
Public Function ExportNOIBULKXML()

VCntStart = 1
Dim VcountLtr As Integer
Dim VMail1
Dim VMail2

Dim rsnotice As RecordSet

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Set rsnotice = CurrentDb.OpenRecordset("WalzXML", dbOpenDynaset, dbSeeChanges)

If Forms![noi-bulk]![mailing] = -1 Or Forms![noi-bulk]![mailing] = 1 Then

If Not IsNull(Forms![noi-bulk]![Billing Address]) And IsNull(Forms![noi-bulk]![billing_add2]) Then
VMail1 = Forms![noi-bulk]![Billing Address]
ElseIf Not IsNull(Forms![noi-bulk]![billing_add2]) And IsNull(Forms![noi-bulk]![Billing Address]) Then
VMail1 = Forms![noi-bulk]![billing_add2]
ElseIf Not IsNull(Forms![noi-bulk]![billing_add2]) And Not IsNull(Forms![noi-bulk]![Billing Address]) Then
VMail1 = Forms![noi-bulk]![Billing Address] & ", " & Forms![noi-bulk]![billing_add2]
End If

If Not IsNull(Forms![noi-bulk]![billing_add3]) And IsNull(Forms![noi-bulk]![billing_add4]) Then
VMail2 = Forms![noi-bulk]![billing_add3]
ElseIf Not IsNull(Forms![noi-bulk]![billing_add4]) And IsNull(Forms![noi-bulk]![billing_add3]) Then
VMail2 = Forms![noi-bulk]![billing_add4]
ElseIf Not IsNull(Forms![noi-bulk]![billing_add4]) And Not IsNull(Forms![noi-bulk]![billing_add3]) Then
VMail2 = Forms![noi-bulk]![billing_add3] & ", " & Forms![noi-bulk]![billing_add4]
End If

End If


With rsnotice
VIDNo = GetAutoNumber("NextWalz")

.AddNew

!NoticeTo = Forms![noi-bulk]!firstdebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!firstdebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = "OneWest Bank, FSB"
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = "Mandy Nelson"
!NoticeCITY = "Kalamazoo"
!NoticeSTATE = "MI"
!NoticeZIP = "49003-4045"
!ri = "ENV"
!pdffile = ""
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!firstdebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If


If IsNull(Forms![noi-bulk]!secondDebtor) Or Forms![noi-bulk]!secondDebtor = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!secondDebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!secondDebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!secondDebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeAdd = Forms![noi-bulk]![billing_add4]
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If


If IsNull(Forms![noi-bulk]!thirddebtor) Or Forms![noi-bulk]!thirddebtor = "" Then

Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!thirddebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!thirddebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!thirddebtor
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If

If IsNull(Forms![noi-bulk]!owner1) Or Forms![noi-bulk]!owner1 = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner1
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With


If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner1
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner1
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If

If IsNull(Forms![noi-bulk]!owner2) Or Forms![noi-bulk]!owner2 = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner2
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner2
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner2
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If

If IsNull(Forms![noi-bulk]!owner3) Or Forms![noi-bulk]!owner3 = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner3
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner3
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!owner3
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If


If IsNull(Forms![noi-bulk]!Owner4) Or Forms![noi-bulk]!Owner4 = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner4
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner4
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner4
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If

If IsNull(Forms![noi-bulk]!Owner5) Or Forms![noi-bulk]!Owner5 = "" Then
Else
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner5
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![PropAddress]
!NoticeCITY = Forms![noi-bulk]!PropertyCity
!NoticeSTATE = Forms![noi-bulk]!PropertyState
!NoticeZIP = Forms![noi-bulk]!propzip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

If Not IsNull(Forms![noi-bulk]![sdat]) Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner5
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = Forms![noi-bulk]![sdat]
!NoticeCITY = Forms![noi-bulk]!SDatCity
!NoticeSTATE = Forms![noi-bulk]!SDatState
!NoticeZIP = Forms![noi-bulk]!SDatZip
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If

If Forms![noi-bulk]![mailing] = 1 Or Forms![noi-bulk]![mailing] = -1 Then
VIDNo = GetAutoNumber("NextWalz")
With rsnotice
.AddNew
!NoticeTo = Forms![noi-bulk]!Owner5
!filenum = Forms![noi-bulk]!LoanNo
!NoticeAdd = VMail1
!NoticeAdd2 = VMail2
!NoticeCITY = Forms![noi-bulk]![Billing City]
!NoticeSTATE = Forms![noi-bulk]![BILLING STATE]
!NoticeZIP = Forms![noi-bulk]![Billing Zip]
!ri = "NOIMDFlat"
!pdffile = VPDF
!reference = VIDNo
!StartPage = 1
!PageCount = "-1"
.Update
End With

End If
End If

End Function
Public Function NOIWalzCode()
Dim txtname As String

Call exportXMLBorrowers
Call NOILienholders

Call CreateWalzXML
Call CreateCompleteFile
End Function

Public Function NOICheck()
Dim txtname As String
Dim Vhamp

Vhamp = Forms![NOI Information Screen]!NOITabs.Form!HAMP

Call NOIScreenTabs

VLtr = "NOIMDFLAT"

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

If Client() Like "Seter*" Then
VConvRpt = "NOI-Cover-Seterus"
Else
VConvRpt = "NOI-Cover"
End If

Call ConvertPDF

If Forms![NOI Information Screen]!NOITabs.Form!Occupied = 5 Or _
Forms![NOI Information Screen]!NOITabs.Form!Occupied = 4 Then
VConvRpt = "NOI-Cover-Occ"
Call ConvertPDF
End If

Call NOI_AttachmentsVIEW

If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Else
txtname = dumpname & "_HopeHousing.pdf"
sourcefile = "\\rvdv-fs01\datatransfer\NOI_Application\NOICoverPage.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname
FileCopy sourcefile, destinationfile
End If

If (Vhamp = 2 Or Vhamp = 0 Or IsNull(Vhamp)) And (Forms![NOI Information Screen]!Client Like "Kondau*" Or _
Forms![NOI Information Screen]!Client Like "Nations Def*") Then
'If Forms![NOI Information Screen]!Client Like "Ditech*" Then
'VConvRpt = "LMOptionsGreentree"
'Call ConvertPDF
'ElseIf Forms![NOI Information Screen]!Client Like "Kondau*" Or _
'Forms![NOI Information Screen]!Client Like "Nations Defaul*" Then
VConvRpt = "LMOptions"
Call ConvertPDF
End If
'End If

VConvRpt = "NOIClientNewTabs"
Call ConvertPDF

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

'--------------




If (Vhamp = 2 Or Vhamp = 0 Or IsNull(Vhamp)) And (Forms![NOI Information Screen]!Client Like "Kondau*" Or _
Forms![NOI Information Screen]!Client Like "Nations Def*") Then

'If Forms![NOI Information Screen]!Client Like "Ditech*" Then
'VPDF = dumpname & "_NOI-Cover.pdf" & ";" & dumpname & "_HopeHousing.pdf" & ";" & dumpname & "_NOIClientNewTabs.pdf" & ";" & dumpname & "_LMAOptionsGreenTree.PDF" & ";" & dumpname & "_LMAOptions34.pdf" & ";" & NOI_Attachments
'Else
VPDF = dumpname & "_NOI-Cover.pdf" & ";" & dumpname & "_HopeHousing.pdf" & ";" & dumpname & "_NOIClientNewTabs.pdf" & ";" & dumpname & "_LMOptions.PDF" & ";" & NOI_Attachments
'End If

Else
If Forms![NOI Information Screen]!Client Like "Seter*" Then
VPDF = dumpname & "_NOI-Cover-Seterus.pdf" & ";" & dumpname & "_HopeHousing.pdf" & ";" & dumpname & "_NOIClientNewTabs.pdf" & ";" & dumpname & "_LMOptions.PDF" & ";" & NOI_Attachments
Else
VPDF = dumpname & "_NOI-Cover.pdf" & ";" & dumpname & "_HopeHousing.pdf" & ";" & dumpname & "_NOIClientNewTabs.pdf" & ";" & NOI_Attachments
End If
End If


'-------------

Call exportXMLBorrowers
Call NOILienholders

Call CreateWalzXML
Call CreateCompleteFile
End Function
Public Function NOSRecordOwner()

Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
strsqlLIEN = "select * from creditors where (record_owner = " & -1 & " or record_owner = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

Dim rsWalz As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "NOIMDFlat" Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
If Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!NoticeAdd2 = ""
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "NOIMDFlat" Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With


rsLienHolders.MoveNext
Loop

End If

End Function

Public Function NOILienholders()

Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
strsqlLIEN = "select * from creditors where (noi = " & -1 & " or noi = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

Dim rsWalz As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "NOIMDFlat" Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")
With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
!Name2 = ""
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!Address1 = Forms![foreclosure database screen]![PropAddress]
Else
!Address1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!Address2 = Forms![foreclosure database screen]!propaddress2
!address3 = ""
!citystatezip = Forms![foreclosure database screen]![PropertyCity] & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
If Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!NoticeAdd2 = ""
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "NOIMDFlat" Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With


rsLienHolders.MoveNext
Loop

End If

End Function
Public Function ROwnersLienholders()

Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
strsqlLIEN = "select * from creditors where (record_owner = " & -1 & " or record_owner = " & 1 & " or serve = " & 1 & " or serve = " & -1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

Dim rsWalz As RecordSet

Set rsWalz = CurrentDb.OpenRecordset("walzinfo", dbOpenDynaset, dbSeeChanges)
Set rs = CurrentDb.OpenRecordset("Walzxml", dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF

VNo = VNo + 1
VIDNo = GetAutoNumber("NextWalz")

With rsWalz
.AddNew
!ID_No = VIDNo
VcountLtr = VcountLtr + 1
!reference = Forms![foreclosure database screen]!filenum & VLtr & VcountLtr
If VLtr Like "FDL*" Then
If Forms![foreclosure database screen]!PropertyState = "VA" Then
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!PostageFeesReg = 0
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
Else
!PostageFees = 0
!ServiceFees = 0
!PostageFeesReg = 0
End If
!WalzDateUploaded = Date
If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate) Then
!bill_saledate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
End If
!ri = VLtr
!filenum = Forms![foreclosure database screen]!filenum
!Name1 = rsLienHolders!OrganizationName
If rsLienHolders!Address Like "Attn*" Or _
rsLienHolders!Address Like "For*" Or _
rsLienHolders!Address Like "c/o*" Or _
rsLienHolders!Address Like "Atten*" Then
!Name2 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address1 = ""
Else
!Address1 = rsLienHolders!Address2
End If
!address3 = ""
Else
!Name2 = ""
!Address1 = rsLienHolders!Address
If rsLienHolders!Address2 = "" Then
!Address2 = ""
Else
!Address2 = rsLienHolders!Address2
End If
!address3 = ""
End If
!citystatezip = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!reference = Forms![foreclosure database screen]!filenum & "lh" & VNo
.Update
End With

With rs
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!ri = VLtr
!pdffile = VPDF
!reference = VIDNo

If VLtr = "ACLVA" Then
!StartPage = VCntStart
!PageCount = 3
ElseIf VLtr Like "FDL*" Or VLtr = "HUD" Or VLtr = "OOMC" Or VLtr = "AMCHOT" Or VLtr = "NTQVa" Or _
VLtr = "VASB" Or VLtr = "ACLMD" Or VLtr = "ACLDC" Or (VLtr Like "NOTHUD*" And Forms![foreclosure database screen]!TypeOfLoan = "VA") Then
!StartPage = VCntStart
!PageCount = 2
ElseIf VLtr = "NOIMDFlat" Then
!StartPage = 1
!PageCount = "-1"
Else
!StartPage = VCntStart
!PageCount = 1
End If

.Update
End With

rsLienHolders.MoveNext
Loop

End If

End Function

