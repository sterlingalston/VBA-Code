Attribute VB_Name = "WordMergeDocs"

Option Compare Database

Public Function BondMerge()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "BondMerge"

Call FCMergePS

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Bond.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function DeedHudVA()
If Forms![foreclosure database screen]!PropertyState = "VA" And Forms![foreclosure database screen]!PostsaleSubForm.Form!subpurchaser <> "" Then
MsgBox ("Bid has been assigned.  Deed will not generate")
Exit Function
ElseIf Forms![foreclosure database screen]!Client Like "Select*" Then
Call DeedSPVa

Else
DoCmd.OpenReport "Deed-HUDVAQuit", acViewPreview
End If
End Function

Public Function DeedSPVa()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "DeedSPVa"

Call DeedMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\VA\Deed-HUDSpecialWarranty-SPS.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function DCMotionPublish()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "MotionPUB"

Call FCDCMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCMotiontopub.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function SeterusNOIPackage()

'Call OpenREFERRALScreen

Dim blRet As Boolean
' Call our Merge function
' Please note the PDF doc passed as the second param is merged into the PDF doc passed as the first param.
' For testing purposes:
Dim sMaster As String
Dim sChild As String

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")

Call RunNOILBPS762PDF
sMaster = "G:\SeterusNOIOnlyReferrals\NOIPackages\" & dumpname & "_NOISeterusPackage.PDF"


VConvRpt = "NOIPackageSeterus"
ConvertPDFALL
sourcefile = pathuser() & "NOIPackageSeterus.PDF"
destinationfile = "G:\SeterusNOIOnlyReferrals\NOIPackages\" & dumpname & "_NOI.PDF"
FileCopy sourcefile, destinationfile    ' Copy source to target.

sChild = destinationfile

blRet = MergePDFDocuments(sMaster, sChild)


sourcefile = "\\rvdv-fs01\datatransfer\NOI_Application\NOIPackageSeterusATTACHMENTS.PDF"
destinationfile = "G:\SeterusNOIOnlyReferrals\NOIPackages\" & dumpname & "_NOISeterusAttachments.PDF"
FileCopy sourcefile, destinationfile    ' Copy source to target.

sMaster = "G:\SeterusNOIOnlyReferrals\NOIPackages\" & dumpname & "_NOISeterusPackage.PDF"
sChild = destinationfile

blRet = MergePDFDocuments(sMaster, sChild)

FollowHyperlink (sMaster)

End Function
Public Function DeedHudDC()
If Forms![foreclosure database screen]!PropertyState = "VA" And Forms![foreclosure database screen]!PostsaleSubForm.Form!subpurchaser <> "" Then
MsgBox ("Bid has been assigned.  Deed will not generate")
Exit Function
Else
'If Forms![foreclosure database screen]!Client Like "Select Port*" Then
'Call RunDeedSWDC

'Else
DoCmd.OpenReport "Deed-HUDDCSP", acViewPreview
'End If

End If
End Function

Public Function DCConsentMotionJudge()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "MotionLS"

Call FCDCMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCConsentMotionJudge.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function RunMotionLiftStay()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "MotionLS"

Call FCDCMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCMotionTermStay.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function


Public Function RunMSJDC()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "DeedSWDC"

Call FCDCMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCMSJ.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function RunDeedSWDC()
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

VTypeMerge = "DeedSWDC"

Call FCDCMerge

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DeedDC-SPS.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function BANAResLtr()
VTypeMerge = "BANAResLtr"
Call FCDCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\BANARescissionNotice.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function

Public Function DCConsentForm()
VTypeMerge = "DCConsent"
Call FCDCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCConsentForm.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function


Public Function BKNOFCAgr()
VTypeMerge = "BKNOFCAgr"
Call BkMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\NOFCnewagree.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function


Public Function BKNOFCDel()
VTypeMerge = "BKNOFCDel"
Call BkMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\NOFCnewdelinquent.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function
Public Function BKPCNForms()
VTypeMerge = "BKPCN"
Call BkMergePOC

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PCN.docx", , , True)

DoCmd.TransferText acExportDelim, , "bkmergepoc", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function
Public Function BKPPFNForms()
VTypeMerge = "BKPCN"
Call BkMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PPFN.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function



Public Function BKPOCForms()
VTypeMerge = "BKPOCForms"
Call BkMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\POCForms.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function

Public Function BKPlanReview()
VTypeMerge = "DCSuggestion"
Call BkMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlanReviewTemplate.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function

Public Function DCSuggestionBK()
VTypeMerge = "DCSuggestion"
Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCSuggestionBK.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function

Public Function FCMergeMultiBorrow()
'=runmilaff()
Call FCMerge
Dim rs As RecordSet
Dim debtorCOUNcloseT As Double
Dim i As Double

If Len(firstdebtor) > 0 Then debtorCOUNT = debtorCOUNT + 1
If Len(secondDebtor) > 0 Then debtorCOUNT = debtorCOUNT + 1
If Len(thirddebtor) > 0 Then debtorCOUNT = debtorCOUNT + 1

Set rs = CurrentDb.OpenRecordset("fcmerge", dbOpenSnapshot)

For i = 1 To debtorCOUNT
    CurrentDb.Execute ("select * into fcmerge" & i & " from fcmerge")
    CurrentDb.Execute ("alter table fcmerge" & i & " alter column [id] number")
    CurrentDb.Execute ("update fcmerge" & i & " set [id]=[id]+" & i & ", [borrowers] = " & """" & IIf(i = 1, firstdebtor, IIf(i = 2, secondDebtor, IIf(i = 3, thirddebtor, Null))) & """")
Next i

rs.Close
Set rs = Nothing

CurrentDb.Execute "DELETE * FROM fcmerge;", dbFailOnError

For i = 1 To debtorCOUNT
    CurrentDb.Execute ("insert into fcmerge select * from fcmerge" & i)
    CurrentDb.Execute ("drop table fcmerge" & i)
Next i

Call Kill(pathuser() & "fcmerge.txt")
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

End Function

Public Function SCRAfilingaffidavit()
VTypeMerge = "SCRAfilingaffidavit "

Call FCDCMerge
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\SCRAfilingPraecipe.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End Function

Public Function MDDCAgreedOrder()
VTypeMerge = "MdDcAgreedOrder"

Call BkMerge
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\MDDCAgreedOrderNew.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End Function
Public Function NTQVaMERGE()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
VLtr = "NTQVA"

VTypeMerge = "NTQVa"
Dim savepath As String

Call EvicMergeMulAdd

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\Eviction\NTQ-VA-BWW.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "evicmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
savepath = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & "_" & VDocName & ".PDF"
oDoc.Close False
oapp.Visible = False
End With

'================================
If oapp.Version < 12 Then
    MsgBox "Word 2007 or above not detected."
    Exit Function
End If
oapp.ActiveDocument.SaveAs savepath, 17
FollowHyperlink (savepath)

'==============================

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

'------------------------


'GblFilenum = Forms![foreclosure database screen]!FileNum
'Dim strsqlE
'Dim rsE As RecordSet
'strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
'Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

'If rsE!clientUpdatesVIA Like "Equato*" Then
'VConvRpt = "evictionscraletter"
'Call ConvertPDF
'VPDF = VPDF & ";" & dumpname & "_" & VConvRpt & ".pdf"
'End If

'rsE.Close


'------------------------
'Occupant Information Form
Dim txtname5
txtname5 = dumpname & "_OccupantInformationForm.pdf"

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > #1/1/2015# Then
'sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationFormBANA.pdf"
Else
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationForm.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname5
FileCopy sourcefile, destinationfile    ' Copy source to target.
VPDF = VPDF & ";" & txtname5
End If
'End Occupent Information Form

'Aldridge/OneWest
Dim txtname2

If Forms![foreclosure database screen]!Client Like "OneWes*" Or _
Forms![foreclosure database screen]!Client Like "Wells*" Then

txtname2 = dumpname & "_NTQVAAttach2.pdf"

If Forms![foreclosure database screen]!Client Like "OneWes*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OWBSCRANotice.pdf"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\WellsSCRANotice.pdf"
End If

destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPDF = VPDF & ";" & txtname2

End If
If Forms![foreclosure database screen]!Client Like "Homeward*" Then
Call ImageNTQVAHomeward
VPDF = VPDF & ";" & VPDFxml
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call exportXMLBorrowersNTQ
Call CreateWalzXML
Call CreateCompleteFile

'Call NTQVaOcc

MsgBox ("Notices Sent to Walz")

End Function

Public Function NTQVaOccMERGE()

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
VLtr = "NTQVAOcc"

VTypeMerge = "NTQVaOcc"
Dim savepath As String

Call EvicMergeMulAdd

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\Eviction\NTQ-VAOcc-BWW.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "evicmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
savepath = "\\rvdv-fs01\DataTransfer\Walz\ToWalz\" & dumpname & "_" & VDocName & ".PDF"
oDoc.Close False
oapp.Visible = False
End With

'================================
If oapp.Version < 12 Then
    MsgBox "Word 2007 or above not detected."
    Exit Function
End If
oapp.ActiveDocument.SaveAs savepath, 17
FollowHyperlink (savepath)

'==============================

If VCancelDump = 1 Then
MsgBox ("Will not create Letters for WALZ!  Need to click on link (\\rvdv-fs01\netlogon\copydll.bat) to copy .dll files")
Exit Function
End If

'------------------------

'------------------------
'Occupant Information Form
Dim txtname5
txtname5 = dumpname & "_OccupantInformationForm.pdf"

If Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate > #1/1/2015# Then
'sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationFormBANA.pdf"
Else
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OccupantInformationForm.pdf"
destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname5
FileCopy sourcefile, destinationfile    ' Copy source to target.
VPDF = VPDF & ";" & txtname5
End If
'End Occupent Information Form

'Aldridge/OneWest
Dim txtname2

If Forms![foreclosure database screen]!Client Like "OneWes*" Or _
Forms![foreclosure database screen]!Client Like "Wells*" Then

txtname2 = dumpname & "_NTQVAAttach2.pdf"

If Forms![foreclosure database screen]!Client Like "OneWes*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\OWBSCRANotice.pdf"
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
sourcefile = "\\rvdv-fs01\datatransfer\attachments\WellsSCRANotice.pdf"
End If

destinationfile = DTLocation & "\WALZ\ToWalz\" & txtname2
FileCopy sourcefile, destinationfile    ' Copy source to target.

VPDF = VPDF & ";" & txtname2

End If
If Forms![foreclosure database screen]!Client Like "Homeward*" Then
Call ImageNTQVAHomeward
VPDF = VPDF & ";" & VPDFxml
End If

CurrentDb.Execute "DELETE * FROM walzxml;", dbFailOnError
Call ExportXMLOccupantsEvic
Call CreateWalzXML
Call CreateCompleteFile

'Call NTQVaOcc

MsgBox ("Notices Sent to Walz")

End Function

Public Function NTQVaOccMulLtr()
VTypeMerge = "NTQVaOcc"

Call EvicMergeMulAdd


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\Eviction\NTQ-VA-BWW.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "evicmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function NTQVaMulLtr()
VTypeMerge = "NTQVa"

Call EvicMergeMulAdd


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\Eviction\NTQ-VA-BWW.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "evicmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function BKPaymentHistoryDCMD()

Call BkMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\MDDCBKPaymentHistory.doc", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function


Public Function WFTitleClaimSubmitionMerge()

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"
DoCmd.TransferText acExportDelim, , "WFTitleClaimSubmissionFrmQry", pathuser() & "wfmerge.txt", True
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String



oDoc = "WFTitleClaimSubmission.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\wfmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function DCProbateGuarantee()

VTypeMerge = "ProbGuaranteeDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\Probate\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "GuaranteeCosts.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function DCProbateAuthRep()

VTypeMerge = "ProbAuthRepDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\Probate\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "AuthorizationRepresentation.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function DCProbateAddendum()

VTypeMerge = "ProbAddDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\Probate\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "Addendum.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function


Public Function SOTOnlyDC()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "SOTDC.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function SOTDCPenny()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DOAMasterPennyMacDC.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function


Public Function SOTDCOcwen()

VTypeMerge = "SOTDC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

oDoc = "DOAMasterOcwenDC.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function SOTDCnonWFSP()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "DOAMasterDCWF-nonWFSP.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function AuctionDCSetSale()


VTypeMerge = "AuctionDCSetSale"


Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\fc\dc\AlexCooperDC.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With


With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
savepath = pathuser() & "AuctionDC_" & Forms![dcsetsales]!filenum & ".PDF"

oDoc.Close False
oapp.Visible = False
End With

'================================
If oapp.Version < 12 Then
    MsgBox "Word 2007 or above not detected."
    Exit Function
End If

oapp.ActiveDocument.SaveAs savepath, 17

'FollowHyperlink (savepath)



End Function


Public Function AuctionDC()


VTypeMerge = "AuctionDC"


Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\fc\dc\AlexCooperDC.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function

Public Function SOTDCWF()

VTypeMerge = "SOTDC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "DOAMasterDCWF.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function SOTDCSuntrust()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "DOAMasterDCSunTrust.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function


Public Function SOTDCSLS()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "DOAMasterDCSLS.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function


Public Function SOTDCCarrington()

VTypeMerge = "SOTDC"


Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DOAMasterDCCarrington.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function BKMergeTextTrans()

Call BkMerge
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

End Function

Public Function FredCoTransPropMerge()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document

On Error GoTo handler
CurrentDb.Execute ("delete from fredcoproptransmergetbl")
DoCmd.OpenQuery ("fredcoproptransmergeqry")

DoCmd.TransferText acExportDelim, , "fredcoproptransmergetbl", pathuser() & "fredcoproptransmerge.txt", True

Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\Frederick County Property Transfer.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fredcoproptransmerge.txt"
End With


With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


Exit Function

handler:

Exit Function

End Function

Public Function FCMergeMulAdd()

Dim rsnotices As RecordSet
Dim rsfcmerge As RecordSet
Dim i As Integer
Dim k As Integer




Call FCMerge

If VTypeMerge = "dcconsent" Then
Call CertDebtorsOwnersAttRecExtra
ElseIf VTypeMerge = "NTQVa" Then
Call ExportNTQVa
ElseIf VTypeMerge = "CitiSaleCan" Then
Call CertDebtorsOwners
ElseIf VTypeMerge = "AuctionDC" Then

End If




CurrentDb.Execute ("select * into fccmergeertserv from fcmerge")
CurrentDb.Execute ("delete * from fccmergeertserv")

Set rsnotices = CurrentDb.OpenRecordset("Notices", , dbOpenForwardOnly)
'Set rsfcmerge = CurrentDb.OpenRecordset("fcmerge", dbOpenForwardOnly)

Do While Not rsnotices.EOF
i = i + 1

sql = "select * into fcmergemulti" & i & " from [fcmerge]"
CurrentDb.Execute sql, dbFailOnError

'run updating
'NoticeTo,NoticeAdd,NoticeAdd2,NoticeCSZ
sql = "update fcmergemulti" & i & " set  [NoticeTo] = " & """" & rsnotices("noticeto").Value & """" & ", [NoticeAdd] = " & """" & rsnotices("noticeadd").Value & """" & ", [NoticeAdd2] = " & """" & _
    rsnotices("NoticeAdd2").Value & """" & ", [NoticeCSZ] = " & """" & rsnotices("NoticeCSZ").Value & """"

CurrentDb.Execute sql, dbFailOnError
sql = "alter table fcmergemulti" & i & " alter column [id] number"

CurrentDb.Execute sql, dbFailOnError
'resume here
sql = "update fcmergemulti" & i & " set  [ID] = [ID] + " & i

CurrentDb.Execute sql, dbFailOnError
sql = "insert into fccmergeertserv select * from fcmergemulti" & i


CurrentDb.Execute sql, dbFailOnError

rsnotices.MoveNext

Loop

For k = i To 1 Step -1
    sql = "drop table fcmergemulti" & k
    CurrentDb.Execute sql, dbFailOnError
Next k

rsnotices.Close
Set rsnotices = Nothing
'rsfcmerge.Close
'Set rsfcmerge = Nothing

DoCmd.TransferText acExportDelim, , "fccmergeertserv", pathuser() & "fcmerge.txt", True
CurrentDb.Execute "drop table fccmergeertserv", dbFailOnError
'DoCmd.TransferText acExportDelim, , "fcmerge", PathUSER() & "fcmerge.txt", True

End Function

Public Function FCMergeMulAddDC()

Dim rsnotices As RecordSet
Dim rsfcmerge As RecordSet
Dim i As Integer
Dim k As Integer




Call FCDCMerge

If VTypeMerge = "dcconsent" Then
Call CertDebtorsOwnersAttRecExtra
ElseIf VTypeMerge = "NTQVa" Then
Call ExportNTQVa
ElseIf VTypeMerge = "CitiSaleCan" Then
Call CertDebtorsOwners
ElseIf VTypeMerge = "AuctionDC" Then

End If




CurrentDb.Execute ("select * into fccmergeertserv from fcmerge")
CurrentDb.Execute ("delete * from fccmergeertserv")

Set rsnotices = CurrentDb.OpenRecordset("Notices", , dbOpenForwardOnly)
'Set rsfcmerge = CurrentDb.OpenRecordset("fcmerge", dbOpenForwardOnly)

Do While Not rsnotices.EOF
i = i + 1

sql = "select * into fcmergemulti" & i & " from [fcmerge]"
CurrentDb.Execute sql, dbFailOnError

'run updating
'NoticeTo,NoticeAdd,NoticeAdd2,NoticeCSZ
sql = "update fcmergemulti" & i & " set  [NoticeTo] = " & """" & rsnotices("noticeto").Value & """" & ", [NoticeAdd] = " & """" & rsnotices("noticeadd").Value & """" & ", [NoticeAdd2] = " & """" & _
    rsnotices("NoticeAdd2").Value & """" & ", [NoticeCSZ] = " & """" & rsnotices("NoticeCSZ").Value & """"

CurrentDb.Execute sql, dbFailOnError
sql = "alter table fcmergemulti" & i & " alter column [id] number"

CurrentDb.Execute sql, dbFailOnError
'resume here
sql = "update fcmergemulti" & i & " set  [ID] = [ID] + " & i

CurrentDb.Execute sql, dbFailOnError
sql = "insert into fccmergeertserv select * from fcmergemulti" & i


CurrentDb.Execute sql, dbFailOnError

rsnotices.MoveNext

Loop

For k = i To 1 Step -1
    sql = "drop table fcmergemulti" & k
    CurrentDb.Execute sql, dbFailOnError
Next k

rsnotices.Close
Set rsnotices = Nothing
'rsfcmerge.Close
'Set rsfcmerge = Nothing

DoCmd.TransferText acExportDelim, , "fccmergeertserv", pathuser() & "fcmerge.txt", True
CurrentDb.Execute "drop table fccmergeertserv", dbFailOnError
'DoCmd.TransferText acExportDelim, , "fcmerge", PathUSER() & "fcmerge.txt", True

End Function

Public Function EvicMergeMulAdd()

Dim rsnotices As RecordSet
Dim rsfcmerge As RecordSet
Dim i As Integer
Dim k As Integer


Call EvicMerge

If VTypeMerge = "NTQVa" Then
Call ExportNTQVa
Set rsnotices = CurrentDb.OpenRecordset("Notices", , dbOpenForwardOnly)

ElseIf VTypeMerge = "NTQVaOcc" Then
Call ExportOccupants
Set rsnotices = CurrentDb.OpenRecordset("NoticesOccupants", , dbOpenForwardOnly)

End If


CurrentDb.Execute ("select * into evicmergecertserv from evicmerge")
CurrentDb.Execute ("delete * from evicmergecertserv")

'Set rsfcmerge = CurrentDb.OpenRecordset("fcmerge", dbOpenForwardOnly)

Do While Not rsnotices.EOF
i = i + 1

sql = "select * into evicmergemulti" & i & " from [evicmerge]"
CurrentDb.Execute sql, dbFailOnError

'run updating
'NoticeTo,NoticeAdd,NoticeAdd2,NoticeCSZ
sql = "update evicmergemulti" & i & " set  [NoticeTo] = " & """" & rsnotices("noticeto").Value & """" & ", [NoticeAdd] = " & """" & rsnotices("noticeadd").Value & """" & ", [NoticeAdd2] = " & """" & _
    rsnotices("NoticeAdd2").Value & """" & ", [NoticeCSZ] = " & """" & rsnotices("NoticeCSZ").Value & """"

CurrentDb.Execute sql, dbFailOnError
sql = "alter table evicmergemulti" & i & " alter column [id] number"

CurrentDb.Execute sql, dbFailOnError
'resume here
sql = "update evicmergemulti" & i & " set  [ID] = [ID] + " & i

CurrentDb.Execute sql, dbFailOnError
sql = "insert into evicmergecertserv select * from evicmergemulti" & i


CurrentDb.Execute sql, dbFailOnError

rsnotices.MoveNext

Loop

For k = i To 1 Step -1
    sql = "drop table evicmergemulti" & k
    CurrentDb.Execute sql, dbFailOnError
Next k

rsnotices.Close
Set rsnotices = Nothing
'rsfcmerge.Close
'Set rsfcmerge = Nothing

DoCmd.TransferText acExportDelim, , "evicmergecertserv", pathuser() & "evicmerge.txt", True
CurrentDb.Execute "drop table evicmergecertserv", dbFailOnError
'DoCmd.TransferText acExportDelim, , "fcmerge", PathUSER() & "fcmerge.txt", True

End Function
Public Function BKChangeOfAddress()

Call BkMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\ChangeofAddress.docx", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function BKMFRWithdrawalMD()

Call BkMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\MDDCBK.NoticeofWithdrawalofMFR.doc", , , True)
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function BKMFRBlank()

Call BkMergeMFR


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\Template.Blank Motion.docx", , , True)

DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function CitiSaleCanMulLtr()
VTypeMerge = "CitiSaleCan"

Call FCMergeMulAdd


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiFCSaleCancel.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function DCConsentMerge()
VTypeMerge = "DCConsent"

Call FCMergeMulAddDC


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCConsentletter.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function Interpleader()
'Interpleaderpetition

VTypeMerge = "INTERP"

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\Interpleaderpetition.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function

Public Function DCMotionDismiss()

VTypeMerge = "DCMotionDism"

Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCMotionDismiss.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function StipDismissal()

VTypeMerge = "DCConsentMotionDism"

Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCStipDismissal.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function

Public Function ConsentMotionDismiss()

VTypeMerge = "DCConsentMotionDism"

Call FCDCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCConsentMotionDismiss.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function
Public Function ExportCitiLivingReqForm()

DoCmd.TransferText acExportDelim, , "CitiLivingFileReqMetFrmMergeQry", pathuser() & "citilivingreqmet.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document

Set oapp = CreateObject("word.application")
'Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\CitiLivingReqMetTemplate.doc", , , True)
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\CitiLivingReqMetTemplate2.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "citilivingreqmet.txt"
End With


With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With

Call WordMerge2PDF(oapp)

End Function
Public Function Testing()
'CitiAbandonedFCNotice-Treasurer
VTypeMerge = "VAComm"

Call LtrMergeVAComm

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


'If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\EquityTrusteesLetterWordMerge.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With


End Function
Public Function VaCommissionerLetter()
'CitiAbandonedFCNotice-Treasurer
VTypeMerge = "VAComm"

Call LtrMergeVAComm

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


'If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\EquityTrusteesLetterWordMerge.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function MobileHomeAOL()
VTypeMerge = "MobileHomeAOL"

Call LtrMergeMH

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


'If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\MobileHome\AOLTemplate.docx", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End Function

Public Function RunLetterAbandonedFCNoticeTreasurer()
'CitiAbandonedFCNotice-Treasurer
VTypeMerge = "AbanFCNotTreas"

Call LtrMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


'If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\CitiAbandonedFCNotice-Treasurer.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
'word merge for Baltimore intake
Public Function BaltimoreIntakeNadel()

'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "BaltimoreIntake"

Call FCBaltimoreIntakeMergeNadel


Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "BaltimoreIntake.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

'word merge for Baltimore intake
Public Function BaltimoreIntake()

'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "BaltimoreIntake"

Call FCBaltimoreIntakeMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "BaltimoreIntake.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function FCBaltimoreIntakeMergeNadel()
 
CurrentDb.Execute ("delete * from fcmerge")

DoCmd.OpenQuery ("Baltimore_IntakeQryNadel")

Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("fcmerge", dbOpenDynaset, dbSeeChanges)
Dim cladd, vaadd, Vpurc



DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True
rs.Close


End Function

Public Function FCBaltimoreIntakeMerge()
 
CurrentDb.Execute ("delete * from fcmerge")

DoCmd.OpenQuery ("Baltimore_IntakeQry")

Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("fcmerge", dbOpenDynaset, dbSeeChanges)
Dim cladd, vaadd, Vpurc

cladd = ClientAdd()
vaadd = "SECRETARY OF VETERANS AFFAIRS, located at the Department of Veteran's Affairs Regional Office, Loan Guarantee Program, Federal Building, 31 Hopkins Plaza, Baltimore, MD  21201"

If Forms![foreclosure database screen]!TypeOfLoan = "VA" And (Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party] = 0 Or _
IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![3rd_party])) Then
Vpurc = vaadd
ElseIf Forms![foreclosure database screen]!PostsaleSubForm.Form!Buyer Like "Federal Nationa*" Then
Vpurc = Purchaser() & ", " & purchaseradd()
ElseIf Forms![foreclosure database screen]!PostsaleSubForm.Form!Buyer = "REO" Then
Vpurc = LSecured() & ", c/o " & Trim(Client()) & ", " & [cladd]
Else
Vpurc = Purchaser() & ", " & purchaseradd()
End If

With rs
.Edit
!ClientAdd = Vpurc
.Update
End With



DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True
rs.Close


End Function

Public Function SOTDC()

VTypeMerge = "SOTDC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

If Client() Like "Specialized*" Then
oDoc = "DOAMasterDCSLS.doc"
ElseIf Client() Like "Carring*" Then
oDoc = "DOAMasterDCCarrington.doc"
ElseIf Client() Like "Nationsta*" Then
oDoc = "SOTDCNationstar.doc"
ElseIf Client() Like "Sun*" Then
oDoc = "DOAMasterDCSunTrust.doc"

ElseIf Client() Like "Wells*" Then
If Forms![foreclosure database screen]!SPsigns = -1 Or Forms![foreclosure database screen]!SPsigns = 1 Then
oDoc = "DOAMasterDCWF-nonWFSP.doc"
Else
oDoc = "DOAMasterDCWF.doc"
End If

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
oDoc = "DOAMasterOcwenDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then
oDoc = "DOAMasterCitiDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
oDoc = "DOAMasterOcwenDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Select Port*" Then
oDoc = "SOTDCSPS.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Pennymac*" Then
oDoc = "DOAMasterPennyMacDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
oDoc = "DOAMasterChaseDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
oDoc = "DOAMasterChaseDC.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then
If Forms![foreclosure database screen]!TypeOfLoan Like "CONV*" And Forms![foreclosure database screen]!SPsigns = 1 Or Forms![foreclosure database screen]!SPsigns = -1 Then
oDoc = "DOAMasterBANADC-PrivateInvestors.doc"
Else
oDoc = "DOAMasterBANADC.doc"
End If

Else
oDoc = "SOTDC.doc"
End If

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges


End Function

Public Function DCLMInComplete()
VTypeMerge = "DCLMInComplete"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCInitialStatementIncomplete.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End Function

Public Function DCLMComplete()
VTypeMerge = "DCLMComplete"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCInitialStatementComplete.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End Function


Public Function TrusteesDeedDC()
VTypeMerge = "TrusteesDeedDC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
If Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
oDoc = "TrusteesDeedDC-GSE.docx"
Else
oDoc = "TrusteesDeedDC.doc"
End If

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End Function
Public Function DCLisPenden()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCLisPenden"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCLisPendens.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function

Public Function DCCMS()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCCMD"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "CMS.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function

Public Function DCDILLisPenden()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCDilLisPenden"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCLisPendensRelease.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function


Public Function DCVerifiedROS()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCVerifiedROS"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCVerifiedROS.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function

Public Function DCMotionExtendTimeMerge()
'DCMotionExtendTime2
VTypeMerge = "DCMOTExt"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String


oDoc = "DCMotionExtendTime5.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

''Second Debtor
'If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
'oDoc = "DCMotionExtendTime2.doc"

'Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
'wrddoc.MailMerge.OpenDataSource (PathUSER() & "\fcmerge.txt")
'Set wrdMailMerge = wrddoc.MailMerge
'wrdMailMerge.Destination = wdSendToNewDocument
'' --- Perform MAIL MERGE --- '
'wrdMailMerge.Execute True
'wrddoc.Close wdDoNotSaveChanges
'End If

''Third Debtor
'If Forms![foreclosure database screen]!LastNameDebtor3 <> "" Then
'oDoc = "DCMotionExtendTime3.doc"

'Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
'wrddoc.MailMerge.OpenDataSource (PathUSER() & "\fcmerge.txt")
'Set wrdMailMerge = wrddoc.MailMerge
'wrdMailMerge.Destination = wdSendToNewDocument
'' --- Perform MAIL MERGE --- '
'wrdMailMerge.Execute True
'wrddoc.Close wdDoNotSaveChanges
'End If

'Fourth Debtor
If Forms![foreclosure database screen]!lastnamedebtor4 <> "" Then
oDoc = "DCMotionExtendTime2.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End If

'Fifth Debtor
If Forms![foreclosure database screen]!lastnamedebtor5 <> "" Then
oDoc = "DCMotionExtendTime2.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End If






End Function
Public Function DCBondPraecipe()
VTypeMerge = "DCBondPraecipe"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCBondPraecipe.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function DCMotionDefMerge()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCMotionDef"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCMotionDefaultJudge.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges




End Function

Public Function DCAffVCMerge()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCAffVC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\dc\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCAffVerifyComplaint.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function
Public Function DCMotRat()
VTypeMerge = "DCMotRat"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCMotRat.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End Function
Public Function BWWRegConfirm()
VTypeMerge = "BWWRegConfirm"
Call LtrMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\BWWNOIRegistrationConfirm.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function

Public Function FHLMCProtest()
VTypeMerge = "FHLMCProtest"
Call LtrMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\FHLMCProtest.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function

Public Function SOTCoverVA()
VTypeMerge = "SOTCoverVA"
Call LtrMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTRecordingCoverLetter.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function
Public Function AOMCoverVA()
VTypeMerge = "AOMCoverVA"
Call LtrMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AOMRecordingCoverLetter.docx", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function


Public Function DCMotionSubPlaintiff()
VTypeMerge = "DCMotionSubPl"
Call FCDCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCMotionSubPlaintiff.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If
End Function
Public Function ComplaintMerge()

VTypeMerge = "ComplaintDC"

Call FCDCMerge
'RequestTerminationInterest

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

'If Forms![foreclosure database screen]!Client Like "Carring*" Then
'oDoc = "ComplaintDC-Carrington.doc"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
oDoc = "COMPLAINTDCWellsFargo.doc"
ElseIf Forms![foreclosure database screen]!Client Like "Nationsta*" Then
oDoc = "COMPLAINTDCNationstar.doc"
ElseIf Forms![foreclosure database screen]!Client Like "pennymac*" Then
oDoc = "COMPLAINTDCpennymac.doc"
ElseIf Forms![foreclosure database screen]!Client Like "ocwen*" Then
oDoc = "COMPLAINTDCOcwen.doc"
ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
oDoc = "COMPLAINTDCSLS.doc"
ElseIf Forms![foreclosure database screen]!Client Like "Select Port*" Then
oDoc = "COMPLAINTDCSPS.doc"
ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
oDoc = "ComplaintDCChase.doc"

Else

VAss = MsgBox("Is Assignment Required?", vbYesNo)

If VAss = vbYes Then
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
If Forms![foreclosure database screen]!TypeOfLoan Like "CONV*" And Forms![foreclosure database screen]!SPsigns = 1 Or Forms![foreclosure database screen]!SPsigns = -1 Then
oDoc = "COMPLAINTDC-BANA-FINAL-Assignment-PRIVATE-INVESTORS.doc"
Else
oDoc = "COMPLAINTDC-BANA-FINAL-Assignment.doc"
End If

Else
oDoc = "ComplaintDC-Assignment.doc"
End If

Else
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
If Forms![foreclosure database screen]!TypeOfLoan Like "CONV*" And Forms![foreclosure database screen]!SPsigns = 1 Or Forms![foreclosure database screen]!SPsigns = -1 Then
oDoc = "COMPLAINTDC-BANA-FINAL-PRIVATE-INVESTORS.doc"
Else
oDoc = "COMPLAINTDC-BANA-FINAL.doc"
End If

Else
oDoc = "COMPLAINTDC.doc"
End If

End If

End If

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function DCNoticeDis()

'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "DCNoticeDis"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "DCNoticeDismissal.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function DCAdMerge()
'If Forms![foreclosure database screen]!status = "DC Judicial" Then
VTypeMerge = "AdDC"

Call FCDCMerge

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\DC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "AdDC.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

'Else

'DoCmd.OpenReport "AdDC", acViewPreview

'End If


End Function

Public Function CoopMergeReq()
VTypeMerge = "Coop"

Call FCMerge
'RequestTerminationInterest

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\Coop\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "RequestMembershipCertificate.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function CoopMergeTerm()
VTypeMerge = "Coop"

Call FCMerge


Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath


AppPath = "\\rvdv-fs01\datatransfer\Templates\Coop\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "RequestTerminationInterest.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function ProbatePetitionPDF()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Templates\FC\DC\Probate\PetitionforProbate-ADM.PDF")

End Function
Public Function EastonOrd()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\eastonordinance.PDF")

End Function
Public Function AffVacant()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\AffVacant.PDF")

End Function
Public Function AffMort()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\AffMortOccupied.PDF")

End Function
Public Function AffNonMort()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\AffOccNotMortgagor.PDF")

End Function
Public Function AffUnknown()
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\AffOccUnknown.PDF")

End Function

Public Function OcwenChkLists()

Dim strsql As String
Dim rs As RecordSet
Dim rsOC
strsql = "select * from OcwenChecklist where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
        
    If rs.EOF Then
    Set rsOC = CurrentDb.OpenRecordset("OcwenChecklist", dbOpenDynaset, dbSeeChanges)
    With rsOC
    .AddNew
    !filenum = Forms![foreclosure database screen]![filenum]
    .Update
    .Close
    End With
    End If
 rs.Close
 

  DoCmd.OpenForm "Ocwen Checklists"
 
End Function
Function Ratio(num As Long, den As Long) As String

  Dim num1 As Long
  Dim num2 As Long
  Dim num3 As Long
  Dim quot As Integer

  num1 = num
  num2 = den
  
  Do
    If num2 > num1 Then
      num3 = num1f
      num1 = num2
      num2 = num3
    End If
    
    quot = Int(num1 / num2)
    num1 = num1 Mod num2
  
  Loop Until num1 = 0
  Ratio = num / num2 & ":" & den / num2



End Function

Public Function MFRResolution()


If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!relief_ord = 1 Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!relief_ord = -1 Or _
Forms!bankruptcymain!BankruptcySubForm!chapter <> "7" Then

Dim strsql As String
Dim rsbkar As RecordSet


strsql = "select * from bkordrelief where bkfileno = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rsbkar = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsbkar.EOF Then
rsbkar.Close
Set rsbkar = CurrentDb.OpenRecordset("bkordrelief", dbOpenDynaset, dbSeeChanges)
With rsbkar
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!bkfileno = Forms!bankruptcymain!BankruptcySubForm.Form!counter
.Update
.Close
End With
End If


Call OrdReliefScrPrintOut



End If



End Function
Public Function MFRVA()

DoCmd.RunMacro ("MotionRelief")

End Function
Public Function WellsSaleCerts()
Call BasicMergeFC

'DoCmd.RunMacro ("exportfcmerge")
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim Vlump, vStip, VIncarr, VattAdd, VPropSur, VLumpAmt2

AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "Wells48hourpresalecerts.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function OrdWithDraw()
'MFR Withdrawal Notice
'MFR Withdrawal Order

Call BkMergeORD
'DoCmd.RunMacro ("exportbkmergeord")
DoCmd.TransferText acExportDelim, , "bkmergeord", pathuser() & "bkmerge.txt", True

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim Vlump, vStip, VIncarr, VattAdd, VPropSur, VLumpAmt2

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\MFR.NODordertemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "WITHDRAWALORDER.MFR.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges







End Function

Public Function MFRWithDraw()
'MFR Withdrawal Notice
'MFR Withdrawal Order

Call BkMergeORD
'DoCmd.RunMacro ("exportbkmergeord")
DoCmd.TransferText acExportDelim, , "bkmergeord", pathuser() & "bkmerge.txt", True

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim Vlump, vStip, VIncarr, VattAdd, VPropSur, VLumpAmt2

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\MFR.NODordertemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
oDoc = "WITHDRAWALNOTICE.MFR.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges







End Function

Public Function OrdReliefScrPrintOut()

If ([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!relief_ord = 1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!relief_ord = -1) Then

DoCmd.OpenForm "ordergrantingrelief"

Else

Call BkMergeORD
'DoCmd.RunMacro ("exportbkmergeord")
DoCmd.TransferText acExportDelim, , "bkmergeord", pathuser() & "bkmerge.txt", True

Dim VJuris
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim Vlump, vStip, VIncarr, VattAdd, VPropSur, VLumpAmt2

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\MFR.NODordertemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

Vlump = 0
vStip = 0
VIncarr = 0
VPropSur = 0
VLumpAmt2 = 0
VJuris = BKJurisdiction()
'MsgBox (VJuris)

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum = 1 Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum = -1 Then
Vlump = 1
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!stip = 1 Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!stip = -1 Then
vStip = 1
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!incarr = 1 Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!incarr = -1 Then
VIncarr = 1
End If

VattAdd = [Forms]![foreclosure database screen]![BankruptcySubForm]!att_add1

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!property_sur = 1 Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!property_sur = -1 Then
VPropSur = 1
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_amt2 = 0 Or IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_amt2) Then
VLumpAmt2 = 0
Else
VLumpAmt2 = 1
End If


If BKChapter() <> "7" Then

If (VJuris Like "Norfol*" Or VJuris Like "Newport*") Then
'4
'MsgBox (Vlump & ": Stip: " & vStip & ": Arr:" & VIncarr & ": Lump2: " & VLumpAmt2)


If (Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 1) Or (vStip = 1 And Vlump = 0 And VIncarr = 0) Or _
(vStip = 1 And Vlump = 1 And VIncarr = 0) Then
oDoc = "NN.MOD.STIP.doc"
'5
ElseIf (Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 0) Or (VIncarr = 1 And vStip = 0 And Vlump = 0) Then
'MsgBox ("HERE")

oDoc = "NN.MOD.PORL.doc"
'6
ElseIf (Vlump = 1 And vStip = 0 And VIncarr = 1) Then
oDoc = "NN.MOD.PANDL.doc"
End If


ElseIf (VJuris Like "*WDVA") Then
'1

If (Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 1) Or (vStip = 1 And Vlump = 0 And VIncarr = 0) Or _
(vStip = 1 And Vlump = 1 And VIncarr = 0) Then
oDoc = "WD.MOD.STIP.doc"
'2
ElseIf (Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 0) Or (VIncarr = 1 And vStip = 0 And Vlump = 0) Then
oDoc = "WD.MOD.PORL.doc"
'3
ElseIf (Vlump = 1 And vStip = 0 And VIncarr = 1) Then
oDoc = "WD.MOD.PANDL.doc"
End If


ElseIf (VJuris Like "Richmond*" Or VJuris Like "Alexan*") Then
'7

If ((Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 1) Or _
(vStip = 1 And Vlump = 0 And VIncarr = 0) Or _
(vStip = 1 And Vlump = 1 And VIncarr = 0)) Then

If ((VattAdd Like "272 Bendi*" Or VattAdd Like "*11588*") Or _
(VPropSur = 0 Or IsNull(VPropSur)) And _
(Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "Bank of A*" Or _
Forms![foreclosure database screen]!Client Like "Citi*")) Then
oDoc = "AR.MOD.STIP+DEV.doc"
Else
'8
oDoc = "AR.MOD.STIP-DEV.doc"
End If
End If


'9
If (Vlump = 1 And vStip = 0 And VIncarr = 0 And VLumpAmt2 = 0) Or _
(vStip = 0 And Vlump = 0 And VIncarr = 1) Then

If ((VattAdd Like "272 Bendi*" Or VattAdd Like "*11588*") Or _
(VPropSur = 0 Or IsNull(VPropSur)) And _
(Forms![foreclosure database screen]!Client Like "Wells*" Or _
Forms![foreclosure database screen]!Client Like "Bank of A*" Or _
Forms![foreclosure database screen]!Client Like "Citi*")) Then
oDoc = "AR.MOD.PORL+DEV.doc"
Else
'10
oDoc = "AR.MOD.PORL-DEV.doc"
End If
End If


'11

If (Vlump = 1 And VIncarr = 1) Then
oDoc = "AR.MOD.PANDL+DEV.doc"
End If



End If



If oDoc = "" Then
MsgBox ("Data did not provide the correct criteria. Doc will not generate")
Else
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)

wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End If





Else
MsgBox ("This Jurisdiction/Data selection combination does not have a document set up")

End If
End If


End Function
Public Function BACCoDebtorMfrONLY()
Dim VChap
Dim VJuris

Call BkMergeMFR
'DoCmd.RunMacro ("exportbkmergeMFR")
DoCmd.TransferText acExportDelim, , "bkmergemfr", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\BACMFRTemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

VChap = BKChapter()
VJuris = BKJurisdiction()
VCo = cobk()


oDoc = "Co-DebtorMFR.doc"

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function

Public Function BACMfrONLY()
Dim VChap
Dim VJuris

Call BkMergeMFR
'DoCmd.RunMacro ("exportbkmergeMFR")
DoCmd.TransferText acExportDelim, , "bkmergeMFR", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\BACMFRTemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

VChap = BKChapter()
VJuris = BKJurisdiction()
VCo = cobk()

oDoc = "MFR.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function

Public Function BACMfr()
Dim VChap
Dim VJuris

Call BkMergeMFR
'DoCmd.RunMacro ("exportbkmergeMFR")
DoCmd.TransferText acExportDelim, , "bkmergeMFR", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\BACMFRTemplates\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

VChap = BKChapter()
VJuris = BKJurisdiction()
VCo = cobk()

'MsgBox (VChap & ":" & VJuris & ":" & VCo)

If VChap = "7" Then

If VJuris = "D.C." Then
oDoc = "BACMFR7DC.doc"
ElseIf VJuris Like "*EDVA" Then
oDoc = "BACMFR7EDVA.doc"
ElseIf VJuris Like "*WDVA" Then
oDoc = "BACMFR7WDVA.doc"

ElseIf VJuris Like "*Md" Then

If TotalBACBKArr > 0 Then
oDoc = "BACMFR7MD+Adv.doc"
Else
oDoc = "BACMFR7MD-ADV.doc"
End If

End If

ElseIf VChap = "13" And VJuris = "D.C." Then


oDoc = "BACMFR13DC.doc"


ElseIf VChap = "13" And VJuris Like "*Md" And VCo = "" Then

If TotalBACBKArr > 0 Then
oDoc = "BACMFR13MD+ADV.doc"
Else
oDoc = "BACMFR13MD-ADV.doc"
End If

ElseIf VChap = "13" And VJuris Like "*Md" And VCo <> "" Then

If TotalBACBKArr > 0 Then
oDoc = "BACMFR13MD.COD+ADV.doc"
Else
oDoc = "BACMFR13MD.COD-ADV.doc"
End If


ElseIf VChap = "13" And VJuris Like "*VA" Then
oDoc = "BACMFR13VA"

ElseIf VChap = "13" And VJuris Like "*Md" And VCo <> "" Then

If BKArrESCROW = 1 And TotalBACBKArr > 0 Then
oDoc = "BACMFR13WDVA.COD+ESC+ADV.doc"
ElseIf BKArrESCROW = 1 And TotalBACBKArr = 0 Then
oDoc = "BACMFR13WDVA.COD+ESC-ADV.doc"
ElseIf BKArrESCROW = 0 And TotalBACBKArr > 0 Then
oDoc = "BACMFR13WDVA.COD-ESC+ADV.doc"
ElseIf BKArrESCROW = 0 And TotalBACBKArr = 0 Then
oDoc = "BACMFR13WDVA.COD-ESC-ADV.doc"
End If
End If



Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function
Public Function BKArrESCROW()

DoCmd.OpenQuery "BKMergeArrPayExcel"
Set rsBKArr = CurrentDb.OpenRecordset("BKMergeArrPay")

If Not rsBKArr.EOF Then
If rsBKArr![co Amt] - rsBKArr!PIAmt = 0 Or _
IsNull(rsBKArr![co Amt] - rsBKArr!PIAmt) Then
BKArrESCROW = 0
Else
BKArrESCROW = 1
End If
Else
BKArrESCROW = 0

End If

rsBKArr.Close


End Function

Public Function TotalBACBKArrDEC()

DoCmd.OpenQuery "BKMergePPFeesExcelDEC"
Set rsBKPPFees = CurrentDb.OpenRecordset("BKMergePPFees")

If Not rsBKPPFees.EOF Then
Do While Not rsBKPPFees.EOF
TotalBACBKArrDEC = rsBKPPFees!BACFee + TotalBACBKArr
rsBKPPFees.MoveNext
Loop
End If
rsBKPPFees.Close

'MsgBox (TotalBACBKArrDEC)


End Function


Public Function TotalBACBKArr()

DoCmd.OpenQuery "BKMergePPFeesExcel"
Set rsBKPPFees = CurrentDb.OpenRecordset("BKMergePPFees")

TotalBACBKArr = 0

If Not rsBKPPFees.EOF Then

Do While Not rsBKPPFees.EOF
'MsgBox ("HERE")
If Not IsNull(rsBKPPFees!BACFee) Then
TotalBACBKArr = rsBKPPFees!BACFee + TotalBACBKArr
End If

rsBKPPFees.MoveNext
Loop

Else

TotalBACBKArr = 0

End If

'MsgBox (TotalBACBKArr)

rsBKPPFees.Close



End Function
Public Function NoticeMerge()

Call ExportFCCert
Call ExportOccupantsEvic
Call ExportLienholderAR

DoCmd.RunMacro ("exportNOTICEmerge")
DoCmd.TransferText acExportDelim, , "notices", pathuser() & "noticemerge.txt", True

DoCmd.OutputTo acOutputReport, "CertServiceEvicMdMP", acFormatRTF, "c:\4closure\NOTICEMerge.rtf"


End Function
Public Function EvicMergeMD()
 

CurrentDb.Execute "Delete * from evicmerge;", dbFailOnError
DoCmd.OpenQuery ("evicbasicmerge")
Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


Set rs = CurrentDb.OpenRecordset("evicmerge", dbOpenDynaset, dbSeeChanges)
GblFilenum = Forms![foreclosure database screen]![filenum]

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)
Dim VDueth
Dim VDayDue

Dim VDate

Call NoticeMerge

With rs
.Edit

VdueDay = Format(Date, "d")
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice]) Then
!SalePrice = "___________________"
Else
!SalePrice = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice], "$###,##0.00")
End If

If Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD Then
!ratdate = "______________"
Else
!ratdate = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD, "mmmm dd, yyyy")
End If

!trialhearing = EvicVATRIALHearing()
VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"
!Occ1 = Occupant1()
!Occ2 = Occupant2()
!Occ3 = Occupant3()
!Occ4 = Occupant4()
!Today = Format(Date, "mmmm dd, yyyy")
!todayday = Format(Date, "dd")
!todaymonthyear = Format(Date, "mmmm, yyyy")
!dayth = VDueth

!taxid = Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid
!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")

'Paragraph#4 on Motion Poss for Maryland
If Not IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form![DeedRecorded]) Then
!rerecorded = "recorded among the land record of " & County() & " on or about " & Format(Forms![foreclosure database screen]![PostsaleSubForm].Form![DeedRecorded], "mmmm dd, yyyy")
ElseIf IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form![DeedRecorded]) And _
Not IsNull(Forms![foreclosure database screen]![PostsaleSubForm].Form![deed_sent_recording]) Then
!rerecorded = "sent to be recorded among the land record of " & County() & " on or about " & Format(Forms![foreclosure database screen]![PostsaleSubForm].Form![deed_sent_recording], "mmmm dd, yyyy")
End If
'End Para #4

!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!dateyear = "20__"
!liberfolio = liberfolio()
![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()

'Paragraph #8
Dim VMotion
VMotion = InputBox("1. Mortgagor Occupied Motion" & vbCr & "2. Occupied by Non-Mortgagor Motion" & vbCr & "3. Occupants Unknown Motion" & vbCr & "4. Vacant Motion" & vbCr & vbCr & "enter 1, 2, 3 or 4")
If VMotion = 1 Then
!motiontype = debtorsFORE() & " and/or other occupants have continued in possession of the Property and have failed to deliver possession to the Movant."
ElseIf VMotion = 2 Then
!motiontype = OccupantsVA() & " and/or other occupants have continued in possession of the Property and have failed to deliver possession to the Movant."
ElseIf VMotion = 3 Then
!motiontype = "Unknown Individuals and/or other occupants have continued in possession of the Property and have failed to deliver possession to the Movant."
ElseIf VMotion = 4 Then
!motiontype = rsE!linked_prop
Else
!motiontype = debtorsFORE() & " and/or other occupants have continued in possession of the Property and have failed to deliver possession to the Movant."

End If


!longsecured = LSecured()

If rsE![alt_st] = yes Then
!attorneysigns = AttorneyEVIC() + ", Attorney for Purchaser"
Else
!attorneysigns = AttorneyEVIC() & ", Attorney for Movant"
End If


!attorneysigns1 = attorneyEvic2()


!attorneysigns3 = rspropertycounty!Trustee

!CaseNo = Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo

!CountyState = CountyState()
!attorneycap = attorneycap()
!Property = PROP()

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!MailingAddress = Forms![foreclosure database screen]![Mailing Address]
!mailingaddress2 = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingaddressb = Forms![foreclosure database screen]![Mailing AddressB]
!mailingaddress2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]


!Propertycounty = County()
!SaleHeld = rspropertycounty!SaleHeld
!Dist1 = rspropertycounty!District_Court
!Dist2 = rspropertycounty!District_Court_Address2
!dist3 = rspropertycounty![District_Court_Address2]
!Dist5 = rspropertycounty!District_Court_contact
!dist4 = rspropertycounty!District_Court_CSZ
!attorneybar = attorneybar()
!attorneybar2 = attorneybar2()

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Then
!Borrowers = debtorsFORE() & " were"
Else
!Borrowers = debtorsFORE() & " was"
End If

If VTypeMerge = "GOVT" Or VTypeMerge = "AssReq" Then
!LegalDescription = Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription
Else
!LegalDescription = ""
End If

!SaleDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "mmmm dd, yyyy")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note], "$###,##0.00")
Else

Dim rsBD As RecordSet
Dim strsqlBD As String

strsqlBD = "SELECT ([principal balance]+[interest amt]+[late charge]+[lender advance]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism6]+[mism7]+[mism8]+[mism9]+[rec_bal]+[mism10]+[mism11]) AS BALDue, AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
Set rsBD = CurrentDb.OpenRecordset(strsqlBD, dbOpenSnapshot)

Dim VAffDebtBd
If Not rsBD.EOF Then
VAffDebtBd = Format(rsBD!BalDue, "$###,##0.00")
Else
VAffDebtBd = 0
End If

!upb = VAffDebtBd
End If

!Letter_Date = Format(Date, "mmmm dd, yyyy")
!Purchaser = Purchaser()

'Signature
Dim Vproc
Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String

Do While Vproc <> "YES"
vInitials = getEmployeeInitials(Environ("username"))
strsqlEmp = "select * from employees where employeeid = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)

If rsEmp.EOF Then
MsgBox ("Incorrect Initials, please re-input")
Else
Vproc = "YES"
If Not IsNull(rsEmp!MiddleName) Then
!Attorney = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
!Attorney = rsEmp!FirstName & " " & rsEmp!LastName
End If
End If
Loop

rsEmp.Close
rsE.Close

'End Signature


.Update
End With

DoCmd.RunMacro ("exportevicmerge")
DoCmd.TransferText acExportDelim, , "evicmerge", pathuser() & "evicmerge.txt", True

End Function

Public Function EvicMerge()
 

CurrentDb.Execute "Delete * from evicmerge;", dbFailOnError
DoCmd.OpenQuery ("evicbasicmerge")
Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet

Set rs = CurrentDb.OpenRecordset("evicmerge", dbOpenDynaset, dbSeeChanges)
GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)
Dim VDueth
Dim VDayDue

Dim VDate


Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


With rs
.Edit

VdueDay = Format(Date, "d")
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice]) Then
!SalePrice = "___________________"
Else
!SalePrice = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice], "$###,##0.00")
End If

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD) Then
!ratdate = "______________"
Else
!ratdate = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD, "mmmm dd, yyyy")
End If

!trialhearing = EvicVATRIALHearing()
VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"
!Occ1 = Occupant1()
!Occ2 = Occupant2()
!Occ3 = Occupant3()
!Occ4 = Occupant4()
!Today = Format(Date, "mmmm dd, yyyy")
!todayday = Format(Date, "dd")
!todaymonthyear = Format(Date, "mmmm, yyyy")
!dayth = VDueth

!taxid = Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid
!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
!rerecorded = "Re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If
!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!dateyear = "20__"
!liberfolio = liberfolio()
![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!longsecured = LSecured()

If VTypeMerge = "NTQVa" Or VTypeMerge = "NTQVaOcc" Then

!attorneysigns = AttorneyEVICNTQVa()
!attorneysigns2 = IIf(AttorneyEVICNTQVa() Like "Allison*" Or AttorneyEVICNTQVa() Like "How*", "", "Paralegal")

If [Forms]![foreclosure database screen]![TypeOfLoan] Like "Conv*" And (Not IsNull(rsE![Broker Name]) Or rsE![Broker Name] <> "") Then
Dim VBroker As String

If Not IsNull(rsE!Broker_Phone) Or rsE![Broker_Phone] <> "" Then
VBroker = Trim(rsE![Broker Name]) & " at " & rsE![Broker_Phone]
Else
VBroker = Trim(rsE![Broker Name])
End If

!extralang1 = "In certain situations, this purchaser provides relocation assistance programs to occupants of its foreclosed properties. To discuss these programs, your options under them or for an emergency situation, please contact " & VBroker & "."
End If

Else

If rsE![alt_st] = yes Then
!attorneysigns = AttorneyEVIC() + ", Attorney for Purchaser"
Else
!attorneysigns = AttorneyEVIC() & ", Attorney for Movant"
End If


!attorneysigns1 = attorneyEvic2()
End If


'!attorneysigns3 = If([trustee] Is Not Null, [trustee])
!Occupant_Att_Firm = rsE!Occupant_Att_Firm
!Occupant_Att = rsE!Occupant_Att
!occupant_add = rsE!Occupant_Att_add
!occupant_csz = rsE!Occupant_Att_csz


!CaseNo = rsE!eviction_case_no
!CountyState = CountyState()
!attorneycap = attorneycap()
!Property = PROP()

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!MailingAddress = Forms![foreclosure database screen]![Mailing Address]
!mailingaddress2 = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingaddressb = Forms![foreclosure database screen]![Mailing AddressB]
!mailingaddress2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]


!Propertycounty = County()
!SaleHeld = rspropertycounty!SaleHeld
!Dist1 = rspropertycounty!District_Court
!Dist2 = rspropertycounty!District_Court_Address1
!dist3 = rspropertycounty![District_Court_Address2]
!Dist5 = rspropertycounty!District_Court_contact
!dist4 = rspropertycounty!District_Court_CSZ
!attorneybar = attorneybar()
!attorneybar2 = attorneybar2()
!Borrowers = debtorsFORE()
If VTypeMerge = "GOVT" Or VTypeMerge = "AssReq" Then
!LegalDescription = Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription
Else
!LegalDescription = ""
End If

!SaleDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "mmmm dd, yyyy")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note], "$###,##0.00")
Else

Dim rsBD As RecordSet
Dim strsqlBD As String
strsqlBD = "SELECT ([principal balance]+[interest amt]+[late charge]+[lender advance]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism6]+[mism7]+[mism8]+[mism9]+[rec_bal]+[mism10]+[mism11]) AS BALDue, AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
Set rsBD = CurrentDb.OpenRecordset(strsqlBD, dbOpenSnapshot)
Dim VAffDebtBd
If Not rsBD.EOF Then
VAffDebtBd = Format(rsBD!BalDue, "$###,##0.00")
Else
VAffDebtBd = 0
End If

!upb = VAffDebtBd
End If

!Letter_Date = Format(Date, "mmmm dd, yyyy")
If Not IsNull(rsE!Abbr_Purchaser) Then
!Purchaser = rsE!Abbr_Purchaser
Else
!Purchaser = Purchaser()
End If


.Update
End With

rsE.Close


DoCmd.RunMacro ("exportevicmerge")
DoCmd.TransferText acExportDelim, , "evicmerge", pathuser() & "evicmerge.txt", True

End Function


Public Function MFRDeclaration()
VTypeMerge = "MFRDeclaration"
Call BkMergeDEC
'DoCmd.RunMacro ("exportbkmergeDEC")
DoCmd.TransferText acExportDelim, , "bkmergedec", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\MFRDeclarations\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

If Forms![foreclosure database screen]!Client Like "JP*" Then

oDoc = "MFRDEC.CHASE.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Suntrust*" Then

oDoc = "MFRDEC.Suntrust.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then

oDoc = "MFRDEC.NATIONSTAR.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!Jurisdiction Like "*MD" And Forms!bankruptcymain!BankruptcySubForm.Form!chapter = "7" Then
oDoc = "MFRDEC.WFMD7.doc"
Else
oDoc = "MFRDEC.WF.doc"
End If

ElseIf Forms![foreclosure database screen]!Client Like "Select Por*" Then
oDoc = "MFRDEC.SPS.doc"

ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then
oDoc = "MFRDEC.BOA.doc"

ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then

If BKJurisdiction() = "D.C." Then

If BKArrESCROW = 1 And (TotalBACBKArr = 0 Or IsNull(TotalBACBKArr)) Then
oDoc = "MFRDEC.CitiMTGDC+ESC-ADV.doc"
ElseIf BKArrESCROW = 1 And TotalBACBKArr() > 0 Then
oDoc = "MFRDEC.CitiMTGDC+ESC+ADV.doc"
ElseIf BKArrESCROW = 0 And (TotalBACBKArr = 0 Or IsNull(TotalBACBKArr)) Then
oDoc = "MFRDEC.CitiMTGDC-ESC-ADV.doc"
ElseIf BKArrESCROW = 0 And TotalBACBKArr() > 0 Then
oDoc = "MFRDEC.CitiMTGDC-ESC+ADV.doc"
End If

ElseIf BKJurisdiction() Like "*VA" And Forms!bankruptcymain!BankruptcySubForm.Form!chapter Like "13*" And (BKMovant() = "Citifinancial Servicing, LLC" Or _
BKMovant() = "CitiFinancial, Inc. D/B/A CitiFinancial, Inc. (WV)") Then

oDoc = "MFRDEC.CITIFIWV.docx"

Else


oDoc = "MFRDEC.CITIMTG50.doc"
End If



ElseIf Forms![foreclosure database screen]!Client Like "GMAC*" Or Forms![foreclosure database screen]!Client Like "Ocwen*" Then
oDoc = "MFRDEC.OCWEN.doc"


Else
oDoc = "MFRDEC.MISC.doc"

End If


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

'




End Function


Public Function BKLatePOC()
VTypeMerge = "LatePOC"
Call BkMerge
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

Dim VSel
VSel = InputBox("1. Motion to Allow Late POC" & vbCr & "2. Notice of Motion" & vbCr & "3. Notice of Hearing" & vbCr & vbCr & "Type in 1, 2 or 3")
If VSel = 1 Then

oDoc = "LatePOCVA-Motion.doc"
ElseIf VSel = 2 Then
oDoc = "LatePOCVA-NoticeofMotion.doc"
ElseIf VSel = 3 Then
oDoc = "LatePOCVA-NoticeofHearing.doc"
End If


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges


End Function
Public Function BACFNMALetter()
VTypeMerge = "LETTER"
Call BkMerge
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

oDoc = "BACFNMALossMitLetter.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function
Public Function RunOrderCont()
Call BkMerge
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

If BKJurisdiction() Like "Nor*" Or _
BKJurisdiction() Like "New*" Then
oDoc = "OrderExtendingStay-NORNN.doc"
Else
oDoc = "OrderContinuingStay.doc"
End If


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges


End Function
Public Function NOILabelText()
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("Notices", dbOpenSnapshot)
Dim Vcnt As Integer
Vcnt = 0

Dim VSelprt
Do While VSelprt <> 2 And VSelprt <> 15 And VSelprt <> 11 And VSelprt <> 12 And VSelprt <> 3 And VSelprt <> 4 And VSelprt <> 5 And VSelprt <> 6 And VSelprt <> 7 And VSelprt <> 8 And VSelprt <> 9
VSelprt = InputBox("Select PRINTER #:" & vbCr & vbCr & "2 = PRINTER 2" & vbCr & "3 - PRINTER 3" & vbCr & "4 - PRINTER 4" & vbCr & "5 - PRINTER 5" & vbCr & "6 - PRINTER 6 (Arlington)" & vbCr & "7 - PRINTER 7 (Trio)" & vbCr & "8 - PRINTER 8" & vbCr & "9 - PRINTER 9" & vbCr & "11 - Printer 11" & vbCr & "12 - Printer 12" & vbCr & "15 - Printer 15")
If VSelprt <> 2 And VSelprt <> 11 And VSelprt <> 12 And VSelprt <> 3 And VSelprt <> 4 And VSelprt <> 5 And VSelprt <> 6 And VSelprt <> 7 And VSelprt <> 8 And VSelprt <> 9 And VSelprt <> 15 Then
MsgBox ("Incorrect Printer Number")
End If
Loop


Set fs = CreateObject("Scripting.FileSystemObject")

If Not rs.EOF Then
Do While Not rs.EOF
If rs!NoticeTo <> "Commissioner of Financial Regulation" Then
Vcnt = Vcnt + 1
Set A = fs.CreateTextFile("\\rvdv-fs01\LabelRequests\" & Vcnt & "_" & Forms![foreclosure database screen]!filenum & "_" & Format$(Date, "mmddyy") & "_LabelReq.txt", True)
A.WriteLine ("|Printer " & VSelprt)
A.WriteLine ("|User " & username() & ", Address Label, File " & rs!filenum)
A.WriteLine (rs!NoticeTo)
If IsNull(rs!NoticeAdd) Then
Else
A.WriteLine (rs!NoticeAdd)
End If

If Not IsNull(rs!NoticeAdd2) Then
A.WriteLine (rs!NoticeAdd2)
End If
A.WriteLine (rs!NoticeCSZ)
A.WriteLine ("|NEWLINE")
A.WriteLine ("|NEWLINE")
A.WriteLine ("BWW#: " & rs!filenum)

End If

rs.MoveNext
Loop

End If
End Function
Public Function CommissionerLABEL()
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("Notices", dbOpenSnapshot)
Dim Vcnt As Integer
Vcnt = 0

Dim VSelprt
Do While VSelprt <> 2 And VSelprt <> 15 And VSelprt <> 11 And VSelprt <> 12 And VSelprt <> 3 And VSelprt <> 4 And VSelprt <> 5 And VSelprt <> 6 And VSelprt <> 7 And VSelprt <> 8 And VSelprt <> 9
VSelprt = InputBox("Select PRINTER #:" & vbCr & vbCr & "2 = PRINTER 2" & vbCr & "3 - PRINTER 3" & vbCr & "4 - PRINTER 4" & vbCr & "5 - PRINTER 5" & vbCr & "6 - PRINTER 6 (Arlington)" & vbCr & "7 - PRINTER 7 (Trio)" & vbCr & "8 - PRINTER 8" & vbCr & "9 - PRINTER 9" & vbCr & "11 - Printer 11" & vbCr & "12 - Printer 12" & vbCr & "15 - Printer 15")
If VSelprt <> 2 And VSelprt <> 11 And VSelprt <> 12 And VSelprt <> 3 And VSelprt <> 4 And VSelprt <> 5 And VSelprt <> 6 And VSelprt <> 7 And VSelprt <> 8 And VSelprt <> 9 And VSelprt <> 15 Then
MsgBox ("Incorrect Printer Number")
End If
Loop

Set fs = CreateObject("Scripting.FileSystemObject")

If Not rs.EOF Then
Do While Not rs.EOF
If rs!NoticeTo = "Commissioner of Financial Regulation" Then
Vcnt = Vcnt + 1
Set A = fs.CreateTextFile("\\rvdv-fs01\LabelRequests\" & Vcnt & "_" & Forms![foreclosure database screen]!filenum & "_" & Format$(Date, "mmddyy") & "_LabelReq.txt", True)
A.WriteLine ("|Printer " & VSelprt)
A.WriteLine ("|User " & username() & ", Address Label, File " & rs!filenum)
A.WriteLine (rs!NoticeTo)
A.WriteLine (rs!NoticeAdd)
If Not IsNull(rs!NoticeAdd2) Then
A.WriteLine (rs!NoticeAdd2)
End If
A.WriteLine (rs!NoticeCSZ)
A.WriteLine ("|NEWLINE")
A.WriteLine ("|NEWLINE")
A.WriteLine ("BWW#: " & rs!filenum)

End If

rs.MoveNext
Loop
End If

End Function


Public Function RunOrderDenyConf()
VTypeMerge = "OrderDeny"

Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlanObj.Co.Alex.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With



'Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\PlanObj.Co.Alex.doc", "Word.Document")

'Docmd SetWarnings True
End Function
Public Function RunNoticeCure()
VTypeMerge = "Motion"

Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\StatementResponseNoticeofCure.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
Public Function WFHomeEquityNOD()
VTypeMerge = "WFHomeEquity"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\NoticeofDefault-Wells.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function
Public Function Salisbury()
MsgBox ("The Salisbury letter must be manually imaged to Imaged Docs")

VTypeMerge = "Salisbury"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitySalisbury.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function


Public Function SuntrustAssignment()
VTypeMerge = "SunAss"
Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SuntrustAssignment.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function AssignmentDC()
VTypeMerge = "DCAss"

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Call FCDCMerge


If Forms![foreclosure database screen]!Client Like "Bank of Amer*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCAssignmentBANA.doc")
ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
If Forms![foreclosure database screen]!mers = -1 Or _
Forms![foreclosure database screen]!mers = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCAssignmentSLS-mers.doc")
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCAssignmentSLS-non-mers.doc")
End If
Else

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCAssignment.doc")
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If




End Function

Public Function AssignmentVA()


VTypeMerge = "VirginiaAss"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Dim Vselect

Dim rsqc As RecordSet
Dim strsqlqc As String
strsqlqc = "Select * from QC where filenum = " & GblFilenum & ";"
Set rsqc = CurrentDb.OpenRecordset(strsqlqc, dbOpenSnapshot)
If rsqc!qc_assignor Like "MER*" Then
Vselect = 1
End If
rsqc.Close
Set rsqc = Nothing


If IsNull(AOMAssignor) Then
Vselect = InputBox("1. MERS" & vbCr & "2. Non-MERS" & vbCr & "enter 1 or 2")
End If


If Vselect = 1 Then

If Forms![foreclosure database screen]!Client Like "Pennymac*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-PennymacMERS.doc")
ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-SLS-MERS.docx")
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-BWWMERS.doc")
End If

Else
If Forms![foreclosure database screen]!Client Like "Pennymac*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-Pennymac.doc")
ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-SLS.docx")

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\AssignmentVA-BWW.doc")
End If
End If



With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End Function

Public Function CitiAssignment()
VTypeMerge = "CitiAss"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "MD" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAssignmentMd.doc")
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAssignment.doc")
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With



End Function
Public Function AssignmentMerge()

If Forms![foreclosure database screen]!PropertyState = "MD" Then
DoCmd.OpenReport "AssignmentDOTNew", acViewPreview

Else


Call AssignmentVA

End If
End Function
Public Function AssignmentReq()


VTypeMerge = "ASSREQ"
Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AssignmentRequest.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILSCRAWaiver()
VTypeMerge = "DILScra"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILSCRAWaiver.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILScraNotice()
VTypeMerge = "DILScra"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\SCRANotice.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILEst()
VTypeMerge = "DILEst"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILEstoppel.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILBorrowerLtr()
'AllBorrowersLtrAdd()
VTypeMerge = "DILBorrowerLtr"
Call DILMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILLettertoBorrower.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End Function
Public Function DILHudLtr()
'AllBorrowersLtrAdd()
VTypeMerge = "DILHudLtr"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILLetterHUD.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILVeteransLtr()
'AllBorrowersLtrAdd()
VTypeMerge = "DILLetterVeterans"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILLetterVeterans.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function

Public Function DILSWDeed()
VTypeMerge = "DILSWDeed"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILBOASWDVA.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILSWDVA.doc", , , True)
End If

Else

If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILBOASWDMD.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILSWDMD.doc", , , True)

End If

End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With








End Function
Public Function DILDeed()
VTypeMerge = "DILDeed"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILDeedinLieuVA.doc", , , True)


Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILDeedinLieu.doc", , , True)

End If
With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With




End Function
Public Function DILPropRel()
VTypeMerge = "DILPropRel"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILPersonalPropertyRelease.doc", , , True)
With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILAgree()
VTypeMerge = "DILAgree"
Call DILMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILAgreement.doc", , , True)
With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILCMA()
VTypeMerge = "DILCMA"
Call DILMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILCMA.doc", , , True)
With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILReleaseMD()
VTypeMerge = "DILReleaseMD"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILBOAReleaseVA.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILReleaseVA.doc", , , True)

End If
Else
If Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILBOAReleaseMd.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILReleaseMd.doc", , , True)

End If
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function DILReleaseMDJR()
VTypeMerge = "DILReleaseMDjR"
Call DILMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DIL\DILReleaseMdjR.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function RunPart1LBPS792()
VTypeMerge = "Seterus"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\L792lettermergePART1.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

'Set oDoc = GetObject("\\rvdv-fs01\datatransfer\Templates\FC\L792lettermergePART1.doc")

End Function
Public Function RunPart1LBPS762()
VTypeMerge = "Seterus"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\L762lettermergePART1.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function RunSeneca()
VTypeMerge = "Seneca"
Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SenecaLetterMerge.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End Function

Public Function RunGreenPlanet()
VTypeMerge = "GreenPlanet"
Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\GreenPlanetMerge.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End Function
Public Function RunNOILBPS762PDF()
VTypeMerge = "SeterusPDF"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document

Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Seteruslettermerge.doc", , , True)

dumpname = Format(Forms![foreclosure database screen]!filenum, "000000") & Format$(Now(), "yyyymmddhhnnss")
destinationfile = "G:\SeterusNOIOnlyReferrals\NOIPackages\" & dumpname & "_NOISeterusPackage"

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With

Call WordMerge3PDF(oapp, destinationfile)



End Function

Public Function RunNOILBPS762()
VTypeMerge = "Seterus"
Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\L762lettermerge.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Seteruslettermerge.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End Function
Private Sub WordApp_MailMergeAfterMerge(ByVal doc As document, ByVal Docresult As document)

End Sub

Public Function RunNOILBPS792()
VTypeMerge = "Seterus"
Call FCMerge

Dim oDoc As Word.document
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\L792LetterMERGE.doc", "Word.Document")
oDoc.Application.Visible = True
oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "fcmerge.txt"

oDoc.MailMerge.Execute
'oDoc.Close

Set oDoc = GetObject("\\rvdv-fs01\datatransfer\Templates\FC\Seteruslettermerge.doc")
oDoc.Application.Visible = True
oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "fcmerge.txt"
oDoc.MailMerge.Execute

End Function
Public Function RunMFRBACVa()
'BACMFR13EDVAPLUS.doc

VTypeMerge = "Motion"
Call BkMergeMFR

'DoCmd.RunMacro ("exportbkmergemfr")
DoCmd.TransferText acExportDelim, , "bkmergeMFR", pathuser() & "bkmerge.txt", True

Dim oDoc As Word.document
If BKChapter() = "7" Then
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR7EDVA.doc", "Word.Document")

ElseIf BKChapter() = "13" And _
(BKJurisdiction() Like "nor*" Or _
BKJurisdiction() Like "newp*") Then

Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR13NornnMinus.doc", "Word.Document")


Else
If cobk() Like "co-debtor*" Then

Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR13EDVAPLUS.doc", "Word.Document")
Else
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR13EDVAMinus.doc", "Word.Document")

End If
End If

oDoc.Application.Visible = True
oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "\BKMerge.txt"
oDoc.MailMerge.Execute
oDoc.Close

End Function
Public Function RunMFRBACMd()
VTypeMerge = "Motion"
Call BkMergeMFR

'DoCmd.RunMacro ("exportbkmergeMFR")
DoCmd.TransferText acExportDelim, , "bkmergeMFR", pathuser() & "bkmerge.txt", True

Dim oDoc As Word.document

If Forms![foreclosure database screen]!PropertyState = "MD" Then

If Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13 Then
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR13MdMinus.doc", "Word.Document")
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 7 Then
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\BACMFRTemplates\BACMFR7Md.doc", "Word.Document")
End If

oDoc.Application.Visible = True

End If

oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "\BKMerge.txt"
oDoc.MailMerge.Execute
oDoc.Close

End Function
Public Function RunMotionToDeem()
VTypeMerge = "Motion"
Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\Motiontodeemcurrent.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

'Docmd SetWarnings True
End Function

Public Function OccupantAllFields()
VNoticeDate = Date

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


GblFilenum = Forms![foreclosure database screen]!filenum

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)



With rsnotice
.AddNew
!NoticeTo = "All Occupants"
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!SaleHeld = rspropertycounty!SaleHeld
!Salutation = "Sir/Madam"
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsnotice.Close
rsE.Close

End Function
Public Function DebtorsPropBULKScreen()
Dim rsnotice As RecordSet
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String

CurrentDb.Execute "Delete * from dismissbulkScreen;", dbFailOnError
DoCmd.OpenQuery ("Dismissbulkqueryscreen")


With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor1) Then
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!MiddleNameDebtor1 & " " & rs!LastNameDebtor1
Else
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!LastNameDebtor1
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or _
rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With

If (rs![Mailing Address] <> "") Then
With rsnotice
.AddNew
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!LastNameDebtor1
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = rs![Mailing Address2]
!NoticeCSZ = rs![Mailing City] & ", " & rs![Mailing State] & "  " & rs![Mailing Zip]
.Update
End With
End If


If Not IsNull(rs!LastNameDebtor2) Or _
rs!LastNameDebtor2 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor2) Then
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!MiddleNameDebtor2 & " " & rs!LastNameDebtor2
Else
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!LastNameDebtor2
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With

If (rs![Mailing Address] <> "") Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor2) Then
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!MiddleNameDebtor2 & " " & rs!LastNameDebtor2
Else
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!LastNameDebtor2
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = rs![Mailing Address2]
!NoticeCSZ = rs![Mailing City] & ", " & rs![Mailing State] & "  " & rs![Mailing Zip]
.Update
End With
End If
End If

If Not IsNull(rs!LastNameDebtor3) Or _
rs!LastNameDebtor3 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor3) Then
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!MiddleNameDebtor3 & " " & rs!LastNameDebtor3
Else
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!LastNameDebtor3
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With

If (rs![Mailing Address] <> "") Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor3) Then
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!MiddleNameDebtor3 & " " & rs!LastNameDebtor3
Else
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!LastNameDebtor3
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = rs![Mailing Address2]
!NoticeCSZ = rs![Mailing City] & ", " & rs![Mailing State] & "  " & rs![Mailing Zip]
.Update
End With
End If
End If

If Not IsNull(rs!lastnamedebtor4) Or _
rs!lastnamedebtor4 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor4) Then
!NoticeTo = rs!firstnamedebtor4 & " " & rs!middlenamedebtor4 & " " & rs!lastnamedebtor4
Else
!NoticeTo = rs!firstnamedebtor4 & " " & rs!lastnamedebtor4
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With

If (rs![Mailing Address] <> "") Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor4) Then
!NoticeTo = rs!firstnamedebtor4 & " " & rs!middlenamedebtor4 & " " & rs!lastnamedebtor4
Else
!NoticeTo = rs!firstnamedebtor4 & " " & rs!lastnamedebtor4
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = rs![Mailing Address2]
!NoticeCSZ = rs![Mailing City] & ", " & rs![Mailing State] & "  " & rs![Mailing Zip]
.Update
End With
End If
End If


If Not IsNull(rs!lastnamedebtor5) Or _
rs!lastnamedebtor5 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor5) Then
!NoticeTo = rs!firstnamedebtor5 & " " & rs!middlenamedebtor5 & " " & rs!lastnamedebtor5
Else
!NoticeTo = rs!firstnamedebtor5 & " " & rs!lastnamedebtor5
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With

If (rs![Mailing Address] <> "") Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor5) Then
!NoticeTo = rs!firstnamedebtor5 & " " & rs!middlenamedebtor5 & " " & rs!lastnamedebtor5
Else
!NoticeTo = rs!firstnamedebtor5 & " " & rs!lastnamedebtor5
End If
!filenum = rs!filenum
!NoticeAdd = rs![Mailing Address]
!NoticeAdd2 = rs![Mailing Address2]
!NoticeCSZ = rs![Mailing City] & ", " & rs![Mailing State] & "  " & rs![Mailing Zip]
.Update
End With
End If
End If

rs.Close
rsnotice.Close
End Function

Public Function DebtorsPropBULK()
Dim rsnotice As RecordSet
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String

Set rs = CurrentDb.OpenRecordset("BulkAffCorrective", dbOpenSnapshot)

Do While Not rs.EOF

With rsnotice
.AddNew
!NoticeTo = rs!Propertycounty & " Court"
!filenum = rs!filenum
.Update
End With


With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor1) Then
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!MiddleNameDebtor1 & " " & rs!LastNameDebtor1
Else
!NoticeTo = rs!FirstNameDebtor1 & " " & rs!LastNameDebtor1
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or _
rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With


If Not IsNull(rs!LastNameDebtor2) Or _
rs!LastNameDebtor2 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor2) Then
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!MiddleNameDebtor2 & " " & rs!LastNameDebtor2
Else
!NoticeTo = rs!FirstNameDebtor2 & " " & rs!LastNameDebtor2
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With
End If

If Not IsNull(rs!LastNameDebtor3) Or _
rs!LastNameDebtor3 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!MiddleNameDebtor3) Then
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!MiddleNameDebtor3 & " " & rs!LastNameDebtor3
Else
!NoticeTo = rs!FirstNameDebtor3 & " " & rs!LastNameDebtor3
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With
End If

If Not IsNull(rs!lastnamedebtor4) Or _
rs!lastnamedebtor4 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor4) Then
!NoticeTo = rs!firstnamedebtor4 & " " & rs!middlenamedebtor4 & " " & rs!lastnamedebtor4
Else
!NoticeTo = rs!firstnamedebtor4 & " " & rs!lastnamedebtor4
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With
End If


If Not IsNull(rs!lastnamedebtor5) Or _
rs!lastnamedebtor5 <> "" Then
With rsnotice
.AddNew
If Not IsNull(rs!middlenamedebtor5) Then
!NoticeTo = rs!firstnamedebtor5 & " " & rs!middlenamedebtor5 & " " & rs!lastnamedebtor5
Else
!NoticeTo = rs!firstnamedebtor5 & " " & rs!lastnamedebtor5
End If
!filenum = rs!filenum
If IsNull(rs![unit_no]) Or rs![unit_no] = "" Then
!NoticeAdd = rs![PropAddress]
Else
!NoticeAdd = rs![PropAddress] & ", Unit # " & rs![unit_no]
End If
!NoticeAdd2 = rs!propaddress2
!NoticeCSZ = rs!PropertyCity & ", " & rs!PropertyState & "  " & rs!propzip
.Update
End With
End If
rs.MoveNext
Loop


rs.Close
rsnotice.Close
End Function

Public Function DebtorsALLFields()

VNoticeDate = Date

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

VSpage = 0

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum

If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If

!Client = Forms![foreclosure database screen]!Client
GblFilenum = Forms![foreclosure database screen]![filenum]
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
'End If

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]


!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
'MsgBox ("2nd Debtor")

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
'MsgBox (Forms![foreclosure database screen]!LastNameDebtor2)

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]

!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If Forms![foreclosure database screen]!LastNameDebtor3 <> "" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate

End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate

If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]


!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If Forms![foreclosure database screen]!lastnamedebtor4 <> "" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]


!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If Forms![foreclosure database screen]!lastnamedebtor5 <> "" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "grantor5" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]

!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then
If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If
rspropertycounty.Close
rsnotice.Close
rsE.Close

End Function

Public Function DebtorsMailingOnly()
Dim rsnotice As RecordSet

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)


If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If


If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
.Update
End With
End If

If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If

End If

If Forms![foreclosure database screen]!LastNameDebtor3 <> "" Then


If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
.Update
End With
End If

End If

If Forms![foreclosure database screen]!lastnamedebtor4 <> "" Then

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]

.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If
End If

If Forms![foreclosure database screen]!lastnamedebtor5 <> "" Then


If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]

.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If

End If


rsnotice.Close

End Function

Public Function DebtorsPropOnly()
Dim rsnotice As RecordSet

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
.Update
End With

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If


If MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor1
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
.Update
End With
End If

If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor2
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor2

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If
End If

If Forms![foreclosure database screen]!LastNameDebtor3 <> "" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]

.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]
.Update
End With
End If


If MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!FirstNameDC = Forms![foreclosure database screen]!FirstNameDebtor3
!LastNameDC = Forms![foreclosure database screen]!LastNameDebtor3

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]
.Update
End With
End If
End If

If Forms![foreclosure database screen]!lastnamedebtor4 <> "" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4

!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]

.Update
End With
End If

If MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor4
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor4
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If
End If

If Forms![foreclosure database screen]!lastnamedebtor5 <> "" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!extra = Forms![foreclosure database screen]![PropAddress]
.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!extra = Forms![foreclosure database screen]![SDatAddress]
.Update
End With
End If

If MailA = "Grantor5" Or MailA = "All Grantors" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!extra = Forms![foreclosure database screen]![Mailing Address]

.Update
End With
End If

If MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!FirstNameDC = Forms![foreclosure database screen]!firstnamedebtor5
!LastNameDC = Forms![foreclosure database screen]!lastnamedebtor5
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!extra = Forms![foreclosure database screen]![Mailing AddressB]

.Update
End With
End If
End If


rsnotice.Close

End Function
Public Function Owner1AllFields()
VNoticeDate = Date

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


If IsNull(Forms![foreclosure database screen]!lastnameo1) Or Forms![foreclosure database screen]!bk1 = -1 Or Forms![foreclosure database screen]!bk1 = 1 Then
Else

With rsnotice
.AddNew
!NoticeTo = owner1()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo1
!LastNameDC = Forms![foreclosure database screen]!lastnameo1
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip

!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If


.Update
End With

If MailSDat = "Owner1" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo1
!LastNameDC = Forms![foreclosure database screen]!lastnameo1
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]


!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] = "" Then
Else
If MailA = "Owner1" Or MailA = "All Owners" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo1
!LastNameDC = Forms![foreclosure database screen]!lastnameo1
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Or _
Forms![foreclosure database screen]![Mailing AddressB] = "" Then
Else
If MailB = "Owner1" Or MailB = "All Owners" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo1
!LastNameDC = Forms![foreclosure database screen]!lastnameo1
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]


!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If
End If

rsnotice.Close
rspropertycounty.Close
rsE.Close

End Function
Public Function Owner2AllFields()
VNoticeDate = Date

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


If IsNull(Forms![foreclosure database screen]!lastnameo2) Or Forms![foreclosure database screen]!bk2 = 1 Or Forms![foreclosure database screen]!bk2 = -1 Then
Else
With rsnotice
.AddNew
!NoticeTo = owner2()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo2
!LastNameDC = Forms![foreclosure database screen]!lastnameo2
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip


!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo2] & " " & Forms![foreclosure database screen]!lastnameo2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If


.Update
End With

If MailSDat = "Owner2" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner2()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo2
!LastNameDC = Forms![foreclosure database screen]!lastnameo2
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]


!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo2] & " " & Forms![foreclosure database screen]!lastnameo2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If


If IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] = "" Then
Else
If MailA = "Owner2" Or MailA = "All Owners" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner2()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo2
!LastNameDC = Forms![foreclosure database screen]!lastnameo2
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo2] & " " & Forms![foreclosure database screen]!lastnameo2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If


.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Then
Else
If MailB = "Owner2" Or MailB = "All Owners" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner2()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo2
!LastNameDC = Forms![foreclosure database screen]!lastnameo2
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]

!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo2] & " " & Forms![foreclosure database screen]!lastnameo2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If
End If

rsnotice.Close
rspropertycounty.Close
rsE.Close

End Function
Public Function Owner3AllFields()
VNoticeDate = Date

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)
Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If IsNull(Forms![foreclosure database screen]!lastnameo3) Or Forms![foreclosure database screen]!bk3 = 1 Or Forms![foreclosure database screen]!bk3 = -1 Then
Else
With rsnotice
.AddNew
!NoticeTo = owner3()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo3
!LastNameDC = Forms![foreclosure database screen]!lastnameo3
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip

!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo3] & " " & Forms![foreclosure database screen]!lastnameo3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If


.Update
End With

If MailSDat = "Owner3" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner3()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo3
!LastNameDC = Forms![foreclosure database screen]!lastnameo3
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo3] & " " & Forms![foreclosure database screen]!lastnameo3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If IsNull(Forms![foreclosure database screen]![Mailing Address]) Or _
Forms![foreclosure database screen]![Mailing Address] = "" Then
Else
If MailA = "Owner3" Or MailA = "All Owners" Or MailA = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner3()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo3
!LastNameDC = Forms![foreclosure database screen]!lastnameo3
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo3] & " " & Forms![foreclosure database screen]!lastnameo3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If


.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]![Mailing AddressB]) Then
Else
If MailB = "Owner3" Or MailB = "All Owners" Or MailB = "All" Then
With rsnotice
.AddNew
!NoticeTo = owner3()
!StartPage = VSpage + 1
VSpage = VSpage + 1
!FirstNameDC = Forms![foreclosure database screen]!firstnameo3
!LastNameDC = Forms![foreclosure database screen]!lastnameo3
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]


!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo3] & " " & Forms![foreclosure database screen]!lastnameo3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If
End If

rsnotice.Close
rspropertycounty.Close
rsE.Close

End Function
Public Function ExportBKAtt()

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)





rsnotice.Close

End Function

Public Function ExportCreditorsBK()

Dim rsnotice As RecordSet
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)


Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
strsqlLIEN = "select * from creditors where (filed_bk = " & -1 & " or filed_bk = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!extra = "BKLien"
.Update
End With

rsLienHolders.MoveNext
Loop
End If
rsnotice.Close

End Function

Public Function ExportOwnersCreditors()

Call Owner1PropOnly
Call Owner2PropOnly
Call Owner3PropOnly

Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
strsqlLIEN = "select * from creditors where (noi = " & -1 & " or noi = " & 1 & ") and filenum = " & Forms![foreclosure database screen]!filenum
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
.Update
End With

With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With


rsLienHolders.MoveNext
Loop
End If

End Function
Public Function ExportLienholderRO_Serve()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE ((Creditors.[serve] = -1 or creditors.[serve] = 1) or (creditors.[noi] = -1 or creditors.[noi] = 1) or (creditors.[record_owner] = -1 or creditors.[record_owner] = 1)) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rsLienHolders!att_for
!Salutation = "Sir/Madam"
!Client = Forms![foreclosure database screen]!Client
.Update
End With
rsLienHolders.MoveNext
Loop
rsnotice.Close
rsLienHolders.Close

End If
End Function
Public Function LienholdersFDL()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

Dim VDate

VNoticeDate = Date

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If
'LIENHOLDERS---------------------------------------
Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE (Creditors.fdl = -1 or creditors.fdl = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
If IsNull(rsLienHolders!dear) Then
!Salutation = rsLienHolders!OrganizationName
Else
!Salutation = rsLienHolders!dear
End If

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop

End If

End Function


Public Function LienholdersLNL()

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

Dim VDate

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


VNoticeDate = Date

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If
'LIENHOLDERS---------------------------------------
Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE (Creditors.MD_Letter = -1 or creditors.MD_Letter = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
If IsNull(rsLienHolders!dear) Then
!Salutation = rsLienHolders!OrganizationName
Else
!Salutation = rsLienHolders!dear
End If

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop

End If
rsE.Close

End Function

Public Function ExportLienholderRONotices()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE (creditors.[record_owner] = " & -1 & " or creditors.[record_owner] = " & 1 & "" _
& ") And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"

Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName

!StartPage = VSpage + 1
VSpage = VSpage + 1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode

!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rsLienHolders!att_for
!Salutation = "Sir/Madam"
!Client = Forms![foreclosure database screen]!Client
'========
!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
'=======
.Update
End With
rsLienHolders.MoveNext
Loop
rsnotice.Close
rsLienHolders.Close

End If
rsE.Close

End Function


Public Function ExportLienholderAR()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE Creditors.[ta-do] = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rsLienHolders!att_for
!Salutation = "Sir/Madam"
!Client = Forms![foreclosure database screen]!Client
.Update
End With
rsLienHolders.MoveNext
Loop
rsnotice.Close
rsLienHolders.Close

End If
End Function
Public Function ExportLienholderNOI()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE Creditors.noi = Yes And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = ""
!Salutation = "Sir/Madam"
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If Not rsE.EOF Then

If IsNull(rsE!PutOutDate) Then
Else
!PutOutDate = rsE!PutOutDate
End If
End If

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop
rsnotice.Close
rsLienHolders.Close

End If

End Function
Public Function ExportEnvelopes()

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
GblFilenum = Forms![foreclosure database screen]![filenum]

Call DebtorsPropOnly
Call OwnersOnly

End Function
Public Function ExportLNLLetters()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String
CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

Dim VDate

VNoticeDate = Date


GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If

If Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1) Then

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum

If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
!noticesent = Date

!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

.Update
End With
'End If

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = firstdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

.Update
End With
End If

If (MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

.Update
End With
End If


If (MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

.Update
End With
End If

End If

If IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 = "" Or _
(Forms![foreclosure database screen]!DNS2 = -1 Or Forms![foreclosure database screen]!DNS2 = 1) Then
Else
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
'MsgBox (Forms![foreclosure database screen]!LastNameDebtor2)

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = secondDebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

.Update
End With
End If

If (MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All") Then

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

.Update
End With
End If

If (MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or _
(Forms![foreclosure database screen]!DNS3 = 1 Or Forms![foreclosure database screen]!DNS3 = -1) Then
Else
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount



If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = thirddebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

.Update
End With
End If

If (MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate

If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

.Update
End With
End If

If (MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or _
(Forms![foreclosure database screen]!DNS4 = -1 Or Forms![foreclosure database screen]!DNS4 = 1) Then
Else
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip


.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fourthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

.Update
End With
End If

If (MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

.Update
End With
End If

If (MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

.Update
End With
End If
End If

If IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or _
Forms![foreclosure database screen]!lastnamedebtor5 <> "" Or _
(Forms![foreclosure database screen]!dns5 = -1 Or Forms![foreclosure database screen]!dns5 = 1) Then
Else
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fifthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeSTATE = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

.Update
End With
End If

If (MailA = "grantor5" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

.Update
End With
End If

If (MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]

.Update
End With
End If
End If


'LIENHOLDERS---------------------------------------
Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE (Creditors.MD_Letter = -1 or creditors.MD_Letter = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
If IsNull(rsLienHolders!dear) Then
!Salutation = rsLienHolders!OrganizationName
Else
!Salutation = rsLienHolders!dear
End If

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount


If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop

End If

rspropertycounty.Close
rsnotice.Close


End Function


Public Function ExportFDLLetters()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

Dim VDate
VNoticeDate = Date


GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)


Dim VPoD
If Not rsE.EOF Then
VPoD = rsE!PutOutDate
Else
VPoD = Null
End If
rsE.Close

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If

If Forms![foreclosure database screen]!DNS1 = 0 Or IsNull(Forms![foreclosure database screen]!DNS1) Then

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum

If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeZIP = Forms![foreclosure database screen]!propzip
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If

!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
'End If

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = firstdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]!SDatState
!NoticeCITY = Forms![foreclosure database screen]!SDatCity
!NoticeCITY = Forms![foreclosure database screen]!SDatState
!NoticeZIP = Forms![foreclosure database screen]!SDatZip

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If


If (MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 <> "") And _
(Forms![foreclosure database screen]!DNS2 = 0 Or IsNull(Forms![foreclosure database screen]!DNS2)) Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
'MsgBox (Forms![foreclosure database screen]!LastNameDebtor2)

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]

!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = secondDebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All") Then

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or Forms![foreclosure database screen]!LastNameDebtor3 <> "") And _
(Forms![foreclosure database screen]!DNS3 = 0 Or IsNull(Forms![foreclosure database screen]!DNS3)) Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD

End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = thirddebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate

If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD

End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or Forms![foreclosure database screen]!lastnamedebtor4 <> "") And _
(Forms![foreclosure database screen]!DNS4 = 0 Or IsNull(Forms![foreclosure database screen]!DNS4)) Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fourthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing StateB]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or Forms![foreclosure database screen]!lastnamedebtor5 <> "") And _
(Forms![foreclosure database screen]!dns5 = 0 Or IsNull(Forms![foreclosure database screen]!dns5)) Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]![PropertyCity]
!NoticeSTATE = Forms![foreclosure database screen]![PropertyState]
!NoticeZIP = Forms![foreclosure database screen]![propzip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fifthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!NoticeCITY = Forms![foreclosure database screen]![SDatCity]
!NoticeSTATE = Forms![foreclosure database screen]![SDatState]
!NoticeZIP = Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "grantor5" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!NoticeCITY = Forms![foreclosure database screen]![Mailing City]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing State]
!NoticeZIP = Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!NoticeCITY = Forms![foreclosure database screen]![Mailing CityB]
!NoticeSTATE = Forms![foreclosure database screen]![Mailing Statebb]
!NoticeZIP = Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If


'LIENHOLDERS---------------------------------------
Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE (Creditors.fdl = -1 or creditors.fdl = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
If IsNull(rsLienHolders!dear) Then
!Salutation = rsLienHolders!OrganizationName
Else
!Salutation = rsLienHolders!dear
End If

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop

End If

rspropertycounty.Close
rsnotice.Close
'rsE.Close

End Function


Public Function ExportACLLetters()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

Dim VDate
VNoticeDate = Date


GblFilenum = Forms![foreclosure database screen]![filenum]

Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)




Dim VPoD
If Not rsE.EOF Then
VPoD = rsE!PutOutDate
Else
VPoD = Null
End If
rsE.Close

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If


With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum

If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If

!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
'End If

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = firstdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If


If (MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor1] & " " & Forms![foreclosure database screen]!LastNameDebtor1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If


If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 <> "") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
'MsgBox (Forms![foreclosure database screen]!LastNameDebtor2)

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = secondDebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All") Then

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor2] & " " & Forms![foreclosure database screen]!LastNameDebtor2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or Forms![foreclosure database screen]!LastNameDebtor3 <> "") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD

End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = thirddebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate

If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD

End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![FirstNameDebtor3] & " " & Forms![foreclosure database screen]!LastNameDebtor3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or Forms![foreclosure database screen]!lastnamedebtor4 <> "") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fourthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor4] & " " & Forms![foreclosure database screen]!lastnamedebtor4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or Forms![foreclosure database screen]!lastnamedebtor5 <> "") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = fifthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If

If (MailA = "grantor5" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If

.Update
End With
End If

If (MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnamedebtor5] & " " & Forms![foreclosure database screen]!lastnamedebtor5
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
End If
End If


'LIENHOLDERS---------------------------------------
Dim rsLienHolders As RecordSet
Dim strsqlLIEN As String

strsqlLIEN = "SELECT * FROM creditors WHERE (Creditors.fdl = -1 or creditors.fdl = 1) And creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"
Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenDynaset, dbSeeChanges)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
If IsNull(rsLienHolders!dear) Then
!Salutation = rsLienHolders!OrganizationName
Else
!Salutation = rsLienHolders!dear
End If

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
If IsNull(VPoD) Then
Else
!PutOutDate = VPoD
End If
If Forms![foreclosure database screen]!Client Like "Citi Res*" Then
!extra = "CALL CITI RESIDENTIAL LENDING HOME RETENTION HOTLINE #1/800-430-5262"
End If
.Update
End With
rsLienHolders.MoveNext
Loop

End If

rspropertycounty.Close
rsnotice.Close
'rsE.Close

End Function
Public Function OwnersFromFDLCode()

Call Owner1AllFields
Call Owner2AllFields
Call Owner3AllFields

End Function
Public Function exportACL()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String
Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If

Call ExportFDLLetters

End Function

Public Function ExportNoticesNOOccupant()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

If AppType Like "fairdebt*" Then
VNoticeDate = Date
Else
VNoticeDate = NoticeDate()
End If

''MsgBox (AppType)

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If

Call DebtorsALLFields

Call ExportOwnersNoOccupant

End Function
Public Function ExportEvicCert()
'Only Property Addresses are Exported for Eviction MD Certificate of Service

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With


If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or _
Forms![foreclosure database screen]!LastNameDebtor2 <> "") Then

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With

End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or _
Forms![foreclosure database screen]!LastNameDebtor3 <> "") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With

End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or _
Forms![foreclosure database screen]!lastnamedebtor4 <> "") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With

End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or _
Forms![foreclosure database screen]!lastnamedebtor5 <> "") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With

End If

rsnotice.Close

End Function
Public Function ExportOccupantsEvicMD()
Dim rs As RecordSet

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

'Eviction Code
Dim strsqlE, VVar, VVar2, VVar3, VVar4
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & Forms![foreclosure database screen]![filenum]
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)
If Not rsE.EOF Then
VVar = rsE!Occ_Last1
VVar2 = rsE!Occ_Last2
VVar3 = rsE!Occ_Last3
VVar4 = rsE!Occ_Last4

Else
VVar = Null
VVar2 = Null
VVar3 = Null
VVar4 = Null

End If
rsE.Close
'End Eviction Code

If IsNull(VVar) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant1()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If IsNull(VVar2) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant2()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If IsNull(VVar3) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant3()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
.Update
End With
End If

If IsNull(VVar4) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant4()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

Call ExportOwnersNoOccupantNoMailings


End Function

Public Function ExportOwnersNoOccupantNoMailings()
'Eviction Only MD has Property Address for Certificate Service
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String
Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

If IsNull(Forms![foreclosure database screen]!lastnameo1) Then
Else
With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
.Update
End With

End If

If IsNull(Forms![foreclosure database screen]!lastnameo2) Then
Else
With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
.Update
End With
End If

If IsNull(Forms![foreclosure database screen]!lastnameo3) Then
Else
With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
.Update
End With
End If


rsnotice.Close

End Function


Public Function ExportFCCert()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Call DebtorsPropOnly

End Function
Public Function ExportCoExecQueue()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim VBK
Dim vFile

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

vFile = Forms![pud queue]!filenum

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from jurisdiction where county = " & """" & Forms![pud queue]!Propertycounty & """" & " and state = " & """" & "VA" & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

With rsnotice
.AddNew
!NoticeTo = "Attention: " & rs![CE_Name] & ", " & rs!CE_Title
!filenum = Forms![pud queue]!filenum
If rs![County] Like "*City*" Then
!NoticeAdd = Trim(rs![County])
'ElseIf rs!County Like "City*" Then
'!NoticeAdd = "the " & rs!County
Else
!NoticeAdd = Trim(rs![County]) & " County"
End If

!NoticeAdd2 = rs![CE_Address]
!NoticeCSZ = Trim(rs![CE_City]) & ", " & rs![CE_State] & "  " & rs![CE_Zip]
!NoticeCITY = Trim(rs!CE_City)
!NoticeSTATE = Trim(rs!CE_State)
!NoticeZIP = Trim(rs!CE_Zip)

.Update
.Close

End With


rs.Close

End Function

Public Function ExportCoExec()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim VBK
Dim vFile

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

vFile = Forms![foreclosure database screen]!filenum

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

With rsnotice
.AddNew
!NoticeTo = "Attention: " & rs![CE_Name] & ", " & rs!CE_Title
!filenum = Forms![foreclosure database screen]!filenum
If rs![County] Like "*City" Then
!NoticeAdd = Trim(rs![County])
'ElseIf rs!County Like "City*" Then
'!NoticeAdd = "The " & rs!County
Else
!NoticeAdd = Trim(rs![County]) & " County"
End If

!NoticeAdd2 = rs![CE_Address]
!NoticeCSZ = Trim(rs![CE_City]) & ", " & rs![CE_State] & "  " & rs![CE_Zip]
!NoticeCITY = Trim(rs!CE_City)
!NoticeSTATE = Trim(rs!CE_State)
!NoticeZIP = Trim(rs!CE_Zip)
.Update
.Close

End With


rs.Close

End Function
Public Function ExportHOACo3Queue()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim Vzip
Dim vFile
Dim VCo

If Forms![pud queue]![PUDName] <> "" Then

If IsNull(Forms![pud queue]!HOAId) Then
MsgBox ("Please go and select the PUD Address from the drop down box on the Title Exam Screen.  There is no unique character.")
Exit Function
End If

VCo = Forms![pud queue]!HOAId

vFile = Forms![pud queue]!filenum

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from hoamaster where [id] = " & VCo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then

If Not IsNull(rs!CompanyName3) Or rs![Company3_add1] <> "" Then
With rsnotice
.AddNew


!NoticeTo = rs![business name]
!filenum = Forms![pud queue]!filenum

If Not IsNull(rs!CompanyName3) Then
!NoticeContact = "c/o " & rs![CompanyName3]
End If

!NoticeAdd = rs![Company3_add1]


If Not IsNull(rs!Company3_add2) Then
!NoticeAdd2 = rs![Company3_add2]
End If




!NoticeCSZ = Trim(rs![Company3_city]) & ", " & rs![company3_state] & "  " & rs!company3_zipcode


!NoticeCITY = Trim(rs!Company3_city)
!NoticeSTATE = Trim(rs!company3_state)
!NoticeZIP = Trim(rs!company3_zipcode)
.Update
End With
End If



rs.Close
rsnotice.Close
End If

End If
End Function

Public Function ExportHOAMgmtQueue()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim Vzip
Dim vFile
Dim VCo

'If Forms![PUD Queue]!MgmtCo <> "" Then
If Forms![pud queue]![PUDName] <> "" Then

If IsNull(Forms![pud queue]!HOAId) Then
MsgBox ("Please go and select the PUD Address from the drop down box on the Title Exam Screen.  There is no unique character.")
Exit Function
End If

VCo = Forms![pud queue]!HOAId

vFile = Forms![pud queue]!filenum


Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from hoamaster where [id] = " & VCo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rs.EOF Then
MsgBox ("Management Company input in Title Exam screen but not input in HOA Master screen.  Will not continue.  Fix entry.")
Exit Function

Else

If Not rs.EOF Then

If Not IsNull(rs!Mgmt_Company) Or rs!mgmt_address1 <> "" Then
With rsnotice
.AddNew
!filenum = Forms![pud queue]!filenum

!NoticeTo = rs![business name]

If Not IsNull(rs!Mgmt_Company) Then
!NoticeContact = "c/o " & rs![Mgmt_Company]
End If

!NoticeAdd = rs![mgmt_address1]

If Not IsNull(rs!mgmt_address2) Then
!NoticeAdd2 = rs!mgmt_address2
End If


!NoticeCSZ = Trim(rs![mgmt_city]) & ", " & rs![mgmt_state] & "  " & rs!Mgmt_Zipcode
!NoticeCITY = Trim(rs!mgmt_city)
!NoticeSTATE = Trim(rs!mgmt_state)
!NoticeZIP = Trim(rs!Mgmt_Zipcode)
.Update
End With
End If

End If

rs.Close
rsnotice.Close
End If
End If

End Function

Public Function ExportHOAMgmt()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim Vzip
Dim vFile

'CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

vFile = Forms![foreclosure database screen]!filenum

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from hoamaster where [business name] = " & """" & Forms![foreclosure database screen]!HOAAdd.Form!HOAAdd & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then

If Not IsNull(rs!Mgmt_Company) Or Not IsNull(rs!mgmt_address1) Then
With rsnotice
.AddNew
!filenum = Forms![pud queue]!filenum

!NoticeTo = rs![business name]

If Not IsNull(rs!Mgmt_Company) Then
!NoticeContact = "c/o " & rs![Mgmt_Company]
End If

!NoticeAdd = rs![mgmt_address1]

If Not IsNull(rs!mgmt_address2) Then
!NoticeAdd2 = rs!mgmt_address2
End If


!NoticeCSZ = Trim(rs![mgmt_city]) & ", " & rs![mgmt_state] & "  " & rs!Mgmt_Zipcode
!NoticeCITY = Trim(rs!mgmt_city)
!NoticeSTATE = Trim(rs!mgmt_state)
!NoticeZIP = Trim(rs!Mgmt_Zipcode)
.Update
End With
End If

End If

rs.Close
rsnotice.Close

End Function
Public Function ExportHOA()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim Vzip
Dim vFile


vFile = Forms![foreclosure database screen]!filenum

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from hoamaster where [business name] = " & """" & Forms![foreclosure database screen]!HOAAdd.Form!HOAAdd & """" & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If Not rs.EOF Then

With rsnotice
.AddNew


!NoticeTo = rs![business name]
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rs![Address1]

If Not IsNull(rs!Address2) Then
!NoticeAdd2 = rs![Address2]
End If


!NoticeCSZ = Trim(rs![City]) & ", " & rs![State] & "  " & rs!ZipCode
!NoticeCITY = Trim(rs!City)
!NoticeSTATE = Trim(rs!State)
!NoticeZIP = Trim(rs!ZipCode)
.Update

End With

End If
rsnotice.Close
rs.Close
End Function
Public Function ExportHOAQUeue()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim Vzip
Dim vFile
Dim VCo

'MsgBox (Forms![pud queue]![hoaid])

If Forms![pud queue]![PUDName] <> "" Then
If IsNull(Forms![pud queue]!HOAId) Then
MsgBox ("Please go and select the PUD Address from the drop down box on the Title Exam Screen.  There is no unique character.")
Exit Function
End If




VCo = Forms![pud queue]!HOAId

vFile = Forms![pud queue]!filenum

'MsgBox (VCo & ": FILE#: " & VFile)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from hoamaster where [id] = " & VCo & ";"
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)


If Not rs.EOF Then

With rsnotice
.AddNew


!NoticeTo = rs![business name]
!filenum = Forms![pud queue]!filenum

If Not IsNull(rs![Contact Name]) Then
!NoticeContact = "c/o " & rs![Contact Name]
End If

!NoticeAdd = rs![Address1]

If Not IsNull(rs!Address2) Then
!NoticeAdd2 = rs![Address2]
End If


!NoticeCSZ = Trim(rs![City]) & ", " & rs![State] & "  " & rs!ZipCode
!NoticeCITY = Trim(rs!City)
!NoticeSTATE = Trim(rs!State)
!NoticeZIP = Trim(rs!ZipCode)
.Update


End With

End If
rsnotice.Close
rs.Close

End If

End Function
Public Function ExportBKAddress()
Dim rs As RecordSet
Dim rsB As RecordSet
Dim strsql As String
Dim VBK
Dim vFile
Dim VCounter
VCounter = Forms!bankruptcymain!BankruptcySubForm.Form!counter

vFile = Forms![foreclosure database screen]!filenum

strsql = "select * from bankruptcy where subfilenum = " & vFile & " and counter = " & VCounter
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

If Not IsNull(rs!trustee_name) Or Not IsNull(Trustees()) Then
With rsnotice
.AddNew
!NoticeTo = Trustees() & ", Trustee"
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = IIf(rs![trustee_name] <> "", rs![trustee_add], trusteeadd())
!NoticeCSZ = IIf(rs![trustee_name] <> "", rs![trustee_citystatezip], trusteecsz())
.Update
End With
End If

If Not IsNull(rs!Attorney) Then
With rsnotice
.AddNew
!NoticeTo = rs!Attorney
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rs!att_add1
!NoticeAdd2 = rs![att_add2]
!NoticeCSZ = rs![att_city] & ", " & rs![att_state] & "  " & rs![att_zip]
.Update
End With
End If

rs.Close

End Function
Public Function ExportBKCert()
'BK Certificate of Service depends on What button is checked on the BK Screen of WHO Files
 

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Call ExportCreditorsBK
Call ExportBKAddress
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

With rsnotice
.AddNew
!NoticeTo = bkCertName()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = bkCertAdd()
!NoticeCSZ = bkCertCSZ()
!extra = "BKCert"
.Update
End With

With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
'If attorneybar() <> "" Then
!NoticeTo = attorneysigns() & ", Esq."
'Else
'!NoticeTo = attorneysigns() & ", Esq."
'End If

!NoticeAdd = SignAdd1()
!NoticeCSZ = SignAdd2()
!extra = "BGW"
.Update
End With

If (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 1) Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13 Then

With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If firstdebtor() <> "" And BKChapter() <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
!extra = "YES"
End If
.Update
End With

If MailSDat = "Grantor1" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = firstdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Grantor1" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Grantor1" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = firstdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or _
Forms![foreclosure database screen]!LastNameDebtor2 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then

With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If secondDebtor() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
!extra = "YES"
End If
.Update
End With

If MailSDat = "Grantor2" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = secondDebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Grantor2" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Grantor2" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = secondDebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!LastNameDebtor3) Or _
Forms![foreclosure database screen]!LastNameDebtor3 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then
'msgbox ("3rd")

With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If thirddebtor() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
!extra = "YES"
End If

.Update
End With

If MailSDat = "Grantor3" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If (MailA = "Grantor3" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Grantor3" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = thirddebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor4) Or _
Forms![foreclosure database screen]!lastnamedebtor4 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then
'msgbox ("4th")

With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If fourthdebtor() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
!extra = "YES"
End If

.Update
End With

If MailSDat = "Grantor4" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If (MailA = "Grantor4" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Grantor4" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fourthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnamedebtor5) Or _
Forms![foreclosure database screen]!lastnamedebtor5 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then

'msgbox ("5th")

With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If fifthdebtor() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![5filed])) Then
!extra = "YES"
End If

.Update
End With

If MailSDat = "Grantor5" Or MailSDat = "All Grantors" Or MailSDat = "All" Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If (MailA = "grantor5" Or MailA = "All Grantors" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Grantor5" Or MailB = "All Grantors" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = fifthdebtor()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

'OWNERS

If (Not IsNull(Forms![foreclosure database screen]!lastnameo1) Or _
Forms![foreclosure database screen]!lastnameo1 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then
'msgbox ("O1")

With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If owner1() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed])) Then
!extra = "YES"
End If

.Update
End With

If MailSDat = "Owner1" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = owner1()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Owner1" Or MailA = "All Owners" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "owner1" Or MailB = "All Owners" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

If (Not IsNull(Forms![foreclosure database screen]!lastnameo2) Or _
Forms![foreclosure database screen]!lastnameo2 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then
'msgbox ("O2")

With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If owner2() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed])) Then
!extra = "YES"
End If
.Update
End With

If MailSDat = "Owner2" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = owner2()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Owner2" Or MailA = "All Owners" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Owner2" Or MailB = "All Owners" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner2()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If


If MailSDat = "Owner1" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = owner1()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Owner1" Or MailA = "All Owners" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "owner1" Or MailB = "All Owners" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner1()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If


If (Not IsNull(Forms![foreclosure database screen]!lastnameo3) Or _
Forms![foreclosure database screen]!lastnameo3 <> "") And _
(Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![o3filed] = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form![chapter] = 13) Then
'msgbox ("O2")

With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
If IsNull(Forms![foreclosure database screen]![unit_no]) Or _
Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
If owner2() <> "" And (Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed])) Then
!extra = "YES"
End If
.Update
End With

If MailSDat = "Owner2" Or MailSDat = "All Owners" Or MailSDat = "All" Then
With rsnotice
.AddNew
!filenum = Forms![foreclosure database screen]!filenum
!NoticeTo = owner2()
!NoticeAdd = Forms![foreclosure database screen]![SDatAddress]
!NoticeAdd2 = Forms![foreclosure database screen]![SDatAddress2]
!NoticeCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]
.Update
End With
End If

If (MailA = "Owner2" Or MailA = "All Owners" Or MailA = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing Address]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
.Update
End With
End If

If (MailB = "Owner3" Or MailB = "All Owners" Or MailB = "All") Then
With rsnotice
.AddNew
!NoticeTo = owner3()
!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = Forms![foreclosure database screen]![Mailing AddressB]
!NoticeAdd2 = Forms![foreclosure database screen]![Mailing Address2B]
!NoticeCSZ = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
.Update
End With
End If
End If

'If Forms!BankruptcyMain!bankruptcysubform.Form![owner3] = -1 Or _
'Forms!BankruptcyMain!bankruptcysubform.Form![owner3] = 1 Or _
'Forms!BankruptcyMain!bankruptcysubform.Form![chapter] = 13 Then
'Call Owner3AllFields
'End If


rsnotice.Close


End Function

Public Function ExportOwnersNoOccupant()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

If AppType Like "fairdebt*" Then
VNoticeDate = Date
Else
VNoticeDate = NoticeDate()
End If

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)
If rspropertycounty.EOF Then
MsgBox ("County input incorrectly?  Will exit")
rspropertycounty.Close
rsnotice.Close
Exit Function
End If

If IsNull(rspropertycounty!SaleHeld) Or rspropertycounty!SaleHeld = "" Then
VSaleHeld = ""
MsgBox ("No Sale Held information for " & rspropertycounty!County & " on Jurisdiction Screen, letters will not dumps")
Exit Function
Else
VSaleHeld = rspropertycounty!SaleHeld
End If

Call Owner1AllFields
Call Owner2AllFields
Call Owner3AllFields

rspropertycounty.Close
rsnotice.Close

End Function
Public Function exportDebtorsDIL()

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
Call DebtorsAddressMailings
End Function
Public Function ExportNotices()

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Call DebtorsALLFields
Call ExportNoticesOWNERS
Call ExportLienholderRONotices
Call OccupantAllFields

gOcc = 0


End Function

Public Function ExportLienholderNoticesVA()
Dim rsLienHolders As RecordSet, rsnotice As RecordSet
Dim strsqlLIEN As String
VNoticeDate = Date

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Set rsnotice = CurrentDb.OpenRecordset("notices", dbOpenDynaset, dbSeeChanges)

strsqlLIEN = "SELECT * FROM creditors WHERE creditors.FIleNum = " & [Forms]![foreclosure database screen]![filenum] & ";"

Set rsLienHolders = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)

GblFilenum = Forms![foreclosure database screen]![filenum]


Dim rspropertycounty As RecordSet
Dim strsql As String
strsql = "select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

If rsLienHolders.EOF Then
rsLienHolders.Close
Else
Do While Not rsLienHolders.EOF
With rsnotice
.AddNew
!NoticeTo = rsLienHolders!OrganizationName

!StartPage = VSpage + 1
VSpage = VSpage + 1

!filenum = Forms![foreclosure database screen]!filenum
!NoticeAdd = rsLienHolders!Address
If Not IsNull(rsLienHolders!Address2) Then
!NoticeAdd2 = rsLienHolders!Address2
Else
!NoticeAdd2 = ""
End If
!NoticeCSZ = rsLienHolders!City & ", " & rsLienHolders!State & "  " & rsLienHolders!PostalCode

!NoticeCITY = rsLienHolders!City
!NoticeSTATE = rsLienHolders!State
!NoticeZIP = rsLienHolders!PostalCode

!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Date
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rsLienHolders!att_for
!Salutation = "Sir/Madam"
!Client = Forms![foreclosure database screen]!Client
'========
!filenum = Forms![foreclosure database screen]!filenum
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = Forms![foreclosure database screen]![firstnameo1] & " " & Forms![foreclosure database screen]!lastnameo1
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
If IsNull(VNoticeDate) Or VNoticeDate = "" Then
!noticesent = Date
Else
!noticesent = VNoticeDate
End If
!Client = Forms![foreclosure database screen]!Client
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount



'=======
.Update
End With
rsLienHolders.MoveNext
Loop
rsnotice.Close
rsLienHolders.Close

End If

End Function

Public Function ExportNTQVa()
Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError

Call DebtorsALLFields
Call ExportNoticesOWNERS
'Call ExportOccupantsEvic

End Function
Public Function ExportOccupants()

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

'Eviction Code
Dim VVar, VVar2, VVar3, VVar4, VPutOut, VVara, VVar2a, VVar3a, VVar4a
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If Not rsE.EOF Then
VVar = rsE!Occ_Last1
VVar2 = rsE!Occ_Last2
VVar3 = rsE!Occ_Last3
VVar4 = rsE!Occ_Last4
VVara = rsE!Occ_First1
VVar2a = rsE!Occ_First2
VVar3a = rsE!Occ_First3
VVar4a = rsE!Occ_First4
VPutOut = VPutOut

Else
VVar = Null
VVar2 = Null
VVar3 = Null
VVar4 = Null
VVara = Null
VVar2a = Null
VVar3a = Null
VVar4a = Null
VPutOut = Null

End If
rsE.Close
'End Eviction Code

CurrentDb.Execute "Delete * from NoticesOccupants;", dbFailOnError



Set rsnotice = CurrentDb.OpenRecordset("NoticesOccupants", dbOpenDynaset, dbSeeChanges)

If IsNull(VVar) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant1()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = VVara & " " & VVar
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!filenum = Forms![foreclosure database screen]!filenum
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPutOut) Then
Else
!PutOutDate = VPutOut
End If

.Update
End With
End If

If IsNull(VVar2) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant2()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = VVar2a & " " & VVar2
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!filenum = Forms![foreclosure database screen]!filenum
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPutOut) Then
Else
!PutOutDate = VPutOut
End If

.Update
End With
End If

If IsNull(VVar3) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant3()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = VVar3a & " " & VVar3
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!filenum = Forms![foreclosure database screen]!filenum
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPutOut) Then
Else
!PutOutDate = VPutOut
End If

.Update
End With
End If

If IsNull(VVar4) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant4()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = VVar4a & " " & VVar4
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!filenum = Forms![foreclosure database screen]!filenum
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPutOut) Then
Else
!PutOutDate = VPutOut
End If

.Update
End With
End If

With rsnotice
.AddNew
!NoticeTo = "Occupant(s)"
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!PropertyState = Forms![foreclosure database screen]!PropertyState
!SaleHeld = rspropertycounty!SaleHeld
!Salutation = "Sir/Madam"
!SaleTime = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime
!SaleDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate
!noticesent = Forms![foreclosure database screen]!ForeclosureSubForm.Form!noticesent
!Client = Forms![foreclosure database screen]!Client
!filenum = Forms![foreclosure database screen]!filenum
!DOTDate = Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate
!SecuredParty = Forms![foreclosure database screen]!SecuredParty
!Propertycounty = Forms![foreclosure database screen]!Propertycounty
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount

If IsNull(VPutOut) Then
Else
!PutOutDate = VPutOut
End If

.Update
End With

rspropertycounty.Close
rsnotice.Close


End Function
Public Function ExportOccupantsEvic()
Dim rs As RecordSet

GblFilenum = Forms![foreclosure database screen]![filenum]

'Eviction Code
Dim VVar, VVar2, VVar3, VVar4, VPutOut, VVara, VVar2a, VVar3a, VVar4a
Dim strsqlE
Dim rsE As RecordSet
strsqlE = "Select * from eviction where subfilenum = " & GblFilenum & ";"
Set rsE = CurrentDb.OpenRecordset(strsqlE, dbOpenSnapshot)

If Not rsE.EOF Then
VVar = rsE!Occ_Last1
VVar2 = rsE!Occ_Last2
VVar3 = rsE!Occ_Last3
VVar4 = rsE!Occ_Last4
VVara = rsE!Occ_First1
VVar2a = rsE!Occ_First2
VVar3a = rsE!Occ_First3
VVar4a = rsE!Occ_First4
VPutOut = VPutOut

Else
VVar = Null
VVar2 = Null
VVar3 = Null
VVar4 = Null
VVara = Null
VVar2a = Null
VVar3a = Null
VVar4a = Null
VPutOut = Null

End If
rsE.Close
'End Eviction Code

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

If IsNull(VVar) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant1()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip

!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If IsNull(VVar2) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant2()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

If IsNull(VVar3) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant3()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum

.Update
End With
End If

If IsNull(VVar4) Then
Else
With rsnotice
.AddNew
!NoticeTo = Occupant4()
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With
End If

With rsnotice
.AddNew
!NoticeTo = "All Occupants"
If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!NoticeAdd = Forms![foreclosure database screen]![PropAddress]
Else
!NoticeAdd = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!NoticeAdd2 = Forms![foreclosure database screen]!propaddress2
!NoticeCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!NoticeCITY = Forms![foreclosure database screen]!PropertyCity
!NoticeSTATE = Forms![foreclosure database screen]!PropertyState
!NoticeZIP = Forms![foreclosure database screen]!propzip
!filenum = Forms![foreclosure database screen]!filenum
.Update
End With

Call ExportOwnersNoOccupant


End Function

Public Function ExportNoticesOWNERS()

Dim VSaleHeld, VNewspaper, VNew1, VNew2 As String

Dim rs, rsnotice, rspropertycounty, rsClient, rsletter As RecordSet
Dim strsql, sqlpropertycounty, sqlclient, sqlLetter As String

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

VSaleHeld = rspropertycounty!SaleHeld

Call Owner1AllFields
Call Owner2AllFields
Call Owner3AllFields

rspropertycounty.Close
rsnotice.Close
End Function
Public Function ExportDemandLtrs()

CurrentDb.Execute "DELETE * FROM notices;", dbFailOnError
Set rsnotice = CurrentDb.OpenRecordset("Notices", dbOpenDynaset, dbSeeChanges)

With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor1 & " " & Forms![demand letter screen]!LastNameDebtor1
If IsNull(Forms![demand letter screen]![unit_no]) Or Forms![demand letter screen]![unit_no] = "" Then
!NoticeAdd = Forms![demand letter screen]![PropAddress]
Else
!NoticeAdd = Forms![demand letter screen]![PropAddress] & ", Unit # " & Forms![demand letter screen]![unit_no]
End If
'!NoticeAdd2 = Forms![Demand Letter Screen]!propaddress2
!NoticeCSZ = Forms![demand letter screen]!PropertyCity & ", " & Forms![demand letter screen]!PropertyState & "  " & Forms![demand letter screen]!propzip
!Salutation = Forms![demand letter screen]![FirstNameDebtor1] & " " & Forms![demand letter screen]!LastNameDebtor1
.Update
End With

If Not IsNull(Forms![demand letter screen]![Mailing Address]) Then
With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor1 & " " & Forms![demand letter screen]!LastNameDebtor1
!NoticeAdd = Forms![demand letter screen]![Mailing Address]
!NoticeAdd2 = Forms![demand letter screen]![Mailing Address2]
!NoticeCSZ = Forms![demand letter screen]![Mailing City] & ", " & Forms![demand letter screen]![Mailing State] & "  " & Forms![demand letter screen]![Mailing Zip]
!Salutation = Forms![demand letter screen]![Mr_Mrs_Ms] & " " & Forms![demand letter screen]!LastNameDebtor1
.Update
End With

End If

If Not IsNull(Forms![foreclosure database screen]!LastNameDebtor2) Or Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor2 & " " & Forms![demand letter screen]!LastNameDebtor2
If IsNull(Forms![demand letter screen]![unit_no]) Or Forms![demand letter screen]![unit_no] = "" Then
!NoticeAdd = Forms![demand letter screen]![PropAddress]
Else
!NoticeAdd = Forms![demand letter screen]![PropAddress] & ", Unit # " & Forms![demand letter screen]![unit_no]
End If
'!NoticeAdd2 = Forms![Demand Letter Screen]!propaddress2
!NoticeCSZ = Forms![demand letter screen]!PropertyCity & ", " & Forms![demand letter screen]!PropertyState & "  " & Forms![demand letter screen]!propzip
!Salutation = Forms![demand letter screen]![Mr_Mrs_Ms2] & " " & Forms![demand letter screen]!LastNameDebtor2
.Update
End With


If Not IsNull(Forms![demand letter screen]![Mailing Address]) Then
With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor2 & " " & Forms![demand letter screen]!LastNameDebtor2
!NoticeAdd = Forms![demand letter screen]![Mailing Address]
!NoticeAdd2 = Forms![demand letter screen]![Mailing Address2]
!NoticeCSZ = Forms![demand letter screen]![Mailing City] & ", " & Forms![demand letter screen]![Mailing State] & "  " & Forms![demand letter screen]![Mailing Zip]
!Salutation = Forms![demand letter screen]![Mr_Mrs_Ms2] & " " & Forms![demand letter screen]!LastNameDebtor2
.Update
End With

End If
End If

If IsNull(Forms![demand letter screen]!LastNameDebtor3) Then
Else

With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor3 & " " & Forms![demand letter screen]!LastNameDebtor3
If IsNull(Forms![demand letter screen]![unit_no]) Or Forms![demand letter screen]![unit_no] = "" Then
!NoticeAdd = Forms![demand letter screen]![PropAddress]
Else
!NoticeAdd = Forms![demand letter screen]![PropAddress] & ", Unit # " & Forms![demand letter screen]![unit_no]
End If
'!NoticeAdd2 = Forms![Demand Letter Screen]!propaddress2
!NoticeCSZ = Forms![demand letter screen]!PropertyCity & ", " & Forms![demand letter screen]!PropertyState & "  " & Forms![demand letter screen]!propzip
!Salutation = Forms![demand letter screen]![Mr_Mrs_Ms3] & " " & Forms![demand letter screen]!LastNameDebtor3
.Update
End With



If Not IsNull(Forms![demand letter screen]![Mailing Address]) Then
With rsnotice
.AddNew
!NoticeTo = Forms![demand letter screen]!FirstNameDebtor3 & " " & Forms![demand letter screen]!LastNameDebtor3
!NoticeAdd = Forms![demand letter screen]![Mailing Address]
!NoticeAdd2 = Forms![demand letter screen]![Mailing Address2]
!NoticeCSZ = Forms![demand letter screen]![Mailing City] & ", " & Forms![demand letter screen]![Mailing State] & "  " & Forms![demand letter screen]![Mailing Zip]
!Salutation = Forms![demand letter screen]![Mr_Mrs_Ms3] & " " & Forms![demand letter screen]!LastNameDebtor3
.Update
End With

End If
End If


rsnotice.Close
End Function

Public Function ExportDOAdata()
CurrentDb.Execute "Delete * from DOAMerge;", dbFailOnError

Dim PrtOut, VarFileNo, VarNWAMU1, VarNWAMU2, VarNWamuInput, VarNWAMU3, VarNWAMU4, VarNWAMU5, VarNWAMU6 As String
Dim VarNotBody1, VarNotBody2, VarNotBody3 As String
Dim rs, rsDOA As RecordSet
Dim strsql, VarParty1, VarSecuredParty, VarSigns As String

'VarFileNo = Forms![foreclosure database screen]![FileNum]

strsql = "SELECT DBA_viewPart1.* from DBA_viewPart1 WHERE (((DBA_viewPart1.FileNum)= " & Forms![foreclosure database screen]![filenum] & "));"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsDOA = CurrentDb.OpenRecordset("DOAMerge", dbOpenDynaset, dbSeeChanges)

With rsDOA
.AddNew
!filenum = Forms![foreclosure database screen]![filenum]
!Debtors = debtorsOPEN()
!fid_no = rs!fid_no
!longsecured = rs!longsecured
!Client = rs!Client

If Client() = "JPMorgan Chase Bank, National Association" Or Client() = "washington mutual bank" Or rs![Fmortgage] = -1 Then
VarParty1 = ""
Else
If Client() Like "Citi*" Then
VarSecuredParty = "THE LENDER"
Else
VarSecuredParty = rs!SecuredParty
End If
VarParty1 = " (" & """" & VarSecuredParty & """" & "),"
End If
!party1stpart = rs!longsecured & VarParty1

!AttorneyAddress = "6003 Executive Blvd., Suite 101, Rockville, MD 20852"

If rs![Propertycounty] = "Baltimore City" Then
!Propertycounty = "Baltimore City,"
Else
!Propertycounty = rs![Propertycounty] & " County,"
End If

!liberfolio = liberfolio()

!DOTDate = rs!DOTDate
!dotrecd = rs![dot recorded]
!legal = rs!LegalDescription
!PROP = PROP()
!OrgLender = rs!OrgLender
!OrgAmount = rs!OrgAmount
!orgtrustee = rs!orgtrustee
!Attorneys = Part1Trustees()

If rs![SPsameasCl] = No Then

If Client() Like "Citi*" Then
VarNWAMU1 = "THE LENDER"
Else
VarNWAMU1 = UCase(rs![SecuredParty])
End If

Else

If Client() = "Ocwen Loan Servicing, LLC" Then
VarNWAMU1 = UCase(rs![SecuredParty])
Else
VarNWAMU1 = UCase(Client())
End If
End If


If Client() Like "Citi*" Or Client() Like "OneWest*" Then

VarNWamuInput = ", attorney-in-fact, by "
Else
VarNWamuInput = ", its authorized Servicing Agent, by "
End If

If rs![SPsameasCl] = No Then
VarNWAMU2 = UCase(Client()) & VarNWamuInput
Else
VarNWAMU2 = ""
End If

If rs![attSign2] <> "" Then
VarNWAMU3 = rs![doaSign1] & ", " & rs![Title1] & " and attested to by " & rs![attSign2] & ", " & rs![Title2]

Else

If rs![doaSign1] <> "" Then
VarNWAMU3 = rs![doaSign1] & ", " & rs![Title1]

Else

VarNWAMU3 = "______________________, its ___________________"
End If
End If

If IsNull(rs!attSign2) Then
VarNWAMU4 = " which individual the said "
Else
VarNWAMU4 = " which individuals the said "
End If

If rs![SPsameasCl] = No Then

If Client() Like "Citi*" Then
VarNWAMU5 = "LENDER"
Else
VarNWAMU5 = UCase(rs![SecuredParty])
End If

Else

If Client() Like "Ocwen*" Then
VarNWAMU5 = rs![SecuredParty]
Else
VarNWAMU5 = UCase(Client())
End If
End If

If IsNull(rs!attSign2) Then
VarNWAMU6 = " has appointed as the party with proper authority so to act for the purposes contained herein."
Else
VarNWAMU6 = " has appointed as the parties with proper authority so to act for the purposes contained herein."
End If

!VarSigns1 = VarNWAMU1 + VarNWAMU2 + VarNWAMU3
!varsigns2 = VarNWAMU4 + VarNWAMU5 + VarNWAMU6 + " "

!doasign = rs!doaSign1
!signatureblock = rs![signature block]
!attSign2 = rs!attSign2
!Title = rs!Title1
!Title2 = rs!Title2

If rs![Fmortgage] = -1 Then
!Signature2 = ""

Else

If Client() Like "Citi*" Or Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
!Signature2 = ""
Else
If rs![SPsameasCl] = 0 Or IsNull(rs!SPsameasCl) Then
!Signature2 = "By:  " & UCase(Client())
End If
End If
End If

If Client() = "BankUnited" Then
!signatureline = "Fran Vater"
ElseIf Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
!signatureline = "Title:___________________________________"
Else
!signatureline = rs!doaSign1
End If

!ClientState = UCase(rs!State)
!clientcounty = UCase(rs!County)
!dateyear = "20__"


If rs![Fmortgage] = -1 Then
VarNotBody1 = " of " & rs![longsecured]
Else
If Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
VarNotBody1 = ""
Else
VarNotBody1 = " of " & UCase(Client())
End If
End If

If rs![SPsameasCl] = No Then
If Client() Like "Citi*" Or Client() Like "OneWest*" Then
VarNotBody2 = ", attorney-in-fact for "
ElseIf Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
VarNotBody2 = ", servicing agent for "
Else
VarNotBody2 = ", servicer/agent for "
End If
End If

If Client() Like "Citi*" Then
VarNotBody3 = "the above referenced secured party"
Else
VarNotBody3 = UCase(rs![longsecured])
End If

!notarybody = VarNotBody1 + VarNotBody2 + VarNotBody3

If rs![attSign2] <> "" Then
If Client() = "BankUnited" Then
!notarybox = "Fran Vater, Vice President"
Else
!notarybox = rs![doaSign1] & ", " & rs![Title1] & " and " & rs![attSign2] & ", " & rs![Title2]
End If

Else

If rs![doaSign1] <> "" Then
If Client() = "BankUnited" Then
!notarybox = "Fran Vater, Vice President"
Else
!notarybox = rs![doaSign1] & ", " & rs![Title1]
End If

Else

!notarybox = "______________________, its ___________________"
End If
End If


.Update
End With




'Call RunDOAMerge



End Function
Public Function RunOrderTerm()
VTypeMerge = "OrderTerm"

Call BkMerge

oDoc = "13NODOrder.doc"

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function
Public Function RunAffDefCITI()
 

VTypeMerge = "AffDefault"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiTest.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
Public Function RUNCOD()


VTypeMerge = "COD"

Call BkMergeNOD


oDoc = "COD.doc"


AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\NODTemplates\"
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
'DoCmd.RunMacro ("exportbkmergenod")
DoCmd.TransferText acExportDelim, , "bkmergeNOD", pathuser() & "bkmerge.txt", True

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
wrdMailMerge.Execute True
End Function
Public Function RunNOT()
VTypeMerge = "NOT"

Call BkMergeNOT

If Forms![foreclosure database screen]!Client Like "Wells*" Then

If TotalFinalCurePost() = 0 Then
oDoc = "NOFCresponse.WellsFargo.current.doc"
Else
oDoc = "NOFCresponse.WellsFargo.delinquent.doc"
End If



ElseIf Forms![foreclosure database screen]!Client Like "Bank of Amer*" Then

If TotalFinalCurePost() = 0 Then
oDoc = "NOFCresponse.BAC.current.doc"
Else
oDoc = "NOFCresponse.BAC.delinquent.doc"
End If

Else

If TotalFinalCurePost() = 0 Then
oDoc = "NOFCResponse.current.doc"
Else
oDoc = "NOFCResponse.delinquent.doc"
End If

End If


AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
'DoCmd.RunMacro ("exportbkmergenot")
DoCmd.TransferText acExportDelim, , "bkmergeNOT", pathuser() & "bkmerge.txt", True

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges
End Function
Public Function RunNOD()
VTypeMerge = "NOD"

If Forms![foreclosure database screen]!Client Like "CitiMor*" Or _
Forms![foreclosure database screen]!Client Like "Everbank*" Then
MsgBox ("SCRA search must be completed prior to NOD filing. Search results and criteria must be uploaded to the database and the client. Please also provide a copy of SCRA search results/criteria to reviewing attorney.")
End If

Call BkMergeNOD

If Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 1 Then
oDoc = "NODFirst.doc"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 2 Then
oDoc = "NODSecond.doc"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 3 Then
oDoc = "NODThird.doc"
Else
oDoc = "NODForm.doc"
End If

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\NODTemplates\"
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
DoCmd.RunMacro ("exportbkmergenod")
DoCmd.TransferText acExportDelim, , "bkmergeNOD", pathuser() & "bkmerge.txt", True

Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
wrdMailMerge.Execute True
wrddoc.Close wdDoNotSaveChanges

End Function


Public Function BkMerge()
 
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmerge;", dbFailOnError

DoCmd.OpenQuery ("consentmerge")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMerge", dbOpenDynaset, dbSeeChanges)

Dim VCon1, VCon2, VCon3
Dim VRegMPD, VRegMD, VRegMOB, VTh, Vth3
Dim VlumpSum, VLumpAmt, VLumpdate
Dim VIncarr
Dim VBK
Dim OneSix
Dim CoDebtorListing
Dim VRemaining
Dim VTotalArr
Dim Vcon2a
Dim Vcon2b
Dim VRelief
Dim VHrgTime
Dim VDayDue
Dim VDueth
Dim VdueDay
Dim VSClaim
Dim VPArrears
Dim VmfrFilingFee
Dim rsBKArr As RecordSet

DoCmd.OpenQuery "BKMergeArrPayExcel"

Set rsBKArr = CurrentDb.OpenRecordset("BKMergeArrPay")


VmfrFilingFee = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_attcosts, "$###,##0.00")

VRelief = [Forms]![bankruptcymain]![BankruptcySubForm].Form!Relief

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage]) Then
VTotalArr = 0

Else
VTotalArr = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$###,##0.00")
End If



VIncarr = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![incarr]
VlumpSum = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![lumpsum]
VLumpAmt = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt, "$###,##0.00")
VLumpdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_date, "mmmm dd, yyyy")
VRegMD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment], "$###,##0.00")
VRegMPD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment Date], "mmmm dd"", ""yyyy")
VRegMOB = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly on or Before Day]
VPPmob = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Post Petition On Or Before Day]


If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
Else
VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

If IsNull(VLumpAmt) Or VLumpAmt = "" Then
VRemaining = 0
Else
VRemaining = Format(VTotalArr - VLumpAmt, "$###,##0.00")
End If


VTh = IIf(VRegMOB = 1 Or VRegMOB = 21 Or VRegMOB = 31, "st", IIf(VRegMOB = 2 Or VRegMOB = 22, "nd", IIf(VRegMOB = 3 Or VRegMOB = 23, "rd", "th")))
Vth3 = IIf(VPPmob = 1 Or VPPmob = 21 Or VPPmob = 31, "st", IIf(VPPmob = 2 Or VPPmob = 22, "nd", IIf(VPPmob = 3 Or VPPmob = 23, "rd", "th")))
vonesix = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![post petition payments], "$###,##0.00")

If VTypeMerge = "LETTER" Then
Dim Vproc

Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String
Do While Vproc <> "YES"
vInitials = getEmployeeInitials(Environ("username"))
strsqlEmp = "select * from employees where employeeid = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)
If rsEmp.EOF Then
MsgBox ("Incorrect Initials, please re-input")
Else
Vproc = "YES"

If Not IsNull(rsEmp!MiddleName) Then
VCon1 = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
VCon1 = rsEmp!FirstName & " " & rsEmp!LastName
End If

End If
Loop


ElseIf VTypeMerge = "withdrawNOD" Then

If [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![NODResolution].[Form]![aod filed] = 1 Then
VCon1 = "First Notice of Default and Notice of Termination of Automatic Stay"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 2 Then
VCon1 = "Second Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 3 Then
VCon1 = "Third Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
Else
VCon1 = "Notice of Default"
End If

ElseIf VTypeMerge = "OrderContinue" Then
VCon1 = bkjudge() & " on " & bkMISChearing()

ElseIf VTypeMerge = "OrdContPlan" Then
VCon1 = bkMISChearing()

ElseIf VTypeMerge = "PlanObjection" Then
If Forms![bankruptcymain]!BankruptcySubForm.Form!PObj_PRes = 1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!PObj_PRes = -1 Then
VCon1 = "The Property is the Debtor's primary residence."
Else
VCon1 = ""
End If

Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!judge = "RGM" Then
VCon1 = "The Debtor will resume making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and will continue to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
Else
VCon1 = "1.     The Debtor resumes making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and continues to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
End If
End If

If VTypeMerge = "PlanObjection" Then

If BKJurisdiction() Like "*Norfolk*" Or BKJurisdiction() Like "*Newport*" Then
VCon2 = "CHAIN OF TITLE - Tidewater."
Else
VCon2 = ""
End If


End If

If (VlumpSum = 0 Or IsNull(VlumpSum)) And (IsNull(VIncarr) Or VIncarr = 0) Then
If Forms![bankruptcymain]!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's total post-petition arrears) on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms![bankruptcymain]!BankruptcySubForm.Form!judge = "RGM" Then
VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by:"
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."

Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = 0 Or IsNull(VIncarr)) Then
If Forms![bankruptcymain]!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else
If VLumpAmt = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage] Then
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Else
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's remaining post-petition arrears of " & VRemaining & ") on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If
End If

ElseIf (VlumpSum = 0 Or IsNull(VlumpSum)) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms![bankruptcymain]!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

End If


Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


If VTypeMerge = "LatePOC" Or _
VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then
VCon1 = Forms![foreclosure database screen]!Propertycounty

If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then
loanMod = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![loanMod]

VCon2 = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![brief_legal]
If Forms![foreclosure database screen]!SPsameasCl = -1 Or _
Forms![foreclosure database screen]!SPsameasCl = 1 Then
VCon3 = ""
Else
VCon3 = " c/o " & Client()
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended = "Increase" Then
Vcon2a = "For purposes of making the increased monthly payments, the Debtor will obtain funds from ______."
Else
Vcon2a = "The Debtor does not intend to increase the amount of the monthly Chapter 13 Plan payments as a result of the monthly mortgage payment being decreased under the terms of the Loan Modification Agreement."
End If


If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included > 0 Then

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraph 2(d) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtors escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
Else
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraphs 6(e) and 6(f) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtor's escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
End If

Else

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "The monthly payment amount set for in paragraph 2(d) hereinabove is inclusive of principal and interest only. No portion of that payment amount is currently being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
Else

Vcon2b = "The monthly payment amounts set for in paragraphs 6(e) and 6(f) hereinabove are inclusive of principal and interest only. No portion of those payments is being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
End If

End If




Else
VCon2 = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!MTA_Dl, "mmmm dd, yyyy")
VCon3 = VdueDay & VDueth
Vcon2a = bkcourt1() & ", " & bkcourt2()
Vcon2b = bkcourt3()
VDate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!mta_hearing, "mmmm dd, yyyy") & " at " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!mta_filed, "hh:ss am/pm")

End If

End If

Dim VIsAre
Dim VHasHave
If Not rs.EOF Then

With rs
.Edit
Dim rsOrdRel
Dim strsqlrsOrd

strsqlrsOrd = "select * from bkordrelief where bkfileno = " & Forms![bankruptcymain]!BankruptcySubForm.Form!counter & ";"
Set rsOrdRel = CurrentDb.OpenRecordset(strsqlrsOrd, dbOpenSnapshot)

If Not rsOrdRel.EOF Then

!ReliefDate = rsOrdRel!relief_granted
!NDRDate = rsOrdRel!NoDist
!DefaultDate = rsOrdRel!default_date
!ssd_da = rsOrdRel!ssd_da
!ssd_tt = rsOrdRel!ssd_tt
!Default_da = rsOrdRel!Default_da
!Default_tt = rsOrdRel!Default_tt
!nodist_da = rsOrdRel!nodist_da
!nodist_tt = rsOrdRel!nodist_tt
!consent_da = rsOrdRel!consent_da
!consent_tt = rsOrdRel!consent_tt
!relief_da = rsOrdRel!relief_da
!relief_tt = rsOrdRel!relief_tt

rsOrdRel.Close
End If

!DebtorFiled = [Forms]![bankruptcymain]![BankruptcySubForm].Form!DebtorFiled
!JointDebtorFiled = [Forms]![bankruptcymain]![BankruptcySubForm].Form!JointDebtorFiled
!surrender = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_sur]
!daresponse = [Forms]![bankruptcymain]![BankruptcySubForm].Form!response_to_mfr
!ttresponse = [Forms]![bankruptcymain]![BankruptcySubForm].Form!trustee_response_MFR

!reliefdelaydays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![relief_ord_no]
!reliefdelaydate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![relief_ord_date]
!lump1amt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Lumpsum_Amt], "$###,##0.00")
!lump1days = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_no1
!lump1date = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_date
!lump2amt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![lumpsum_amt2], "$###,##0.00")
!lump2days = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_no2
!lump2date = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_date2
!stippmtday = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp day due]
!ssddays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ssd_no
!ssddate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ssd_date
!adpropmt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ad_prot_amt, "$###,##0.00")
!moddays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![lmo_no]
!ModDate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lmo_date


!stipfrom = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp payment date], "mmmm dd, yyyy")
!stipthru = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp thru], "mmmm dd, yyyy")
!stipamt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![post petition payments], "$###,##0.00")
!stippmts = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!stip_no


If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees] = 0 Or IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees]) Then
![13fees] = "(which includes late charges and deferred late charges)"
Else
![13fees] = "(which includes late charges, deferred late charges, filing fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![bk_attcosts], "$###,##0.00") & " and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ")"
End If


If bk() = "Debtors" Then
!ddebtor = "debtors"
!ddebtors = "debtors'"
!doesdo = "do"
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
Else
!ddebtor = "debtor"
!ddebtors = "debtor's"
!doesdo = "does"
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
End If



!mfrtotarr = BKPayTotalAmt()
If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit Like "Promissory note*" Then
!promheloc = "promissory note"
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit = "HELOC Agreement*" Then
!promheloc = "home equity line of credit agreement"
Else
!promheloc = "____________"
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppph = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppph = 1 Then
!ppph = "(a) Attached hereto as Exhibit A is a post-petition payment history."
Else
!ppph = ""
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = 1 Then
If !ppph = "" Then
!ppfa = "(a) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
Else
!ppfa = "(b) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
End If
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = 1 Then
If !ppph = "" And !ppfa = "" Then
!ppfa = "(a) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
ElseIf !ppph <> "" Or !ppfa <> "" Then
!ppfa = "(b) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
ElseIf !ppph <> "" And !ppfa <> "" Then
!pptia = "(c) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
End If
End If

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security) Then
!DeedofTrust = "Deed of Trust"
!SmallDOT = "deed of trust"
Else
!DeedofTrust = Trim([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security)
End If

'!EffDate = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_effective, "mmmm dd, yyyy")
!BKMovant = BKMovant()


If Not rsBKArr.EOF Then

Do While Not rsBKArr.EOF
If IsNull(!bkfrom4) And Not IsNull(!bkfrom3) Then
!bkpay4 = rsBKArr![co #payments]
!bkfrom4 = rsBKArr![dfrom]
!bkto4 = rsBKArr![dthru]
!BKAmt4 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot4 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt4 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt4 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom3) And Not IsNull(!bkfrom2) Then
!bkpay3 = rsBKArr![co #payments]
!bkfrom3 = rsBKArr![dfrom]
!bkto3 = rsBKArr![dthru]
!BKAmt3 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot3 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt3 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt3 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom2) And Not IsNull(!bkfrom1) Then
!BKpay2 = rsBKArr![co #payments]
!bkfrom2 = rsBKArr![dfrom]
!BKTo2 = rsBKArr![dthru]
!BKAmt2 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot2 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt2 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt2 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom1) Then
!BKpay1 = rsBKArr![co #payments]
!bkfrom1 = rsBKArr![dfrom]
!BKTo1 = rsBKArr![dthru]
!BKAmt1 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot1 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt1 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt1 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

End If

'end BKArr

rsBKArr.MoveNext
Loop

End If

!County = County()
!DebtorDebtors = bk()
!cobk = cobk()





If VTypeMerge = "PlanObjARREARS" Then

!POCFiled = Forms![bankruptcymain]!BankruptcySubForm.Form!PObj_PocFiled
!PrePetArrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!POCDef_PPArr, "$###,##0.00")
End If


!PPArrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pre_pet_amt], "$###,##0.00")
'!corpadvance = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![bk_corp], "$###,##0.00")

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!plan_conf) Then
!confdate = "A Chapter 13 Plan was confirmed on " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!plan_conf, "mmmm dd, yyyy") & "."
Else
!confdate = "A hearing to consider confirmation of the Chapter 13 Plan of the " & bk() & " " & VIsAre & " scheduled for " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!POC_Conf_Hrg, "mmmm dd, yyyy") & "."
End If

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date]) Then
!payoffdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date], "mmmm dd, yyyy")
Else
!payoffdate = ""
End If

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance]) Then
!minusfunds = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")
Else
!minusfunds = 0#
End If





If Forms![foreclosure database screen]!Client Like "Wells*" And _
BKChapter() = "13" Then
!WellsPara = "IT IS FURTHER ORDERED that upon entry of this order, the Movant may cease filing in this case or serving upon the debtor, debtor's counsel, or trustee, any notice that may be required under Federal Rule of Bankruptcy Procedure 3002.1."
!wellspara2 = "9.        In the event that the automatic stay is terminated as a result of the debtor's future default under the terms set forth herein, the movant may cease filing in this case or serving upon the debtor, debtor's counsel, or trustee, any notice that may be required under Federal Rule of Bankruptcy Procedure 3002.1."

Else
!WellsPara = ""
!wellspara2 = ""
End If


If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Or VTypeMerge = "BKPCN" Or VTypeMerge = "BKPPFN" Then


!planfileddate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArrDueThru, "mmmm dd, yyyy")
!pocamount = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArr, "$###,##0.00")
!arrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod!lm_att_fee, "$###,##0.00")
!incdec = LCase(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended)
!attphone = Forms!bankruptcymain!BankruptcySubForm.Form!att_phone
!attfax = Forms!bankruptcymain!BankruptcySubForm.Form!att_fax
!attemail = Forms!bankruptcymain!BankruptcySubForm.Form!att_Email
!oldInterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_int_rate
!newinterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Int_rate
!oldPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_monthly_pmt, "$###,##0.00")
!newPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Monthly_Pmt, "$###,##0.00")

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed) Then

Dim todayth, dayeff As String

todayth = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If


!pmtday = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed & dayeff

End If


End If

If VTypeMerge <> "VALoanMod" And VTypeMerge <> "VALoanModOrd" Then
!planfileddate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!pobj_Plan_filed, "mmmm dd, yyyy")
End If

If VTypeMerge = "LatePOC" Then
!bkfiled = VDate
Else
!bkfiled = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
![owner1-bk] = owner1()
![owner2-bk] = owner2()

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If

If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
Else
CoDebtorListing = secondDebtor()
End If
!codebtorand = "and"
End If

If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & thirddebtor()
Else
CoDebtorListing = thirddebtor()
End If
End If

If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fourthdebtor()
Else
CoDebtorListing = fourthdebtor()
End If
End If

If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![5filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fifthdebtor()
Else
CoDebtorListing = fifthdebtor()
End If
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!DOD = Format(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered], "mmmm dd, yyyy")

'If Forms![bankruptcyMain]!BankruptcySubForm.Form!NODresoltuion.Form![AOD Filed] = 2 Then
'!NODFiled = Format(Forms!bankruptcymain!bankruptcysubform.[Form]![nodresolution].Form!nod2_date_filed, "mmmm dd, yyyy")
'Else
'!NODFiled = Format(Forms!bankruptcymain!bankruptcysubform.[Form]![nodresolution].Form!AffDefaultMailed, "mmmm dd, yyyy")
'End If


If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through]) Then
!dueth = Null
Else
!dueth = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy")
End If

!RegMd = VRegMD
!totarr = VTotalArr
If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Monthly_Late]) Then
!latefee = "$0.00"
Else
!latefee = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Monthly_Late], "$###,##0.00")
End If

!BKJuris = BKJuris()
!SecuredParty = BKMovant()

If VTypeMerge = "BKPOCForms" Then
!ClientRefNumber = Right(Forms![foreclosure database screen]!ClientRefNumber, 4)

!longsecured = LSecuredBK()
!BKTo1 = IIf(Client() Like "JPM*", "Chase Records Center", bkPOCnotice1())
!BKTo2 = bkPOCNotice2()
!bkto3 = bkPOCNotice3()
!bkto4 = bkPOCNotice4()
!BKpay1 = IIf(BKPOCPay3() = bkPOCNotice3(), "", bkPOCnotice1())
!BKpay2 = IIf(BKPOCPay3() = bkPOCNotice3(), "", BKPOCPay2())
!bkpay3 = IIf(BKPOCPay3() = bkPOCNotice3(), "", IIf([Forms]![proofofclaimmain]![poc].[Form]![EMC] = -1 Or [Forms]![proofofclaimmain]![poc].[Form]![EMC] = 1, "3415 Vision Drive, ATTN: OH4-7133", BKPOCPay3()))
!bkpay4 = IIf(BKPOCPay3() = bkPOCNotice3(), "", BKPOCPay4())
!bkblank1a = bkPOCNoticePhone()
!bkblank1b = bkPOCNoticeemail()
!bkblank2a = IIf(BKPOCPay3() = bkPOCNotice3(), "", BKPOCPayPhone())
!bkblank2b = IIf(BKPOCPay3() = bkPOCNotice3(), "", BKPOCPayemail())
!PrePetArrears = Format(Forms![proofofclaimmain]!poc.Form!PreParrears, "$###,##0.00")
!PPArrears = Format(Forms![proofofclaimmain]!poc.Form!PPArrears, "$###,##0.00")
!bkblank3a = Forms![proofofclaimmain]!poc.Form!int_rate
!totarr = Format(Forms![proofofclaimmain]!poc.Form!totalarrears, "$###,##0.00")
!bkblank3b = Format(Forms![proofofclaimmain]!poc.Form!totalsecuredclaim, "$###,##0.00")

If attorneyOffice() = "Md" Then
!AAddress = "6003 Executive Blvd. Suite 101"
!AAddress2 = "Rockville, MD 20852"
!APhone = "(301) 961-6555"
Else
!AAddress = "8100 Three Chopt Rd., Suite 240"
!AAddress2 = "Richmond, VA 23229"
!APhone = "(804) 282-0463"
End If

Else
!longsecured = BKMovant()
!ClientRefNumber = Forms![foreclosure database screen]!ClientRefNumber
End If

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


If attorneysigns2() <> "" Then
!attorneysigns = attorneysigns() & ", " & attorneysigns2() & " and " & rs![Attorneys Company Name]
Else
!attorneysigns = attorneysigns() & " and " & rs![Attorneys Company Name]
End If

!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneysigns2 = attorneysigns2()
!attorneybar = attorneybar()
!attorneybar2 = attorneybar2()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth

If VtodayDay = 1 Or VtodayDay = 21 Or VtodayDay = 31 Then
!certh = VtodayDay & "st"
ElseIf VtodayDay = 2 Or !todayday = 22 Then
!certh = VtodayDay & "nd"
ElseIf VtodayDay = 3 Or VtodayDay = 23 Then
!certh = VtodayDay & "rd"
Else
!certh = VtodayDay & "th"
End If

'MsgBox (VtodayDay & ", " & !certh)


!todaymonthyear = Format(Date, "mmmm, yyyy")



If (VIncarr = -1 Or VIncarr = 1) And [Forms]![foreclosure database screen]![BankruptcySubForm].[Form]![trusteename] Like "*Gorman*" Then
!aopara = "SEEN WITH RESERVATION OF RIGHT TO OBJECT TO THE AMENDED PLAN:"
Else
!aopara = "SEEN:"
End If

'!dateofNote = Format(Forms!bankruptcymain!bankruptcysubform.Form!dateofNote, "mmmm dd, yyyy")
!obj_deadline = Format(Forms!bankruptcymain!BankruptcySubForm.Form!objdeadline, "mmmm dd, yyyy")
!taxid = ""
!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")
!PrinBal = Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance]
!RegMPD = VRegMPD
!bkjudge = Forms!bankruptcymain!BankruptcySubForm.Form!judge

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "KLP" Then
!bkjudgelong = "Keith L. Phillips"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "KRH" Then
!bkjudgelong = "Kevin R. Huennekens"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SSM" Then
!bkjudgelong = "Stephen S. Mitchell"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
!bkjudgelong = "Robert G. Mayer"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SCS" Then
!bkjudgelong = "Stephen C. St. John"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Then
!bkjudgelong = "Frank J. Santoro"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "BFK" Then
!bkjudgelong = "Brian F. Kenney"
End If

'!aodfiled = Forms![bankruptcyMain]!BankruptcySubForm.Form!NODresoltuion.Form![AOD Filed]
!cobk = cobk()
!proofpay = Forms!bankruptcymain!BankruptcySubForm.Form!proofpay
!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3
!con2a = Vcon2a
!con2b = Vcon2b
!DirNegClause = VDirect
!bkadd1 = bkPOCAdd1()
!bkadd2 = bkPOCAdd2()
!bkadd3 = bkPaymentAdd3()
!bkadd4 = bkPaymentAdd4()
!mfrhearing = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362Hearing], "mmmm dd, yyyy")
!mfrHearingTime = Format(Forms!bankruptcymain!BankruptcySubForm.Form![hearing_time], "h:mm am/pm")

!mfrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362MotionFiled], "mmmm dd, yyyy")
!ndrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![NDR_filed], "mmmm dd, yyyy")

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

If BKJurisdiction() Like "Richmond*" Then
!PropertyCity = "Richmond"
ElseIf BKJurisdiction() Like "Alexan*" Then
!PropertyCity = "Alexandria"
ElseIf BKJurisdiction() Like "Norfol*" Then
!PropertyCity = "Norfolk"
If BKJurisdiction() Like "Newport*" Then
!PropertyCity = "Newport News"
End If
End If


If CoDebtorListing <> "" And Not IsNull(CoDebtorListing) Then

!BKLang = "and Co-Debtor Stay "

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
!codebtorpara = "9.     Relief is granted as to " & CoDebtorListing & ", the co-debtor, from the automatic stay imposed by U.S.C. Section 1301(a) to the same extent and on the same terms and conditions as granted as to the Debtor."
Else
!codebtorpara = "IT IS FURTHER ORDERED that upon termination of the automatic stay of U.S.C. Section 362, the Co-Debtor stay of U.S.C. Section 1301, if applicable, shall automatically terminate without any further proceeding in this Court."
End If

!CoDebtParaRELIEF = "IT IS FURTHER ORDERED that relief is granted as to " & CoDebtorListing & ", the co-debtor(s)," _
& " from the automatic stay imposed by Section 1301(a) to the same extent and on the same terms" _
& " and conditions as granted as to the debtor."

!CoDebtParaRELIEF2 = "Relief is granted as to " & CoDebtorListing & ", the co-debtor(s)," _
& " from the automatic stay imposed by Section 1301(a) to the same extent and on the same terms" _
& " and conditions as granted as to the debtor."

End If

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered]) Then
!dateorderdocketpara = "submitted to the court concurrently with this Order Terminating the Co-Debtor Stay"
Else
!dateorderdocketpara = "entered by the court in this case on " & Format(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered], "mmmm dd, yyyy")
End If

!hearingonobj = Format(Forms!bankruptcymain!BankruptcySubForm.Form!po_hearing, "mmmm dd, yyyy")
!ReqDate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!rrequested, "mmmm dd, yyyy")
'!BKUPB = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_upb, "$###,##0.00")
'!BKInterest = InterestTotalBK()
'!BKLateFees = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_latefees, "$###,##0.00")
'!BKMipPmi = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_mippmi, "$###,##0.00")
'!BKEscrow = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_esc, "$###,##0.00")
!BKBlanks = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!BK_ADMON1 + [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!BK_ADMON2 + [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!BK_ADMON3, "$###,##0.00")
'!BKSuspense = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_sus, "$###,##0.00")
!COattfees = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00")
!PropValue = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value], "$#,##0.00")

'If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value_text] Like "Tax*" Then
'!taxass = "the tax assessment of the Property"
'Else
'!taxass = IIf(bk() = "Debtor", "Debtor's Schedules", "Debtors' Schedule")
'End If

'!taxass = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value_text]


!totallien = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total_liens], "$#,##0.00")


.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function BkMergeNOT()
 
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmergeNOT;", dbFailOnError

DoCmd.OpenQuery ("mergeNOT")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergeNOT", dbOpenDynaset, dbSeeChanges)


'If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
'Else
'VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
'End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


Dim VIsAre
Dim VHasHave
Dim rsDef
Dim strsqlrsDef


If Not rs.EOF Then

With rs
.Edit

!totalpp = Format(TotalFinalCurePost(), "$###,##0.00")

!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled

!loan4 = LoanMask4()

!bkadd1 = bkPOCAdd1()
!bkadd2 = bkPOCAdd2()
!bkadd3 = bkPaymentAdd3()
!bkadd4 = bkPaymentAdd4()
!mfrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362MotionFiled], "mmmm dd, yyyy")

If bk() = "Debtors" Then
!ddebtor = "debtors"
!ddebtors = "debtors'"
!doesdo = "do"
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
Else
!ddebtor = "debtor"
!ddebtors = "debtor's"
!doesdo = "does"
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
End If


!BKMovant = BKMovant()

!County = County()
!DebtorDebtors = bk()



Dim todayth, dayeff As String

todayth = Date

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If



!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")



If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
![owner1-bk] = owner1()
![owner2-bk] = owner2()

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If
If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
!codebtorand = "and"
End If
If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & thirddebtor()
!codebtorand = "and"
End If
If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fourthdebtor()
!codebtorand = "and"
End If
If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fifthdebtor()
!codebtorand = "and"
End If



!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth

!todaymonthyear = Format(Date, "mmmm, yyyy")

'!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")



!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3


If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]




.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function BkMergeNOD()

 
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmergeNOD;", dbFailOnError

DoCmd.OpenQuery ("mergeNOD")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergeNOD", dbOpenDynaset, dbSeeChanges)


If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
Else
VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


Dim VIsAre
Dim VHasHave
Dim rsDef
Dim strsqlrsDef

strsqlrsDef = "select * from affs where counter = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rsDef = CurrentDb.OpenRecordset(strsqlrsDef, dbOpenSnapshot)

If Not rs.EOF Then

With rs
.Edit

!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled

If Not rsDef.EOF Then
Do While Not rsDef.EOF

If IsNull(!defdesc20) And Not IsNull(!defdesc19) Then
!defdate20 = rsDef![payment_date]
!defdesc20 = rsDef![payment_txt]
!defamt20 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled20 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc19) And Not IsNull(!defdesc18) Then
!defdate19 = rsDef![payment_date]
!defdesc19 = rsDef![payment_txt]
!defamt19 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled19 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc18) And Not IsNull(!defdesc17) Then
!defdate18 = rsDef![payment_date]
!defdesc18 = rsDef![payment_txt]
!defamt18 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled18 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc17) And Not IsNull(!defdesc16) Then
!defdate17 = rsDef![payment_date]
!defdesc17 = rsDef![payment_txt]
!defamt17 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled17 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc16) And Not IsNull(!defdesc15) Then
!defdate16 = rsDef![payment_date]
!defdesc16 = rsDef![payment_txt]
!defamt16 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled16 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc15) And Not IsNull(!defdesc14) Then
!defdate15 = rsDef![payment_date]
!defdesc15 = rsDef![payment_txt]
!defamt15 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled15 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc14) And Not IsNull(!defdesc13) Then
!defdate14 = rsDef![payment_date]
!defdesc14 = rsDef![payment_txt]
!defamt14 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled14 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc13) And Not IsNull(!defdesc12) Then
!defdate13 = rsDef![payment_date]
!defdesc13 = rsDef![payment_txt]
!defamt13 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled13 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc12) And Not IsNull(!defdesc11) Then
!defdate12 = rsDef![payment_date]
!defdesc12 = rsDef![payment_txt]
!defamt12 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled12 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc11) And Not IsNull(!defdesc10) Then
!defdate11 = rsDef![payment_date]
!defdesc11 = rsDef![payment_txt]
!defamt11 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled11 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc10) And Not IsNull(!defdesc9) Then
!defdate10 = rsDef![payment_date]
!defdesc10 = rsDef![payment_txt]
!defamt10 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled10 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc9) And Not IsNull(!defdesc8) Then
!defdate9 = rsDef![payment_date]
!defdesc9 = rsDef![payment_txt]
!defamt9 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled9 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc8) And Not IsNull(!defdesc7) Then
!defdate8 = rsDef![payment_date]
!defdesc8 = rsDef![payment_txt]
!defamt8 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled8 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc7) And Not IsNull(!defdesc6) Then
!defdate7 = rsDef![payment_date]
!defdesc7 = rsDef![payment_txt]
!defamt7 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled7 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc6) And Not IsNull(!defdesc5) Then
!defdate6 = rsDef![payment_date]
!defdesc6 = rsDef![payment_txt]
!defamt6 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled6 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc5) And Not IsNull(!defdesc4) Then
!defdate5 = rsDef![payment_date]
!defdesc5 = rsDef![payment_txt]
!defamt5 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled5 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc4) And Not IsNull(!defdesc3) Then
!defdate4 = rsDef![payment_date]
!defdesc4 = rsDef![payment_txt]
!defamt4 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled4 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc3) And Not IsNull(!defdesc2) Then
!defdate3 = rsDef![payment_date]
!defdesc3 = rsDef![payment_txt]
!defamt3 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled3 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc2) And Not IsNull(!defdesc1) Then
!defdate2 = rsDef![payment_date]
!defdesc2 = rsDef![payment_txt]
!defamt2 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled2 = rsDef!Aff_Filed

ElseIf IsNull(!defdesc1) Then
!defdate1 = rsDef![payment_date]
!defdesc1 = rsDef![payment_txt]
!defamt1 = Format(rsDef![payment_amt], "$###,##0.00")
!afffiled1 = rsDef!Aff_Filed
End If

rsDef.MoveNext
Loop
rsDef.Close


End If

!bkadd1 = bkPOCAdd1()
!bkadd2 = bkPOCAdd2()
!bkadd3 = bkPaymentAdd3()
!bkadd4 = bkPaymentAdd4()
!mfrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362MotionFiled], "mmmm dd, yyyy")

If bk() = "Debtors" Then
!ddebtor = "debtors"
!ddebtors = "debtors'"
!doesdo = "do"
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
Else
!ddebtor = "debtor"
!ddebtors = "debtor's"
!doesdo = "does"
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
End If


!BKMovant = BKMovant()

!County = County()
!DebtorDebtors = bk()



Dim todayth, dayeff As String

todayth = Date

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If



!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")



If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
![owner1-bk] = owner1()
![owner2-bk] = owner2()

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If
If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
!codebtorand = "and"
End If
If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & thirddebtor()
!codebtorand = "and"
End If
If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fourthdebtor()
!codebtorand = "and"
End If
If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fifthdebtor()
!codebtorand = "and"
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")

'NOD Resolution Screen Begin
!affno = [Forms]![bankruptcymain]![BankruptcySubForm].[Form]![noticedefault].[Form]![PrtNotice]
!OrderDate = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![Order_EOD]
!ordertype = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![ordertype], "mmmm dd, yyyy")
!curepd = Trim(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![cureperiod])
![defaults] = Trim(Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![DefaultsAllowed])
If Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 1 Then
vnod = "First"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 2 Then
vnod = "Second"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 3 Then
vnod = "Third"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![aod filed] = 4 Then
vnod = "Form"
Else
vnod = ""
End If

![nod#] = vnod
![NODFees1] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![attorney_fees]
![NODFees2] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![Attorney_Fees2]
![NODFees3] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![attorney_fees3]

![NOD1Date] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![AffDefaultMailed]
![NOD2Date] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![nod2_date_filed]
![NOD3Date] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![nod3_date_filed]

![NODDefault1] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt]
![NODDefault2] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt2]
![NODDefault3] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![totaldebt3]
![AmdPlan_nottimely] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![amd_notfiled]
![lmo_nottimely] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![loanmod_notfiled]
![ssd_nottimely] = Forms![bankruptcymain]!BankruptcySubForm.Form!NODResolution.Form![SSD_notfiled]



'NOD Resolution Screen End

!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth

!todaymonthyear = Format(Date, "mmmm, yyyy")

!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")



!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3


If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]




.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function


Public Function BkMergePOC()

 
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmergePOC;", dbFailOnError

DoCmd.OpenQuery ("mergePOC")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergePOC", dbOpenDynaset, dbSeeChanges)

Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()

If Not rs.EOF Then

With rs
.Edit

!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled
!bkadd1 = bkPOCAdd1()
!bkadd2 = bkPOCAdd2()
!bkadd3 = bkPaymentAdd3()
!bkadd4 = bkPaymentAdd4()
!mfrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362MotionFiled], "mmmm dd, yyyy")

If bk() = "Debtors" Then
!ddebtor = "debtors"
!ddebtors = "debtors'"
!doesdo = "do"
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
Else
!ddebtor = "debtor"
!ddebtors = "debtor's"
!doesdo = "does"
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
End If


!BKMovant = BKMovant()

!County = County()
!DebtorDebtors = bk()



Dim todayth, dayeff As String

todayth = Date

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If



!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")



If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
![owner1-bk] = owner1()
![owner2-bk] = owner2()

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If
If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
!codebtorand = "and"
End If
If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & thirddebtor()
!codebtorand = "and"
End If
If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fourthdebtor()
!codebtorand = "and"
End If
If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fifthdebtor()
!codebtorand = "and"
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")


!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth

!todaymonthyear = Format(Date, "mmmm, yyyy")

!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")

If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]




.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function BkMergeORD()

 
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmergeOrd;", dbFailOnError

DoCmd.OpenQuery ("consentmergeORD")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergeORD", dbOpenDynaset, dbSeeChanges)


Dim VRegMPD, VRegMD, VRegMOB, VTh, Vth3
Dim VlumpSum, VLumpAmt, VLumpdate
Dim VIncarr
Dim VBK
Dim OneSix
Dim CoDebtorListing
Dim VRemaining
Dim VTotalArr
Dim Vcon2a
Dim Vcon2b
Dim VRelief
Dim VHrgTime
Dim VDayDue
Dim VDueth
Dim VdueDay
Dim VSClaim
Dim VPArrears
Dim VmfrFilingFee
Dim rsBKArr As RecordSet

DoCmd.OpenQuery "BKMergeArrPayExcel"

Set rsBKArr = CurrentDb.OpenRecordset("BKMergeArrPay")


VmfrFilingFee = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_attcosts, "$###,##0.00")

VRelief = [Forms]!bankruptcymain!BankruptcySubForm.Form!Relief

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage]) Then
VTotalArr = 0

Else
VTotalArr = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$###,##0.00")
End If



VIncarr = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![incarr]
VlumpSum = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![lumpsum]
VLumpAmt = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt, "$###,##0.00")
VLumpdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_date, "mmmm dd, yyyy")
VRegMD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment], "$###,##0.00")
VRegMPD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment Date], "mmmm dd"", ""yyyy")
VRegMOB = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly on or Before Day]
VPPmob = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Post Petition On Or Before Day]


If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
Else
VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

If IsNull(VLumpAmt) Or VLumpAmt = "" Then
VRemaining = 0
Else
VRemaining = Format(VTotalArr - VLumpAmt, "$###,##0.00")
End If


VTh = IIf(VRegMOB = 1 Or VRegMOB = 21 Or VRegMOB = 31, "st", IIf(VRegMOB = 2 Or VRegMOB = 22, "nd", IIf(VRegMOB = 3 Or VRegMOB = 23, "rd", "th")))
Vth3 = IIf(VPPmob = 1 Or VPPmob = 21 Or VPPmob = 31, "st", IIf(VPPmob = 2 Or VPPmob = 22, "nd", IIf(VPPmob = 3 Or VPPmob = 23, "rd", "th")))
vonesix = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![post petition payments], "$###,##0.00")


Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


Dim VIsAre
Dim VHasHave
If Not rs.EOF Then

With rs
.Edit

!respdeadline = Format([Forms]!bankruptcymain!BankruptcySubForm.[Form]![Ojb_Deadline], "mmmm dd, yyyy")

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance]) Or Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance] <> 0 Then
!minusfunds = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")
Else
!minusfunds = 0#
End If

If Not rsBKArr.EOF Then

Do While Not rsBKArr.EOF

If IsNull(!bkfrom12) And Not IsNull(!bkfrom11) Then
!BKPay12 = rsBKArr![co #payments]
!bkfrom12 = rsBKArr![dfrom]
!BKTo12 = rsBKArr![dthru]
!BKAmt12 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot12 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt12 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt12 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom11) And Not IsNull(!bkfrom10) Then
!BKPay11 = rsBKArr![co #payments]
!bkfrom11 = rsBKArr![dfrom]
!BKTo11 = rsBKArr![dthru]
!BKAmt11 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot11 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt11 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt11 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom10) And Not IsNull(!bkfrom9) Then
!BKPay10 = rsBKArr![co #payments]
!bkfrom10 = rsBKArr![dfrom]
!BKTo10 = rsBKArr![dthru]
!BKAmt10 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot10 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt10 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt10 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom9) And Not IsNull(!bkfrom8) Then
!BKPay9 = rsBKArr![co #payments]
!bkfrom9 = rsBKArr![dfrom]
!BKTo9 = rsBKArr![dthru]
!BKAmt9 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot9 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt9 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt9 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom8) And Not IsNull(!bkfrom7) Then
!BKPay8 = rsBKArr![co #payments]
!bkfrom8 = rsBKArr![dfrom]
!BKTo8 = rsBKArr![dthru]
!BKAmt8 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot8 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt8 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt8 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom7) And Not IsNull(!bkfrom6) Then
!BKPay7 = rsBKArr![co #payments]
!bkfrom7 = rsBKArr![dfrom]
!BKTo7 = rsBKArr![dthru]
!BKAmt7 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot7 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt7 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt7 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom6) And Not IsNull(!bkfrom5) Then
!BKPay6 = rsBKArr![co #payments]
!bkfrom6 = rsBKArr![dfrom]
!BKTo6 = rsBKArr![dthru]
!BKAmt6 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot6 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt6 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt6 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom5) And Not IsNull(!bkfrom4) Then
!BKPay5 = rsBKArr![co #payments]
!bkfrom5 = rsBKArr![dfrom]
!BKTo5 = rsBKArr![dthru]
!BKAmt5 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot5 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt5 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt5 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom4) And Not IsNull(!bkfrom3) Then
!bkpay4 = rsBKArr![co #payments]
!bkfrom4 = rsBKArr![dfrom]
!bkto4 = rsBKArr![dthru]
!BKAmt4 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot4 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt4 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt4 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom3) And Not IsNull(!bkfrom2) Then
!bkpay3 = rsBKArr![co #payments]
!bkfrom3 = rsBKArr![dfrom]
!bkto3 = rsBKArr![dthru]
!BKAmt3 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot3 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt3 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt3 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom2) And Not IsNull(!bkfrom1) Then
!BKpay2 = rsBKArr![co #payments]
!bkfrom2 = rsBKArr![dfrom]
!BKTo2 = rsBKArr![dthru]
!BKAmt2 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot2 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt2 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt2 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

ElseIf IsNull(!bkfrom1) Then
!BKpay1 = rsBKArr![co #payments]
!bkfrom1 = rsBKArr![dfrom]
!BKTo1 = rsBKArr![dthru]
!BKAmt1 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot1 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt1 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt1 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")

End If

'end BKArr

rsBKArr.MoveNext
Loop

End If
!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled

Dim rsOrdRel
Dim strsqlrsOrd

strsqlrsOrd = "select * from bkordrelief where bkfileno = " & Forms!bankruptcymain!BankruptcySubForm.Form!counter & ";"
Set rsOrdRel = CurrentDb.OpenRecordset(strsqlrsOrd, dbOpenSnapshot)

If Not rsOrdRel.EOF Then

!ReliefDate = rsOrdRel!relief_granted
!NDRDate = rsOrdRel!NoDist
!DefaultDate = rsOrdRel!default_date
!ssd_da = rsOrdRel!ssd_da
!ssd_tt = rsOrdRel!ssd_tt
!Default_da = rsOrdRel!Default_da
!Default_tt = rsOrdRel!Default_tt
!nodist_da = rsOrdRel!nodist_da
!nodist_tt = rsOrdRel!nodist_tt
!consent_da = rsOrdRel!consent_da
!consent_tt = rsOrdRel!consent_tt
!relief_da = rsOrdRel!relief_da
!relief_tt = rsOrdRel!relief_tt

rsOrdRel.Close
End If

!COattfees = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00")


!bkadd1 = bkPOCAdd1()
!bkadd2 = bkPOCAdd2()
!bkadd3 = bkPaymentAdd3()
!bkadd4 = bkPaymentAdd4()
'!bkadd5 = bkpaymentAdd5()
!mfrfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form![362MotionFiled], "mmmm dd, yyyy")

!surrender = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_sur]
!daresponse = [Forms]!bankruptcymain!BankruptcySubForm.Form!response_to_mfr
!ttresponse = [Forms]!bankruptcymain!BankruptcySubForm.Form!trustee_response_MFR
!staywaiver = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![rule4001]
!co = [Forms]![foreclosure database screen]!SPsameasCl

!reliefdelaydays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![relief_ord_no]
!reliefdelaydate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![relief_ord_date]
!lump1amt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Lumpsum_Amt], "$###,##0.00")
!lump1days = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_no1
!lump1date = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_date
!lump2amt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![lumpsum_amt2], "$###,##0.00")
!lump2days = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_no2
!lump2date = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lumpsum_date2
!stippmtday = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp day due]
!ssddays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ssd_no
!ssddate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ssd_date
!adpropmt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!ad_prot_amt, "$###,##0.00")
!moddays = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![lmo_no]
!ModDate = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!lmo_date


!stipfrom = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp payment date], "mmmm dd, yyyy")
!stipthru = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![pp thru], "mmmm dd, yyyy")
!stipamt = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![post petition payments], "$###,##0.00")
!stippmts = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!stip_no

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees] = 0 Or IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees]) Then
![13fees] = "(which includes late charges and deferred late charges)"
Else
![13fees] = "(which includes late charges, deferred late charges, filing fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![bk_attcosts], "$###,##0.00") & " and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ")"
End If

If bk() = "Debtors" Then
!ddebtor = "debtors"
!ddebtors = "debtors'"
!doesdo = "do"
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
Else
!ddebtor = "debtor"
!ddebtors = "debtor's"
!doesdo = "does"
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
End If


If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit Like "Promissory note*" Then
!promheloc = "promissory note"
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit = "HELOC Agreement*" Then
!promheloc = "home equity line of credit agreement"
Else
!promheloc = "____________"
End If



'If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = -1 Or _
'[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = 1 Then
'If !ppph = "" Then
'!ppfa = "(a) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
'Else
'!ppfa = "(b) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
'End If
'End If

'If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = -1 Or _
'[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = 1 Then
'If !ppph = "" And !ppfa = "" Then
'!ppfa = "(a) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
'ElseIf !ppph <> "" Or !ppfa <> "" Then
'!ppfa = "(b) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
'ElseIf !ppph <> "" And !ppfa <> "" Then
'!pptia = "(c) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
'End If
'End If

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security) Then
!DeedofTrust = "Deed of Trust"
!SmallDOT = "deed of trust"

Else
!DeedofTrust = Trim([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security)
End If

!BKMovant = BKMovant()

!County = County()
!DebtorDebtors = bk()


If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then


!planfileddate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArrDueThru, "mmmm dd, yyyy")
!pocamount = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArr, "$###,##0.00")
!arrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod!lm_att_fee, "$###,##0.00")
!incdec = LCase(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended)
!attphone = Forms!bankruptcymain!BankruptcySubForm.Form!att_phone
!attfax = Forms!bankruptcymain!BankruptcySubForm.Form!att_fax
!attemail = Forms!bankruptcymain!BankruptcySubForm.Form!att_Email
!oldInterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_int_rate
!newinterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Int_rate
!oldPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_monthly_pmt, "$###,##0.00")
!newPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Monthly_Pmt, "$###,##0.00")

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed Then

Dim todayth, dayeff As String

todayth = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If


!pmtday = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed & dayeff

End If


End If

If VTypeMerge <> "VALoanMod" And VTypeMerge <> "VALoanModOrd" Then
!planfileddate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!pobj_Plan_filed, "mmmm dd, yyyy")
End If


If VTypeMerge = "LatePOC" Then
!bkfiled = VDate
Else
!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
![owner1-bk] = owner1()
![owner2-bk] = owner2()

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If
If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
!codebtorand = "and"
End If
If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & thirddebtor()
!codebtorand = "and"
End If
If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fourthdebtor()
!codebtorand = "and"
End If
If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = CoDebtorListing + ", " & fifthdebtor()
!codebtorand = "and"
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!DOD = Format(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered], "mmmm dd, yyyy")


If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through]) Then
!dueth = Null
Else
!dueth = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy")
End If

!RegMd = VRegMD
!totarr = VTotalArr
If IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Monthly_Late]) Then
!latefee = "$0.00"
Else
!latefee = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Monthly_Late], "$###,##0.00")
End If

!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth


'MsgBox (VtodayDay & ", " & !certh)


!todaymonthyear = Format(Date, "mmmm, yyyy")



If (VIncarr = -1 Or VIncarr = 1) And [Forms]![foreclosure database screen]![BankruptcySubForm].[Form]![trusteename] Like "*Gorman*" Then
!aopara = "SEEN WITH RESERVATION OF RIGHT TO OBJECT TO THE AMENDED PLAN:"
Else
!aopara = "SEEN:"
End If

'!dateofNote = Format(Forms!BankruptcyMain!bankruptcysubform.Form!dateofNote, "mmmm dd, yyyy")
!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")
!RegMPD = VRegMPD
!bkjudge = Forms!bankruptcymain!BankruptcySubForm.Form!judge

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "KLP" Then
!bkjudgelong = "Keith L. Phillips"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "KRH" Then
!bkjudgelong = "Kevin R. Huennekens"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SSM" Then
!bkjudgelong = "Stephen S. Mitchell"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
!bkjudgelong = "Robert G. Mayer"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SCS" Then
!bkjudgelong = "Stephen C. St. John"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Then
!bkjudgelong = "Frank J. Santoro"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "BFK" Then
!bkjudgelong = "Brian F. Kenney"
End If

!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3
!con2a = Vcon2a
!con2b = Vcon2b
!DirNegClause = VDirect


If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If

!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

If BKJurisdiction() Like "Richmond*" Then
!PropertyCity = "Richmond"
ElseIf BKJurisdiction() Like "Alexan*" Then
!PropertyCity = "Alexandria"
ElseIf BKJurisdiction() Like "Norfol*" Then
!PropertyCity = "Norfolk"
If BKJurisdiction() Like "Newport*" Then
!PropertyCity = "Newport News"
End If
End If





If CoDebtorListing <> "" And Not IsNull(CoDebtorListing) Then

!BKLang = "and Co-Debtor Stay "

'If Forms!BankruptcyMain!bankruptcysubform.Form!judge = "RGM" Then
'!codebtorpara = "9.     Relief is granted as to " & CoDebtorListing & ", the co-debtor, from the automatic stay imposed by U.S.C. Section 1301(a) to the same extent and on the same terms and conditions as granted as to the Debtor."
'Else
'!codebtorpara = "IT IS FURTHER ORDERED that upon termination of the automatic stay of U.S.C. Section 362, the Co-Debtor stay of U.S.C. Section 1301, if applicable, shall automatically terminate without any further proceeding in this Court."
'End If

!CoDebtParaRELIEF = "IT IS FURTHER ORDERED that relief is granted as to " & CoDebtorListing & ", the co-debtor(s)," _
& " from the automatic stay imposed by Section 1301(a) to the same extent and on the same terms" _
& " and conditions as granted as to the debtor."

!CoDebtParaRELIEF2 = "Relief is granted as to " & CoDebtorListing & ", the co-debtor(s)," _
& " from the automatic stay imposed by Section 1301(a) to the same extent and on the same terms" _
& " and conditions as granted as to the debtor."

End If

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered]) Then
!dateorderdocketpara = "submitted to the court concurrently with this Order Terminating the Co-Debtor Stay"
Else
!dateorderdocketpara = "entered by the court in this case on " & Format(Forms!bankruptcymain!BankruptcySubForm.Form![Date Order Entered], "mmmm dd, yyyy")
End If




.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function BkMergeMFR()
 
'On Error GoTo Err_Command16_Click
'=([BK_ADMON1]+[BK_ADMON2]+[BK_ADMON3]+[bk_latefees]+[bk_upb]+[bk_int]+[bk_esc]+[bk_mippmi]++[bk_corp])-[bk_sus]'

CurrentDb.Execute "Delete * from bkmergeMFR;", dbFailOnError

DoCmd.OpenQuery ("BKMergeMFRQRY")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergeMFR", dbOpenDynaset, dbSeeChanges)

Dim VCon1, VCon2, VCon3
Dim VRegMPD, VRegMD, VRegMOB, VTh, Vth3
Dim VlumpSum, VLumpAmt, VLumpdate
Dim VIncarr
Dim VBK
Dim OneSix
Dim CoDebtorListing
Dim VRemaining
Dim VTotalArr
Dim Vcon2a
Dim Vcon2b
Dim VRelief
Dim VHrgTime
Dim VDayDue
Dim VDueth
Dim VdueDay
Dim VSClaim
Dim VPArrears
Dim VmfrFilingFee
Dim rsBKArr As RecordSet
Dim rsBKPPFees As RecordSet
Dim rsBKChain As RecordSet

DoCmd.OpenQuery "BKMergeBKChainQry"

Set rsBKChain = CurrentDb.OpenRecordset("BKMergeBKChain")
Dim VChainCnt
VChainCnt = 0



DoCmd.OpenQuery "BKMergeArrPayExcel"

Set rsBKArr = CurrentDb.OpenRecordset("BKMergeArrPay")

DoCmd.OpenQuery "BKMergePPFeesExcel"

Set rsBKPPFees = CurrentDb.OpenRecordset("BKMergePPFees")


VmfrFilingFee = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_attcosts, "$###,##0.00")

VRelief = [Forms]!bankruptcymain!BankruptcySubForm.Form!Relief

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage]) Then
VTotalArr = 0

Else
VTotalArr = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$###,##0.00")
End If


VIncarr = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![incarr]
VlumpSum = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![lumpsum]
VLumpAmt = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt, "$###,##0.00")
VLumpdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_date, "mmmm dd, yyyy")
VRegMD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment], "$###,##0.00")
VRegMPD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment Date], "mmmm dd"", ""yyyy")
VRegMOB = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly on or Before Day]
VPPmob = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Post Petition On Or Before Day]


If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
Else
VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

If IsNull(VLumpAmt) Or VLumpAmt = "" Then
VRemaining = 0
Else
VRemaining = Format(VTotalArr - VLumpAmt, "$###,##0.00")
End If


VTh = IIf(VRegMOB = 1 Or VRegMOB = 21 Or VRegMOB = 31, "st", IIf(VRegMOB = 2 Or VRegMOB = 22, "nd", IIf(VRegMOB = 3 Or VRegMOB = 23, "rd", "th")))
Vth3 = IIf(VPPmob = 1 Or VPPmob = 21 Or VPPmob = 31, "st", IIf(VPPmob = 2 Or VPPmob = 22, "nd", IIf(VPPmob = 3 Or VPPmob = 23, "rd", "th")))
vonesix = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![post petition payments], "$###,##0.00")

If VTypeMerge = "LETTER" Then
Dim Vproc
Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String
Do While Vproc <> "YES"
vInitials = getEmployeeInitials(Environ("username"))
strsqlEmp = "select * from employees where employeeid = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)
If rsEmp.EOF Then
MsgBox ("Incorrect Initials, please re-input")
Else
Vproc = "YES"
If Not IsNull(rsEmp!MiddleName) Then
VCon1 = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
VCon1 = rsEmp!FirstName & " " & rsEmp!LastName
End If

End If
Loop


ElseIf VTypeMerge = "withdrawNOD" Then

If Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 1 Then
VCon1 = "First Notice of Default and Notice of Termination of Automatic Stay"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 2 Then
VCon1 = "Second Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 3 Then
VCon1 = "Third Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
Else
VCon1 = "Notice of Default"
End If

ElseIf VTypeMerge = "OrderContinue" Then
VCon1 = bkjudge() & " on " & bkMISChearing()

ElseIf VTypeMerge = "OrdContPlan" Then
VCon1 = bkMISChearing()

ElseIf VTypeMerge = "PlanObjection" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PRes = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PRes = -1 Then
VCon1 = "The Property is the Debtor's primary residence."
Else
VCon1 = ""
End If


Else

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
VCon1 = "The Debtor will resume making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and will continue to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
Else
VCon1 = "1.     The Debtor resumes making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and continues to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
End If
End If

If VTypeMerge = "PlanObjection" Then

If BKJurisdiction() Like "*Norfolk*" Or BKJurisdiction() Like "*Newport*" Then
VCon2 = "CHAIN OF TITLE - Tidewater."
Else
VCon2 = ""
End If

If Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled = 0 Or _
IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled) Then

VSClaim = InputBox("Amount of Secured Claim:")
Vcon2a = Format(VSClaim, "$###,##0.00")
VPArrears = InputBox("Amount of Pre-Petition Arrears:")
Vcon2b = Format(VPArrears, "$###,##0.00")
End If

ElseIf (VlumpSum = 0 Or IsNull(VlumpSum)) And (IsNull(VIncarr) Or VIncarr = 0) Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's total post-petition arrears) on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by:"
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."

Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = 0 Or IsNull(VIncarr)) Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else
If VLumpAmt = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage] Then
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Else
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's remaining post-petition arrears of " & VRemaining & ") on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If
End If

ElseIf (VlumpSum = 0 Or IsNull(VlumpSum)) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

End If

Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


If VTypeMerge = "LatePOC" Or _
VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then
VCon1 = Forms![foreclosure database screen]!Propertycounty

If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then

VCon2 = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![brief_legal]
If Forms![foreclosure database screen]!SPsameasCl = -1 Or _
Forms![foreclosure database screen]!SPsameasCl = 1 Then
VCon3 = ""
Else
VCon3 = " c/o " & Client()
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended = "Increase" Then
Vcon2a = "For purposes of making the increased monthly payments, the Debtor will obtain funds from ______."
Else
Vcon2a = "The Debtor does not intend to increase the amount of the monthly Chapter 13 Plan payments as a result of the monthly mortgage payment being decreased under the terms of the Loan Modification Agreement."
End If


If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included > 0 Then

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraph 2(d) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtors escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
Else
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraphs 6(e) and 6(f) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtor's escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
End If

Else

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "The monthly payment amount set for in paragraph 2(d) hereinabove is inclusive of principal and interest only. No portion of that payment amount is currently being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
Else

Vcon2b = "The monthly payment amounts set for in paragraphs 6(e) and 6(f) hereinabove are inclusive of principal and interest only. No portion of those payments is being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
End If

End If




Else
VCon2 = Format(Forms!bankruptcymain!BankruptcySubForm.Form!MTA_Dl, "mmmm dd, yyyy")
VCon3 = VdueDay & VDueth
Vcon2a = bkcourt1() & ", " & bkcourt2()
Vcon2b = bkcourt3()
VDate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!mta_hearing, "mmmm dd, yyyy") & " at " & Format(Forms!bankruptcymain!BankruptcySubForm.Form!mta_filed, "hh:ss am/pm")

End If

End If

Dim VIsAre
Dim VHasHave
Dim VcoIsAre
Dim VCoHasHave


If Not rs.EOF Then
Dim VEnd

With rs
.Edit
!confhearingdate = [Forms]!bankruptcymain!BankruptcySubForm.Form!POC_Conf_Hrg
!OrigNoteholder = Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!orgNoteholder
!notestatus = Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!StatusNote
!blankend = Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!GrRel8
!EffDate = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_effective, "mmmm dd, yyyy")
!EffDatePO = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_payoff_eff, "mmmm dd, yyyy")

If Not IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!LoanModDate) Then
!LoanModDate = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!LoanModDate, "mmmm dd, yyyy")
End If


!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled

If Not rsBKChain.EOF Then
MsgBox ("Check Status of the Note to make sure it populated correctly!!")

Do While Not rsBKChain.EOF
VChainCnt = VChainCnt + 1
rsBKChain.MoveNext
Loop

rsBKChain.MoveFirst


Do While Not rsBKChain.EOF

If VChainCnt > 0 And (IsNull(!xferfrom1)) Then
!lastend1 = rsBKChain!lastendorsed
!xfermeans1 = rsBKChain!MeansTransfer
!docdate1 = Format(rsBKChain!docdate, "mmmm dd, yyyy")
!xferfrom1 = rsBKChain!Chain_From
!custodian1 = rsBKChain!Custodian
!endlocation1 = Trim(rsBKChain!EndorsementLocation)
!backpage1 = rsBKChain!backofpage
!bankrep1 = rsBKChain!BankRep
!xferto1 = rsBKChain!Chain_To
VChainCnt = VChainCnt - 1


ElseIf VChainCnt > 0 And (Not IsNull(!xferfrom1) And IsNull(!xferfrom2)) Then
!lastend2 = rsBKChain!lastendorsed
!xfermeans2 = rsBKChain!MeansTransfer
!docdate2 = Format(rsBKChain!docdate, "mmmm dd, yyyy")
!xferfrom2 = rsBKChain!Chain_From
!custodian2 = rsBKChain!Custodian
!endlocation2 = Trim(rsBKChain!EndorsementLocation)
!backpage2 = rsBKChain!backofpage
!bankrep2 = rsBKChain!BankRep
!xferto2 = rsBKChain!Chain_To
VChainCnt = VChainCnt - 1

ElseIf VChainCnt > 0 And (Not IsNull(!xferfrom2) And IsNull(!xferfrom3)) Then
!lastend3 = rsBKChain!lastendorsed
!xfermeans3 = rsBKChain!MeansTransfer
!docdate3 = Format(rsBKChain!docdate, "mmmm dd, yyyy")
!xferfrom3 = rsBKChain!Chain_From
!custodian3 = rsBKChain!Custodian
!endlocation3 = Trim(rsBKChain!EndorsementLocation)
!backpage3 = rsBKChain!backofpage
!bankrep3 = rsBKChain!BankRep
!xferto3 = rsBKChain!Chain_To
VChainCnt = VChainCnt - 1

'ElseIf VChainCnt > 0 And (Not IsNull(!xferfrom3) And IsNull(!xferfrom4)) Then
'!lastend4 = rsBKChain!lastendorsed
'!xfermeans4 = rsBKChain!MeansTransfer
'!docdate4 = Format(rsBKChain!docdate, "mmmm dd, yyyy")
'!xferfrom4 = rsBKChain!Chain_From
'!custodian4 = rsBKChain!Custodian
'!endlocation4 = Trim(rsBKChain!EndorsementLocation)
'!backpage4 = rsBKChain!backofpage
'!bankrep4 = rsBKChain!BankRep
'!xferto4 = rsBKChain!Chain_To
'VChainCnt = VChainCnt - 1
End If


rsBKChain.MoveNext
Loop
End If


'End BKChain


!obtain = IIf(bk() = "Debtors", "obtain", "obtains")

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![totaldue]) Or [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![totaldue] = 0 Then
!bktotaldue = 0#
Else

!bktotaldue = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![totaldue], "$###,##0.00")
End If

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security) Then
!DeedofTrust = "Deed of Trust"
!SmallDOT = "deed of trust"

VDOT = "Deed of Trust"

Else
!DeedofTrust = Trim([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security)
VDOT = Trim([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security)

End If

Dim VBACRightToFC2

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!nodot = 0 Or _
IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!nodot) Then
VBACRightToFC2 = "  Movant is the original mortgagee or beneficiary or the assignee of the " & VDOT & "."
Else
VBACRightToFC2 = ""
End If

Dim VstatusNote
VstatusNote = Trim(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![StatusNote])


If VstatusNote = "Creditor: Note endorsed to Creditor" Or _
VstatusNote = "Agent: Note endorsed to Creditor" Or _
VstatusNote = "Creditor: Note endorsed in blank" Or _
VstatusNote = "Agent: Note endorsed in blank" Then
!BACRIGHTTOFC = "Movant, directly or through an agent, has possession of the Note.  The Note is either made payable to Movant or has been duly endorsed." & VBACRightToFC2

ElseIf VstatusNote = "Note is Lost: Lost Note Affidavit" Then
!BACRIGHTTOFC = "Movant is unable to find the Note and will seek to prove the Note using a lost note affidavit." & VBACRightToFC2

ElseIf VstatusNote = "Creditor: Note improperly endorsed" Or _
VstatusNote = "Agent: Note improperly endorsed" Then
!BACRIGHTTOFC = "Movant, directly or through an agent, has possession of the Note.  Movant will enforce the Note as transferee in possession." & VBACRightToFC2
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bac_debtor_LM = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bac_debtor_LM = 1 Then

!edvapara13 = "13."
!lossmit = "As of the date of this Motion, the " & IIf(bk() Like "Debtors", "Debtors are", "Debtor is") & " being evaluated for a loss mitigation option.  Additional information regarding such evaluation is available upon request."
!edvapara1314 = "14."

Else
!edvapara13 = ""
!lossmit = ""
!edvapara1314 = "13."
End If



!convdate = Format([Forms]!bankruptcymain!BankruptcySubForm.Form![converted Date], "mmmm dd, yyyy")
!convfrom = [Forms]!bankruptcymain!BankruptcySubForm.Form!chap_from

!mfrtotarr = BKPayTotalAmt()
!totalarrfees = Format(VtotalPPFees - Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")



If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit Like "Promissory note*" Then
!promheloc = "promissory note"
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit = "HELOC Agreement*" Then
!promheloc = "home equity line of credit agreement"
Else
!promheloc = "____________"
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppph = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppph = 1 Then
!ppph = "(a) Attached hereto as Exhibit A is a post-petition payment history."
Else
!ppph = ""
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa = 1 Then
If !ppph = "" Then
!ppfa = "(a) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
Else
!ppfa = "(b) Attached hereto as Exhibit B is an addendum listing all fees and charges assessed to the account of the " & bk() & " post-petition."
End If
End If

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = -1 Or _
[Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia = 1 Then
If !ppph = "" And !ppfa = "" Then
!ppfa = "(a) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
ElseIf !ppph <> "" Or !ppfa <> "" Then
!ppfa = "(b) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
ElseIf !ppph <> "" And !ppfa <> "" Then
!pptia = "(c) Attached hereto as Exhibit C is an addendum listing all post-petition taxes and insurance advances."
End If
End If


If Not rsBKPPFees.EOF Then

Do While Not rsBKPPFees.EOF

If IsNull(!ppd10) And Not IsNull(!ppd9) Then
!ppd10 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp10 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp10 = "Post Petition"
End If

!ppa10 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd9) And Not IsNull(!ppd8) Then
!ppd9 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp9 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp9 = "Post Petition"
End If
!ppa9 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd8) And Not IsNull(!ppd7) Then
!ppd8 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp8 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp8 = "Post Petition"
End If
!ppa8 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd7) And Not IsNull(!ppd6) Then
!ppd7 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp7 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp7 = "Post Petition"
End If
!ppa7 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd6) And Not IsNull(!ppd5) Then
!ppd6 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp6 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp6 = "Post Petition"
End If
!ppa6 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees


ElseIf IsNull(!ppd5) And Not IsNull(!ppd4) Then
!ppd5 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp5 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp5 = "Post Petition"
End If
!ppa5 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd4) And Not IsNull(!ppd3) Then
!ppd4 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp4 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp4 = "Post Petition"
End If
!ppa4 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd3) And Not IsNull(!ppd2) Then
!ppd3 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp3 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp3 = "Post Petition"
End If
!ppa3 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd2) And Not IsNull(!ppd1) Then
!ppd2 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp2 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp2 = "Post Petition"
End If
!ppa2 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd1) Then
!ppd1 = rsBKPPFees![BACDesc]
If rsBKPPFees![PrePost] Like "Pre*" Then
!pp1 = "Pre Petition"
ElseIf rsBKPPFees![PrePost] Like "Pos*" Then
!pp1 = "Post Petition"
End If
!ppa1 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

End If

rsBKPPFees.MoveNext
Loop

End If
If Not rsBKArr.EOF Then

Do While Not rsBKArr.EOF
If IsNull(!bkfrom8) And Not IsNull(!bkfrom7) Then
!BKPay8 = rsBKArr![co #payments]
!bkfrom8 = rsBKArr![dfrom]
!BKTo8 = rsBKArr![dthru]
!BKAmt8 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot8 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt8 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt8 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom7) And Not IsNull(!bkfrom6) Then
!BKPay7 = rsBKArr![co #payments]
!bkfrom7 = rsBKArr![dfrom]
!BKTo7 = rsBKArr![dthru]
!BKAmt7 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot7 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt7 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt7 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom6) And Not IsNull(!bkfrom5) Then
!BKPay6 = rsBKArr![co #payments]
!bkfrom6 = rsBKArr![dfrom]
!BKTo6 = rsBKArr![dthru]
!BKAmt6 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot6 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt6 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt6 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom5) And Not IsNull(!bkfrom4) Then
!BKPay5 = rsBKArr![co #payments]
!bkfrom5 = rsBKArr![dfrom]
!BKTo5 = rsBKArr![dthru]
!BKAmt5 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot5 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt5 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt5 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom4) And Not IsNull(!bkfrom3) Then
!bkpay4 = rsBKArr![co #payments]
!bkfrom4 = rsBKArr![dfrom]
!bkto4 = rsBKArr![dthru]
!BKAmt4 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot4 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt4 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt4 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom3) And Not IsNull(!bkfrom2) Then
!bkpay3 = rsBKArr![co #payments]
!bkfrom3 = rsBKArr![dfrom]
!bkto3 = rsBKArr![dthru]
!BKAmt3 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot3 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt3 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt3 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom2) And Not IsNull(!bkfrom1) Then
!BKpay2 = rsBKArr![co #payments]
!bkfrom2 = rsBKArr![dfrom]
!BKTo2 = rsBKArr![dthru]
!BKAmt2 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot2 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt2 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt2 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom1) Then
!BKpay1 = rsBKArr![co #payments]
!bkfrom1 = rsBKArr![dfrom]
!BKTo1 = rsBKArr![dthru]
!BKAmt1 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot1 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt1 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt1 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

End If

''end BKArr

rsBKArr.MoveNext
Loop

End If

!County = County()
!DebtorDebtors = bk()
!BKMovant = BKMovant()
!cobk = cobk()


If bk() = "Debtors" Then
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
!consents = "consent"
Else
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
!consents = "consents"
End If

If CoDebt() = "YES" Then
!coisare = "are"
VcoIsAre = "are"
!cohashave = "have"
VCoHasHave = "have"
Else
!coisare = "is"
VcoIare = "is"
!cohashave = "has"
VCoHasHave = "has"
End If

!PPArrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pre_pet_amt], "$###,##0.00")
!corpadvance = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![bk_corp], "$###,##0.00")

!confdate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!plan_conf, "mmmm dd, yyyy")

!confhrg = Format(Forms!bankruptcymain!BankruptcySubForm.Form!POC_Conf_Hrg, "mmmm dd, yyyy")



If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date]) Then
!payoffdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![payoff_date], "mmmm dd, yyyy")
Else
!payoffdate = ""
End If

If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance]) Or Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance] <> 0 Then
!minusfunds = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")
Else
!minusfunds = 0#
End If




If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel1 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel1 = 1 Then
!para14a = "Movant's interest in the Property is not adequately protected.  "
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel2 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel2 = 1 Then
!para14a = !para14a + "Movant 's interest in the collateral is not protected by an adequate equity cushion.  "
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel3 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel3 = 1 Then
!para14a = !para14a + "The fair market value of the Property is declining and payments are not being made to Movant sufficient to protect Movant's interest against that decline.  "
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel4 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel4 = 1 Then
!para14a = !para14a + "Payments have not been made as required by an Adequate Protection Order previously granted in this case.  "
End If

!para14b = ""
!para14bltr = ""

If BKChapter() = "13" Then

If (Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel6 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel6 = 1) Then
!para14bltr = "(b)"
!para14b = "Postconfirmation plan payments have not been made to the standing trustee."
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel7 = -1 Or _
Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!GrRel7 = 1 Then
!para14bltr = "(b)"
!para14b = "Postconfirmation payments required by the confirmed plan have not been made to Movant."
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Then
If !para14b = "" Then
!para14c = "Pursuant to 11 U.S.C.  362(d)(2)(A), " & bk() & " " & VHasHave & " no equity in the Property; and pursuant to  362(d)(2)(B), the Property is not necessary for an effective reorganization."
Else
!para14c = "Pursuant to 11 U.S.C.  362(d)(2)(A), " & bk() & " " & VHasHave & " no equity in the Property; and pursuant to  362(d)(2)(B), the Property is not necessary for an effective reorganization."
End If
End If


Else

If Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!payoff_amt > Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![property_value] Then
!para14b = "Pursuant to 11 U.S.C.  362(d)(2)(A), " & bk() & " " & VHasHave & " no equity in the Property; and pursuant to  362(d)(2)(B), the Property is not necessary for an effective reorganization."
End If


End If


If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then


!planfileddate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArrDueThru, "mmmm dd, yyyy")
!pocamount = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArr, "$###,##0.00")
!arrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod!lm_att_fee, "$###,##0.00")
!incdec = LCase(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended)
!attphone = Forms!bankruptcymain!BankruptcySubForm.Form!att_phone
!attfax = Forms!bankruptcymain!BankruptcySubForm.Form!att_fax
!attemail = Forms!bankruptcymain!BankruptcySubForm.Form!att_Email
!oldInterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_int_rate
!newinterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Int_rate
!oldPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_monthly_pmt, "$###,##0.00")
!newPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Monthly_Pmt, "$###,##0.00")

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed Then

Dim todayth, dayeff As String

todayth = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If


!pmtday = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed & dayeff

End If


End If

If VTypeMerge <> "VALoanMod" And VTypeMerge <> "VALoanModOrd" Then
!planfileddate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!pobj_Plan_filed, "mmmm dd, yyyy")
End If

If VTypeMerge = "LatePOC" Then
!bkfiled = VDate
Else
!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Then
![owner1-bk] = owner1()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Then
![owner2-bk] = owner2()
End If

If firstdebtor() <> "" And rs!chapter <> "7" And _
(Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If

If secondDebtor() <> "" And rs!chapter <> "7" And _
(Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
Else
CoDebtorListing = secondDebtor()
End If
!codebtorand = "and"
End If

If thirddebtor() <> "" And rs!chapter <> "7" And _
(Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & thirddebtor()
Else
CoDebtorListing = thirddebtor()
End If
End If

If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fourthdebtor()
Else
CoDebtorListing = fourthdebtor()
End If
End If

If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![5filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fifthdebtor()
Else
CoDebtorListing = fifthdebtor()
End If
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")


!RegMd = VRegMD


!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If
!propstate = Trim(Forms![foreclosure database screen]!PropertyState)
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth

If VtodayDay = 1 Or VtodayDay = 21 Or VtodayDay = 31 Then
!certh = VtodayDay & "st"
ElseIf VtodayDay = 2 Or !todayday = 22 Then
!certh = VtodayDay & "nd"
ElseIf VtodayDay = 3 Or VtodayDay = 23 Then
!certh = VtodayDay & "rd"
Else
!certh = VtodayDay & "th"
End If

'MsgBox (VtodayDay & ", " & !certh)


!todaymonthyear = Format(Date, "mmmm, yyyy")

!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")
!RegMPD = VRegMPD
!bkjudge = Forms!bankruptcymain!BankruptcySubForm.Form!judge

!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3


If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

!BKUPB = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_upb, "$###,##0.00")
!bkinterest = InterestTotalBK()
!BKLateFees = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_latefees, "$###,##0.00")
!BKMipPmi = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_mippmi, "$###,##0.00")
!BKEscrow = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_esc, "$###,##0.00")
!BKSuspense = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_sus, "$###,##0.00")
!COattfees = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00")
!PropValue = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value], "$#,##0.00")

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value_text] Like "Tax*" Then
!taxass = "the tax assessment of the Property"
Else
!taxass = IIf(bk() = "Debtor", "Debtor's Schedules", "Debtors' Schedule")
End If

'!taxass = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_value_text]


!totallien = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total_liens], "$#,##0.00")


.Update
End With


DoCmd.TransferText acExportDelim, , "bkmergemfr", pathuser() & "bkmerge.txt", True

Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function BkMergeDEC()
'
'On Error GoTo Err_Command16_Click

CurrentDb.Execute "Delete * from bkmergeDEC;", dbFailOnError

DoCmd.OpenQuery ("BKMergeDECQRY")
Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("BKMergeDEC", dbOpenDynaset, dbSeeChanges)

Dim VCon1, VCon2, VCon3
Dim VRegMPD, VRegMD, VRegMOB, VTh, Vth3
Dim VlumpSum, VLumpAmt, VLumpdate
Dim VIncarr
Dim VBK
Dim OneSix
Dim CoDebtorListing
Dim VRemaining
Dim VTotalArr
Dim Vcon2a
Dim Vcon2b
Dim VRelief
Dim VHrgTime
Dim VDayDue
Dim VDueth
Dim VdueDay
Dim VSClaim
Dim VPArrears
Dim VmfrFilingFee
Dim rsBKArr As RecordSet
Dim rsBKPPFees As RecordSet

DoCmd.OpenQuery "BKMergeArrPayExcel"

Set rsBKArr = CurrentDb.OpenRecordset("BKMergeArrPay")

DoCmd.OpenQuery "BKMergePPFeesExceldec"

Set rsBKPPFees = CurrentDb.OpenRecordset("BKMergePPFees")


VmfrFilingFee = Format([Forms]![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.[Form]!bk_attcosts, "$###,##0.00")

VRelief = [Forms]!bankruptcymain!BankruptcySubForm.Form!Relief

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage]) Then
VTotalArr = 0

Else
VTotalArr = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$###,##0.00")
End If




VIncarr = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![incarr]
VlumpSum = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![lumpsum]
VLumpAmt = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!Lumpsum_Amt, "$###,##0.00")
VLumpdate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!lumpsum_date, "mmmm dd, yyyy")
VRegMD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment], "$###,##0.00")
VRegMPD = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly Payment Date], "mmmm dd"", ""yyyy")
VRegMOB = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Regular Monthly on or Before Day]
VPPmob = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Post Petition On Or Before Day]


If VTypeMerge = "LatePOC" Then
VdueDay = Format(Date, "d")
Else
VdueDay = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![day due]
End If

VDueth = IIf(VdueDay = "1" Or VdueDay = "21" Or VdueDay = "31", "st", IIf(VdueDay = "2" Or VdueDay = "22", "nd", IIf(VdueDay = "3" Or VdueDay = "23", "rd", "th")))
VDayDue = DateENG(VdueDay) & " (" & VdueDay & VDueth & ")"

If IsNull(VLumpAmt) Or VLumpAmt = "" Then
VRemaining = 0
Else
VRemaining = Format(VTotalArr - VLumpAmt, "$###,##0.00")
End If


VTh = IIf(VRegMOB = 1 Or VRegMOB = 21 Or VRegMOB = 31, "st", IIf(VRegMOB = 2 Or VRegMOB = 22, "nd", IIf(VRegMOB = 3 Or VRegMOB = 23, "rd", "th")))
Vth3 = IIf(VPPmob = 1 Or VPPmob = 21 Or VPPmob = 31, "st", IIf(VPPmob = 2 Or VPPmob = 22, "nd", IIf(VPPmob = 3 Or VPPmob = 23, "rd", "th")))
vonesix = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![post petition payments], "$###,##0.00")

If VTypeMerge = "LETTER" Then
Dim Vproc
Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String
Do While Vproc <> "YES"
vInitials = getEmployeeInitials(Environ("username"))
strsqlEmp = "select * from employees where employeeid = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)
If rsEmp.EOF Then
MsgBox ("Incorrect Initials, please re-input")
Else
Vproc = "YES"
If Not IsNull(rsEmp!MiddleName) Then
VCon1 = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
VCon1 = rsEmp!FirstName & " " & rsEmp!LastName
End If

End If
Loop


ElseIf VTypeMerge = "withdrawNOD" Then

If Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 1 Then
VCon1 = "First Notice of Default and Notice of Termination of Automatic Stay"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 2 Then
VCon1 = "Second Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
ElseIf Forms![bankruptcymain]!BankruptcySubForm.Form!NODresoltuion.Form![aod filed] = 3 Then
VCon1 = "Third Notice of Default, Notice of Termination of Automatic Stay and Notice of Secured Creditor's Intent to Commence Foreclosure Proceedings"
Else
VCon1 = "Notice of Default"
End If

ElseIf VTypeMerge = "OrderContinue" Then
VCon1 = bkjudge() & " on " & bkMISChearing()

ElseIf VTypeMerge = "OrdContPlan" Then
VCon1 = bkMISChearing()

ElseIf VTypeMerge = "PlanObjection" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PRes = 1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PRes = -1 Then
VCon1 = "The Property is the Debtor's primary residence."
Else
VCon1 = ""
End If


Else

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
VCon1 = "The Debtor will resume making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and will continue to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
Else
VCon1 = "1.     The Debtor resumes making regular monthly installment payments to the Movant in the amount of " _
& VRegMD & " commencing on " & VRegMPD & ", and continues to make regular monthly installment payments on the " & VDayDue & " day of each month thereafter as they become due as adjusted for escrow or interest rate changes and all other conditions and obligations set forth in the Note and Deed of Trust."
End If
End If

If VTypeMerge = "PlanObjection" Then

If BKJurisdiction() Like "*Norfolk*" Or BKJurisdiction() Like "*Newport*" Then
VCon2 = "CHAIN OF TITLE - Tidewater."
Else
VCon2 = ""
End If



If Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled = 0 Or _
IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled) Then

VSClaim = InputBox("Amount of Secured Claim:")
Vcon2a = Format(VSClaim, "$###,##0.00")
VPArrears = InputBox("Amount of Pre-Petition Arrears:")
Vcon2b = Format(VPArrears, "$###,##0.00")
End If

ElseIf (VlumpSum = 0 Or IsNull(VlumpSum)) And (IsNull(VIncarr) Or VIncarr = 0) Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's total post-petition arrears) on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by:"
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."

Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the remaining post-petition arrearage of " & _
VRemaining & " and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

ElseIf (VlumpSum = -1 Or VlumpSum = 1) And (VIncarr = 0 Or IsNull(VIncarr)) Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making the following payments: "


Else
If VLumpAmt = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage] Then
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Else
VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by: "
Vcon2a = "a.     Making a lump sum payment to the Movant in the amount of " & VLumpAmt & " on or before " & VLumpdate & "; and"
Vcon2b = "b.     Making a payment to the Movant in the amount of " & vonesix & _
" (this figure represents one-sixth (1/6th) of the Debtor's remaining post-petition arrears of " & VRemaining & ") on or before " & _
Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![Post Petition Payment Date], "mmmm dd"", ""yyyy") & _
", and continuing to make payments of " & vonesix & _
" on or before the fifteenth (15th) day of each and every month thereafter until the arrearage owed is paid."
End If
End If

ElseIf (VlumpSum = 0 Or IsNull(VlumpSum)) And (VIncarr = -1 Or VIncarr = 1) Then
VCon3 = "or if the Debtor does not file the Amended Plan within twenty (20) days of the entry of this Agreed Order, "

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then

VCon2 = "The Debtor will cure the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."


Else

VCon2 = "2.     The Debtor cures the post-petition arrearages due to the Movant through " & _
Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![Due Through], "mmmm dd, yyyy") & _
" in the total amount of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![total arrearage], "$#,##0.00") & _
" (which includes late charges, deferred late charges, filing fees of " & VmfrFilingFee & _
" and attorney's fees of " & Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![co Attorneys Fees], "$#,##0.00") & ") by making payments pursuant to an Amended/Modified Chapter 13 plan (the " & """" & "Amended Plan" & """" & ") that will incorporate the post-petition arrearage" & _
" and provide that the arrearage will be paid out by the Chapter 13 Trustee to the Movant throughout the life of the bankruptcy.  " & _
"The Debtor shall file the Amended Plan within twenty (20) days of the entry of this Agreed Order.  The Movant shall file an Amended Proof of Claim to include the post-petition arrears after the Amended Plan is filed."
End If

End If

Dim strsqlJ As String
Dim rsJ As RecordSet

Dim VCourthouse As String
VCourthouse = "United States Bankruptcy Court" & ", " & bkcourt1() & ", " & bkcourt2() & " " & bkcourt3()


If VTypeMerge = "LatePOC" Or _
VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then
VCon1 = Forms![foreclosure database screen]!Propertycounty

If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then

VCon2 = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![brief_legal]
If Forms![foreclosure database screen]!SPsameasCl = -1 Or _
Forms![foreclosure database screen]!SPsameasCl = 1 Then
VCon3 = ""
Else
VCon3 = " c/o " & Client()
End If

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended = "Increase" Then
Vcon2a = "For purposes of making the increased monthly payments, the Debtor will obtain funds from ______."
Else
Vcon2a = "The Debtor does not intend to increase the amount of the monthly Chapter 13 Plan payments as a result of the monthly mortgage payment being decreased under the terms of the Loan Modification Agreement."
End If


If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included > 0 Then

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraph 2(d) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtors escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
Else
Vcon2b = "In addition to making monthly principal and interest payments as set forth in paragraphs 6(e) and 6(f) hereinabove, the Debtor will also be required to make monthly payments to be applied towards the Debtor's escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly escrow payment is currently due in the amount of " & Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Esc_Included, "$###,##0.00") & ". This amount is subject to change due to changes in the taxes and/or insurance premiums."
End If

Else

If VTypeMerge = "VALoanModOrd" Then
Vcon2b = "The monthly payment amount set for in paragraph 2(d) hereinabove is inclusive of principal and interest only. No portion of that payment amount is currently being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
Else

Vcon2b = "The monthly payment amounts set for in paragraphs 6(e) and 6(f) hereinabove are inclusive of principal and interest only. No portion of those payments is being applied to an escrow account for purposes of paying taxes and insurance premiums on the Property. The monthly payment amount shall be subject to change should the Debtor establish an escrow account with the Lender for purposes of paying taxes and insurance premiums on the Property."
End If

End If




Else
VCon2 = Format(Forms!bankruptcymain!BankruptcySubForm.Form!MTA_Dl, "mmmm dd, yyyy")
VCon3 = VdueDay & VDueth
Vcon2a = bkcourt1() & ", " & bkcourt2()
Vcon2b = bkcourt3()
VDate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!mta_hearing, "mmmm dd, yyyy") & " at " & Format(Forms!bankruptcymain!BankruptcySubForm.Form!mta_filed, "hh:ss am/pm")

End If

End If

Dim VIsAre
Dim VHasHave
Dim VcoIsAre
Dim VCoHasHave
If Not rs.EOF Then

With rs
.Edit

!surrender = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![property_sur]


!DebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!DebtorFiled
!JointDebtorFiled = [Forms]!bankruptcymain!BankruptcySubForm.Form!JointDebtorFiled

!notemaker = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form![bac_maker_note]

!bktotaldue = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]![totaldue], "$###,##0.00")

!EffDate = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_effective, "mmmm dd, yyyy")
!EffDatePO = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_payoff_eff, "mmmm dd, yyyy")
!LoanModDate = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!LoanModDate, "mmmm dd, yyyy")
!loanMod = Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form!loanMod

!mfrtotarr = BKPayTotalAmt()

If [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit Like "Promissory note*" Then
!promheloc = "promissory note"
ElseIf [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_credit = "HELOC Agreement*" Then
!promheloc = "home equity line of credit agreement"
Else
!promheloc = "____________"
End If

!ppph = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppph
!ppfa = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_ppfa
!pptia = [Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_pptia

If IsNull([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security) Then
!DeedofTrust = "Deed of Trust"
!SmallDOT = "deed of trust"

Else
!DeedofTrust = Trim([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bacmfr_security)
End If

!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
Dim VstatusNote
VstatusNote = Trim(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![StatusNote])

If VstatusNote = "Creditor: Note endorsed to Creditor" Or _
VstatusNote = "Agent: Note endorsed to Creditor" Then
!chaserighttofc = "The Movant's agent has possession of the original promissory note, and the note is payable to the Movant."
ElseIf VstatusNote = "Creditor: Note endorsed in blank" Or _
VstatusNote = "Agent: Note endorsed in blank" Then
!chaserighttofc = "The Movant's agent has possession of the original promissory note, and the note is endorsed in blank."
ElseIf VstatusNote = "Note is Lost: Lost Note Affidavit" Then
!chaserighttofc = "The original promissory note is lost or missing.  A copy of an affidavit of lost or missing note, with a copy of the note, is attached as Exhibit A."
ElseIf VstatusNote = "Creditor: Note improperly endorsed" Or _
VstatusNote = "Agent: Note improperly endorsed" Then
!chaserighttofc = "ERROR"
End If

If VstatusNote = "Note is Lost: Lost Note Affidavit" Then
![exhibit#] = "B"
Else
![exhibit#] = "A"
End If

If Forms![foreclosure database screen]!SPsameasCl = -1 Or Forms![foreclosure database screen]!SPsameasCl = 1 Then
!MovantisServicer = "( " & """" & "Movant" & """" & ") and am authorized to sign this supplemental declaration on behalf of Movant."
!dcservicer = ""
Else
!MovantisServicer = " and am authorized to sign this supplemental declaration on behalf of " & Client() & ", as servicing agent for " & BKMovant() & " (" & """" & "Movant" & """" & ")."
!dcservicer = "  " & Client() & " is the servicer of the loan and is authorized to act on behalf of the holder of the note, " & BKMovant() & "."
End If

!BKMovant = BKMovant()

If Forms![foreclosure database screen]!SPsameasCl = 0 Or IsNull(Forms![foreclosure database screen]!SPsameasCl) Then
!Signature1 = " as servicing agent for " & BKMovant()
Else
!Signature1 = ""
End If


If Not rsBKPPFees.EOF Then

Do While Not rsBKPPFees.EOF

If IsNull(!ppd10) And Not IsNull(!ppd9) Then
!ppd10 = rsBKPPFees![BACDesc]
!pp10 = rsBKPPFees![PrePost]
!ppa10 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd9) And Not IsNull(!ppd8) Then
!ppd9 = rsBKPPFees![BACDesc]
!pp9 = rsBKPPFees![PrePost]
!ppa9 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd8) And Not IsNull(!ppd7) Then
!ppd8 = rsBKPPFees![BACDesc]
!pp8 = rsBKPPFees![PrePost]
!ppa8 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd7) And Not IsNull(!ppd6) Then
!ppd7 = rsBKPPFees![BACDesc]
!pp7 = rsBKPPFees![PrePost]
!ppa7 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd6) And Not IsNull(!ppd5) Then
!ppd6 = rsBKPPFees![BACDesc]
!pp6 = rsBKPPFees![PrePost]
!ppa6 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees


ElseIf IsNull(!ppd5) And Not IsNull(!ppd4) Then
!ppd5 = rsBKPPFees![BACDesc]
!pp5 = rsBKPPFees![PrePost]
!ppa5 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd4) And Not IsNull(!ppd3) Then
!ppd4 = rsBKPPFees![BACDesc]
!pp4 = rsBKPPFees![PrePost]
!ppa4 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd3) And Not IsNull(!ppd2) Then
!ppd3 = rsBKPPFees![BACDesc]
!pp3 = rsBKPPFees![PrePost]
!ppa3 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd2) And Not IsNull(!ppd1) Then
!ppd2 = rsBKPPFees![BACDesc]
!pp2 = rsBKPPFees![PrePost]
!ppa2 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

ElseIf IsNull(!ppd1) Then
!ppd1 = rsBKPPFees![BACDesc]
!pp1 = rsBKPPFees![PrePost]
!ppa1 = Format(rsBKPPFees!BACFee, "$###,##0.00")
VtotalPPFees = rsBKPPFees!BACFee + VtotalPPFees

End If

rsBKPPFees.MoveNext
Loop

End If

If Not rsBKArr.EOF Then

Do While Not rsBKArr.EOF

If IsNull(!bkfrom12) And Not IsNull(!bkfrom11) Then
!BKPay12 = rsBKArr![co #payments]
!bkfrom12 = rsBKArr![dfrom]
!BKTo12 = rsBKArr![dthru]
!BKAmt12 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot12 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt12 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt12 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom11) And Not IsNull(!bkfrom10) Then
!BKPay11 = rsBKArr![co #payments]
!bkfrom11 = rsBKArr![dfrom]
!BKTo11 = rsBKArr![dthru]
!BKAmt11 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot11 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt11 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt11 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom10) And Not IsNull(!bkfrom9) Then
!BKPay10 = rsBKArr![co #payments]
!bkfrom10 = rsBKArr![dfrom]
!BKTo10 = rsBKArr![dthru]
!BKAmt10 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot10 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt10 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt10 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom9) And Not IsNull(!bkfrom8) Then
!BKPay9 = rsBKArr![co #payments]
!bkfrom9 = rsBKArr![dfrom]
!BKTo9 = rsBKArr![dthru]
!BKAmt9 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot9 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt9 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt9 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom8) And Not IsNull(!bkfrom7) Then
!BKPay8 = rsBKArr![co #payments]
!bkfrom8 = rsBKArr![dfrom]
!BKTo8 = rsBKArr![dthru]
!BKAmt8 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot8 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt8 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt8 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom7) And Not IsNull(!bkfrom6) Then
!BKPay7 = rsBKArr![co #payments]
!bkfrom7 = rsBKArr![dfrom]
!BKTo7 = rsBKArr![dthru]
!BKAmt7 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot7 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt7 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt7 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom6) And Not IsNull(!bkfrom5) Then
!BKPay6 = rsBKArr![co #payments]
!bkfrom6 = rsBKArr![dfrom]
!BKTo6 = rsBKArr![dthru]
!BKAmt6 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot6 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt6 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt6 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom5) And Not IsNull(!bkfrom4) Then
!BKPay5 = rsBKArr![co #payments]
!bkfrom5 = rsBKArr![dfrom]
!BKTo5 = rsBKArr![dthru]
!BKAmt5 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot5 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt5 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt5 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom4) And Not IsNull(!bkfrom3) Then
!bkpay4 = rsBKArr![co #payments]
!bkfrom4 = rsBKArr![dfrom]
!bkto4 = rsBKArr![dthru]
!BKAmt4 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot4 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt4 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt4 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees


ElseIf IsNull(!bkfrom3) And Not IsNull(!bkfrom2) Then
!bkpay3 = rsBKArr![co #payments]
!bkfrom3 = rsBKArr![dfrom]
!bkto3 = rsBKArr![dthru]
!BKAmt3 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot3 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt3 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt3 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom2) And Not IsNull(!bkfrom1) Then
!BKpay2 = rsBKArr![co #payments]
!bkfrom2 = rsBKArr![dfrom]
!BKTo2 = rsBKArr![dthru]
!BKAmt2 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot2 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt2 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt2 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

ElseIf IsNull(!bkfrom1) Then
!BKpay1 = rsBKArr![co #payments]
!bkfrom1 = rsBKArr![dfrom]
!BKTo1 = rsBKArr![dthru]
!BKAmt1 = Format(rsBKArr![co Amt], "$###,##0.00")
!BKTot1 = Format(rsBKArr![co #payments] * rsBKArr![co Amt], "$###,##0.00")
!p1amt1 = Format(rsBKArr!PIAmt, "$###,##0.00")
!escamt1 = Format(rsBKArr![co Amt] - rsBKArr!PIAmt, "$###,##0.00")
VtotalPPFees = (rsBKArr![co #payments] * rsBKArr![co Amt]) + VtotalPPFees

End If

'end BKArr

rsBKArr.MoveNext
Loop

End If

!totalarrfees = Format(VtotalPPFees - Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")


!DebtorDebtors = bk()
!cobk = cobk()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()



If bk() = "Debtors" Then
VIsAre = "are"
!isare = "are"
!hashave = "have"
VHasHave = "have"
!respondent = "Respondents"
!consents = "consent"
Else
VIsAre = "is"
!isare = "is"
!hashave = "has"
VHasHave = "has"
!respondent = "Respondent"
!consents = "consents"
End If

If CoDebt() = "YES" Then
!coisare = "are"
VcoIsAre = "are"
!cohashave = "have"
VCoHasHave = "have"
Else
!coisare = "is"
VcoIare = "is"
!cohashave = "has"
VCoHasHave = "has"
End If

!PPArrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![pre_pet_amt], "$###,##0.00")


If Not IsNull(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance]) Then
!minusfunds = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!bkarrearages.Form![suspense_balance], "$###,##0.00")
Else
!minusfunds = 0#
End If



If VTypeMerge = "VALoanMod" Or VTypeMerge = "VALoanModOrd" Then


!planfileddate = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArrDueThru, "mmmm dd, yyyy")
!pocamount = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_PPArr, "$###,##0.00")
!arrears = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod!lm_att_fee, "$###,##0.00")
!incdec = LCase(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Date_Plan_Amended)
!attphone = Forms!bankruptcymain!BankruptcySubForm.Form!att_phone
!attfax = Forms!bankruptcymain!BankruptcySubForm.Form!att_fax
!attemail = Forms!bankruptcymain!BankruptcySubForm.Form!att_Email
!oldInterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_int_rate
!newinterest = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Int_rate
!oldPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_Old_monthly_pmt, "$###,##0.00")
!newPI = Format(Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!LM_New_Monthly_Pmt, "$###,##0.00")

If Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed Then

Dim todayth, dayeff As String

todayth = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If


!pmtday = Forms![bankruptcymain]!BankruptcySubForm.Form!BKLoanMod.Form!lm_date_plan_filed & dayeff

End If


End If

If VTypeMerge <> "VALoanMod" And VTypeMerge <> "VALoanModOrd" Then
!planfileddate = Format(Forms!bankruptcymain!BankruptcySubForm.Form!pobj_Plan_filed, "mmmm dd, yyyy")
End If


If VTypeMerge = "LatePOC" Then
!bkfiled = VDate
Else
!bkfiled = Format(Forms!bankruptcymain!BankruptcySubForm.Form!DateFiled, "mmmm dd, yyyy")
End If


If Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = -1 Then
![firstdebtor-bk] = firstdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = -1 Then
![seconddebtor-bk] = secondDebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = -1 Then
![thirddebtor-bk] = thirddebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = -1 Then
![fourthdebtor-bk] = fourthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = -1 Then
![fifthdebtor-bk] = fifthdebtor()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![owner1filed] = -1 Then
![owner1-bk] = owner1()
End If
If Forms!bankruptcymain!BankruptcySubForm.Form![owner2filed] = -1 Then
![owner2-bk] = owner2()
End If

If firstdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![1filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![1filed])) Then
![firstdebtor-cobk] = firstdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
CoDebtorListing = firstdebtor()
!codebtorand = "and"
End If

If secondDebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![2filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![2filed])) Then
![seconddebtor-cobk] = secondDebtor()
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & secondDebtor()
Else
CoDebtorListing = secondDebtor()
End If
!codebtorand = "and"
End If

If thirddebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![3filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![3filed])) Then
![thirddebtor-cobk] = thirddebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & thirddebtor()
Else
CoDebtorListing = thirddebtor()
End If
End If

If fourthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![4filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![4filed])) Then
![fourthdebtor-cobk] = fourthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fourthdebtor()
Else
CoDebtorListing = fourthdebtor()
End If
End If

If fifthdebtor() <> "" And rs!chapter <> "7" And (Forms!bankruptcymain!BankruptcySubForm.Form![5filed] = 0 Or IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![5filed])) Then
![fifthdebtor-cobk] = fifthdebtor()
!codebtor = "Co-Debtor/Co-Respondent"
!codebtorand = "and"
If CoDebtorListing <> "" Then
CoDebtorListing = CoDebtorListing & ", " & fifthdebtor()
Else
CoDebtorListing = fifthdebtor()
End If
End If

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")


!RegMd = VRegMD


!BKJuris = BKJuris()
!SecuredParty = BKMovant()
!longsecured = BKMovant()

If BKJurisdiction() Like "*VA" Then
!State = "Virginia"
ElseIf BKJurisdiction() Like "*md" Then
!State = "Maryland"
Else
!State = "DC"
End If


!WhoFiled = debtorsbk()
!Property = PROP()
!BKDistrict = BKDistrict()

If rs![Jurisdiction] Like "*WDVA" Then
!district = "Western District of Virginia"
ElseIf rs![Jurisdiction] Like "*EDVA" Then
!district = "Eastern District of Virginia"
ElseIf rs![Jurisdiction] = "D.C." Then
!district = "District of Columbia"
ElseIf rs![Jurisdiction] Like "Greenbelt*" Or rs![Jurisdiction] Like "Balti*" Then
!district = "District of Maryland"
End If

!attorneysigns1 = attorneysigns()
!attorneybar = attorneybar()
!trustee_name = Trustees()
!bkCertName = bkCertName()
!bkCertAdd = bkCertAdd()
!bkCertCSZ = bkCertCSZ()

!DateYr = "20__"

!todaydate = Format(Date, "mmmm dd, yyyy")


!todayday = Format(Date, "dd")

VtodayDay = Format(Date, "dd")

Dim vdayth


'MsgBox (VtodayDay & ", " & !certh)


!todaymonthyear = Format(Date, "mmmm, yyyy")

!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,##0.00")
!RegMPD = VRegMPD
!bkjudge = Forms!bankruptcymain!BankruptcySubForm.Form!judge

!Con1 = VCon1
!Con2 = VCon2
!Con3 = VCon3


If IsNull(Forms![foreclosure database screen]![unit_no]) Or Forms![foreclosure database screen]![unit_no] = "" Then
!property1 = Forms![foreclosure database screen]![PropAddress]
Else
!property1 = Forms![foreclosure database screen]![PropAddress] & ", Unit # " & Forms![foreclosure database screen]![unit_no]
End If
!property2 = Forms![foreclosure database screen]!propaddress2
!propertyCSZ = Forms![foreclosure database screen]!PropertyCity & ", " & Forms![foreclosure database screen]!PropertyState & "  " & Forms![foreclosure database screen]!propzip
!mailingadd = Forms![foreclosure database screen]![Mailing Address]
!mailingaddb = Forms![foreclosure database screen]![Mailing Address2]
!mailingcsz = Forms![foreclosure database screen]![Mailing City] & ", " & Forms![foreclosure database screen]![Mailing State] & "  " & Forms![foreclosure database screen]![Mailing Zip]
!mailingadd2 = Forms![foreclosure database screen]![Mailing AddressB]
!mailingadd2b = Forms![foreclosure database screen]![Mailing Address2B]
!mailingcsz2 = Forms![foreclosure database screen]![Mailing CityB] & ", " & Forms![foreclosure database screen]![Mailing StateB] & "  " & Forms![foreclosure database screen]![Mailing ZipB]
!sdat = Forms![foreclosure database screen]![SDatAddress]
!sdatb = Forms![foreclosure database screen]![SDatAddress2]
!sdatCSZ = Forms![foreclosure database screen]![SDatCity] & ", " & Forms![foreclosure database screen]![SDatState] & "  " & Forms![foreclosure database screen]![SDatZip]

!BKUPB = Format([Forms]![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.[Form]!bk_upb, "$###,##0.00")


.Update
End With


Else
MsgBox ("No data in BK to Merge.  The document will not preview.")
VMergeData = 1
End If

Exit Function

Err_Command16_Click:
    MsgBox Err.description
    Exit Function
    
End Function

Public Function ReliefFormOrdersWDVA()
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
'Document Selection
Dim oDoc As String

VMenu = InputBox("Relief Orders: WDVA - Who endorses Order" & vbCr & "1. Debtor and Trustee" & vbCr & "2. Debtor Only" & vbCr & "3. Trustee Only" & vbCr & "4. Neither Debtor nor Trustee" & vbCr & "select consent to print")
If VMenu = 1 Then
oDoc = "Relief-WD.conDatt.doc"
ElseIf VMenu = 2 Then
oDoc = "Relief-WD.ConDA.doc"
ElseIf VMenu = 3 Then
oDoc = "Relief-WD.conTT.doc"
ElseIf VMenu = 4 Then
oDoc = "Relief-WD.nocon.doc"
End If

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges


End Function

Public Function RunOrdContPlanMerge()
VTypeMerge = "OrdContPlan"

Call BkMerge

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Document Selection
Dim oDoc As String

oDoc = "ContinueHrg-PlanObj.WDVA.doc"

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function

Public Function RunConsentMerge()
VTypeMerge = "Consent"

Call BkMerge

If VMergeData = 1 Then
Exit Function

Else
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!Relief) Then
VRelief = 0
Else
VRelief = Forms!bankruptcymain!BankruptcySubForm.Form!Relief
End If


'Document Selection
Dim oDoc As String


Dim VMenu

If BKChapter() = 7 Then

If BKJurisdiction() Like "*-MD" Or _
BKJurisdiction() = "D.C." Then
'VMenu = InputBox("Consent Orders for MD/DC Chapter 7" & vbCr & "1. NDR" & vbCr & "2. Trustee No Response" & vbCr & "select consent to print")
'If VMenu = 1 Then
If Not IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![NDR_filed]) Then
oDoc = "DCMD7ConsentNDR.doc"
ElseIf IsNull(Forms!bankruptcymain!BankruptcySubForm.Form![NDR_filed]) And IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!trustee_response_MFR) Then
oDoc = "DC-MD7ConsentTTNORESP.doc"
End If

ElseIf BKJurisdiction() Like "*WDVA" Then

VMenu = InputBox("Consent Orders for WDVA Chapter 7" & vbCr & "1. Debtor and TT Consent" & vbCr & "2. Debtor Consent/TT NDR" & vbCr & "3. Debtor Consent/TT Relief" & vbCr & "4. Debtor and TT Relief" & vbCr & "5. Debtor Relief/TT NDR" & vbCr & "6. Sell/Settle/Disburse Order" & vbCr & "7. Debtor Relief/TT Consent" & vbCr & "8. Relief-Form Order" & vbCr & "9. Default Order" & vbCr & "select consent to print")
If VMenu = 1 Then
oDoc = "EDVA7Consentx2.doc"
ElseIf VMenu = 2 Then
oDoc = "ED7ConsentNDE.doc"
ElseIf VMenu = 3 Then
oDoc = "07apparconsda.deftee.doc"
ElseIf VMenu = 4 Then
oDoc = "7apprdef.doc"
ElseIf VMenu = 5 Then
oDoc = "7apprdefdaNDR.doc"
ElseIf VMenu = 6 Then
oDoc = "sellsettledisburse7.doc"
ElseIf VMenu = 7 Then
oDoc = "07apparconstee.defda.doc"
ElseIf VMenu = 8 Then
VRFO = "YES"
Call ReliefFormOrdersWDVA
ElseIf VMenu = 9 Then
oDoc = "WD7default.doc"

End If

ElseIf BKJurisdiction() Like "*EDVA" Then
VMenu = InputBox("Consent Orders for EDVA Chapter 7" & vbCr & "1. Debtor and TT Consent" & vbCr & "2. Debtor Consent/TT NDR" & vbCr & "3. Debtor Consent/TT Relief" & vbCr & "4. Debtor and TT Relief" & vbCr & "5. Debtor Relief/TT Consent" & vbCr & "6. Debtor Relief/TT NDR" & vbCr & "7. Sell/Settle/Disburse Order" & vbCr & "8. Relief-Form Order" & vbCr & "9. Modify Stay-Form Order" & vbCr & "select consent to print")
If VMenu = 1 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!Attorney = "Neil Spencer Welles, Esq." Then
oDoc = "EDVA7Consentx2RGM-welles.doc"
Else
oDoc = "EDVA7Consentx2RGM.doc"
End If
Else
oDoc = "EDVA7Consentx2.doc"
End If
ElseIf VMenu = 2 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!Attorney Like "*Welles*" Then
oDoc = "ED7ConsentNDRRGM-welles.doc"
Else
oDoc = "ED7ConsentNDRRGM.doc"
End If
Else
If Forms!bankruptcymain!BankruptcySubForm.Form!Attorney Like "*Welles*" Then
oDoc = "7ConsentNDR-Welles.doc"
Else
oDoc = "ED7ConsentNDE.doc"
End If
End If
ElseIf VMenu = 3 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
If Forms!bankruptcymain!BankruptcySubForm.Form!Attorney Like "*Welles*" Then
oDoc = "07apparconsda.defteeRGM-welles.doc"
Else
oDoc = "07apparconsda.defteeRGM.doc"
End If
Else
oDoc = "07apparconsda.deftee.doc"
End If
ElseIf VMenu = 4 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!Attorney Like "*Welles*" Then
oDoc = "7Apprconsda.deftt-Welles.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
oDoc = "EDVA7apprdefRGM.doc"
Else
oDoc = "7apprdef.doc"
End If
ElseIf VMenu = 8 Then
VRFO = "YES"
Call ReliefFormOrdersEDVA
ElseIf VMenu = 5 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
oDoc = "07apparconstee.defdaRGM.doc"
Else
oDoc = "07apparconstee.defda.doc"
End If
ElseIf VMenu = 9 Then
If BKJurisdiction() Like "*Nor*" Then
Call ModFormOrder
oDoc = "13Modify-NOR.NN.doc"
Else
If Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form!incarr = -1 Or _
Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form!incarr = 1 Then
oDoc = "13Modify-AmendPlan-EDVA.doc"
Else
Call ModFormOrder
oDoc = "13Modify-EDVA.doc"
End If

End If

ElseIf VMenu = 6 Then
'If Forms!BankruptcyMain!bankruptcysubform.Form!judge = "RGM" Then
oDoc = "7apprdefdaNDR-RGM.doc"
'Else
'MsgBox ("Only 7apprdefdaNDR-RGM document set up is for Judge Mayer")
ElseIf VMenu = 7 Then
Dim vMsg1, VMsg2
vMsg1 = InputBox("Date Default Effective")
VMsg2 = InputBox("Sale Time Frame (30/60/90)")
Set rs = CurrentDb.OpenRecordset("Bkmerge", dbOpenDynaset, dbSeeChanges)
With rs
.Edit
!dde = vMsg1
!saletf = VMsg2
.Update
.Close
End With
oDoc = "sellsettledisburse7.doc"
End If
End If
End If

If BKChapter() = "13" Or _
BKChapter() = "11" Then

If BKJurisdiction() Like "*WDVA" Then
VMenu = InputBox("Consent Orders for WDVA Chapter 11/13" & vbCr & "1. Consent" & vbCr & "2. Agreed" & vbCr & "3. ApprRelief" & vbCr & "4. ConsentLatePOC" & vbCr & "5.  Co-Debtor Default" & vbCr & "6.  Co-Debtor Response" & vbCr & "7. Relief-Form Order" & vbCr & "8. Modify Stay-Form Order" & vbCr & "select consent to print")
Else
VMenu = InputBox("Consent Orders for EDVA/WDVA Chapter 11/13" & vbCr & "1. Consent" & vbCr & "2. Agreed" & vbCr & "3. ApprRelief" & vbCr & "4. ConsentLatePOC" & vbCr & "5. Relief-Form Order" & vbCr & "6. Modify Stay-Form Order" & vbCr & "select consent to print")
End If

If VMenu = 1 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
oDoc = "ED13Consent.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Or _
Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SCS" Then
oDoc = "ED13ConsentNOR-NN.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "WEA" Then
oDoc = "WD13ConsentWEA.doc"
Else
oDoc = "ED13Consent.doc"
End If

ElseIf VMenu = 2 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "RGM" Then
'DoCmd.RunMacro ("exportStipmerge")
oDoc = "ED13AOPlanRGM.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "WEA" Then
oDoc = "WD13AgreedOrderWEA.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SSM" Then
oDoc = "ED13agreedorderSSM.doc"
'ElseIf Forms!BankruptcyMain!bankruptcysubform.Form!trustee_name Like "*Beskin*" Then
'oDoc = "WD13agreedorderBESKIN.doc"
ElseIf BKJurisdiction() Like "Norfolk*" Or _
BKJurisdiction() Like "Newport*" Then
oDoc = "ED13agreedorderNN-NOR.doc"
ElseIf BKJurisdiction() Like "*WDVA" Then
oDoc = "WD13AgreedOrder"
Else
oDoc = "ED13agreedorder.doc"
End If

ElseIf VMenu = 3 Then
If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Or _
Forms!bankruptcymain!BankruptcySubForm.Form!judge = "SCS" Then
oDoc = "13apprreliefNOR-NN.doc"
ElseIf Forms!bankruptcymain!BankruptcySubForm.Form!judge = "WEA" Then
oDoc = "13apprreliefWEA.doc"
ElseIf BKJurisdiction() Like "*WDVA" Then
oDoc = "13apprrelief.doc"
Else
oDoc = "13apprrelief.doc"
End If


ElseIf VMenu = 4 Then
oDoc = "13ConsentlatePOC"

ElseIf VMenu = 5 Then
If BKJurisdiction() Like "*WDVA" Then

Set rsBKmerge = CurrentDb.OpenRecordset("bkmerge", dbOpenDynaset, dbSeeChanges)
VSelectCoDebtor = InputBox("Co-Debtor Selection:  If the debtor is a Co-Debtor the name will appear for selection" & vbCr & vbCr & "1. " & rsBKmerge![firstdebtor-cobk] & vbCr & "2. " & rsBKmerge![seconddebtor-cobk] & vbCr & "3. " & rsBKmerge![thirddebtor-cobk] & vbCr & "4.  " & rsBKmerge![fourthdebtor-cobk] & vbCr & "input 1, 2, 3 or 4")
If VSelectCoDebtor = 1 Then
With rsBKmerge
.Edit
!codebt1 = ![firstdebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 2 Then
With rsBKmerge
.Edit
!codebt1 = ![seconddebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 3 Then
With rsBKmerge
.Edit
!codebt1 = ![thirddebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 4 Then
With rsBKmerge
.Edit
!codebt1 = ![fourthdebtor-cobk]
.Update
End With
End If
rsBKmerge.Close
If VRelief = 2 Then
oDoc = "WD13.CoDdef.DAAO.doc"
ElseIf VRelief = 1 Then
oDoc = "WD13.CoDdef.DACO.doc"
ElseIf VRelief = 3 Then
oDoc = "WD13.CoDdef.DArelief.doc"
End If

Else

VRFO = "YES"
Call ReliefFormOrdersEDVA
End If


ElseIf VMenu = 7 Then
VRFO = "YES"
Call ReliefFormOrdersWDVA

ElseIf VMenu = 8 Then
If BKJurisdiction() Like "*WDVA" Then
oDoc = "13Modify-WDVA.doc"
End If

ElseIf VMenu = 6 Then
If BKJurisdiction() Like "*EDVA" Then
If BKJurisdiction() Like "*Nor*" Then
Call ModFormOrder
oDoc = "13Modify-NOR.NN.doc"
Else
If Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form!incarr = -1 Or _
Forms![bankruptcymain]![BankruptcySubForm].Form!bkarrearages.Form!incarr = 1 Then
oDoc = "13Modify-AmendPlan-EDVA.doc"
Else
Call ModFormOrder
oDoc = "13Modify-EDVA.doc"
End If
End If
Else

Set rsBKmerge = CurrentDb.OpenRecordset("bkmerge", dbOpenDynaset, dbSeeChanges)
VSelectCoDebtor = InputBox("Co-Debtor Selection:  If the debtor is a Co-Debtor the name will appear for selection" & vbCr & vbCr & "1. " & rsBKmerge![firstdebtor-cobk] & vbCr & "2. " & rsBKmerge![seconddebtor-cobk] & vbCr & "3. " & rsBKmerge![thirddebtor-cobk] & vbCr & "4.  " & rsBKmerge![fourthdebtor-cobk] & vbCr & "input 1, 2, 3 or 4")

If VSelectCoDebtor = 1 Then
With rsBKmerge
.Edit
!codebt1 = ![firstdebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 2 Then
With rsBKmerge
.Edit
!codebt1 = ![seconddebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 3 Then
With rsBKmerge
.Edit
!codebt1 = ![thirddebtor-cobk]
.Update
End With
ElseIf VSelectCoDebtor = 4 Then
With rsBKmerge
.Edit
!codebt1 = ![fourthdebtor-cobk]
.Update
End With
End If
rsBKmerge.Close

If VRelief = 2 Then
oDoc = "WD13.CoDresp.DAAO.doc"
ElseIf VRelief = 1 Then
oDoc = "WD13.CoDresp.DACO.doc"
ElseIf VRelief = 3 Then
oDoc = "WD13.CoDresp.DArelief.doc"
End If
End If
End If

End If

If VRFO <> "YES" Then

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument
'wrdMailMerge.Destination = wdSendToEmail
'wrdMailMerge.Destination = wdSendToFax
'wrdMailMerge.Destination = wdSendToPrinter

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges
End If

End If

End Function

Public Function ReliefFormOrdersEDVA()
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True
'Document Selection
Dim oDoc As String

VMenu = InputBox("Relief Orders: EDVA - Who endorses Order: " & vbCr & "1. Debtor and Trustee" & vbCr & "2. Debtor Only" & vbCr & "3. Trustee Only" & vbCr & "4. Neither Debtor nor Trustee" & vbCr & "select consent to print")
If VMenu = 1 Then
oDoc = "Relief-ED.conDatt.doc"
ElseIf VMenu = 2 Then
oDoc = "Relief-ED.ConDA.doc"
ElseIf VMenu = 3 Then
oDoc = "Relief-ED.conTT.doc"
ElseIf VMenu = 4 Then
oDoc = "Relief-ED.nocon.doc"
End If

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges


End Function
Public Function OrderWithdrawMFR()
VTypeMerge = "WithdrawMFR"

Call BkMerge

If VMergeData = 1 Then
Exit Function

Else

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO


Dim oDoc As String

Dim VMenu

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Then
VMenu = 1
Else
VMenu = 2
End If

If VMenu = 1 Then
oDoc = "WithdrawalOrder-MFR.FJS.doc"
ElseIf VMenu = 2 Then
oDoc = "WithdrawalOrder-MFR.doc"
End If

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument
'wrdMailMerge.Destination = wdSendToEmail
'wrdMailMerge.Destination = wdSendToFax
'wrdMailMerge.Destination = wdSendToPrinter

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges
End If

End Function
Public Function OrderContinue()

VTypeMerge = "OrderContinue"

Call BkMerge

If VMergeData = 1 Then
Exit Function

Else

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO


Dim oDoc As String

Dim VMenu

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "WEA" Or _
Forms!bankruptcymain!BankruptcySubForm.Form!chapter = "7" Then
VMenu = 1
Else
VMenu = 2
End If

If VMenu = 1 Then
oDoc = "7MFR-ContinueHrg.doc"
ElseIf VMenu = 2 Then
oDoc = "13MFR-ContinueHrg.doc"
End If

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument
'wrdMailMerge.Destination = wdSendToEmail
'wrdMailMerge.Destination = wdSendToFax
'wrdMailMerge.Destination = wdSendToPrinter

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges
End If

End Function

Public Function OrderWithdrawNOD()

VTypeMerge = "WithdrawNOD"

Call BkMerge

If VMergeData = 1 Then
Exit Function

Else

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO


Dim oDoc As String

Dim VMenu

If Forms!bankruptcymain!BankruptcySubForm.Form!judge = "FJS" Then
VMenu = 1
Else
VMenu = 2
End If

If VMenu = 1 Then
oDoc = "WithdrawalOrder-NOD.FJS.doc"
ElseIf VMenu = 2 Then
oDoc = "WithdrawalOrder-NOD.doc"
End If

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument
'wrdMailMerge.Destination = wdSendToEmail
'wrdMailMerge.Destination = wdSendToFax
'wrdMailMerge.Destination = wdSendToPrinter

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges
End If

End Function
Public Function OrderTermCoDebt()
Dim VMenu
Dim oDoc As String

VTypeMerge = "OrdTermCoDebt"
If BKJurisdiction() Like "Richmon*" Or _
 BKJurisdiction() Like "Alexan*" Then
oDoc = "AR.TERM.COD.doc"
Else
oDoc = "NNWD.TERM.COD.doc"
End If

Call BkMerge

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\MFR.NODordertemplates\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges



End Function

Public Function RunLoanModsVA()
Dim VMenu
Dim oDoc As String

VMenu = InputBox("VA Loan Mods" & vbCr & "1. Notice/Motion" & vbCr & "2. Order" & vbCr & "3. Loan Modification Agreement" & vbCr & "select document to print")

If VMenu = 1 Then
VTypeMerge = "VALoanMod"
'If bkjurisdiction() = "Richmond-EDVA" Then
oDoc = "LoanMod.BK.Motion.Richmond.doc"
'End If

ElseIf VMenu = 2 Then
VTypeMerge = "VALoanModOrd"
'If bkjurisdiction() = "Richmond-EDVA" Then
oDoc = "LoanMod.BK.Order.Richmond.doc"
'End If

ElseIf VMenu = 3 Then
VTypeMerge = "VALoanMod"
oDoc = "LoanMod.BK.Agmt.doc"

End If




Call BkMerge

If VMergeData = 1 Then

Exit Function

Else

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
Dim VRelief As Integer
Dim rsBKmerge As RecordSet
Dim VSelectCoDebtor
Dim VRFO

If IsNull(Forms!bankruptcymain!BankruptcySubForm.Form!Relief) Then
VRelief = 0
Else
VRelief = Forms!bankruptcymain!BankruptcySubForm.Form!Relief
End If


AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"
'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'End of Document Selection
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
'Where to send the document?
wrdMailMerge.destination = wdSendToNewDocument
'wrdMailMerge.Destination = wdSendToEmail
'wrdMailMerge.Destination = wdSendToFax
'wrdMailMerge.Destination = wdSendToPrinter

' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End If

End Function

Public Function RunPPCMerge()
VTypeMerge = "Motion"

Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\POSTPETITIONCHARGEMD.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

'Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\BK\POSTPETITIONCHARGEMD.doc", "Word.Document")


'Docmd SetWarnings True
End Function
Public Function RunPlanObjArr()
VTypeMerge = "PlanObjArrears"

Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlanObj.CO.Arrears.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
Public Function RunPlanObj()

VTypeMerge = "PlanObjection"

Call BkMerge

'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled = -1 Or _
Forms!bankruptcymain!BankruptcySubForm.Form!PObj_PocFiled = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlanObjectionPOC.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlanObjection.doc", , , True)

End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\bkmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


'Docmd SetWarnings True
End Function
Public Function RunFNMAMerge()
VTypeMerge = "FNMA"

Call FCMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\ForeclosureHalttoClient.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

'Docmd SetWarnings True

End Function
Public Function USGovtMerge()
VTypeMerge = "GOVT"

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\USGovt.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
'MsgBox (PathUSER())

.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function
Public Function ETSLtrMerge()
VTypeMerge = "ETSBlank"

Call ETSMerge

Dim oDoc As Word.document
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\ETS-BlankLtr.doc", "Word.Document")
oDoc.Application.Visible = True
oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "fcmerge.txt"
oDoc.MailMerge.Execute
oDoc.Close
End Function
Public Function ADMerge()
 

CurrentDb.Execute "Delete * from ADmerge;", dbFailOnError
DoCmd.OpenQuery ("ADbasicmerge")
Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet
Dim rsAdOcwen As RecordSet

Set rs = CurrentDb.OpenRecordset("ADMerge", dbOpenDynaset, dbSeeChanges)
Set rsAdOcwen = CurrentDb.OpenRecordset("select taxes, [lender advance],mism6,mism7 from affdebt where subfilenum=" & Forms![foreclosure database screen]!filenum, dbOpenSnapshot)
GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Dim VDate

With rs
.Edit
!Borrowers = debtorsFORE()
!liberfolio = liberfolio()
!borrowersdns = debtorsOPENDNS()
!Property = PROP()
!Attorney = Part1Trustees()
!due_date = NOIDueDate()
!datedefault = NOIDefDate()

!dateyear = "20__"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
!Client = Client()
End If
If Forms![foreclosure database screen]!Client Like "ocwen*" Then
!taxes = rsAdOcwen("taxes")
!insurance = rsAdOcwen("lender advance")
!ps_escrow = rsAdOcwen("mism6")
!Escrow = rsAdOcwen("mism7")
End If



!Propertycounty = County()


Dim rsBD As RecordSet
Dim strsqlBD As String


If VTypeMerge = "affdebtmoniesOcwen" Then


strsqlBD = "SELECT int_vr, [extra text], [interest thru], int_through2, int_through3, [extra date], int_from2, int_from3, [mism10],[mism12],[interestarrears],[principal balance],[interest amt],[interest amt2],[interest amt3],[late charge],[lender advance],[interest on advance],[nsf charge],[foreb],[escbal],[miscm1],[miscm2],[mism3],[mism4],[mism5],[mism6],[mism7],[mism8],[mism9],[rec_bal],[mism11], perdiem, ([mism10]+[serv_fees]+[mism12]+[interestarrears]+[principal balance]+[interest amt]+[interest amt2]+[interest amt3]+[late charge]+[interest on advance]+[nsf charge]+[foreb]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism8]+[mism9]+[rec_bal]+[mism11]+[escbal]) AS BALDue," _
& " ([mism10]+[mism12]+[interestarrears]+[principal balance]+[interest amt]+[interest amt2]+[interest amt3]+[late charge]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism8]+[rec_bal]+[mism11]) as TotalNoSurplus, " _
& " AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]

ElseIf VTypeMerge = "affdebtmoniesCiti" Then
strsqlBD = "SELECT pmi, unapplied, [extra text], perdiem, interestarrears, mism10, mism12, mism13, mism14, mism15, int_vr, int_through3, int_through2, [interest thru], ([Principal Balance] + [interest amt] + [interest amt2] + [interest amt3] + [late charge] + [lender advance] + [interest on advance] + [nsf charge] + [foreb] + [escbal] + [miscm1] + [miscm2] + [mism3] + [mism4] + [mism5] + [mism6] + [mism7] + [mism8] + [mism9] + [rec_bal] + [mism10] + [mism11]+ del_exp + serv_fees + pmi + unapplied) AS BALDue, AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
Else

strsqlBD = "SELECT [extra text], [rec_bal],perdiem, mism11, foreb, interestarrears, mism5, mism10, mism12, mism13, mism14, mism15, int_vr, int_through3, int_through2, [interest thru], ([Principal Balance] + [interest amt] + [interest amt2] + [interest amt3] + [late charge] + [lender advance] + [interest on advance] + [nsf charge] + [foreb] + [escbal] + [miscm1] + [miscm2] + [mism3] + [mism4] + [mism5] + [mism6] + [mism7] + [mism8] + [mism9] + [rec_bal] + [mism10] + [mism11]+ del_exp + serv_fees) AS BALDue, AFFDebt.SubFileNum, " & _
" ([mism10]+[mism12]+[interestarrears]+[principal balance]+[interest amt]+[interest amt2]+[interest amt3]+[late charge]+[lender advance]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism6]+[mism7]+[mism8]+[rec_bal]+[mism11]) as TotalNoSurplus" & _
 " FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
End If

Set rsBD = CurrentDb.OpenRecordset(strsqlBD, dbOpenSnapshot)

If Not rsBD.EOF Then
If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
!TotalNoSurplus = Format(rsBD!TotalNoSurplus, "$###,##0.00")
End If

!balancedue = Format(rsBD!BalDue, "$###,##0.00")

If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
'OCWEN start
!BPO = Format(rsBD!Rec_bal, "$###,##0.00")
!intarrears = Format(rsBD!InterestArrears, "$###,##0.00")
!Defprinbal = Format(rsBD!mism10, "$###,##0.00")
!Priorservfee = Format(rsBD!Mism12, "$###,##0.00")
!titlerpt = Format(rsBD!mism5, "$###,##0.00")
!priorbk = Format(rsBD!foreb, "$###,##0.00")
!proppres = Format(rsBD!mism11, "$###,##0.00")



'OCWEN end
End If

If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
!BalDueAsOf = BalDueAsOf()
ElseIf Not IsNull(rsBD!int_through3) Then
!BalDueAsOf = Format(rsBD!int_through3, "mmmm dd, yyyy")
ElseIf Not IsNull(rsBD!int_through2) Then
'!BalDueAsOf = Format(rs!int_through2, "mmmm dd, yyyy")
ElseIf Not IsNull(rsBD![interest thru]) Then
!BalDueAsOf = Format(rsBD![interest thru], "mmmm dd, yyyy")
End If

If (Forms![foreclosure database screen]!Client Like "Ocwen*" Or Forms![foreclosure database screen]!Client Like "Citimor*") And rsBD!perdiem > 0 Then
!perdiem = rsBD!perdiem
ElseIf rsBD![int_vr] = yes Then
!intpara = "Per diem interest in the amount of " & _
Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance] * (rsBD![extra text] * 0.1) / 365 * 0.1, "$###,##0.00") & " will accrue on the principal from " & !BalDueAsOf & _
" and thereafter will accrue in accordance with the variable rate as set forth in the Note."
Else
!intpara = "Per diem interest in the amount of " & _
Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance] * (rsBD![extra text] * 0.1) / 365 * 0.1, "$###,##0.00") & " will accrue on the principal from " & !BalDueAsOf & "."
End If

Else
!balancedue = 0
End If


!caption1 = attorneycap() & ", et al"

![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!SecuredParty = Forms![foreclosure database screen]!longsecured
!Signature2 = ""

If Forms![foreclosure database screen]!Client Like "Ocwen*" And (Forms![foreclosure database screen]!TypeOfLoan Like "FHLM*" Or _
Forms![foreclosure database screen]!TypeOfLoan Like "FNMA*") Then
!signature = "Ocwen Loan Servicing, LLC "
Else
!signature = PartOneSignatureAff1()

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!signaturewff = "Wells Fargo Financial Maryland, Inc."
!signaturerm = "Wells Fargo Bank, NA., as servicer for Wells Fargo Financial Maryland, Inc."

ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Or Forms![foreclosure database screen]!TypeOfLoan Like "FHLM*" Then
!signaturewff = "Wells Fargo Bank, NA"
!signaturerm = "Wells Fargo Bank, NA"
Else
'MsgBox (PartOneSignatureAff1())

!signaturewff = PartOneSignatureAff1()
!signaturerm = PartOneSignatureAff1()
End If
End If
'      ' ElseIf Client() Like "Ocwen*" And (IsNull(Forms![foreclosure database screen]!prime_nonprime) Or Forms![foreclosure database screen]!prime_nonprime <> 1) Then

!party1stpart = DOASecParty()

.Update
End With

If Forms![foreclosure database screen]!Client Like "Ocwe*" Then
DoCmd.OpenQuery ("AffdebtupdatemergeOcwen")
ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
DoCmd.OpenQuery ("AffdebtupdatemergeCiti")
ElseIf Forms![foreclosure database screen]!Client Like "Select Por*" Then
DoCmd.OpenQuery ("AffdebtupdatemergeSPS")
ElseIf Forms![foreclosure database screen]!Client Like "Well*" Or _
Forms![foreclosure database screen]!Client Like "Specialized L*" Then
DoCmd.OpenQuery ("AFFDEBTUPDATEMERGE")
End If

rsAdOcwen.Close
Set rsAdOcwen = Nothing

DoCmd.TransferText acExportDelim, , "admerge", pathuser() & "admerge.txt", True

End Function

Public Function BasicMergeFC()
 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("basicmergeqryfc")

'DoCmd.RunMacro ("exportbasicmerge")
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

End Function

Public Function BasicMerge()
 

CurrentDb.Execute "Delete * from Basicmerge;", dbFailOnError
CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError

DoCmd.OpenQuery ("basicmergeqry")
'DoCmd.RunMacro ("exportbasicmerge")

DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

End Function
Public Function BasicMergeS()
 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
CurrentDb.Execute "Delete * from Basicmerge;", dbFailOnError
DoCmd.OpenQuery ("basicmergeqryS")
'DoCmd.RunMacro ("exportbasicmerge")
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

End Function
Public Function DILMerge()
 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("fcbasicmerge")

Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet
Dim vAssignor
Dim rsClient As RecordSet
Dim strsqlClient As String

Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)

GblFilenum = Forms![foreclosure database screen]![filenum]

strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

'strsqlfc = "Select * from fctracking where filenum = " & gblfilenum & ";"
'Set rsfc = CurrentDb.OpenRecordset(strsqlfc, dbopensnapshot)
strsqlClient = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

Dim VDate

With rs
.Edit

If VTypeMerge = "DILReleaseMd" Then
!signatureline = DILRelease()

ElseIf VTypeMerge = "DILBorrowerLtr" Then
'Signature
Dim Vproc
Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String

Do While Vproc <> "YES"
vInitials = getEmployeeInitials(Environ("username"))
strsqlEmp = "select * from employees where employeeid = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)

If rsEmp.EOF Then
MsgBox ("Incorrect Initials, please re-input")
Else
Vproc = "YES"
If Not IsNull(rsEmp!MiddleName) Then
!signature = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
Else
!signature = rsEmp!FirstName & " " & rsEmp!LastName
End If

If Not IsNull(rsEmp!Extension) Then
!signatureline2 = " x" & rsEmp!Extension
End If

End If
Loop

rsEmp.Close
'End Signature



End If

If VTypeMerge = "DILSWDeed" Or VTypeMerge = "DILDeed" Then
Dim rsEmpSigns As RecordSet
Dim strsql2 As String
strsql2 = "SELECT DISTINCTROW Employees.EmployeeID, Employees.FirstName, Employees.MiddleName, Employees.LastName, Employees.WorkPhone, " & _
"Employees.[VSB#], " & _
"DeedInLieu.FileNum FROM Employees INNER JOIN DeedInLieu ON Employees.EmployeeID = DeedInLieu.DIL_Signs_Deed WHERE DeedInLieu.FileNum = " & [Forms]![foreclosure database screen]![filenum] & ";"


Set rsEmpSigns = CurrentDb.OpenRecordset(strsql2, dbOpenSnapshot)
If Not rsEmpSigns.EOF Then
Dim VMid
If Not IsNull(rsEmpSigns!MiddleName) Then
VMid = " " & rsEmpSigns!MiddleName
Else
VMid = ""
End If

!Attorney = rsEmpSigns!FirstName & VMid & " " & rsEmpSigns!LastName & ", " & rsEmpSigns![VSB#]
Else
MsgBox ("No selection on who signs SW Deed")

End If

!deposit = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!ta_value, "$###,##0.00")
!ClientAdd = ClientAdd()


End If


If VTypeMerge = "DILCMA" Or VTypeMerge = "DILBorrowerLtr" Or VTypeMerge = "DILPropRel" Then
!LegalDescription = ""
End If

Dim strsqlDIL As String
Dim rsDIL As RecordSet
strsqlDIL = "Select * from Deedinlieu where filenum = " & Forms![foreclosure database screen]!filenum
Set rsDIL = CurrentDb.OpenRecordset(strsqlDIL, dbOpenSnapshot)


If VTypeMerge = "DILAgree" Or VTypeMerge = "DILPropRel" Then
If rsDIL!Escrow = 1 Then
!borown = "PR"
Else
!borown = "Borrower(s)"
!borown2 = "Borrower(s)'"
End If
If POACOwners() <> "" Then
!borown = !borown & " and Co-Owner(s)"
!borown2 = !borown2 & " and Co-Owner(s)'s"
End If

If rsDIL!Escrow = 1 And (Forms![foreclosure database screen]!dec1 = 1 Or Forms![foreclosure database screen]!dec1 = -1) _
And rsDIL!POA1 <> "" Then
!signature = rsDIL![POA1]
ElseIf rsDIL![POA1] <> "" Or Not IsNull(rsDIL![POA1]) Then
!signature = firstdebtor() & " by " & rsDIL![POA1]
Else
!signature = firstdebtor()
End If

If secondDebtor() <> "" Then
If rsDIL!Escrow = 1 _
And (Forms![foreclosure database screen]!dec2 = 1 Or _
Forms![foreclosure database screen]!dec2 = -1) And rsDIL!POA2 <> "" Then
!Signature2 = rsDIL![POA2]
ElseIf rsDIL![POA2] <> "" Or Not IsNull(rsDIL![POA2]) Then
!Signature2 = secondDebtor() & " by " & rsDIL![POA2]
Else
!Signature2 = secondDebtor()
End If
End If

If thirddebtor() <> "" Then
If rsDIL!Escrow = 1 And _
(Forms![foreclosure database screen]!dec3 = 1 Or _
Forms![foreclosure database screen]!dec3 = -1) And rsDIL!POA3 <> "" Then
!signature3 = rsDIL![POA3]
ElseIf rsDIL![POA3] <> "" Or Not IsNull(rsDIL![POA3]) Then
!signature3 = thirddebtor() & " by " & rsDIL![POA3]
Else
!signature3 = thirddebtor()
End If
End If

If fourthdebtor() <> "" Then
If rsDIL!Escrow = 1 And _
(Forms![foreclosure database screen]!dec4 = 1 Or _
Forms![foreclosure database screen]!dec4 = -1) And rsDIL!POA4 <> "" Then
!Signature4 = rsDIL![POA4]
ElseIf rsDIL![POA4] <> "" Or Not IsNull(rsDIL![POA4]) Then
!Signature4 = fourthdebtor() & " by " & rsDIL![POA4]
Else
!Signature4 = fourthdebtor()
End If
End If


If fifthdebtor() <> "" Then
If rsDIL!Escrow = 1 And _
(Forms![foreclosure database screen]!dec5 = 1 Or _
Forms![foreclosure database screen]!dec5 = -1) And rsDIL!POA5 <> "" Then
!Signature4 = rsDIL![POA5]
ElseIf rsDIL![POA5] <> "" Or Not IsNull(rsDIL![POA5]) Then
!Signatur5 = fifthdebtor() & " by " & rsDIL![POA5]
Else
!Signature5 = fifthdebtor()
End If
End If

End If

'AllBorrowersLtrAdd()

If VTypeMerge = "DILBorrowerLtr" Then
Dim VLtrDate As Date
Dim LtrDateInput

vltrdateinput = MsgBox("Enter Different Letter Date if not today", vbYesNo)
If vltrdateinput = vbYes Then

VLtrDate = InputBox("Enter Date 00/00/00")
Else
VLtrDate = Format(Date, "mmmm dd, yyyy")
End If

!AAddress = AllBorrowersLtrAdd()
!AAddress2 = AllBorrowersLtrAdd2()
!AAddress3 = AllBorrowersLtrCSZ()
!extralang1 = IIf(rsDIL![Escrow] = 3, POADebtorsSurviving(), debtorsDILEstate())
!extralang2 = IIf(rsDIL![Escrow] = 3, POADebtorsSurviving(), IIf(rsDIL![Escrow] = 1, POAList() & ", for " & debtorsDILEstate(), POA()))
!due_date = Format(rsDIL!DocsDueBy, "mmmm dd, yyyy")

If vltrdateinput = vbNo Then
!Letter_Date = Format(VLtrDate, "mmmm dd, yyyy")
Else
!Letter_Date = Format(Date, "mmmm dd, yyyy")
End If



Else

!Letter_Date = Format(Date, "mmmm dd, yyyy")


!AAddress = DILGrantee1()
!AAddress2 = DILGrantee2()
!AAddress3 = DILGrantee3()
!extralang1 = dilclause()

If VTypeMerge = "DILDeed" Then

'Ground Rent language
'MsgBox (Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent)

If Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent <> "" And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form!date_payable1 <> "" And _
Forms![foreclosure database screen]![ForeclosureSubForm].Form!date_payable2 <> "" Then
!extralang3 = "a leasehold interest"
!extralang4 = "SUBJECT TO the payment of an annual ground rent of " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent, "$###,##0.00") & ", payable semiannually on " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!date_payable1, "mmmm dd") & " and " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!date_payable2, "mmmm dd") & " of each year; and"

Else
!extralang3 = "in fee simple"
!extralang4 = ""
End If


'Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!grent, "$###,##0.00")


!extralang2 = DILDeedPara1()
!modification = DILTaxExempt()

ElseIf VTypeMerge = "DILSWDeed" Then
Dim vaadd
If Forms![foreclosure database screen]!TypeOfLoan = "VA" Then
vaadd = "SECRETARY OF VETERANS AFFAIRS, located at the Department of Veteran's Affairs Regional Office, Loan Guarantee Program, 210 Franklin Rd., SW, Roanoke, VA 24011,"
ElseIf Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Then
vaadd = "THE SECRETARY OF HOUSING AND URBAN DEVELOPMENT, an officer of the United States of America whose address is Department of Housing & Urban Development, Attn: Property Disposition/Acquisition, 820 First Street, NE, Washington, DC 20002,"
Else
vaadd = ""
End If

!extralang2 = vaadd

ElseIf VTypeMerge = "DILAgree" Then
!extralang2 = DILAgreePara1()
ElseIf VTypeMerge = "DILReleaseMdJr" Then
Dim VExec
VExec = InputBox("Executed By " & vbCr & "1-Org Lender" & vbCr & "2-MERS" & vbCr & "Type Name Here")
If VExec = 1 Then
!extralang2 = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
ElseIf VExec = 2 Then
Dim VNominee
VNominee = InputBox("Type in Nominee")
!extralang2 = "Mortgage Electronic Registration Systems, Inc. (" & """" & "MERS" & """" & ") as nominee for " & VNominee
Else
!extralang2 = VExec
End If
Else
!extralang2 = ""
End If

End If



rsDIL.Close



'Date/Year
!dateyear = "20__"

!SecuredParty = Forms![foreclosure database screen]!longsecured
!signatureblock = Forms![foreclosure database screen]![signature block]

!ClientState = "______________"
!clientcounty = "______________"

!deedmort = DML()


!Assignee = Assignee()

!taxid = Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid
!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!Book) Then
!DeedBook = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Liber
Else
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
End If
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!VAPage) Then
!VAPage = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Folio
Else
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
End If

!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!minno = Forms![foreclosure database screen]!Min
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
!upb = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![Principal Balance], "$###,##0.00")
If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
!rerecorded = "Re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If
!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])

If VTypeMerge = "DILReleaseMdJr" Then
Dim strsqlJr As String
Dim rsJr As RecordSet
Dim JrCt
JrCt = 0

strsqlJr = "Select * from DIL_Junior_Dot where filenum = " & Forms![foreclosure database screen]!filenum
Set rsJr = CurrentDb.OpenRecordset(strsqlJr, dbOpenSnapshot)

Do While Not rsJr.EOF
JrCt = JrCt + 1
rsJr.MoveNext
Loop

rsJr.Close

If JrCt > 1 Then
Dim JrID
JrID = InputBox("Enter Junior ID#")

strsqlJr = "Select * from DIL_Junior_Dot where filenum = " & Forms![foreclosure database screen]!filenum & _
 " and ID = " & JrID
Else
strsqlJr = "Select * from DIL_Junior_Dot where filenum = " & Forms![foreclosure database screen]!filenum
End If
 
Set rsJr = CurrentDb.OpenRecordset(strsqlJr, dbOpenSnapshot)
!liberfolio = "Liber " & Trim(rsJr!Liber) & ", Folio " & Trim(rsJr!Folio)
!DOTDate = Format(rsJr!Dot_Date, "mmmm dd, yyyy")
rsJr.Close

Else
!liberfolio = liberfolio()
!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")

End If

![firstdebtor] = firstdebtorDIL()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!CaseNo = Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo
!CountyState = CountyState()
!Property = PROP()
!Propertycounty = County()
!SaleHeld = rspropertycounty!SaleHeld

If VTypeMerge = "DILEst" Or VTypeMerge = "DILDeed" Then
!Borrowers = POADebtorsSurviving()
Else
!Borrowers = POA()
End If


!debtorsCAPS = debtorsCAPS()
!borrowersdns = debtorsOPENDNS()
!BorrowersOwners = debtorsforeOwners()
!BorrowersActiveMil = debtorsActiveMil()



If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
!iwe = "We"
!amare = "are"
!myour = "ourselves"
!iwe2 = "we"
Else
!iwe = "I"
!amare = "am"
!myour = "myself"
!iwe2 = "I"
End If

.Update
End With
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True


'DoCmd.RunMacro ("exportfcmerge")

End Function
Public Function WellsBwrAtty()
 

VTypeMerge = "WellsBwrAtty"
Call LtrMergeNoSignature

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\WellsBwrAtty.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function

Public Function TrusteesDeedCover()
 

VTypeMerge = "TrusteesDeedCover"
Call LtrMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\TrusteesDeedCoverLetter.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
oDoc.Close False
'oApp.ActiveDocument.SaveAs PathUSER() & dumpname
oapp.Visible = True
End With


End Function


Public Function ConfCover()
 

VTypeMerge = "ConfirmatoryCover"
Call LtrMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\ConfirmatorySOTCoverLetter.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
Public Function LtrMergeNoSignature()
 

CurrentDb.Execute "Delete * from ltrmerge;", dbFailOnError
DoCmd.OpenQuery ("lettermergeNoSignature")
'MsgBox (PathUSER())

'DoCmd.RunMacro ("exportfcmerge")
DoCmd.TransferText acExportDelim, , "ltrmerge", pathuser() & "ltrmerge.txt", True

End Function
Public Function LtrMerge()

CurrentDb.Execute "Delete * from ltrmerge;", dbFailOnError

If VTypeMerge = "AOMCoverVA" Or VTypeMerge = "SOTCoverVA" Then
DoCmd.OpenQuery ("LetterMergeAOMVa")
ElseIf VTypeMerge = "BWWRegConfirm" Then
DoCmd.OpenQuery ("lettermergeNOIConfirm")

ElseIf VTypeMerge = "ChampionFDL" Then
DoCmd.OpenQuery ("lettermergenodate")
Else
DoCmd.OpenQuery ("lettermerge")
End If

'MsgBox (PathUSER())

'DoCmd.RunMacro ("exportfcmerge")
DoCmd.TransferText acExportDelim, , "ltrmerge", pathuser() & "ltrmerge.txt", True


End Function
Public Function LtrMergeMH()


CurrentDb.Execute "Delete * from ltrmerge;", dbFailOnError
DoCmd.OpenQuery ("lettermergeMH")


DoCmd.TransferText acExportDelim, , "ltrmerge", pathuser() & "ltrmerge.txt", True

End Function

Public Function LtrMergeVAComm()


CurrentDb.Execute "Delete * from ltrmerge;", dbFailOnError
DoCmd.OpenQuery ("lettermergeVAComm")
'MsgBox (PathUSER())

'DoCmd.RunMacro ("exportfcmerge")
DoCmd.TransferText acExportDelim, , "ltrmerge", pathuser() & "ltrmerge.txt", True
End Function
Public Function LtrMergeHOA()
 
VTypeMerge = "LetterHOA"

CurrentDb.Execute "Delete * from ltrmerge;", dbFailOnError
DoCmd.OpenQuery ("lettermergeHOA")

Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("ltrmerge", dbOpenDynaset, dbSeeChanges)
With rs
.Edit
!Borrowers = debtorsFORE()
.Update
.Close
End With

DoCmd.TransferText acExportDelim, , "ltrmerge", pathuser() & "ltrmerge.txt", True

'---Letter HOA Merge
Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "DC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DC\DCCondoLetter.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\HOALetterPO.doc", , , True)
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "\ltrmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function FCDCMerge()
 

Dim rs As RecordSet

If VTypeMerge = "Complaintdc" Or VTypeMerge = "DCMotionDef" Then
CurrentDb.Execute "Delete * from complaintdcserve;", dbFailOnError

DoCmd.OpenQuery ("FCBasicMergeDCComplaintdc")
DoCmd.OpenQuery ("MergeComplaintdc")
DoCmd.OpenQuery ("MergeComplaintdcb")

DoCmd.OpenQuery ("FCBasicMergeDCComplaintSERVE")
Set rs = CurrentDb.OpenRecordset("ComplaintDCServe", dbOpenDynaset, dbSeeChanges)

ElseIf VTypeMerge = "auctiondcSetSale" Or VTypeMerge = "auctionDC" Then

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError

If VTypeMerge = "auctionDC" Then

DoCmd.OpenQuery ("FCDCBasicMergeAuction")
Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)

Else

DoCmd.OpenQuery ("FCDCBasicMergesetsale")

Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)

With rs
.Edit

If VTypeMerge = "AuctionDC" Then


If Forms!dcsetsales![2mortgage] = -1 Or _
Forms!dcsetsales![2mortgage] = 1 Then
!extralang1 = "Position you are selling from:  Second "
!extralang2 = "Date of 1st DOT " & Format(Forms!dcsetsales![1dotdate], "mmmm dd, yyyy") & " Date 1st DOT was recorded " & Format(Forms!dcsetsales![1dotrecorded], "mmmm dd, yyyy") & " Instrument No. " & Forms!dcsetsales![1instno]
Else
!extralang1 = "Position you are selling from:  First "
!extralang2 = ""
End If
End If
!SaleDate = Format(Forms!dcsetsales!SaleDate, "mmmm dd, yyyy")
!LegalDescription = Replace(Replace(Replace(!LegalDescription, Chr(147), """"), Chr(148), """"), Chr(146), "'")
.Update
End With
rs.Close
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True
Exit Function
End If

Else


CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("FcDCBasicMerge")
Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)
End If

Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet
Dim vAssignor
Dim rsClient As RecordSet
Dim strsqlClient As String
Dim strsqlLIEN As String
Dim rsLIENT As RecordSet
Dim legaldesc As String

GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
strsqlfc = "Select * from fctrackingDC where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)
strsqlClient = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)
strsqlLIEN = "select * from creditors where filenum = " & GblFilenum & ";"
Set rslien = CurrentDb.OpenRecordset(strsqlLIEN, dbOpenSnapshot)
Dim VDate

With rs
.Edit

If Forms![foreclosure database screen]!Client Like "Seter*" Then
!plaintiff = "Federal National Mortgage Association (Fannie Mae) c/o Seterus, Inc., its authorized subservicer"
ElseIf Forms![foreclosure database screen]!Client Like "Champio*" Then
!plaintiff = "Nationstar Mortgage LLC of Delaware d/b/a Champion Mortgage Company"
ElseIf (Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or Forms![foreclosure database screen]!TypeOfLoan = "FNMA") Then
!plaintiff = Client()
Else
'!plaintiff = SecuredParty()
!plaintiff = LSecured()
End If
If VTypeMerge = "SOTDC" Then
!employeesigns = empname()
!EmpEmail = EmpEmail()
!Purchaser = ""
Else
!Purchaser = Purchaser()
End If



Dim todayth, dayeff As String

todayth = Date

If todayth = 1 Or todayth = 21 Or todayth = 31 Then
dayeff = "st"
ElseIf todayth = 2 Or todayth = 22 Then
dayeff = "nd"
ElseIf todayth = 3 Or todayth = 23 Then
dayeff = "rd"
Else
dayeff = "th"
End If
!dayth = Format(Date, "dd") & dayeff
!servicer = servicer()

!summonsissued = rsFC!summons_issued
!summonsdue = rsFC!Summons_Due
!FirstLegal = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Approx_1st
!PropertyState = Forms![foreclosure database screen]!PropertyState
!party1stpart = DOASecParty()
'!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])
!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!liberfolio = liberfolio()
'!modification = Trim(modification())
![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!longsecured = LSecured()
!goodthru = Format(rsFC!payoff_goodthru, "mmmm dd, yyyy")

!InitialConfHrg = rsFC!Conf_date
!mjd_granted = rsFC!mjd_granted
!dotrecorded = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded], "mmmm dd, yyyy")


!signatureblock = Forms![foreclosure database screen]![signature block]
!deedmort = DML()
!Attorney = Part1Trustees()
!signatureline = PartOneSignatureAff1()
!signatureline2 = PartOneSignatureAff2()

If Forms![foreclosure database screen]!Client Like "Wells*" Then

!taxid = Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!lot & "/" & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!square
Else
!taxid = "Lot: " & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!lot & "/ Square: " & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!square

End If
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
!resume_recd = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
!Property = PROP()
!Propertycounty = County()
'!SaleHeld = rspropertycounty!SaleHeld
!Borrowers = debtorsFORE()
'!debtorsCAPS = debtorsCAPS()
!borrowersdns = debtorsOPENDNS()
!BorrowersOwners = debtorsforeOwners()
!BorrowersActiveMil = debtorsActiveMil()
!SaleTime = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime, "hh:mm am/pm")
!SaleDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "mmmm dd, yyyy")
!Letter_Date = Format(Date, "mmmm dd, yyyy")
!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!minno = Forms![foreclosure database screen]!Min
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
!CaseNo = Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo
!CountyState = CountyState()
!mjdgranted = Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!mjd_granted
!Part2filed = Forms![foreclosure database screen]!PostsaleSubForm.Form!Part2filed
!dc_ord_rat = Forms![foreclosure database screen]!PostsaleDCSubForm.Form!dc_orderRat
!dc_ord_rat_inst = Forms![foreclosure database screen]!PostsaleDCSubForm.Form!dc_ord_rat_inst

'Part2filed
legaldesc = Replace(Nz(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription, ""), Chr(148), """")
legaldesc = Replace(Replace(legaldesc, Chr(146), "'"), Chr(147), """")
'need code for handling quotation marks
!LegalDescription = legaldesc


If Not rslien.EOF Then
'!lienholders = ""

Do While Not rslien.EOF
!lienholders = rslien!OrganizationName & ", " + !lienholders
rslien.MoveNext
Loop
End If
rslien.Close

!stateresident = Forms![foreclosure database screen]!PropertyState
If Not IsNull(Forms![foreclosure database screen]![Mailing State]) Then
If Forms![foreclosure database screen]![Mailing State] = Forms![foreclosure database screen]!PropertyState Then
Else
!stateresident = !stateresident + ", " & Forms![foreclosure database screen]![Mailing State]
End If
End If



If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
!SecuredParty = ""
Else

If VTypeMerge = "ComplaintDC" Then
If Forms![foreclosure database screen]!Client Like "Shellpoint*" Then
!SecuredParty = "c/o " & "New Penn Financial, LLC d/b/a Shellpoint Mortgage Servicing"
Else
!SecuredParty = "c/o " & Client()
End If
End If

!SecuredParty = "c/o " & Client()
End If

'Date/Year
!dateyear = Format(Date, "yyyy")

!datemonth = Format(Date, "mmmm")

If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
!iwe = Trim("Defendants")
!amare = "are"
!myour = "residents"
!iwe2 = "we"
!borown = "owners"
Else
!iwe = Trim("Defendant")
!amare = "is"
!myour = "resident"
!iwe2 = "I"
!borown = "owners"
End If

If Forms![foreclosure database screen]!Client Like "Seter*" Then
!caption1 = "Federal National Mortgage Association"
!caption2 = "c/o " & Client()
Else

If [Forms]![foreclosure database screen]![SPsameasCl] = -1 Or _
[Forms]![foreclosure database screen]![SPsigns] = -1 Or _
[Forms]![foreclosure database screen]![SPsameasCl] = 1 Or _
[Forms]![foreclosure database screen]![SPsigns] = 1 Then
!caption1 = UCase(LSecured())
!caption2 = ""
Else
If LSecured() Like "Federal National Mortgage*" Then
!caption1 = Client()
Else
!caption1 = UCase(LSecured())

If Forms![foreclosure database screen]!Client Like "Shellpoint*" Then
!caption2 = "c/o " & "New Penn Financial, LLC d/b/a Shellpoint Mortgage Servicing"
Else
!caption2 = "c/o " & Client()
End If

End If

End If

End If





If VTypeMerge = "ComplaintDC" Or VTypeMerge = "DCMotionDef" Then



'Paragraph Payoff
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Then
!complaintpayoff = "the good through date of the attached payoff quote, " & debtorsOPENDNS() & " owe(s) " & Format(Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!payoff_amt, "$###,##0.00") & " to Plaintiff under the Note, exclusive of any costs or fees incurred herein.  See payoff attached hereto as Exhibit E."
ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Or Forms![foreclosure database screen]!Client Like "Specializ*" Then
!complaintpayoff = debtorsOPENDNS() & " owe(s) " & Format(Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!payoff_amt, "$###,##0.00") & " to Plaintiff under the Note, exclusive of any costs or fees incurred herein.  See judgment figures attached hereto as Exhibit E."
ElseIf Forms![foreclosure database screen]!Client Like "Champ*" Then
!complaintpayoff = debtorsOPENDNS() & " owe(s) up to " & Format(Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!payoff_amt, "$###,##0.00") & " to Plaintiff under the Note, exclusive of any costs or fees incurred herein.  See payoff attached hereto as Exhibit E."
Else
!complaintpayoff = debtorsOPENDNS() & " owe(s) " & Format(Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!payoff_amt, "$###,##0.00") & " to Plaintiff under the Note, exclusive of any costs or fees incurred herein.  See payoff attached hereto as Exhibit E."
End If

'Paragraph 11

If Forms![foreclosure database screen]!Client Like "Champio*" Then

If Not IsNull(!complaintpara11) And !complaintpara11 <> "" Then
If !complaintpara11 Like "Deat*" Then
!complaintpara11 = "Upon Defendants death on " & rsFC!default_date & ", " & !iwe & " defaulted under the terms of the Note and Deed of Trust."
ElseIf !complaintpara11 Like "Move*" Then
!complaintpara11 = "On or about " & rsFC!default_date & ", upon Defendants failure to maintain residence in the Property, Defendant defaulted under the terms of the Note and Deed of Trust."
ElseIf !complaintpara11 Like "Tax*" Then
!complaintpara11 = "On or about " & rsFC!default_date & ", upon Defendants failure to pay existing taxes and/or insurance payments, Defendant defaulted under the terms of the Note and Deed of Trust."
ElseIf !complaintpara11 Like "Repai*" Then
!complaintpara11 = "On or about " & rsFC!default_date & ", upon Defendants failure to make necessary repairs to the Property, Defendant defaulted under the terms of the Note and Deed of Trust."
End If
Else
!complaintpara11 = "On or about " & rsFC!default_date & ", " & !iwe & " defaulted under the terms of the Note and Deed of Trust by failing to make the required monthly payments."
End If

Else
!complaintpara11 = "On or about " & rsFC!default_date & ", " & !iwe & " defaulted under the terms of the Note and Deed of Trust by failing to make the required monthly payments."
End If


If (Forms![foreclosure database screen]!ForeclosureSubForm.Form!title_button = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!title_button = 1) Then

!IRS1 = "Serve: United States of America"
!IRS2 = "c/o Channing D. Phillips"
!IRS3 = "United States Attorney for the District of Columbia"
!IRS4 = "555 4th Street, NW"
!IRS5 = "Washington, DC 20530"

!IRS6 = "Serve By Certified mail:"
!IRS7 = "United States of America"
!IRS8 = "c/o Attorney General of the United States "
!IRS9 = "U.S Department of Justice"
!IRS10 = "950 Pennsylvania Avenue, NW"
!IRS11 = "Washington, DC 20530-0001"

!extralang1 = "Defendant United States of America is named as a party to this lawsuit under 28 USC  2410, as this action involves a lien or liens arising under the internal revenue laws, which are more particularly identified below:"
!extralang2 = "Name and address of taxpayer(s) whose liability created the lien: "
!extralang3 = "Identity of internal revenue office(s) which filed the notice(s) of lien: Small Business/Self Employed Area #3"
!extralang4 = "Date notice(s) of lien filed:"
!extralang5 = "Place(s) IRS lien filed: Office of Recorder of Deeds for Washington, DC"
!extralang6 = "Order that the liens on the Property in favor of the United States of America and/or the Internal Revenue Service are discharged under 28 USC  2410."

Else

!IRS1 = ""
!IRS2 = ""
!IRS3 = ""
!IRS4 = ""
!IRS5 = ""

!IRS6 = ""
!IRS7 = ""
!IRS8 = ""
!IRS9 = ""
!IRS10 = ""
!IRS11 = ""
!extralang1 = ""
!extralang1 = ""
!extralang3 = ""
!extralang4 = ""
!extralang5 = ""
End If
End If

If VTypeMerge = "ComplaintDC" Then
Else
If Forms![foreclosure database screen]!Client Like "Ocwen*" And _
(Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1) And _
(Forms![foreclosure database screen]!HomewardOcwen = 0 Or IsNull(Forms![foreclosure database screen]!HomewardOcwen)) Then
!extralang1 = "Mortgage Electronic Registration Systems, Inc."
End If
End If


If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!Book) Then
!DeedBook = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Liber
Else
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
End If
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!VAPage) Then
!VAPage = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Folio
Else
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
End If

If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
!rerecorded = "Re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
!rerecorded = "Re-recorded as Instrument # " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
!rerecorded = "Re-recorded as Instrument # " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If

If Not IsNull(Forms![foreclosure database screen]![resume_recd]) Then
!Referral_Date = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
Else
!Referral_Date = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd"", ""yyyy")
End If

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!clientwff = "Wells Fargo Financial Maryland, Inc."
ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Then
!clientwff = "Wells Fargo Bank, NA"
Else
!clientwff = Forms![foreclosure database screen]!Client
End If

If Client() Like "Suntrust M*" And Forms![foreclosure database screen]!longsecured = "Suntrust Bank" Then
!sotclient = "Suntrust Bank"

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then

If (Forms![foreclosure database screen]!SPsameasCl = 0 Or _
IsNull(Forms![foreclosure database screen]!SPsameasCl)) Then
!sotclient = !clientwff & " as servicer for " & LSecured()
Else
!sotclient = !clientwff
End If

ElseIf Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then

!sotclient = LSecured()

If Forms![foreclosure database screen]!Client Like "ocwen*" Then !sotclient = !clientwff & _
    " as servicer for " & LSecured()
    
ElseIf Client() Like "specia*" Or Client() Like "Seter*" Then
!sotclient = SignsSP()

ElseIf Not IsNull(Forms![foreclosure database screen]!servicer) Then
!sotclient = Forms![foreclosure database screen]!servicer

Else
!sotclient = Client()
End If

!servicer_address = servicer_addMerge

.Update
End With


rsFC.Close
rs.Close

'---new function created _
    does the same thing as below.  use this code: _
    exportfcmerge "fcmerge","fcmerge"
    
    
If VTypeMerge = "ComplaintDC" Or VTypeMerge = "DCMotionDef" Then
DoCmd.TransferText acExportDelim, , "ComplaintDCServe", pathuser() & "fcmerge.txt", True

Else
DoCmd.TransferText acExportDelim, , "fcmerge", pathuser() & "fcmerge.txt", True

End If



End Function
Public Function FCMergeVaSales()
 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("FCBasicMergeMinVaSales")


Dim rs As RecordSet
Set rs = CurrentDb.OpenRecordset("fcmerge", dbOpenDynaset, dbSeeChanges)


With rs
.Edit
!liberfolio = liberfolioVA()
!modification = Trim(ModificationSALES())
!Property = propVA()
.Update
End With
rs.Close

DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True




End Function


Public Function FCMergePS()

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("fcbasicmergePS")

GblFilenum = Forms![foreclosure database screen]![filenum]


Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet
Dim vAssignor
Dim rsClient As RecordSet
Dim strsqlClient As String
Dim rsVAcct As RecordSet
Dim rsqc As RecordSet
Dim strsqlqc As String
Dim legaldesc As String


Set rs = CurrentDb.OpenRecordset("FCMergePS", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)
strsqlClient = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

Dim VDate

With rs
.Edit
If VTypeMerge = "BondMerge" Then
If Forms![foreclosure database screen]!PostsaleSubForm.Form![bondamt] > 0 Or IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![bondamt]) Then
!bondamt = "$0.00"
MsgBox ("There is no Bond Amount input")

Else
!bondamt = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![bondamt], "$###,##0.00")
End If
End If

!LastNameDebtor1 = Forms![foreclosure database screen]!LastNameDebtor1
!bondno = Forms![foreclosure database screen]!PostsaleSubForm.Form![BondNumber]

If VTypeMerge = "BondMerge" Then
If Forms![foreclosure database screen]!PostsaleSubForm.Form![bondamt] > 0 Or IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![bondamt]) Then
!bondamt = "$0.00"
MsgBox ("There is no Bond Amount input")
Else
!englishloan = English(Forms![foreclosure database screen]![PostsaleSubForm].Form![bondamt])
End If
Else
If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount] > 0 Then
!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])
End If
End If


!borrowerscaps = debtorsCAPS()


!employeesigns = GetEmployee()
!servicer = servicer()

If VTypeMerge = "interp" Then
Dim VrecinfoVA

strsqlVAcct = "select * from virginiaaccounting where subfilenum = " & GblFilenum
Set rsVAcct = CurrentDb.OpenRecordset("strsqlVacct", dbOpenSnapshot)

If rsVAcct.EOF Then
rsVAcct.Close

Else

!sot_Date = rsVAcct!doadate
!sot_recorded = rsVAcct!doarec

If rsVAcct!doainst <> "" Then
VrecinfoVA = "Instrument No. " & rsVAcct!doainst
ElseIf rsVAcct!DeedBook <> "" Then
VrecinfoVA = "Deed Book " & rsVAcct!DeedBook & ", Page " & rsVAcct!deedpage
End If

!sot_recording_info = VrecinfoVA
rsVAcct.Close

End If

End If

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice]) Then
!SalePrice = "___________________"
Else
!SalePrice = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice], "$###,##0.00")
End If

!deed_prepared = Forms![foreclosure database screen]!PostsaleSubForm.Form!dprepared_by_date

!FirstLegal = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Approx_1st
!PropertyState = Forms![foreclosure database screen]!PropertyState

!mil_start = ""

If Not IsNull(Forms![foreclosure database screen]!AD_Start) Then
!mil_start = Forms![foreclosure database screen]!AD_Start & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start2) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start2 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_Start3) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_Start3 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start4) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start5 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start5) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start5 & " "
End If

If !mil_start = "" Then
!mil_start = "________________________________________"
End If


If Forms![foreclosure database screen]!Client Like "Seter*" Then
If rsFC!noi_4s = -1 Or rsFC!noi_4s = 1 Then
!Set4s = "Since you have received a non-recourse assumption, you will not be personally responsible for the debt. However, the lien against the property securing this debt may remain on the property until the amount owing on the loan is paid."
End If
If rsFC!noi_bc = -1 Or rsFC!noi_bc = 1 Then

!setbc = "This notice of our intent to foreclose has no effect on your right to dispute the debt in writing as indicated in the debt validation letter we sent to you on __________________.  The Fair Debt Collection Practices Act does not require us to wait until the end of the 30-day validation period before attempting to collect this debt. If, however, you request proof of the debt or the name and address of the original creditor within the 30-day period upon your receipt of the debt validation letter, the law requires us to suspend our efforts to collect the debt until we mail the requested information to you."

End If


End If

If VTypeMerge = "AdVAMerge" Or VTypeMerge = "VirginiaAss" Then
!Attorney = ""
Else
!Attorney = Part1Trustees()
End If

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!clientwff = "Wells Fargo Financial Maryland, Inc."
ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Then
!clientwff = "Wells Fargo Bank, NA"
Else
!clientwff = Forms![foreclosure database screen]!Client
End If

If Client() Like "Suntrust M*" And Forms![foreclosure database screen]!longsecured = "Suntrust Bank" Then
!sotclient = "Suntrust Bank"

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then

If (Forms![foreclosure database screen]!SPsameasCl = 0 Or _
IsNull(Forms![foreclosure database screen]!SPsameasCl)) Then
!sotclient = !clientwff & " as servicing agent for " & LSecured()
Else
!sotclient = !clientwff
End If

ElseIf Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then

!sotclient = LSecured()

If Forms![foreclosure database screen]!Client Like "ocwen*" Then !sotclient = !clientwff & _
    " as servicing agent for " & LSecured()
    
ElseIf Client() Like "specia*" Or Client() Like "Seter*" Then
!sotclient = SignsSP()

ElseIf Not IsNull(Forms![foreclosure database screen]!servicer) Then
!sotclient = Forms![foreclosure database screen]!servicer

Else
!sotclient = Client()
End If

!Assignor = "Mortgage Electronic Registration Systems, Inc. (" & """" & "MERS" & """" & ") as nominee for " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgLender]

!Assignee = IIf([Forms]![foreclosure database screen]![TypeOfLoan] = "FNMA" And [Forms]![foreclosure database screen]![PropertyState] = "MD", "Federal National Mortgage Association", IIf([Forms]![foreclosure database screen]![TypeOfLoan] = "FHLMC" And [Forms]![foreclosure database screen]![PropertyState] = "MD", "Federal  Home Loan Mortgage Corporation", [Forms]![foreclosure database screen]![longsecured])) & ", (" & """" & "Assignee" & """" & "), whose address is, c/o " & rsClient![OrganizationName] & ", " & IIf(Client() = "American Home Mortgage Servicing, Inc.", "1525 S. Belt Line Road, Coppell, TX 75019", rsClient![Address] & ", " & rsClient![City] & ", " & rsClient![cl_state] & "  " & rsClient![PostalCode])
rsClient.Close

', all its beneficial interest, if any, in and to the below described Deed of Trust.", ", all its beneficial interest in and to the below described Deed of Trust.")

If VTypeMerge Like "Aff*" Then
!AffDef = "I hereby certify and affirm that, " & IIf(rsFC![Occupied] <> 1 Or IsNull(rsFC!Occupied), "in compliance with Real Property 7-105.1(c)(6), said notice was accompanied by a Notice Regarding Occupancy Determination and contained a telephone number to call to dispute the occupancy determination.  ", "in compliance with Real Property  7-105.1(c)(5), said notice was accompanied by a loss mitigation application and all required documents and addressed envelopes. ")
Else
!AffDef = ""
End If

If VTypeMerge = "MilAff" Or VTypeMerge = "BondMerge" Or VTypeMerge = "CitiSaleCan" Or VTypeMerge = "ComplaintDC" Or _
VTypeMerge = "DCMotionDism" Or VTypeMerge = "INTERP" Or VTypeMerge = "milAffcheck" Or _
VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "DCAss" Or _
VTypeMerge = "AffCertOwn" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "Coop" Or VTypeMerge = "CitiAntVA" Then
Else
!due_date = NOIDueDate()
!datedefault = NOIDefDate()

If Forms![foreclosure database screen]!Client Like "Wells*" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noi_sent] < #1/15/2011# Then
!affdefpara = "mailed regular mail"
Else
!affdefpara = "electronically sent"
End If
Else
!affdefpara = AffDefPara2()
End If

End If

If Forms![foreclosure database screen]!Asc_wff = 4 Or Forms![foreclosure database screen]!Asc_wff = 5 Then

If rsFC!reason_default Like "Death*" Then
!aff_def_para4 = "the nature of default is death."
ElseIf rsFC!reason_default Like "Move Out*" Then
!aff_def_para4 = "the nature of the default is property no longer owner occupied."
ElseIf IsNull(rsFC!reason_default) Then
!aff_def_para4 = "the nature of default is the failure to tender payments."
Else
!aff_def_para4 = rsFC!reason_default & "."
End If

Else
'!aff_def_para4 = "is the failure to tender the payment due on " & NOIDueDate()
!aff_def_para4 = "the nature of default is the failure to tender payments."

End If

'and that the nature of default is the failure to tender payments


!party1stpart = DOASecParty()


Dim EL1, EL2

'----From Aff Cert
Dim OwnRecord

If Client() Like "Bayv*" Then
OwnRecord = "record owner"
Else
OwnRecord = "owner"
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then


If Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then
!AffCert = ", that Federal National Mortgage Corporation is the owner of the loan evidenced by the Note, and that Federal National Mortgage Corporation has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure action."
'!AffCert = "of the loan evidenced by the note, and that they, " & LSecured() & " has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure action."
Else
!AffCert = ", that " & LSecured() & " is the owner and holder of the loan evidenced by the note."
End If

'CITICode

ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then

If Forms![foreclosure database screen]![SPsameasCl] = 0 Or IsNull(Forms![foreclosure database screen]![SPsameasCl]) And _
(Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA") Then
!AffCert = "Bank of America, N.A., who services the loan which is the subject of this proceeding"
Else
!AffCert = "Bank of America, N.A., as an officer of BANA"
End If



ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then

If LSecured() Like "Citifin*" Or LSecured() Like "One*" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.  Pursuant to an agreement, CitiMortgage, Inc. provides certain loan servicing activities to " & [Forms]![foreclosure database screen]![servicer] & _
" the servicer of  the  loan evidenced by the Note.  I am authorized to execute this affidavit on behalf of " _
& [Forms]![foreclosure database screen]![servicer] & " pursuant to the corporate resolutions of " & [Forms]![foreclosure database screen]![servicer] & _
".  In my capacity as a  Vice President - Document Control,  I hereby certify in compliance with  7-105.1(D)(2)(III)  that " & LSecured() & " is the owner of the Note and that the copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
!AffCert = "          I am employed by CitiMortgage Inc. as a Vice President - Document Control.   In that capacity, I HEREBY CERTIFY in compliance with  7-105.1(D)(2)(111)  that Federal National Mortgage Association is the owner of the loan that is the subject of this foreclosure action  (the Loan).  CitiMortgage Inc. is the servicer of the Loan.  The copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.   In that capacity, I HEREBY CERTIFY in compliance with  7-105.1(D)(2)(III)  that Federal Home Loan Mortgage Corporation is the owner of the loan that is the subject of this foreclosure action  (the Loan).  CitiMortgage, Inc. is the servicer of the Loan.  The copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.  In that capacity, I hereby certify in compliance with  7-105.1(D)(2)(III)  that " & LSecured() & " is the owner of the Note and has authorized CitiMortgage, Inc. to be the holder of the Note for purposes of executing this affidavit and conducting this foreclosure action and that the copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."

End If
'CitiCode

ElseIf (Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or Forms![foreclosure database screen]![SPsigns] = -1) And _
(Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And _
Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA" And _
Forms![foreclosure database screen]![TypeOfLoan] <> "GNMA") Then
EL1 = LSecured() & " is the " & OwnRecord & "of the Note and that the copy of the Note attached hereto is a true and accurate copy of the original debt instrument."
Else
EL1 = IIf(Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Or Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC", LoanInvestor(), LSecured()) & " is the owner of the Note and that " & IIf(Client() Like "Dov*" And (Forms![foreclosure database screen]![SPsigns] = -1 Or Forms![foreclosure database screen]![SPsigns] = 1), "", servicer() & " is servicer for said owner and that") & " the copy of the Note attached hereto is a true and accurate copy of the original debt instrument."

'----

!AffCert = "          I HEREBY CERTIFY that " & EL1

End If


'FCTracking for Final LMA
If Not rsFC.EOF Then

!PreFiled = rsFC!pre_docket_filed
!FLMA_Filed = rsFC!final_LMA_filed

End If

'Date/Year
!dateyear = "20__"
If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
!iwe = "We"
!amare = "are"
!myour = "ourselves"
!iwe2 = "we"
Else
!iwe = "I"
!amare = "am"
!myour = "myself"
!iwe2 = "I"
End If
 
If VTypeMerge = "DCMotionDism" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "milAffcheck" Or VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "DCAss" Or VTypeMerge = "Interp" Then

Else
If Forms![foreclosure database screen]!PropertyState = "MD" Then
!caption1 = attorneycap() & ", et al"
Else

Dim rsAtt As RecordSet
Set rsAtt = CurrentDb.OpenRecordset("attorneys", dbOpenSnapshot)

If attorneycap() Like "*Ward" Then
!caption1 = rsAtt!Attorney7
!caption2 = rsAtt!Attorney1
!Caption3 = rsAtt!Attorney2
!Caption4 = trusteenoncooper()
!Caption5 = ""
ElseIf attorneycap() Like "*Geesing" Then
!caption1 = rsAtt!Attorney2
!caption2 = rsAtt!Attorney7
!Caption3 = rsAtt!Attorney1
!Caption4 = trusteenoncooper()
!Caption5 = ""
ElseIf attorneycap() Like "*Bierman" Then
!caption1 = rsAtt!Attorney1
!caption2 = rsAtt!Attorney2
!Caption3 = rsAtt!Attorney7
!Caption4 = trusteenoncooper()
!Caption5 = ""
End If
rsAtt.Close
End If
End If

'Start DOA Code
If VTypeMerge = "AffsALL" Or VTypeMerge = "AffsAllWells" Then
Dim VWit2
Dim VWit3
Dim VDateYr
VDateYr = "20__"

If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then
VWit2 = " by its duly authorized agent on ______ day of _____________, " & VDateYr
ElseIf Client() Like "HomEq*" Then
VWit2 = ", by Assistant Secretary of " & Forms![foreclosure database screen]![signature block] & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "Wells*" Then
VWit2 = ", by the authorized agent of " & Client() & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "One*" Then
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, ______"
Else
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, " & VDateYr
End If

!inwitness = IIf(Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC", _
IIf(Client() Like "Seteru*", LoanInvestor(), Client() & ""), _
IIf((Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Or _
Forms![foreclosure database screen]![SPsigns] = 1), LSecured(), Client())) & _
" has caused this Appointment of Substitute Trustee to be executed " & VWit2 & "."



!SecuredParty = Forms![foreclosure database screen]!longsecured
!AffDefPara1 = AffDefPara1()
!signatureblock = Forms![foreclosure database screen]![signature block]


!signatureline = PartOneSignature3()


!Title = PartOneSignature4()

!ClientState = "______________"
!clientcounty = "______________"

Dim VNotary1, VNotary2, VNotary3
If Client() Like "Seter*" Then
!Notary = "______________________________, authorized agent of " & Client() & ", as attorney-in-fact for Fannie Mae (" & """" & "Federal National Mortgage Association" & """" & "), personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
!Notary = "___________________ of " & servicer() & ", authorized servicer for " & LoanInvestor() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Client() Like "HomEq*" Or Client() Like "Wells*" Then
!Notary = DOANotaryHomEq()
ElseIf Client() Like "Ocwen*" Then
!Notary = DOANotaryOcwen()
ElseIf Client() Like "MGC*" Then
!Notary = PartOneDOA1() & ", " & PartOneDOA2() & " "
Else
If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary1 = " by "
Else
VNotary1 = " agent of "
End If
If Client() Like "JP*" Or _
(Client() Like "Ocwen*" And _
(Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]))) Then
If Forms![foreclosure database screen]![signature block] Like "*Attorney-in*" Then
VNotary2 = "as Attorney-in-Fact for " & LSecured()
Else
VNotary2 = "Authorized Servicer for " & LSecured()
End If
ElseIf Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary2 = LSecured()
Else
VNotary2 = servicer()
End If
VNotary3 = ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
!Notary = "_______________________________" & ", authorized" & VNotary1 & VNotary2 & VNotary3

End If
End If
'END OF DOA CODE

!deedmort = DML()

If Forms![foreclosure database screen]!PropertyState <> "MD" Then
!signature = PartOneSignature1()
!Signature2 = PartOneSignature2()
Else
!Signature2 = ""

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!signaturewff = "Wells Fargo Financial Maryland, Inc."
!signaturerm = "Wells Fargo Bank, NA., as servicer for Wells Fargo Financial Maryland, Inc."
ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Or Forms![foreclosure database screen]!TypeOfLoan Like "FHLM*" Then
!signaturewff = "Wells Fargo Bank, NA"
!signaturerm = "Wells Fargo Bank, NA"
Else
!signaturewff = PartOneSignatureAff1()
!signaturerm = PartOneSignatureAff1()
End If


!signature = PartOneSignatureAff1()
End If


!pastdue = rsFC!past_due_no



!Assignee = Assignee()

!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!Book) Then
!DeedBook = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Liber
Else
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
End If

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!VAPage) Then
!VAPage = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Folio
Else
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
End If

!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!minno = Forms![foreclosure database screen]!Min
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then

If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
!rerecorded = "Re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If



'FC Tracking for Final LMA

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!liberfolio = liberfolio()
!modification = Trim(modification())

![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!longsecured = LSecured()
If attorneysigns2() <> "" Then
!attorneysigns = attorneysigns() & ", " & attorneysigns2() & " and " & rs![Attorneys Company Name]
Else
!attorneysigns = attorneysigns() & " and " & rs![Attorneys Company Name]
End If
!CaseNo = Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo
!CountyState = CountyState()
If Not IsNull(Forms![foreclosure database screen]![resume_recd]) Then
!Referral_Date = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
Else
!Referral_Date = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd"", ""yyyy")
End If

!resume_recd = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
If VTypeMerge = "AdVAMerge" Or VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "Interp" Or VTypeMerge = "milAffcheck" Or VTypeMerge = "DCMotionDism" Then
Else
!AttorneyCAPDOA = Part1Trustees()
!attorneycap = attorneycap()
End If

!Property = PROP()
!Propertycounty = County()
!SaleHeld = rspropertycounty!SaleHeld
!CourtAddress = rspropertycounty!CourtAddress
!courtcsz = rspropertycounty!CourtCity & ", " & rspropertycounty!State & "  " & rspropertycounty!CourtZip
!CourtName = "Circuit Court for " & County()

!attorneysigns1 = attorneysigns()
!attorneysigns2 = attorneysigns2()
!attorneybar = attorneybar()
!attorneybar2 = attorneybar2()
!Borrowers = debtorsFORE()
!debtorsCAPS = debtorsCAPS()
!borrowersdns = debtorsOPENDNS()
!BorrowersOwners = debtorsforeOwners()
!BorrowersActiveMil = debtorsActiveMil()

If VTypeMerge = "GOVT" Or VTypeMerge = "AssReq" Or VTypeMerge = "CitiAss" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "InterP" Or VTypeMerge = "DCMotionDism" Or VTypeMerge = "DCMotionDism" Then
legaldesc = Replace(Nz(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription, ""), Chr(148), """")
legaldesc = Replace(Replace(legaldesc, Chr(146), "'"), Chr(147), """")
!LegalDescription = legaldesc
Else
!LegalDescription = ""
End If


!SaleTime = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime, "h:mm am/pm")
!SaleDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "mmmm dd, yyyy")
If Forms![foreclosure database screen]!PropertyState = "VA" And VTypeMerge = "AffDebtBlank" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
' !upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note], "$###,##0.00")
Else
Dim rsBD As RecordSet
Dim strsqlBD As String
strsqlBD = "SELECT ([principal balance]+[interest amt]+[late charge]+[lender advance]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism6]+[mism7]+[mism8]+[mism9]+[rec_bal]+[mism10]+[mism11]) AS BALDue, AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
Set rsBD = CurrentDb.OpenRecordset(strsqlBD, dbOpenSnapshot)
Dim VAffDebtBd
If Not rsBD.EOF Then
VAffDebtBd = Format(rsBD!BalDue, "$###,##0.00")
Else
VAffDebtBd = 0
End If
!upb = VAffDebtBd
End If

!paidonprin = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount] - Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")

If VTypeMerge = "SeterusPDF" Or VTypeMerge = "Seterus" Or VTypeMerge = "Seneca" Or VTypeMerge = "GreenPlanet" Then
!Letter_Date = Format(Forms![NOI Information Screen]!NOITabs.Form!noi_prepared, "mmmm dd, yyyy")
Else
!Letter_Date = Format(Date, "mmmm dd, yyyy")
End If

!deposit = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit] - 2500, "$###,##0.00")


If VTypeMerge <> "Seterus" And VTypeMerge <> "DILScra" And VTypeMerge <> "Chronology" Then

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!FeesCosts = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd"", ""yyyy")

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then

If VTypeMerge <> "AffDefault" And VTypeMerge <> "DOA" And VTypeMerge <> "PLMA" And VTypeMerge <> "FLMA" And VTypeMerge <> "AffCertOwn" Then

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![good thru date]) Then
!FeesCosts = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![good thru date], "mmmm dd"", ""yyyy")
VDate = InputBox("Fees and Costs As of Date")
!FeesCosts = Format(VDate, "mmmm dd"", ""yyyy")
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Not IsNull([Forms]![foreclosure database screen]![affdavitdebtfc].[Form]![interest thru]) Then
!FeesCosts = Format([Forms]![foreclosure database screen]![affdavitdebtfc].[Form]![interest thru], "mmmm dd, yyyy")
Else
VDate = InputBox("Fees and Costs As of Date")
!FeesCosts = Format(VDate, "mmmm dd"", ""yyyy")
End If
End If
End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then
!govtsent = "A deposit of ten percent (10%) of the sale price in the form of cash or certified funds with balance of the purchase price to be paid in cash within fifteen (15) days of sale"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!govtsent = "A deposit of " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit], "$###,##0.00") & " in the form of cash or certified funds with balance of the purchase price to be paid in cash within thirty (30) days of sale"
Else
!govtsent = "A deposit of " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit], "$###,##0.00") & " in the form of cash or certified funds with balance of the purchase price to be paid in cash within ten (10) days of sale"
End If

End If

If VTypeMerge = "ASSREQ" Then
!Client = servicerVA()
End If

.Update
End With
rsFC.Close
rs.Close


'If FileOrDirExists(PathUSER & "\fcmerge.txt") Then Kill (PathUSER & "\fcmerge.txt")

DoCmd.TransferText acExportDelim, , "Fcmergeps", pathuser() & "fcmerge.txt", True



End Function



Public Function FCMerge()

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("fcbasicmerge")

GblFilenum = Forms![foreclosure database screen]![filenum]

If VTypeMerge = "Coop" Then
DoCmd.OpenQuery ("MergeCoop")
End If

Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim strsqlfc As String
Dim rsFC As RecordSet
Dim vAssignor
Dim rsClient As RecordSet
Dim strsqlClient As String
Dim rsVAcct As RecordSet
Dim rsqc As RecordSet
Dim strsqlqc As String
Dim legaldesc As String


Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)
strsqlClient = "Select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

Dim VDate

With rs
.Edit



If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount]) Or _
Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount] > 0 Then
!englishloan = English(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount])
End If


!borrowerscaps = debtorsCAPS()


!employeesigns = GetEmployee()
!servicer = servicer()

If VTypeMerge = "interp" Then
Dim VrecinfoVA

strsqlVAcct = "select * from virginiaaccounting where subfilenum = " & GblFilenum
Set rsVAcct = CurrentDb.OpenRecordset("strsqlVacct", dbOpenSnapshot)

If rsVAcct.EOF Then
rsVAcct.Close

Else

!sot_Date = rsVAcct!doadate
!sot_recorded = rsVAcct!doarec

If rsVAcct!doainst <> "" Then
VrecinfoVA = "Instrument No. " & rsVAcct!doainst
ElseIf rsVAcct!DeedBook <> "" Then
VrecinfoVA = "Deed Book " & rsVAcct!DeedBook & ", Page " & rsVAcct!deedpage
End If

!sot_recording_info = VrecinfoVA
rsVAcct.Close

End If

End If

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice]) Then
!SalePrice = "___________________"
Else
!SalePrice = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice], "$###,##0.00")
End If

!deed_prepared = Forms![foreclosure database screen]!PostsaleSubForm.Form!dprepared_by_date

!FirstLegal = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Approx_1st
!PropertyState = Forms![foreclosure database screen]!PropertyState

!mil_start = ""

If Not IsNull(Forms![foreclosure database screen]!AD_Start) Then
!mil_start = Forms![foreclosure database screen]!AD_Start & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start2) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start2 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_Start3) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_Start3 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start4) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start5 & " "
End If
If Not IsNull(Forms![foreclosure database screen]!ad_start5) Then
!mil_start = !mil_start & Forms![foreclosure database screen]!ad_start5 & " "
End If

If !mil_start = "" Then
!mil_start = "________________________________________"
End If


If Forms![foreclosure database screen]!Client Like "Seter*" Then
If rsFC!noi_4s = -1 Or rsFC!noi_4s = 1 Then
!Set4s = "Since you have received a non-recourse assumption, you will not be personally responsible for the debt. However, the lien against the property securing this debt may remain on the property until the amount owing on the loan is paid."
End If
If rsFC!noi_bc = -1 Or rsFC!noi_bc = 1 Then

!setbc = "This notice of our intent to foreclose has no effect on your right to dispute the debt in writing as indicated in the debt validation letter we sent to you on __________________.  The Fair Debt Collection Practices Act does not require us to wait until the end of the 30-day validation period before attempting to collect this debt. If, however, you request proof of the debt or the name and address of the original creditor within the 30-day period upon your receipt of the debt validation letter, the law requires us to suspend our efforts to collect the debt until we mail the requested information to you."

End If


End If

If VTypeMerge = "AdVAMerge" Or VTypeMerge = "VirginiaAss" Then
!Attorney = ""
Else
!Attorney = Part1Trustees()
End If

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!clientwff = "Wells Fargo Financial Maryland, Inc."
ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Then
!clientwff = "Wells Fargo Bank, NA"
Else
!clientwff = Forms![foreclosure database screen]!Client
End If

If Client() Like "Suntrust M*" And Forms![foreclosure database screen]!longsecured = "Suntrust Bank" Then
!sotclient = "Suntrust Bank"

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then

If (Forms![foreclosure database screen]!SPsameasCl = 0 Or _
IsNull(Forms![foreclosure database screen]!SPsameasCl)) Then
!sotclient = !clientwff & " as servicing agent for " & LSecured()
Else
!sotclient = !clientwff
End If

ElseIf Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then

!sotclient = LSecured()

If Forms![foreclosure database screen]!Client Like "ocwen*" Then !sotclient = !clientwff & _
    " as servicing agent for " & LSecured()
    
ElseIf Client() Like "specia*" Or Client() Like "Seter*" Then
!sotclient = SignsSP()

ElseIf Not IsNull(Forms![foreclosure database screen]!servicer) Then
!sotclient = Forms![foreclosure database screen]!servicer

Else
!sotclient = Client()
End If

!Assignor = "Mortgage Electronic Registration Systems, Inc. (" & """" & "MERS" & """" & ") as nominee for " & [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![OrgLender]

!Assignee = IIf([Forms]![foreclosure database screen]![TypeOfLoan] = "FNMA" And [Forms]![foreclosure database screen]![PropertyState] = "MD", "Federal National Mortgage Association", IIf([Forms]![foreclosure database screen]![TypeOfLoan] = "FHLMC" And [Forms]![foreclosure database screen]![PropertyState] = "MD", "Federal  Home Loan Mortgage Corporation", [Forms]![foreclosure database screen]![longsecured])) & ", (" & """" & "Assignee" & """" & "), whose address is, c/o " & rsClient![OrganizationName] & ", " & IIf(Client() = "American Home Mortgage Servicing, Inc.", "1525 S. Belt Line Road, Coppell, TX 75019", rsClient![Address] & ", " & rsClient![City] & ", " & rsClient![cl_state] & "  " & rsClient![PostalCode])
rsClient.Close

', all its beneficial interest, if any, in and to the below described Deed of Trust.", ", all its beneficial interest in and to the below described Deed of Trust.")

If VTypeMerge Like "Aff*" Then
!AffDef = "I hereby certify and affirm that, " & IIf(rsFC![Occupied] <> 1 Or IsNull(rsFC!Occupied), "in compliance with Real Property 7-105.1(c)(6), said notice was accompanied by a Notice Regarding Occupancy Determination and contained a telephone number to call to dispute the occupancy determination.  ", "in compliance with Real Property  7-105.1(c)(5), said notice was accompanied by a loss mitigation application and all required documents and addressed envelopes. ")
Else
!AffDef = ""
End If

If VTypeMerge = "MilAff" Or VTypeMerge = "CitiSaleCan" Or VTypeMerge = "ComplaintDC" Or _
VTypeMerge = "DCMotionDism" Or VTypeMerge = "INTERP" Or VTypeMerge = "milAffcheck" Or _
VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "DCAss" Or _
VTypeMerge = "AffCertOwn" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "Coop" Or VTypeMerge = "CitiAntVA" Then
Else
!due_date = NOIDueDate()
!datedefault = NOIDefDate()

If Forms![foreclosure database screen]!Client Like "Wells*" Then
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noi_sent] < #1/15/2011# Then
!affdefpara = "mailed regular mail"
Else
!affdefpara = "electronically sent"
End If
Else
!affdefpara = AffDefPara2()
End If

End If

If Forms![foreclosure database screen]!Asc_wff = 4 Or Forms![foreclosure database screen]!Asc_wff = 5 Then

If rsFC!reason_default Like "Death*" Then
!aff_def_para4 = "the nature of default is death."
ElseIf rsFC!reason_default Like "Move Out*" Then
!aff_def_para4 = "the nature of the default is property no longer owner occupied."
ElseIf IsNull(rsFC!reason_default) Then
!aff_def_para4 = "the nature of default is the failure to tender payments."
Else
!aff_def_para4 = rsFC!reason_default & "."
End If

Else
'!aff_def_para4 = "is the failure to tender the payment due on " & NOIDueDate()
!aff_def_para4 = "the nature of default is the failure to tender payments."

End If

'and that the nature of default is the failure to tender payments


!party1stpart = DOASecParty()


Dim EL1, EL2

'----From Aff Cert
Dim OwnRecord

If Client() Like "Bayv*" Then
OwnRecord = "record owner"
Else
OwnRecord = "owner"
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then


If Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then
!AffCert = ", that Federal National Mortgage Corporation is the owner of the loan evidenced by the Note, and that Federal National Mortgage Corporation has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure action."
'!AffCert = "of the loan evidenced by the note, and that they, " & LSecured() & " has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure action."
Else
!AffCert = ", that " & LSecured() & " is the owner and holder of the loan evidenced by the note."
End If

'CITICode

ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then

If Forms![foreclosure database screen]![SPsameasCl] = 0 Or IsNull(Forms![foreclosure database screen]![SPsameasCl]) And _
(Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA") Then
!AffCert = "Bank of America, N.A., who services the loan which is the subject of this proceeding"
Else
!AffCert = "Bank of America, N.A., as an officer of BANA"
End If



ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then

If LSecured() Like "Citifin*" Or LSecured() Like "One*" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.  Pursuant to an agreement, CitiMortgage, Inc. provides certain loan servicing activities to " & [Forms]![foreclosure database screen]![servicer] & _
" the servicer of  the  loan evidenced by the Note.  I am authorized to execute this affidavit on behalf of " _
& [Forms]![foreclosure database screen]![servicer] & " pursuant to the corporate resolutions of " & [Forms]![foreclosure database screen]![servicer] & _
".  In my capacity as a  Vice President - Document Control,  I hereby certify in compliance with  7-105.1(D)(2)(III)  that " & LSecured() & " is the owner of the Note and that the copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Then
!AffCert = "          I am employed by CitiMortgage Inc. as a Vice President - Document Control.   In that capacity, I HEREBY CERTIFY in compliance with  7-105.1(D)(2)(111)  that Federal National Mortgage Association is the owner of the loan that is the subject of this foreclosure action  (the Loan).  CitiMortgage Inc. is the servicer of the Loan.  The copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.   In that capacity, I HEREBY CERTIFY in compliance with  7-105.1(D)(2)(III)  that Federal Home Loan Mortgage Corporation is the owner of the loan that is the subject of this foreclosure action  (the Loan).  CitiMortgage, Inc. is the servicer of the Loan.  The copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA" Then
!AffCert = "          I am employed by CitiMortgage, Inc. as a Vice President - Document Control.  In that capacity, I hereby certify in compliance with  7-105.1(D)(2)(III)  that " & LSecured() & " is the owner of the Note and has authorized CitiMortgage, Inc. to be the holder of the Note for purposes of executing this affidavit and conducting this foreclosure action and that the copy of the Note filed in this foreclosure case is a true and accurate copy of said Note."

End If
'CitiCode

ElseIf (Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or Forms![foreclosure database screen]![SPsigns] = -1) And _
(Forms![foreclosure database screen]![TypeOfLoan] <> "FHLMC" And _
Forms![foreclosure database screen]![TypeOfLoan] <> "FNMA" And _
Forms![foreclosure database screen]![TypeOfLoan] <> "GNMA") Then
EL1 = LSecured() & " is the " & OwnRecord & "of the Note and that the copy of the Note attached hereto is a true and accurate copy of the original debt instrument."
Else
EL1 = IIf(Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or Forms![foreclosure database screen]!TypeOfLoan Like "FHA*" Or Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Or Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Or Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC", LoanInvestor(), LSecured()) & " is the owner of the Note and that " & IIf(Client() Like "Dov*" And (Forms![foreclosure database screen]![SPsigns] = -1 Or Forms![foreclosure database screen]![SPsigns] = 1), "", servicer() & " is servicer for said owner and that") & " the copy of the Note attached hereto is a true and accurate copy of the original debt instrument."

'----

!AffCert = "          I HEREBY CERTIFY that " & EL1

End If


'FCTracking for Final LMA
If Not rsFC.EOF Then

!PreFiled = rsFC!pre_docket_filed
!FLMA_Filed = rsFC!final_LMA_filed

End If

'Date/Year
!dateyear = "20__"
If Forms![foreclosure database screen]!LastNameDebtor2 <> "" Then
!iwe = "We"
!amare = "are"
!myour = "ourselves"
!iwe2 = "we"
Else
!iwe = "I"
!amare = "am"
!myour = "myself"
!iwe2 = "I"
End If
 
If VTypeMerge = "DCMotionDism" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "milAffcheck" Or VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "DCAss" Or VTypeMerge = "Interp" Then

Else
If Forms![foreclosure database screen]!PropertyState = "MD" Then
!caption1 = attorneycap() & ", et al"
Else

Dim rsAtt As RecordSet
Set rsAtt = CurrentDb.OpenRecordset("attorneys", dbOpenSnapshot)

If attorneycap() Like "*Ward" Then
!caption1 = rsAtt!Attorney7
!caption2 = rsAtt!Attorney1
!Caption3 = rsAtt!Attorney2
!Caption4 = trusteenoncooper()
!Caption5 = ""
ElseIf attorneycap() Like "*Geesing" Then
!caption1 = rsAtt!Attorney2
!caption2 = rsAtt!Attorney7
!Caption3 = rsAtt!Attorney1
!Caption4 = trusteenoncooper()
!Caption5 = ""
ElseIf attorneycap() Like "*Bierman" Then
!caption1 = rsAtt!Attorney1
!caption2 = rsAtt!Attorney2
!Caption3 = rsAtt!Attorney7
!Caption4 = trusteenoncooper()
!Caption5 = ""
End If
rsAtt.Close
End If
End If

'Start DOA Code
If VTypeMerge = "AffsALL" Or VTypeMerge = "AffsAllWells" Then
Dim VWit2
Dim VWit3
Dim VDateYr
VDateYr = "20__"

If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then
VWit2 = " by its duly authorized agent on ______ day of _____________, " & VDateYr
ElseIf Client() Like "HomEq*" Then
VWit2 = ", by Assistant Secretary of " & Forms![foreclosure database screen]![signature block] & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "Wells*" Then
VWit2 = ", by the authorized agent of " & Client() & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "One*" Then
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, ______"
Else
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, " & VDateYr
End If

!inwitness = IIf(Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC", _
IIf(Client() Like "Seteru*", LoanInvestor(), Client() & ""), _
IIf((Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Or _
Forms![foreclosure database screen]![SPsigns] = 1), LSecured(), Client())) & _
" has caused this Appointment of Substitute Trustee to be executed " & VWit2 & "."



!SecuredParty = Forms![foreclosure database screen]!longsecured
!AffDefPara1 = AffDefPara1()
!signatureblock = Forms![foreclosure database screen]![signature block]


!signatureline = PartOneSignature3()


!Title = PartOneSignature4()

!ClientState = "______________"
!clientcounty = "______________"

Dim VNotary1, VNotary2, VNotary3
If Client() Like "Seter*" Then
!Notary = "______________________________, authorized agent of " & Client() & ", as attorney-in-fact for Fannie Mae (" & """" & "Federal National Mortgage Association" & """" & "), personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
!Notary = "___________________ of " & servicer() & ", authorized servicer for " & LoanInvestor() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Client() Like "HomEq*" Or Client() Like "Wells*" Then
!Notary = DOANotaryHomEq()
ElseIf Client() Like "Ocwen*" Then
!Notary = DOANotaryOcwen()
ElseIf Client() Like "MGC*" Then
!Notary = PartOneDOA1() & ", " & PartOneDOA2() & " "
Else
If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary1 = " by "
Else
VNotary1 = " agent of "
End If
If Client() Like "JP*" Or _
(Client() Like "Ocwen*" And _
(Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]))) Then
If Forms![foreclosure database screen]![signature block] Like "*Attorney-in*" Then
VNotary2 = "as Attorney-in-Fact for " & LSecured()
Else
VNotary2 = "Authorized Servicer for " & LSecured()
End If
ElseIf Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary2 = LSecured()
Else
VNotary2 = servicer()
End If
VNotary3 = ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
!Notary = "_______________________________" & ", authorized" & VNotary1 & VNotary2 & VNotary3

End If
End If
'END OF DOA CODE

!deedmort = DML()

If Forms![foreclosure database screen]!PropertyState <> "MD" Then
!signature = PartOneSignature1()
!Signature2 = PartOneSignature2()
Else
!Signature2 = ""

If Forms![foreclosure database screen]!Asc_wff = 2 Then
!signaturewff = "Wells Fargo Financial Maryland, Inc."
!signaturerm = "Wells Fargo Bank, NA., as servicer for Wells Fargo Financial Maryland, Inc."
ElseIf Forms![foreclosure database screen]!Asc_wff = 4 Or Forms![foreclosure database screen]!TypeOfLoan Like "FHLM*" Then
!signaturewff = "Wells Fargo Bank, NA"
!signaturerm = "Wells Fargo Bank, NA"
Else
!signaturewff = PartOneSignatureAff1()
!signaturerm = PartOneSignatureAff1()
End If


!signature = PartOneSignatureAff1()
End If


If VTypeMerge = "AffDefault" Or VTypeMerge = "AffsALL" Or VTypeMerge = "AffsAllWells" Then

If Forms![foreclosure database screen]![Client] Like "one*" Then
!extralang3 = "representative of " & PartOneSignature1()
Else
!extralang3 = ", "
End If

If Forms![foreclosure database screen]!Client Like "Dov*" And (Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1) Then
!extralang4 = ""
Else
!extralang4 = "/servicer"
End If

If Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then

If Forms![foreclosure database screen]![ForeclosureSubForm].Form!noi_sent < #1/15/2011# Then
!extralang2 = "A copy of Notice of Intent to Foreclose was sent to the Commissioner of Financial Regulation, on " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!noi_sent, "mmmm dd, yyyy") & ", by first class mail, postage prepaid, in accordance with Section 7-105.1(c)."
Else
!extralang2 = "A copy of Notice of Intent to Foreclose was sent to the Commissioner of Financial Regulation, on " & Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![noi_sent], "mmmm dd, yyyy") & ", via electronic submission in accordance with Section 7-105.1(c) and COMAR 09.03.12.02."
End If

Else
If [Forms]![foreclosure database screen]![ForeclosureSubForm].[Form]![noi_sent] < #1/15/2011# Then
!extralang2 = "sent to the Commissioner of Financial Regulation, on that date, by first class mail, postage prepaid, in accordance with Section 7-105.1(c)(3)."
Else
!extralang2 = "submitted electronically to the Commissioner of Financial Regulation, in accordance with Section 7-105.1(c)(3) and COMAR 09.03.12.02."
End If

End If


If Forms![foreclosure database screen]!Client = "Foreclosure Management Company" Then
!FOOTER = Forms![foreclosure database screen]!LastNameDebtor1 & "/" & PROP()
End If

End If

If IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form!noi_sent) Then
!noiSent = "____________"
!NOIExp = "____________"
Else
!noiSent = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!noi_sent, "mmmm dd, yyyy")
!NOIExp = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!noi_sent + 45, "mm/dd/yyyy")

End If

!pastdue = rsFC!past_due_no


If VTypeMerge = "AffCertOwn" Or VTypeMerge = "AffsAllWells" Then
If Forms![foreclosure database screen]!Client Like "Wells*" Then
!FOOTER = "005_MD_V2"
End If
End If


If VTypeMerge = "VirginiaAss" Or VTypeMerge = "DCAss" Then

strsqlqc = "Select * from QC where filenum = " & GblFilenum & ";"
Set rsqc = CurrentDb.OpenRecordset(strsqlqc, dbOpenSnapshot)

If Not IsNull(rsqc!qc_assignor) Then
!AOMAssignor = rsqc!qc_assignor
End If
If Not IsNull(rsqc!qc_Assignee) Then
!aomassignee = rsqc!qc_Assignee
End If
If Not IsNull(rsqc!qc_Assignee_Add) Then
!aomassigneeaddress = rsqc!qc_Assignee_Add
End If

rsqc.Close
Set rsqc = Nothing

'If IsNull(!AOMAssignor) And IsNull(!aomassignee) And IsNull(!aomassigneeaddress) Then
'Dim Vselect
'Vselect = InputBox("Who is Assignee? 1-Secured Party  2-Client or 3-Type in Here")
'If Vselect = 1 Then
'!extralang1 = LSecured()
'ElseIf Vselect = 2 Then
'!extralang1 = servicerVA()
'Else
'!extralang1 = Vselect
'End If
'Else
'!extralang1 = ""
'End If
End If


If VTypeMerge = "MilAffCheck" Then
If Forms![foreclosure database screen]!Client Like "Bank of Am*" Or Forms![foreclosure database screen]!Client Like "Citi*" Then
!extralang1 = "Have all searches been uploaded to the clients system of record? ___ Yes ___ No "
Else
!extralang1 = ""
End If
End If

If VTypeMerge = "AdVAMerge" Then
If Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = -1 Or Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = 1 Then
!extralang1 = "The property is being sold subject to a note secured by a prior deed of trust, the outstanding balance of which will be made available if known to the trustee.  "
Else
!extralang1 = ""
End If
End If

If VTypeMerge = "AffsAllWells" Or _
(Forms![foreclosure database screen]!Client Like "Wells*") Then
If Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Then
!extralang1 = "of the loan evidenced by the note, and that they, " & LSecured() & " has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure action."
Else
!extralang1 = "and holder of the loan evidenced by the Note."
End If
End If



If VTypeMerge = "PLMA" Or VTypeMerge = "AffsAll" Then
If Forms![foreclosure database screen]!Client Like "Wells*" Then
Else
If Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Then
!extralang1 = "of the loan evidenced by the Note, and that " & LSecured() & " has authorized " & Client() & " to be the holder of the Note for purposes of conducting this foreclosure."
Else
!extralang1 = " and holder of the loan evidenced by the Note."
End If
End If
End If


If VTypeMerge = "PLMA" Or VTypeMerge = "FLMA" Or VTypeMerge = "AffsAll" Then
If Client() Like "Citi*" Then
!prefinal_line = "_________________________________, Vice President - Document Control"
Else
!prefinal_line = "_________________________________"
End If
End If

If VTypeMerge = "PLMA" Then
If Forms![foreclosure database screen]!Client Like "Wells*" Then
!FOOTER = "004-MD_Prelim_V3"
End If
End If

If VTypeMerge = "FLMA" Then
If Forms![foreclosure database screen]!Client Like "Wells*" Then
!FOOTER = "004-MD_Final_V3"
End If
End If

If Forms![foreclosure database screen]!Client Like "OneWest Bank, F.S.B. (d/b/a Financial Freedom*" And _
VTypeMerge = "FLMA" Then
!masign = "Minda Turnbull"
!matitle = ", Authorized Secretary"
Else
!masign = "____________________________"
!matitle = ""
End If

If Forms![foreclosure database screen]!Client Like "Ocwen*" And Forms![foreclosure database screen]!PropertyState = "MD" And Forms![foreclosure database screen]!prime_nonprime = 1 Then
Dim VOcwen
VOcwen = MsgBox("Did Ocwen Send NOI?", vbYesNo)
If VOcwen = vbYes Then
!signatureline = "Ocwen Loan Servicing, LLC"
Else
!signatureline = "Ocwen Loan Servicing, LLC, successor in interest to Homeward Residential, Inc."
End If
End If


!Assignee = Assignee()


'Assignment Request
If VTypeMerge = "VirginiaAss" Then
!taxid = taxidCode() & Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid
Else
!taxid = Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid

End If

!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!Book) Then
!DeedBook = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Liber
Else
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
End If
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!VAPage) Then
!VAPage = Forms![foreclosure database screen]![ForeclosureSubForm].Form!Folio
Else
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
End If

!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!minno = Forms![foreclosure database screen]!Min
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
If Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]) _
Or Not IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber]) Then
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!reinstrument) Then
!rerecorded = "Re-recorded as DeedBook " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reliber] _
& " Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
Else
If IsNull(Forms![foreclosure database screen]![ForeclosureSubForm].Form!refolio) Then
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument]
Else
!rerecorded = "Re-recorded as Instrument No. " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![reinstrument] _
& " at Page " & Forms![foreclosure database screen]![ForeclosureSubForm].Form![refolio]
End If
End If
End If





'FC Tracking for Final LMA

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!liberfolio = liberfolio()
!modification = Trim(modification())

![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!longsecured = LSecured()
If attorneysigns2() <> "" Then
!attorneysigns = attorneysigns() & ", " & attorneysigns2() & " and " & rs![Attorneys Company Name]
Else
!attorneysigns = attorneysigns() & " and " & rs![Attorneys Company Name]
End If
!CaseNo = Forms![foreclosure database screen]!PostsaleSubForm.Form!CaseNo
!CountyState = CountyState()
If Not IsNull(Forms![foreclosure database screen]![resume_recd]) Then
!Referral_Date = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
Else
!Referral_Date = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd"", ""yyyy")
End If

!resume_recd = Format(Forms![foreclosure database screen]![resume_recd], "mmmm dd"", ""yyyy")
If VTypeMerge = "AdVAMerge" Or VTypeMerge = "MultipleAdd" Or VTypeMerge = "VirginiaAss" Or VTypeMerge = "Interp" Or VTypeMerge = "milAffcheck" Or VTypeMerge = "DCMotionDism" Then
Else
!AttorneyCAPDOA = Part1Trustees()
!attorneycap = attorneycap()
End If

!Property = PROP()
!Propertycounty = County()
!SaleHeld = rspropertycounty!SaleHeld
!CourtAddress = rspropertycounty!CourtAddress
!courtcsz = rspropertycounty!CourtCity & ", " & rspropertycounty!State & "  " & rspropertycounty!CourtZip
!CourtName = "Circuit Court for " & County()

!attorneysigns1 = attorneysigns()
!attorneysigns2 = attorneysigns2()
!attorneybar = attorneybar()
!attorneybar2 = attorneybar2()
!Borrowers = debtorsFORE()
!debtorsCAPS = debtorsCAPS()
!borrowersdns = debtorsOPENDNS()
!BorrowersOwners = debtorsforeOwners()
!BorrowersActiveMil = debtorsActiveMil()

If VTypeMerge = "GOVT" Or VTypeMerge = "AssReq" Or VTypeMerge = "CitiAss" Or VTypeMerge = "AdVAMerge" Or VTypeMerge = "InterP" Or VTypeMerge = "DCMotionDism" Or VTypeMerge = "DCMotionDism" Then
legaldesc = Replace(Nz(Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription, ""), Chr(148), """")
legaldesc = Replace(Replace(legaldesc, Chr(146), "'"), Chr(147), """")
!LegalDescription = legaldesc
Else
!LegalDescription = ""
End If


!SaleTime = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleTime, "h:mm am/pm")
!SaleDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!SaleDate, "mmmm dd, yyyy")
If Forms![foreclosure database screen]!PropertyState = "VA" And VTypeMerge = "AffDebtBlank" Then
!upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
' !upb = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![Balance Due on Note], "$###,##0.00")
Else
Dim rsBD As RecordSet
Dim strsqlBD As String
strsqlBD = "SELECT ([principal balance]+[interest amt]+[late charge]+[lender advance]+[interest on advance]+[nsf charge]+[foreb]+[escbal]+[miscm1]+[miscm2]+[mism3]+[mism4]+[mism5]+[mism6]+[mism7]+[mism8]+[mism9]+[rec_bal]+[mism10]+[mism11]) AS BALDue, AFFDebt.SubFileNum " _
& "FROM AFFDebt INNER JOIN Foreclosure ON AFFDebt.SubFileNum = Foreclosure.SubFileNum WHERE AFFDebt.SubFileNum = " & [Forms]![foreclosure database screen]![filenum]
Set rsBD = CurrentDb.OpenRecordset(strsqlBD, dbOpenSnapshot)
Dim VAffDebtBd
If Not rsBD.EOF Then
VAffDebtBd = Format(rsBD!BalDue, "$###,##0.00")
Else
VAffDebtBd = 0
End If
!upb = VAffDebtBd
End If

!paidonprin = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount] - Forms![foreclosure database screen]!ForeclosureSubForm.Form![Principal Balance], "$###,##0.00")

If VTypeMerge = "SeterusPDF" Or VTypeMerge = "Seterus" Or VTypeMerge = "Seneca" Or VTypeMerge = "GreenPlanet" Then
!Letter_Date = Format(Forms![NOI Information Screen]!NOITabs.Form!noi_prepared, "mmmm dd, yyyy")
Else
!Letter_Date = Format(Date, "mmmm dd, yyyy")
End If

!deposit = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit] - 2500, "$###,##0.00")


If VTypeMerge <> "Seterus" And VTypeMerge <> "DILScra" And VTypeMerge <> "Chronology" Then

If Forms![foreclosure database screen]![PropertyState] = "VA" Then
!FeesCosts = Format(Forms![foreclosure database screen]![Date Recieved], "mmmm dd"", ""yyyy")

ElseIf Forms![foreclosure database screen]![PropertyState] = "DC" Then

If VTypeMerge <> "AffDefault" And VTypeMerge <> "DOA" And VTypeMerge <> "PLMA" And VTypeMerge <> "FLMA" And VTypeMerge <> "AffCertOwn" Then

If Not IsNull(Forms![foreclosure database screen]!ForeclosureSubForm.Form![good thru date]) Then
!FeesCosts = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![good thru date], "mmmm dd"", ""yyyy")
VDate = InputBox("Fees and Costs As of Date")
!FeesCosts = Format(VDate, "mmmm dd"", ""yyyy")
End If

ElseIf Forms![foreclosure database screen]![PropertyState] = "MD" Then
If Not IsNull([Forms]![foreclosure database screen]![affdavitdebtfc].[Form]![interest thru]) Then
!FeesCosts = Format([Forms]![foreclosure database screen]![affdavitdebtfc].[Form]![interest thru], "mmmm dd, yyyy")
Else
VDate = InputBox("Fees and Costs As of Date")
!FeesCosts = Format(VDate, "mmmm dd"", ""yyyy")
End If
End If
End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then
!govtsent = "A deposit of ten percent (10%) of the sale price in the form of cash or certified funds with balance of the purchase price to be paid in cash within fifteen (15) days of sale"
ElseIf Forms![foreclosure database screen]!PropertyState = "DC" Then
!govtsent = "A deposit of " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit], "$###,##0.00") & " in the form of cash or certified funds with balance of the purchase price to be paid in cash within thirty (30) days of sale"
Else
!govtsent = "A deposit of " & Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![vadeposit], "$###,##0.00") & " in the form of cash or certified funds with balance of the purchase price to be paid in cash within ten (10) days of sale"
End If

End If

If VTypeMerge = "ASSREQ" Then
!Client = servicerVA()
End If

.Update
End With
rsFC.Close
rs.Close


'If FileOrDirExists(PathUSER & "\fcmerge.txt") Then Kill (PathUSER & "\fcmerge.txt")

If VTypeMerge = "GOVT" Or VTypeMerge = "AdVAMerge" Then
'DoCmd.TransferText acExportDelim, , "fcmerge", PathUSER() & "fcmerge.txt"
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

Else
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

'DoCmd.RunMacro ("exportfcmerge")
End If


End Function

Public Function ETSMerge()

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("etsbasicmerge")
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

'DoCmd.RunMacro ("exportfcmerge")

End Function
Public Function BasicFCMerge()

 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError
DoCmd.OpenQuery ("fcbasicmerge")

Dim rs As RecordSet

Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)
GblFilenum = Forms![foreclosure database screen]![filenum]

Dim VDate

With rs
.Edit
!dateyear = "20__"
!liberfolio = liberfolio()
![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!Property = PROP()
!Propertycounty = County()
!Borrowers = debtorsFORE()
!Letter_Date = Format(Date, "mmmm dd, yyyy")
.Update
End With

DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

'DoCmd.RunMacro ("exportfcmerge")



End Function
Public Function RunSOTWellsSOTNoOrgTrustee()

Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SOTWellsNoOrgTrustee.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With




End Function

Public Function BKMFRBayView()
Call BkMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!Client Like "Bayvi*" Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\BK\PlaintiffAffidavitofMilitaryService.Bayview.docx", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "bkmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End If

End Function


Public Function CitiAbandonedVA()
Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" And Forms![foreclosure database screen]!Client Like "Citi*" Then

If Forms![foreclosure database screen]!Client Like "Citi*" Then
If IsNull(Forms![foreclosure database screen]!servicer) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\CitiMortgageAbandonedFCNotices.docx", , , True)
ElseIf Forms![foreclosure database screen]!servicer Like "*Citifinancial*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\CitiFinancialAbandonedFCNotices.docx", , , True)
Else
MsgBox ("Citi  file but the SERVICER is not Null or does NOT have Citifinancial in the name")
Exit Function
End If
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End If

End Function

Public Function RunLNAVaMERGE()
Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]!Client Like "Citi*" Then
If IsNull(Forms![foreclosure database screen]!servicer) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\LNAVA-Citi.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\LNAVA-Citifinancial.doc", , , True)
End If
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\LNAVA-BWW.doc", , , True)

End If



With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End If

End Function


Public Function RunDOAVaMERGE()
Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterChaseVAam.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Pennymac*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Pennymac.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Bank of Amer*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-BANA.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-SLS.docx", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\DOAMasterNationstarVA.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Champio*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-Champion.doc", , , True)
'Mers
'SOTVA-Champion-MERS.doc

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-Ocwen.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterVANov2014.doc", , , True)
End If



With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If

End If

End Function

Public Function DeedVASpecialty()
Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\Deed-HUDSpecialWarranty.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With



End Function

Public Function RunDOAVa()
Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterChaseVAam.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterVA.doc", , , True)
End If



With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End If

End Function
Public Function RunDOAMaryland()

Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")
'DOAMasterCitiDC

If Forms![foreclosure database screen]!PropertyState = "DC" Then

Call SOTDC

Exit Function

End If

'VIRGINIA

If Forms![foreclosure database screen]!PropertyState = "VA" Then


If Forms![foreclosure database screen]!Client Like "Citi*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterVACITI.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Champio*" Then
If Forms![foreclosure database screen]!mers = 1 Or Forms![foreclosure database screen]!mers = -1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Champion-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-Champion.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Select*" Then
If Forms![foreclosure database screen]!mers = 1 Or Forms![foreclosure database screen]!mers = -1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-SPS-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-SPS.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Suntrust*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-Suntrust.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
If Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\datatransfer\templates\fc\virginia\SOTVA-Nationstar-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Nationstar.doc", , , True)

End If

ElseIf Forms![foreclosure database screen]!Client Like "JP*" Then
If Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Chase-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterChaseVA.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Penny*" Then
If Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Pennymac-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Pennymac.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Bank of Amer*" Then
If Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-BANA-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-BANA.doc", , , True)
End If


ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Ocwen-MERS.doc", , , True)

ElseIf Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\DOAMasterVAOcwenHomeward.doc", , , True)
'Call CoverPage
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Ocwen.doc", , , True)
'Call CoverPage

End If

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Wells.doc", , , True)

ElseIf Forms![foreclosure database screen]!mers = 1 Or Forms![foreclosure database screen]!mers = -1 Then

If Forms![foreclosure database screen]!Client Like "Champion*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-Champion-MERS.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-BWW-MERS.doc", , , True)
End If

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\SOTVA-BWW.doc", , , True)
End If
'END Virginia



'MARYLAND

ElseIf Forms![foreclosure database screen]!PropertyState = "MD" Then

If Forms![foreclosure database screen]!Client Like "Seter*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterSeterus.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Specialized *" Then

If Forms![foreclosure database screen]!TypeOfLoan = "CONV" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSSOTNonGSA.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSSOTGSA.doc", , , True)
End If


ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\NstarSOT.docx", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterChase.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Select Port*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSSOT.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterOcwenBaltCityONLY.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterOcwen.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterCitiMd.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMaster.doc", , , True)
End If
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If


End Function
Public Function RunSOTLost()
VTypeMerge = "SOTLost"

Call DOAMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterVALost.doc", , , True)


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"

End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Call ConfCover



End Function
Public Function ADVaMerge()

VTypeMerge = "AdVaMERGE"


Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

dumpname = Forms![foreclosure database screen]!filenum & "_" & Format$(Now(), "yyyymmddhhnnss") & "_AdVA.doc"

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Adva.doc", , True)

'DoCmd.TransferText acExportDelim, , "Fcmerge", PathUSER() & "fcmerge.txt", True
'.OpenDataSource name:=PathUSER() & "fcmerge.txt"


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
'.OpenDataSource name:=pathuser() & "fcmerge.txt"
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & dumpname
oapp.Visible = True


End With


End Function
Public Function CitiAntVa()

VTypeMerge = "CitiAntVa"


Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

dumpname = Forms![foreclosure database screen]!filenum & "_" & Format$(Now(), "yyyymmddhhnnss") & "_CitiAntCover.doc"

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Virginia\CitiANTCoverSheet.docx", , True)

'DoCmd.TransferText acExportDelim, , "Fcmerge", PathUSER() & "fcmerge.txt", True
'.OpenDataSource name:=PathUSER() & "fcmerge.txt"


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
'.OpenDataSource name:=pathuser() & "fcmerge.txt"
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & dumpname
oapp.Visible = True


End With


End Function

Public Function ADVaMergeVASales()

VTypeMerge = "AdVaMERGE"


Call FCMergeVaSales


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

dumpname = Forms![VirginiaSales]!filenum & "_" & Format$(Now(), "yyyymmddhhnnss") & "_AdVA.doc"

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Adva.doc", , True)

'DoCmd.TransferText acExportDelim, , "Fcmerge", PathUSER() & "fcmerge.txt", True
'.OpenDataSource name:=PathUSER() & "fcmerge.txt"


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
'.OpenDataSource name:=pathuser() & "fcmerge.txt"
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & dumpname
oapp.Visible = True


End With


End Function

Public Function AFFDEBTMONIES()

If Forms![foreclosure database screen]!Client Like "Ocwen*" Then
VTypeMerge = "AffDebtMoniesOCWEN"
ElseIf Forms![foreclosure database screen]!Client Like "Citi*" Then
VTypeMerge = "AffDebtMoniesCiti"
Else
VTypeMerge = "AffDebtMONIES"
End If

Call ADMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Dim strsql As String
Dim rs As RecordSet
strsql = "select * from affdebt where subfilenum = " & Forms![foreclosure database screen]!filenum
Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

'MsgBox ("#1")


If Forms![foreclosure database screen]!Client Like "Ocwen*" Then

If Forms![foreclosure database screen]!PropertyState = "DC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\dc\AffDebt-Monies-OcwenDC.doc", , True)

Else

If rs!int_vr = -1 Or rs!int_vr = 1 Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Monies-Ocwen-Variable-MD-FNMA-FHLMCOnly.doc", , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Monies-Ocwen-Variable.doc", , True)
End If


Else

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Monies-Ocwen-MD-FNMA-FHLMCOnly.doc", , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-monies-Ocwen.doc", , True)
End If

End If
End If


ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDebtSPFannieFreddie.doc", , , True)

ElseIf Forms![foreclosure database screen]!Asc_wff = 2 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDebtSPCMI.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDebtSPCB-CF-OMonly.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Speciali*" Then
'MsgBox ("#2 inside SLS code")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSAffDebt.doc", , True)

ElseIf Forms![foreclosure database screen]!Client Like "Select Po*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSCombinedMDAffs.doc", , True)

'ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
'Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\NstarCombinedAff.doc", , True)

ElseIf Forms![foreclosure database screen]!Client Like "Select Port*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSCombinedMDAffs.doc", , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-monies.doc", , True)
End If

rs.Close


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "admerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function
Public Function AffDebtBlank()

VTypeMerge = "AffDebtBlank"
Call FCMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

'Set oDoc = oApp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPOWB.doc", , , True)
Dim VSel
If Client() Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebtBlankClient-Chase.doc", , , True)



Else

VSel = InputBox("1. BWW Sends" & vbCr & "2. Client Sends")
If VSel = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebtBlankBWWSigns.doc", , True)
ElseIf VSel = 2 Then
If Forms![foreclosure database screen]!Client Like "Ocwen*" And Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffidavitDebtBlank-OcwenHomeward.doc", , , True)
Else

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebtBlankClient.doc", , , True)
End If

End If
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function RunAffDefault()

VTypeMerge = "AffDefault"

strsqlfc = "Select * from fctracking where filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)

If Forms![foreclosure database screen]!Client Like "Wells*" And _
(IsNull(rsFC![Occupied]) Or rsFC![Occupied] = 0) Then
MsgBox ("Occupied box is not checked will not merge!")
rsFC.Close

Exit Function

Else

Call FCMerge
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")


If Forms![foreclosure database screen]!Client Like "Ever*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultEVERHOME.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Specialized L*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSAffDef.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "BAC*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultBAC.doc", , , True)

'OcwenAffidavitDefaultBWWSent.doc
ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" And (IsNull(Forms![foreclosure database screen]!prime_nonprime) Or Forms![foreclosure database screen]!prime_nonprime <> 1) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\OcwenAffidavitDefaultBWWSent.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDefSPFannieFreddie.doc", , , True)
ElseIf Forms![foreclosure database screen]!Asc_wff = 0 Or IsNull(Forms![foreclosure database screen]!Asc_wff) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDefSPOther.doc", , , True)
ElseIf Forms![foreclosure database screen]!Asc_wff = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDefSPCB-CF-OMonly.doc", , , True)
ElseIf Forms![foreclosure database screen]!Asc_wff = 2 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiAffDefSPCMI.doc", , , True)
End If


Else

Dim VSel
VSel = InputBox("1. BWW Sends" & vbCr & "2. Client Sends")
If VSel = 1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultBGWWSends.doc", , True)


ElseIf VSel = 2 Then
If Forms![foreclosure database screen]!Client Like "Wells*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultWells.doc", , , True)


ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefault-OcwenHomeward.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultOcwen.doc", , , True)
End If


ElseIf Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then
MsgBox ("There are 2 separate Affidavits for OneWest Bank.  They will BOTH merge now")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultOWB.doc", , , True)
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultMailingOWB.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultClientSigns.doc", , , True)


End If
End If
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End If

'Call CoverPage

End Function
Public Function RunFLMA()

'If Client() Like "Ocwen*" Then
'MsgBox ("Ocwen files use the database version of the Final Loss Mit Aff.  Will not generate Word Merge")
'Exit Function

'Else

VTypeMerge = "FLMA"

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMANoCaption.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Specialized L*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSFLMA.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Select Por*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSFLMA.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
If Forms![foreclosure database screen]!SPsameasCl = 1 Or Forms![foreclosure database screen]!SPsameasCl = -1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Nstar_FLMAisSP.docx", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Nstar_FLMANotSP.docx", , , True)
End If

ElseIf Client() Like "JP*" Then
Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMANoCaptionChase.doc", "Word.Document")
FollowHyperlink ("\\rvdv-fs01\datatransfer\Attachments\ChaseLMAAttachment.PDF")

ElseIf Forms![foreclosure database screen]!Client Like "CitiMor*" Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiFLMASPFannieFreddie.doc", , , True)
'CitiAffDebtSPFannieFreddie
'CitiMilAffSPFannieFreddie
'CitiPLMASPFannieFreddie
ElseIf Forms![foreclosure database screen]!Asc_wff = 2 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiFLMASPCMI.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiFLMASPCB-CF-OMonly.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\OcwenFLMAupdated.doc", , , True)

ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMACitiFin.doc", , , True)


Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMA.doc", , , True)
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
Call FLMAAttachOcwen

'End If


End Function
Public Function SPSCompliance()
If Client() Like "Select Po*" Then

VTypeMerge = "ComplianceCert"
Call BasicMergeFC

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSCert.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End If

End Function
Public Function FLMAAttachOcwen()
If Client() Like "Ocwen*" And (Forms![foreclosure database screen]!prime_nonprime = 0 Or _
IsNull(Forms![foreclosure database screen]!prime_nonprime)) Then

VTypeMerge = "FLMAAttach"
Call BasicMergeFC

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\OcwenOcwenCover.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With
End If


End Function
Public Function CoverPage()

If Client() Like "Ocwen*" Then

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Client() Like "Ocwen*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CoverOcwen.doc", , , True)
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End If

End Function
Public Function SuntrustSubTrusReq()



'Aff Package
VTypeMerge = "AffReq"
Call BasicMergeS

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SubTrusteeRequirements.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function SuntrustAffReq()



'Aff Package
VTypeMerge = "AffReq"
Call BasicMerge


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffidavitRequirements.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With


End Function

Public Function AffPkgONLY()

Dim oapp As Word.Application
Dim oDoc As Word.document

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VClientID = Forms![foreclosure database screen]!Client_id
End If

'Aff Package
VTypeMerge = "AffPKG"
Call FCMerge
Set oapp = CreateObject("word.application")

If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgNoCaption.doc", , , True)
ElseIf Client() Like "JP*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgNoCaptionChase.doc", , , True)
ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgCitiFin.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkg.doc", , , True)
End If

VName1 = Forms![foreclosure database screen]!filenum & "_AffPkg_" & (Format$(Now(), "mmddyyhhnnss"))


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function


Public Function AffPkgEmail()

Dim oapp As Word.Application
Dim oDoc As Word.document

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VClientID = Forms![foreclosure database screen]!Client_id
End If

'Aff Package
VTypeMerge = "AffPKG"
Call FCMerge
Set oapp = CreateObject("word.application")

If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgNoCaption.doc", , , True)

ElseIf Client() Like "JP*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgNoCaptionChase.doc", , , True)

'ElseIf Client() Like "Select Port*" Then
'Call ADMerge
'Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSCombinedMDAffs.doc", , , True)

ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgCitiFin.doc", , , True)

ElseIf Client() Like "Ocwen*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkgOcwenNEW.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffPkg.doc", , , True)
End If

VName1 = Forms![foreclosure database screen]!filenum & "_AffPkg_" & (Format$(Now(), "mmddyyhhnnss"))


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
'If Client() Like "Select Port*" Then
'    .OpenDataSource Name:=pathuser() & "admerge.txt"
'Else
    .OpenDataSource name:=pathuser() & "fcmerge.txt"
'End If

End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = ""

MyMail.Subject = "Affidavits for: " & PROP()

MyMail.body = "Attached please find Affidavit Package for " & PROP()
MyMail.Attachments.ADD pathuser() & VName1 & ".doc"
If Client() Like "JP*" Then

MyMail.Attachments.ADD ("\\rvdv-fs01\datatransfer\Attachments\ChaseLMAAttachment.PDF")
End If


MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & VName1 & ".doc"


End Function

Public Function AffsEmailWord()

Dim oapp As Word.Application
Dim oDoc As Word.document

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VClientID = Forms![foreclosure database screen]!Client_id
End If

'Aff Cert Ownership
VTypeMerge = "AffCertOwn"
Call FCMerge
Set oapp = CreateObject("word.application")

'Aff Cert

If Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPOWB.doc", , , True)
''Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPOWB.doc", "Word.Document")
ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPCITI.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then

If Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCert-OcwenHomeward.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipOCWENFHLMC.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipOCWENFNMA.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipOCWEN.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPWells.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ever*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipClientEverhome.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipBAC.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "JP*" Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChaseFNMA.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChaseFHLMC.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChase.doc", , , True)
End If


Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIP.doc", , , True)
''Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnership.doc", "Word.Document")
End If
If Forms![foreclosure database screen]!Client Like "Wells*" Then
VName1 = "Bierman MDPROJ(1)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
Else
VName1 = Forms![foreclosure database screen]!filenum & "_AffCertOwn_" & (Format$(Now(), "mmddyyhhnnss"))
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


'Aff Default

VTypeMerge = "AffDefault"
Call FCMerge

Set oapp = CreateObject("word.application")
If Forms![foreclosure database screen]!Client Like "Wells*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultWells.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultClientSignsCITI.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ever*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultEVERHOME.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultBAC.doc", , , True)

Else
Dim VSel
VSel = InputBox("1. BWW Sends" & vbCr & "2. Client Sends")
If VSel = 1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultBGWWSends.doc", , , True)


ElseIf VSel = 2 Then
If Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then
MsgBox ("There are 2 separate Affidavits for OneWest Bank.  They will BOTH merge now")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultOWB.doc", , , True)
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultMailingOWB.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefault-OcwenHomeward.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultOcwen.doc", , , True)
End If

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDefaultClientSigns.doc", , , True)


End If
End If
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then
Vname2 = "Bierman MDPROJ(2)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
Else
Vname2 = Forms![foreclosure database screen]!filenum & "_AffDefault_" & (Format$(Now(), "mmddyyhhnnss"))
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & Vname2 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing



'DOA
VTypeMerge = "DOA"
Call DOAMerge
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!PropertyState = "VA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterVA.doc", , , True)
Else
If Forms![foreclosure database screen]!Client Like "Seter*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterSeterus.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterChase.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!Propertycounty = "Baltimore City" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterOcwenBaltCityONLY.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMasterOcwen.doc", , , True)
End If
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\DOAMaster.doc", , , True)
End If

End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VName3 = "Bierman MDPROJ(3)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
Else
VName3 = Forms![foreclosure database screen]!filenum & "_DOA_" & (Format$(Now(), "mmddyyhhnnss"))
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName3 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing
'FLMA
VTypeMerge = "FLMA"
Call FCMerge
Set oapp = CreateObject("word.application")

If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMANoCaption.doc", , , True)

ElseIf Client() Like "JP*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMANoCaptionChase.doc", , , True)

ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMACitiFin.doc", , , True)


Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMA.doc", , , True)
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
If Forms![foreclosure database screen]!Client Like "Wells*" Then
VName4 = "Bierman MDPROJ(4)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
Else
VName4 = Forms![foreclosure database screen]!filenum & "_FLMA_" & (Format$(Now(), "mmddyyhhnnss"))
End If
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName4 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing
End With

'PLMA
VTypeMerge = "PLMA"
Call FCMerge
Set oapp = CreateObject("word.application")
If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMANoCaption.doc", , , True)
ElseIf Client() Like "JP*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMANoCaptionChase.doc", , , True)
ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMACitiFin.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMA.doc", , , True)
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
If Forms![foreclosure database screen]!Client Like "Wells*" Then
VName5 = "Bierman MDPROJ(4)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
Else
VName5 = Forms![foreclosure database screen]!filenum & "_PLMA_" & (Format$(Now(), "mmddyyhhnnss"))
End If
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName5 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing
End With





Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.To = "doc.execution@wellsfargo.com"
Else
MyMail.To = ""
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "Bierman: MD PROJ (4)-" & VClientID & " - " & Forms![foreclosure database screen]!ClientRefNumber
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If

MyMail.body = "Attached please find Affidavits for " & PROP()
MyMail.Attachments.ADD pathuser() & VName1 & ".doc"
MyMail.Attachments.ADD pathuser() & Vname2 & ".doc"
MyMail.Attachments.ADD pathuser() & VName3 & ".doc"
MyMail.Attachments.ADD pathuser() & VName4 & ".doc"
MyMail.Attachments.ADD pathuser() & VName5 & ".doc"



If Forms![foreclosure database screen]!Client Like "JP*" Then
MyMail.Attachments.ADD ("\\rvdv-fs01\datatransfer\Attachments\ChaseLMAAttachment.PDF")
End If

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & VName1 & ".doc"

Kill pathuser() & Vname2 & ".doc"
Kill pathuser() & VName3 & ".doc"
Kill pathuser() & VName4 & ".doc"
Kill pathuser() & VName5 & ".doc"

End Function

Public Function AffsEmailWordALLSEND()

Dim oapp As Word.Application
Dim oDoc As Word.document



Call FCMerge
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VTypeMerge = "AffsALLWells"
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllwells.doc", , , True)
VName1 = "Bierman MDPROJ(1)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

Else
VTypeMerge = "AffsALL"
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAll.doc", , , True)
VName1 = "Affidavits-" & Forms![foreclosure database screen]!filenum & "-" & Forms![foreclosure database screen]!ClientRefNumber


End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs "\\rvdv-fs01\datatransfer\MergeDocs\Suntrust\" & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

If Forms![foreclosure database screen]!Client Like "wells*" Then
MyMail.To = "doc.execution@wellsfargo.com"
Else
MyMail.To = "Nacole.Mason@Suntrust.com; carrie.ward@bww-law.com"
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "Bierman: MD PROJ (4)-" & VClientID & " - " & Forms![foreclosure database screen]!ClientRefNumber
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Affidavits for " & PROP()
MyMail.Attachments.ADD "\\rvdv-fs01\datatransfer\Mergedocs\Suntrust\" & VName1 & ".doc"

MyMail.Send
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
'Kill pathuser()& VName1 & ".doc"

End Function
Public Function AffsWordALL()


Dim oapp As Word.Application
Dim oDoc As Word.document


Call FCMerge
Set oapp = CreateObject("word.application")

Dim VSel
VTypeMerge = "AffsALL"

If Forms![foreclosure database screen]!Client Like "Nations*" Then
VSel = InputBox("1. SOT" & vbCr & "2. Aff Cert Ownership" & vbCr & "3. Aff Default" & vbCr & "4. Affidavit Debt w/figures" & vbCr & "5. Affidavit Debt Blank" & vbCr & "6. Prelim/Final LMA together" & vbCr & "7. Final LMA Only" & vbCr & "8. Prelim LMA Only")
If VSel = 1 Then
Call RunDOAMaryland
ElseIf VSel = 2 Then
Call RunAffCertOwnership
ElseIf VSel = 3 Then
Call RunAffDefault
ElseIf VSel = 4 Then
Call AFFDEBTMONIES
Exit Function
ElseIf VSel = 5 Then
Call AffDebtBlank
ElseIf VSel = 6 Then
Call AffPkgONLY
ElseIf VSel = 7 Then
Call RunFLMA
ElseIf VSel = 8 Then
Call RunLMA

End If




Else


VSel = InputBox("1. BWW Sends" & vbCr & "2. Client Sends")


If VSel = 1 Then
If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWWNoCaption.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWW.doc", , , True)
End If

ElseIf VSel = 2 Then

If Forms![foreclosure database screen]!Client Like "CitiM*" Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllCITI.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then

MsgBox ("OWB Not a FF File, 2 Affs are included in Doc.")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllOWB.doc", , , True)

Else
If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllClientSignsNoCaption.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllClientSigns.doc", , , True)
End If

End If
End If




VName1 = "Affidavits-" & Forms![foreclosure database screen]!filenum & "-" & Forms![foreclosure database screen]!ClientRefNumber


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = True

Call CoverPage


End If


'"\\rvdv-fs01\datatransfer\Mergedocs\" & VName1 & ".doc"


'Delete
'Kill "\\rvdv-fs01\datatransfer\Mergedocs\" & VName1 & ".doc"

End Function
Public Function AffsEmailWordALLWells2()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

GblFilenum = Forms![foreclosure database screen]!filenum
VClientID = Forms![foreclosure database screen]!Client_id
VTypeMerge = "AffsALLWells"

strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)

If Forms![foreclosure database screen]!Client Like "Wells*" And _
(IsNull(rsFC![Occupied]) Or rsFC![Occupied] = 0) Then
MsgBox ("Occupied box is not checked will not merge!")
rsFC.Close

Exit Function

Else


Call FCMerge
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllWells2.docx", , , True)
VName1 = "Bierman MDPROJ(4)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing

Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "doc.execution@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW MD 1st legal package (4)"
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Affidavits for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & VName1 & ".doc"



MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & VName1 & ".doc"

End If

End Function

Public Function AffsEmailWordALL()

Dim oapp As Word.Application
Dim oDoc As Word.document


Call FCMerge
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!Client Like "Wells*" Then
VTypeMerge = "AffsALLWells"
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllwells.doc", , , True)
VName1 = "Bierman MDPROJ(1)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

ElseIf Forms![foreclosure database screen]!Client Like "Ever*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllEverhome.doc", , , True)
VName1 = "Affidavits-" & Forms![foreclosure database screen]!filenum & "-" & Forms![foreclosure database screen]!ClientRefNumber

ElseIf Forms![foreclosure database screen]!Client Like "JPM*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllChase.doc", , , True)
VName1 = "Affidavits-" & Forms![foreclosure database screen]!filenum & "-" & Forms![foreclosure database screen]!ClientRefNumber

ElseIf Forms![foreclosure database screen]!Client Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWWNoCaptionBAC.doc", , , True)

Else



Dim VSel
VTypeMerge = "AffsALL"

VSel = InputBox("1. BWW Sends" & vbCr & "2. Client Sends")
If VSel = 1 Then

If Forms![foreclosure database screen]!Client Like "Ocwen*" And (IsNull(Forms![foreclosure database screen]!prime_nonprime) Or Forms![foreclosure database screen]!prime_nonprime <> 1) Then
Call AFFDEBTMONIES

If Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWWOcwenFHLMC.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWWOcwen.doc", , , True)
End If

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllBWW.doc", , , True)
End If


ElseIf VSel = 2 Then

If Forms![foreclosure database screen]!Client Like "CitiM*" Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllCITI.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then

MsgBox ("OWB Not a FF File, 2 Affs are included in Doc.")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllOWB.doc", , , True)

Else

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllClientSigns.doc", , , True)


End If
End If



VName1 = "Affidavits-" & Forms![foreclosure database screen]!filenum & "-" & Forms![foreclosure database screen]!ClientRefNumber


End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)

If Forms![foreclosure database screen]!Client Like "wells*" Then
MyMail.To = "doc.execution@wellsfargo.com"
Else
MyMail.To = ""
End If

If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "Bierman: MD PROJ (4)-" & VClientID & " - " & Forms![foreclosure database screen]!ClientRefNumber
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Affidavits for " & PROP()
MyMail.Attachments.ADD pathuser() & VName1 & ".doc"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & VName1 & ".doc"

End Function
Public Function AffsEmailWordALLWells()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

VClientID = Forms![foreclosure database screen]!Client_id
VTypeMerge = "AffsALLWells"

strsqlfc = "Select * from fctracking where filenum = " & GblFilenum & ";"
Set rsFC = CurrentDb.OpenRecordset(strsqlfc, dbOpenSnapshot)

If Forms![foreclosure database screen]!Client Like "Wells*" And _
(IsNull(rsFC![Occupied]) Or rsFC![Occupied] = 0) Then
MsgBox ("Occupied box is not checked will not merge!")
rsFC.Close

Exit Function

Else


Call FCMerge
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffsAllWells.doc", , , True)
VName1 = "Bierman MDPROJ(4)" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & VName1 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing

Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "doc.execution@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW MD 1st legal package (4)"
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Affidavits for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & VName1 & ".doc"
'MyMail.Attachments.ADD pathuser()& VName2 & ".doc"

'If BrowseFLDRRDOT() = "" Then

'Else
'VRDOT = BrowseFLDRRDOT()
'VNameRDOT = "Bierman MDPROJ()" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber
'sourcefile = VRDOT
'Destinationfile = "\\rvdv-fs01\datatransfer\Mergedocs\" & VNameRDOT & ".pdf"
'FileCopy sourcefile, Destinationfile    ' Copy source to target.
'MyMail.Attachments.ADD "\\rvdv-fs01\datatransfer\Mergedocs\" & VNameRDOT & ".pdf"
'Kill "\\rvdv-fs01\datatransfer\Mergedocs\" & VNameRDOT & ".pdf"
'End If


MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & VName1 & ".doc"

End If

End Function
Public Function FLMAWells()
Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

VClientID = Forms![foreclosure database screen]!Client_id

Call FCMerge
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\FinalLMAWELLS2.doc", , , True)
Vname2 = "ATY-MD-BIE-" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & Vname2 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "doc.execution@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW Final MD 1st legal"
Else
MyMail.Subject = "Affidavit for: " & PROP()
End If
MyMail.body = "Attached please find Final LMA for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & Vname2 & ".doc"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & Vname2 & ".doc"

End Function
Public Function AffDebtEmailWells5()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

VClientID = Forms![foreclosure database screen]!Client_id

Call ADMerge
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Wells5.doc", , , True)
Vname2 = "ATY-MD-BIE-" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "admerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & Vname2 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "judgment.affidavit@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW MD Aff Debt"
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Aff Debt for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & Vname2 & ".doc"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & Vname2 & ".doc"

End Function

Public Function AffDebtEmailWells4()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

VClientID = Forms![foreclosure database screen]!Client_id

Call ADMerge
Set oapp = CreateObject("word.application")
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Wells4.doc", , , True)
Vname2 = "ATY-MD-BIE-" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "admerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & Vname2 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "judgment.affidavit@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW MD Aff Debt"
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Aff Debt for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & Vname2 & ".doc"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & Vname2 & ".doc"

End Function

Public Function AffDebtEmailWells()

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim VRDOT
Dim VNameRDOT

VClientID = Forms![foreclosure database screen]!Client_id

Call ADMerge
Set oapp = CreateObject("word.application")
If Forms![foreclosure database screen]!Client Like "Nations*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Monies.doc", , , True)

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffDebt-Wells1.doc", , , True)
End If

Vname2 = "ATY-MD-BIE-" & VClientID & "-" & Forms![foreclosure database screen]!ClientRefNumber

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "admerge.txt"
End With
With oDoc.MailMerge
.destination = wdSendToNewDocument
.Execute Pause:=False
End With
oDoc.Close False
oapp.ActiveDocument.SaveAs pathuser() & Vname2 & ".doc"
oapp.Visible = False
oapp.ActiveDocument.Close
oapp.Quit
Set oDoc = Nothing
Set oapp = Nothing


Dim emailmessage As String
Dim from, varemailto, varsendemail As String
Dim MyOutlook As Outlook.Application
Dim MyMail As Outlook.MailItem
Set MyOutlook = New Outlook.Application
Set MyMail = MyOutlook.CreateItem(olMailItem)
MyMail.To = "judgment.affidavit@wellsfargo.com"
If Forms![foreclosure database screen]!Client Like "Wells*" Then
MyMail.Subject = "BWW MD Aff Debt"
Else
MyMail.Subject = "Affidavits for: " & PROP()
End If
MyMail.body = "Attached please find Aff Debt for Loan#: " & Forms![foreclosure database screen]!ClientRefNumber & vbCr & "Property: " & PROP()
MyMail.Attachments.ADD pathuser() & Vname2 & ".doc"

MyMail.Display
Set MyMail = Nothing
Set MyOutlook = Nothing

'Delete
Kill pathuser() & Vname2 & ".doc"

End Function
Public Function RunMilAffCheck()
'MilitaryChecklist.doc
VTypeMerge = "MilAffCheck"

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")


Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\MilitaryChecklist.doc")


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim VSelect2
VSelect2 = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If VSelect2 = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End Function
Public Function RunMilAff()
VTypeMerge = "MilAff"


Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!Client Like "CitiMor*" Or _
Forms![foreclosure database screen]!Client Like "Specialized*" Or _
(Forms![foreclosure database screen]!Client Like "Ocwen*" And _
(IsNull(Forms![foreclosure database screen]!prime_nonprime) Or _
Forms![foreclosure database screen]!prime_nonprime <> 1)) Then
'Call FCMerge
Call FCMergeMultiBorrow

If Forms![foreclosure database screen]!Client Like "CitiMor*" Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiMilAffSPFannieFreddie.doc", , , True)
'CitiAffDebtSPFannieFreddie
'CitiPLMASPFannieFreddie
ElseIf Forms![foreclosure database screen]!Asc_wff = 2 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiMilAffSPCMI.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiMilAffSPCB-CF-OMonly.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Specialized*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSAffSCRA.doc", , , True)

Else
If Forms![foreclosure database screen]!TypeOfLoan = "CONV" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\OcwenMilitaryAffidavit-NonFNMA-FHLMC.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\OcwenMilitaryAffidavit.doc", , , True)
End If

End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else
MsgBox ("Military Affidavit not in merge documents for : " & Forms![foreclosure database screen]!Client)


End If


End Function
Public Function RunAffCertOwnership()
VTypeMerge = "AffCertOwn"

Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Forms![foreclosure database screen]!Client Like "OneWe*" And _
(Forms![foreclosure database screen]!FF = 0 Or IsNull(Forms![foreclosure database screen]!FF)) Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPOWB.doc", , , True)
''Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPOWB.doc", "Word.Document")

ElseIf Forms![foreclosure database screen]!Client Like "CitiM*" Then
If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiACO-NonCMISP.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiACO-NonCMISP.doc", , , True)
ElseIf Forms![foreclosure database screen]!SPsameasCl = -1 Or Forms![foreclosure database screen]!SPsameasCl = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiACO.doc", , , True)
Else

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiACO-NonCMISP.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Specialized L*" Then
'SLSAffCertGSA
If Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSAffCertGSE.doc", , , True)
Else

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSAffCert.doc", , , True)
End If


ElseIf Forms![foreclosure database screen]!Client Like "Wells*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIPWells.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ever*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipClientEverhome.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Bank of A*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipBAC.doc", , , True)
ElseIf Forms![foreclosure database screen]!Client Like "Ocwen*" Then
If Forms![foreclosure database screen]!prime_nonprime = 1 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCert-OcwenHomeward.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipOCWENFHLMC.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipOCWEN.doc", , , True)
End If
ElseIf Forms![foreclosure database screen]!Client Like "JP*" Then

If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChaseFNMA.doc", , , True)
ElseIf Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChaseFHLMC.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnershipChase.doc", , , True)
End If

Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\AffCERTOWNERSHIP.doc", , , True)
''Set oDoc = GetObject("\\rvdv-fs01\DataTransfer\Templates\FC\AffCertOwnership.doc", "Word.Document")
End If

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

'Call CoverPage


End Function
Public Function RunLMA()
If Client() Like "Ocwen*" Then
MsgBox ("Ocwen files use the database version of the Prelim.  Will not generate Word Merge")
Exit Function

Else

VTypeMerge = "PLMA"
Call FCMerge

Dim oapp As Word.Application
Dim oDoc As Word.document
Dim oMMDoc As Word.document
Set oapp = CreateObject("word.application")

If Client() Like "Bank of*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMANoCaption.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Specialized L*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SLSPLMA.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "Nationstar*" Then
If Forms![foreclosure database screen]!SPsameasCl = 1 Or Forms![foreclosure database screen]!SPsameasCl = -1 Then

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Nstar_PLMAisSP.docx", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\Nstar_PLMANotSP.docx", , , True)
End If

ElseIf Forms![foreclosure database screen]!Client Like "Select Por*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\SPSPLMA.doc", , , True)

ElseIf Client() Like "JP*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMANoCaptionChase.doc", , , True)

ElseIf Forms![foreclosure database screen]!Client Like "CitiMor*" Then
If Forms![foreclosure database screen]!TypeOfLoan = "FNMA" Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiPLMASPFannieFreddie.doc", , , True)
ElseIf Forms![foreclosure database screen]!Asc_wff = 2 Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiPLMASPCMI.doc", , , True)
Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\CitiPLMASPCB-CF-OMonly.doc", , , True)
End If

ElseIf Forms![foreclosure database screen]!servicer Like "OneM*" Or Forms![foreclosure database screen]!servicer Like "CitiFin*" Then
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMACitiFin.doc", , , True)


Else
Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\FC\PrelimLMA.doc", , , True)
End If


With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

Dim Vselect
Vselect = InputBox("1. Word Doc" & vbCr & "2. PDF" & vbCr & vbCr & "input 1 or 2")

If Vselect = 1 Then
With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

Else

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = False
End With
Call WordMerge2PDF(oapp)
End If



End If


End Function
Public Function RunDeedVAMerge()
Call ExportDeedVAdata

'DoCmd.RunMacro "ExportDeedVA"
DoCmd.TransferText acExportDelim, , "doamerge", pathuser() & "deedva.txt", True


Dim oapp As Word.Application
Dim oDoc As Word.document
Set oapp = CreateObject("word.application")

Set oDoc = oapp.Documents.ADD("\\rvdv-fs01\DataTransfer\Templates\DeedVAMaster.doc", , , True)

With oDoc.MailMerge
.MainDocumentType = wdFormLetters
.OpenDataSource name:=pathuser() & "fcmerge.txt"
End With

With oDoc.MailMerge
.destination = wdSendToNewDocument '; wdSendToFax; wdSendToEmail wdSendToPrinter
.Execute Pause:=False
oDoc.Close False
oapp.Visible = True
End With

End Function

Public Function RunREM()
Call BkMerge
'DoCmd.RunMacro ("exportbkmerge")
DoCmd.TransferText acExportDelim, , "bkmerge", pathuser() & "bkmerge.txt", True

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

oDoc = "IN REM MFR-MD.doc"


Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "bkmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges


End Function
Public Function RunMotionPossMD()

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\Eviction\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
Call EvicMergeMD

oDoc = "EvicMotionPossMD.doc"

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "evicmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function

Public Function RunDOA()

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\BK\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
Call DOAMerge

oDoc = "RICHMONDDOA.doc"

'DoCmd.RunMacro "fcmerge"

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

Call CoverPage

End Function
Public Function RunFredPT()
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

VTypeMerge = "FREDPT"

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form!dprepared_by_date) Then
MsgBox ("Deed needs to be prepared, exiting will not preview/print Frederick Property Transfer merge")
Exit Function

Else
AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
Call FCMerge

oDoc = "FrederickPropertyTransfer.doc"


'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End If

End Function


Public Function RunDeedHUD()

Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath

AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String
Call DeedMerge

oDoc = "Deed-Trustees-HUD.doc"

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges

End Function
Public Function RunDeedQC()
Dim wrdMailMerge As Word.MailMerge
Dim WrdDataDoc
Dim WrdApp
Dim AppPath
VTypeMerge = "DeedQC"

AppPath = "\\rvdv-fs01\datatransfer\Templates\FC\Virginia\"

'Open word New document
Set WrdApp = CreateObject("Word.Application")
WrdApp.Visible = True

'Document Selection
Dim oDoc As String

Call DeedMerge

oDoc = "Deed-QuitClaim.doc"
'MsgBox (PathUSER())

'Locate the template file
Set wrddoc = WrdApp.Documents.Open(AppPath & oDoc)
wrddoc.MailMerge.OpenDataSource (pathuser() & "\fcmerge.txt")
Set wrdMailMerge = wrddoc.MailMerge
wrdMailMerge.destination = wdSendToNewDocument
' --- Perform MAIL MERGE --- '
wrdMailMerge.Execute True

wrddoc.Close wdDoNotSaveChanges
End Function

Public Function RunFAMMerge()

Dim rs, rsFAm As RecordSet
Dim Vinitial, strsql, VProp2, VProp3, VProp As String

Vinitial = Environ("username")
CurrentDb.Execute "Delete * from FamMerge;", dbFailOnError

strsql = "Select Employees.FirstName, Employees.MiddleName, " _
& "Employees.LastName, Employees.Title, employees.emailname " _
& "from Employees WHERE Employees.login = " & """" & Vinitial & """" & ";"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsFAm = CurrentDb.OpenRecordset("FAMMerge", dbOpenDynaset, dbSeeChanges)
VProp2 = propadd2()
VProp3 = propadd3()

With rsFAm
.AddNew
!filenum = Forms![foreclosure database screen]![filenum]

If VProp3 = "" Then
!PROP = propadd()
!prop2 = VProp2
Else
!PROP = propadd() & ", " & VProp2
!prop2 = VProp3
End If

!Client = Client()




!ClientRefNumber = Forms![foreclosure database screen]!ClientRefNumber
!contact = rs!FirstName & " " & rs!LastName
!Email = rs!EmailName
!SaleDate = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!SaleDate, "mmmm dd, yyyy")
.Update
.Close

End With


DoCmd.RunMacro "ExportFAM"
DoCmd.TransferText acExportDelim, , "fammerge", pathuser() & "fam.txt", True

Dim oDoc As Word.document
Set oDoc = GetObject("F:\FAmUnderwritingReq.doc", "Word.Document")
oDoc.Application.Visible = True
oDoc.MailMerge.OpenDataSource _
name:=pathuser() & "\FAm.txt"
oDoc.MailMerge.Execute

End Function
Public Function ExportDeedVAdata()
CurrentDb.Execute "Delete * from DOAMerge;", dbFailOnError

Dim PrtOut, VarFileNo, VarNWAMU1, VarNWAMU2, VarNWamuInput, VarNWAMU3, VarNWAMU4, VarNWAMU5, VarNWAMU6 As String
Dim VarNotBody1, VarNotBody2, VarNotBody3 As String
Dim rs, rsDOA As RecordSet
Dim strsql, VarParty1, VarSecuredParty, VarSigns As String

'VarFileNo = Forms![foreclosure database screen]![FileNum]

strsql = "SELECT DBA_viewPart1.* from DBA_viewPart1 WHERE (((DBA_viewPart1.FileNum)= " & Forms![foreclosure database screen]![filenum] & "));"

Set rs = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)

Set rsDOA = CurrentDb.OpenRecordset("DOAMerge", dbOpenDynaset, dbSeeChanges)

With rsDOA
.AddNew
!filenum = Forms![foreclosure database screen]![filenum]
!Debtors = debtorsOPEN()
!fid_no = rs!fid_no
!longsecured = rs!longsecured
!Client = rs!Client
!taxid = varTaxID()

If Client() = "JPMorgan Chase Bank, National Association" Or Client() = "washington mutual bank" Or rs![Fmortgage] = -1 Then
VarParty1 = ""
Else
If Client() Like "Citi*" Then
VarSecuredParty = "THE LENDER"
Else
VarSecuredParty = rs!SecuredParty
End If
VarParty1 = " (" & """" & VarSecuredParty & """" & "),"
End If
!party1stpart = rs!longsecured & VarParty1

!AttorneyAddress = "6003 Executive Blvd., Suite 101, Rockville, MD 20852"

If rs![Propertycounty] = "Baltimore City" Then
!Propertycounty = "Baltimore City,"
Else
!Propertycounty = rs![Propertycounty] & " County,"
End If

!liberfolio = liberfolio()

!DOTDate = rs!DOTDate
!dotrecd = rs![dot recorded]
!legal = rs!LegalDescription
!PROP = PROP()
!OrgLender = rs!OrgLender
!OrgAmount = rs!OrgAmount
!orgtrustee = rs!orgtrustee
!Attorneys = Part1Trustees()

If Forms![foreclosure database screen]!ForeclosureSubForm.Form![Mortgage] = 0 Then
var1 = "SUBSTITUTE TRUSTEE'S DEED (" & """" & "Deed" & """" & "), is made this _______ day of ______________, 20__, by and between EQUITY TRUSTEES, LLC, a Virginia Limited Liability Company, Substitute Trustees under a "
End If
If Forms![foreclosure database screen]!ForeclosureSubForm.Form![Mortgage] = -1 Then
var2 = "Mortgage"
Else
var2 = "Deed of Trust"
End If
var3 = " from " & debtorsCAPS() & ",  securing the below described property, GRANTOR, and "
If Forms![foreclosure database screen]!PostsaleSubForm.Form![Buyer] = "REO" Then
var4 = Trim(UCase(LSecured())) & " (" & """" & " & """" & Trim(UCase([SecuredParty])) & """" & " & """" & "),"
Else
var4 = Purchaser() & ", " & purchaseradd()
End If

If Forms![foreclosure database screen]!PostsaleSubForm.Form![Buyer] Like "Federal Home*" Then
var5 = " (" & """" & "Freddie Mac" & """" & ")"
ElseIf Forms![foreclosure database screen]!PostsaleSubForm.Form![Buyer] Like "Federal National*" Then
var5 = " (" & """" & "FNMA" & """" & ") "
Else
var5 = ""
End If

var6 = " the High Bidder, GRANTEE."
!para1 = var1 + var2 + var3 + var4 + var5 + var6
!VATitleCo = VATitleCo()


If rs![SPsameasCl] = No Then

If Client() Like "Citi*" Then
VarNWAMU1 = "THE LENDER"
Else
VarNWAMU1 = UCase(rs![SecuredParty])
End If

Else

If Client() = "Ocwen Loan Servicing, LLC" Then
VarNWAMU1 = UCase(rs![SecuredParty])
Else
VarNWAMU1 = UCase(Client())
End If
End If


If Client() Like "Citi*" Or Client() Like "OneWest*" Then
VarNWamuInput = ", attorney-in-fact, by "
Else
VarNWamuInput = ", its authorized Servicing Agent, by "
End If

If rs![SPsameasCl] = No Then
VarNWAMU2 = UCase(Client()) & VarNWamuInput
Else
VarNWAMU2 = ""
End If

If rs![attSign2] <> "" Then
VarNWAMU3 = rs![doaSign1] & ", " & rs![Title1] & " and attested to by " & rs![attSign2] & ", " & rs![Title2]

Else

If rs![doaSign1] <> "" Then
VarNWAMU3 = rs![doaSign1] & ", " & rs![Title1]

Else

VarNWAMU3 = "______________________, its ___________________"
End If
End If

If IsNull(rs!attSign2) Then
VarNWAMU4 = " which individual the said "
Else
VarNWAMU4 = " which individuals the said "
End If

If rs![SPsameasCl] = No Then

If Client() Like "Citi*" Then
VarNWAMU5 = "LENDER"
Else
VarNWAMU5 = UCase(rs![SecuredParty])
End If

Else

If Client() Like "Ocwen*" Then
VarNWAMU5 = rs![SecuredParty]
Else
VarNWAMU5 = UCase(Client())
End If
End If

If IsNull(rs!attSign2) Then
VarNWAMU6 = " has appointed as the party with proper authority so to act for the purposes contained herein."
Else
VarNWAMU6 = " has appointed as the parties with proper authority so to act for the purposes contained herein."
End If

!VarSigns1 = VarNWAMU1 + VarNWAMU2 + VarNWAMU3
!varsigns2 = VarNWAMU4 + VarNWAMU5 + VarNWAMU6 + " "

!doasign = rs!doaSign1
!signatureblock = rs![signature block]
!attSign2 = rs!attSign2
!Title = rs!Title1
!Title2 = rs!Title2

If rs![Fmortgage] = -1 Then
!Signature2 = ""

Else

If Client() Like "Citi*" Or Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
!Signature2 = ""
Else
If rs![SPsameasCl] = 0 Or IsNull(rs!SPsameasCl) Then
!Signature2 = "By:  " & UCase(Client())
End If
End If
End If

If Client() = "BankUnited" Then
!signatureline = "Fran Vater"
ElseIf Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
!signatureline = "Title:___________________________________"
Else
!signatureline = rs!doaSign1
End If

!ClientState = UCase(rs!State)
!clientcounty = UCase(rs!County)
!dateyear = "20__"


If rs![Fmortgage] = -1 Then
VarNotBody1 = " of " & rs![longsecured]
Else
If Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
VarNotBody1 = ""
Else
VarNotBody1 = " of " & UCase(Client())
End If
End If

If rs![SPsameasCl] = No Then
If Client() Like "Citi*" Or Client() Like "OneWest*" Then
VarNotBody2 = ", attorney-in-fact for "
ElseIf Client() = "JPMorgan Chase Bank, National Association" Or Client() = "Washington Mutual Bank" Then
VarNotBody2 = ", servicing agent for "
Else
VarNotBody2 = ", servicer/agent for "
End If
End If

If Client() Like "Citi*" Then
VarNotBody3 = "the above referenced secured party"
Else
VarNotBody3 = UCase(rs![longsecured])
End If

!notarybody = VarNotBody1 + VarNotBody2 + VarNotBody3

If rs![attSign2] <> "" Then
If Client() = "BankUnited" Then
!notarybox = "Fran Vater, Vice President"
Else
!notarybox = rs![doaSign1] & ", " & rs![Title1] & " and " & rs![attSign2] & ", " & rs![Title2]
End If

Else

If rs![doaSign1] <> "" Then
If Client() = "BankUnited" Then
!notarybox = "Fran Vater, Vice President"
Else
!notarybox = rs![doaSign1] & ", " & rs![Title1]
End If

Else

!notarybox = "______________________, its ___________________"
End If
End If


.Update
End With




'Call RunDOAMerge



End Function

Public Function OwnersOnly()

Call Owner1AllFields
Call Owner2AllFields
Call Owner3AllFields

End Function

Public Function DeedMerge()
 

CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError

Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim rsClient As RecordSet
Dim strsqlClient As String

strsqlClient = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)
GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim VDate
Dim vtrustee

With rs
.AddNew
!filenum = Forms![foreclosure database screen]!filenum

Dim Vproc
Vproc = "NO"
Dim vInitials
Dim rsEmp As RecordSet
Dim strsqlEmp As String

Do While Vproc <> "YES"
If VTypeMerge = "DeedQC" Then
vInitials = Environ("username")
Else
vInitials = Environ("username")
End If

strsqlEmp = "select * from employees where login = " & """" & vInitials & """" & ";"
Set rsEmp = CurrentDb.OpenRecordset(strsqlEmp, dbOpenSnapshot)

If rsEmp.EOF Then
MsgBox ("Login not in Foreclosure employee table")
Else

Vproc = "YES"
If Not IsNull(rsEmp!MiddleName) Then
!Attorney = rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName
!attorneycap = UCase(rsEmp!FirstName & " " & rsEmp!MiddleName & " " & rsEmp!LastName)
!attorneybar = rsEmp![VSB#]
Else
!Attorney = rsEmp!FirstName & " " & rsEmp!LastName
!attorneycap = UCase(rsEmp!FirstName & " " & rsEmp!LastName)
!attorneybar = rsEmp![VSB#]

End If
End If
Loop

rsEmp.Close

![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()
!ClientAdd = ClientAdd()


If Forms![foreclosure database screen]!ForeclosureSubForm.Form!Mortgage = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form!Mortgage = 1 Then
!captionheader = UCase("Trustee's Deed")
!DeedType = "Trustee"
!DeedDOA = "Decree"
!deedmort = "Mortgage"

If Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = 1 Then
!mortlang2 = ", subject to the outstanding balance on a prior Mortgage"
End If

Else
!captionheader = UCase("Substitute Trustee's Deed")
!DeedType = "Substitute Trustee"
!DeedDOA = "Appointment of Substitute Trustee"
!deedmort = "Deed of Trust"
If Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = -1 Or _
Forms![foreclosure database screen]!ForeclosureSubForm.Form![2mortgage] = 1 Then
!mortlang2 = ", subject to the outstanding balance on a prior Deed of Trust"
End If

End If

If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice]) Then
!SalePrice = "___________________"
Else
!SalePrice = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form![SalePrice], "$###,##0.00")
End If

If Forms![foreclosure database screen]!PropertyState = "MD" Then
If IsNull(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD) Then
!ratdate = "______________"
Else
!ratdate = Format(Forms![foreclosure database screen]!PostsaleSubForm.Form!RatDateMD, "mmmm dd, yyyy")
End If
End If

!Purchaser = DeedPurchaser()
!longsecured = LSecured()
!liberfolio = liberfolio()
!taxid = varTaxID()
!OrgAmount = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount
!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!dateyear = "20__"
'!taxid = Forms![foreclosure database screen]!PostsaleSubForm.Form!taxid
!dotrecorded = Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded]
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
!Property = PROP()
!Client = Forms![foreclosure database screen]!Client
!Propertycounty = County()
!Borrowers = debtorsFORE()
!LegalDescription = Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription
!ClientRefNumber = Forms![foreclosure database screen]!ClientRefNumber

If Client() Like "Seter*" Then
VarParty1 = "Federal National Mortgage Association (" & """" & "FNMA" & """" & ")"
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] Like "FHA*" Or _
Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
VarParty1 = LoanInvestor()
Else
VarParty1 = UCase(LSecured())
End If

If [Forms]![foreclosure database screen]![Client] = "washington mutual bank" Or _
Forms![foreclosure database screen]![Fmortgage] = -1 Or _
[Forms]![foreclosure database screen]![SPsigns] = -1 Then
VarParty2 = ""
ElseIf Forms![foreclosure database screen]![SecuredParty] = "" Or _
IsNull(Forms![foreclosure database screen]![SecuredParty]) Then
VarParty2 = ""
Else
VarParty2 = " (" & """" & Trim(UCase(Forms![foreclosure database screen]![SecuredParty])) & """" & ")"
End If

!party1stpart = VarParty1 & VarParty2

Dim VWit2
Dim VWit3

If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then
VWit2 = " by its duly authorized agent on ______ day of _____________, 20__"
ElseIf Client() Like "HomEq*" Then
VWit2 = ", by Assistant Secretary of " & Forms![foreclosure database screen]![signature block] & " on ______ day of _____________, 20__"
ElseIf Client() Like "Wells*" Then
VWit2 = ", by the authorized agent of " & Client() & " on ______ day of _____________, 20__"
ElseIf Client() Like "One*" Then
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, ______"
Else
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, 20__"
End If

!inwitness = VarParty1 & "has caused this Appointment of Substitute Trustee to be executed " & VWit2 & VWit3 & "."

'MsgBox (VarParty1 & "has caused this Appointment of Substitute Trustee to be executed " & VWit2 & VWit3 & ".")


!modification = modification()

'!VarSigns1 = VarNWAMU1 + VarNWAMU2 + VarNWAMU3
'!varsigns2 = VarNWAMU4 + VarNWAMU5 + VarNWAMU6 + " "
!SecuredParty = Forms![foreclosure database screen]!longsecured

!doasign = rsClient!doaSign1
!signatureblock = Forms![foreclosure database screen]![signature block]
!attSign2 = rsClient!attSign2
!inwitness = DeedPurchaserSign()

'!Title2 = rsclient!Title2

If Client() Like "Seter*" Then
!signature = "Federal National Mortgage Association"
Else
!signature = PartOneSignature1()
End If

If Client() Like "Seter*" Then
!Signature2 = "By: IBM Lender Business Process Services, Inc., as Attorney-in-Fact"
Else
!Signature2 = PartOneSignature2()
End If

!signatureline = PartOneSignature3()
!Title = PartOneSignature4()

!ClientState = UCase(rsClient!State)
!clientcounty = UCase(rsClient!County)

If attorneysigns2() <> "" Then
!attorneysigns = attorneysigns() & ", " & attorneysigns2() & " and " & rs![Attorneys Company Name]
Else
!attorneysigns = attorneysigns() & " and " & rs![Attorneys Company Name]
End If

Dim VNotary1, VNotary2, VNotary3

If DeedPurchaserSign() = Forms![foreclosure database screen]![SecuredParty] Then

VNotary1 = Trim(UCase(Client()))
If Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Then
VNotary2 = ", servicer/agent for " & Trim(UCase([SecuredParty]))
Else
VNotary2 = ""
End If
!Notary = VNotary1 + VNotary2

Else
!Notary = DeedPurchaserSign()
End If


If Client() Like "Seter*" Then
!Notary = "______________________________, authorized agent of " & Client() & ", as attorney-in-fact for Fannie Mae (" & """" & "Federal National Mortgage Association" & """" & "), personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
!Notary = "___________________ of " & servicer() & ", authorized servicer for " & LoanInvestor() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."
ElseIf Client() Like "HomEq*" Or Client() Like "Wells*" Then
!Notary = DOANotaryHomEq()
ElseIf Client() Like "Ocwen*" Then
!Notary = DOANotaryOcwen()
ElseIf Client() Like "MGC*" Then
!Notary = PartOneDOA1() & ", " & PartOneDOA2() & " "
End If


.Update
End With
DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True

End Function

Public Function DOAMerge()


CurrentDb.Execute "Delete * from fcmerge;", dbFailOnError

Dim rs As RecordSet
Dim rspropertycounty As RecordSet
Dim strsql As String

Dim rsClient As RecordSet
Dim strsqlClient As String

Dim rsBKAttorney As RecordSet
Dim strsqlBKAttorney As String
Dim VBKAtt, VBKAdd1, VBKAdd2, VBKCSZ, VBKContact


strsqlBKAttorney = "select * from PhoneScreenAttorneys where Filenum = " & Forms![foreclosure database screen]!filenum & ";"
Set rsBKAttorney = CurrentDb.OpenRecordset(strsqlBKAttorney, dbOpenSnapshot)
If Not rsBKAttorney.EOF Then
VBKAtt = rsBKAttorney!AttorneyCompany
VBKContact = rsBKAttorney!AttorneyContact
VBKAdd1 = rsBKAttorney!AttorneyAddress
VBKAdd2 = rsBKAttorney!AttorneyAddress2
VBKCSZ = rsBKAttorney!AttorneyCity & ", " & rsBKAttorney!AttorneyState & "  " & rsBKAttorney!AttorneyZip
End If
rsBKAttorney.Close




strsqlClient = "select * from clients where organizationname = " & """" & Forms![foreclosure database screen]!Client & """" & ";"
Set rsClient = CurrentDb.OpenRecordset(strsqlClient, dbOpenSnapshot)

Set rs = CurrentDb.OpenRecordset("FCMerge", dbOpenDynaset, dbSeeChanges)
GblFilenum = Forms![foreclosure database screen]![filenum]
strsql = "Select * from jurisdiction where county = " & """" & Forms![foreclosure database screen]!Propertycounty & """" & " and state = " & """" & Forms![foreclosure database screen]!PropertyState & """" & ";"
Set rspropertycounty = CurrentDb.OpenRecordset(strsql, dbOpenSnapshot)
Dim VDate


With rs
.AddNew
!borrowerscaps = debtorsCAPS()

!bwrattorney = VBKAtt
!bwrcontact = VBKContact
!bwraddress1 = VBKAdd1
!bwraddress2 = VBKAdd2
!bwrcsz = VBKCSZ
!PropAddress = Forms![foreclosure database screen]![PropAddress]
!propaddress2 = Forms![foreclosure database screen]![propaddress2]
!PropertyCity = Forms![foreclosure database screen]![PropertyCity]
!propzip = Forms![foreclosure database screen]![propzip]
!PropertyState = Forms![foreclosure database screen]![PropertyState]
!servicer = servicer()
    ![Mailing Address] = Forms![foreclosure database screen]![Mailing Address]
    ![Mailing Address2] = Forms![foreclosure database screen]![Mailing Address2]

!ClientAdd = ClientAdd()

If SPVar() = 0 Then
!extralang3 = "authorized agent of the"
Else
!extralang3 = "present"
End If
If Forms![foreclosure database screen]!Client Like "Ocwen*" Or Forms![foreclosure database screen]!Client Like "Nationstar*" Then
!sotclient = PartOneSignatureAff1
Else
!sotclient = SOTSignatureMD1()
!sotclient2 = SOTSignatureMD2()
End If

'IIf([asc_wff]=3 Or [asc_wff]=4 Or [typeofloan]="FHA/REV" Or [typeofloan]="Conv/Rev","maximum","original") &
If Forms![foreclosure database screen]!Asc_wff = 3 Or _
Forms![foreclosure database screen]!Asc_wff = 4 Or _
Forms![foreclosure database screen]!TypeOfLoan = "FHA/REV" Or _
Forms![foreclosure database screen]!TypeOfLoan = "Conv/Rev" Then
!orgmax = "maximum"
Else
!orgmax = "original"
End If


If Forms![foreclosure database screen]!Client Like "Ocwen*" And _
(Forms![foreclosure database screen]!mers = -1 Or Forms![foreclosure database screen]!mers = 1) Then ' And _
'(Forms![foreclosure database screen]!HomewardOcwen = 0 Or IsNull(Forms![foreclosure database screen]!HomewardOcwen)) Then
!extralang1 = ", Mortgage Electronic Registration Systems, Inc."
End If

If VTypeMerge = "SOTLost" Then
Dim VOption
VOption = InputBox("What is the problem with the existing SOT?" & vbCr & vbCr & "1. Missing Instrument Prepared By Language" & vbCr & "2. GPIN/Tax ID is incorrect or missing" & vbCr & "3. POA Information Missing" & vbCr & "4. Deed Book/Page Missing" & vbCr & "5. Other")
If VOption = 1 Then
!extralang1 = "to add an " & """" & "instrument prepared by" & """" & " designation to the top of the page"
ElseIf VOption = 2 Then
!extralang1 = "to add or modify the GPIN or Tax ID at the top of the page"
ElseIf VOption = 3 Then
!extralang1 = "include the recording information for a relevant power of attorney instrument"
ElseIf VOption = 4 Then
!extralang1 = "to add in the deed book and page recording information for the referenced Deed of Trust instrument"
Else
!extralang1 = "_________________________________"
End If
End If

!filenum = Forms![foreclosure database screen]!filenum
!FirstLegal = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Approx_1st
!PropertyState = Forms![foreclosure database screen]!PropertyState

'SOT Revd Code

If Not IsNull([Forms]![foreclosure database screen]![ForeclosureSubFormVA].[Form]![qcsubform].[Form]![sot_revd]) Then
!sot_reviewed = getEmployeeEmail([Forms]![foreclosure database screen]![ForeclosureSubFormVA].[Form]![qcsubform].[Form]![sot_revd])
End If



If Forms![foreclosure database screen]!PropertyState = "MD" Or Forms![foreclosure database screen]!PropertyState = "DC" Then
!Attorney = Part1Trustees()
!attorneycap = UCase(Part1Trustees())
End If

![firstdebtor] = firstdebtor()
![secondDebtor] = secondDebtor()
![thirddebtor] = thirddebtor()
![fourthdebtor] = fourthdebtor()
![fifthdebtor] = fifthdebtor()
![owner1] = owner1()
![owner2] = owner2()
![owner3] = owner3()



If Forms![foreclosure database screen]!Client Like "JP*" And Forms![foreclosure database screen]!PropertyState = "MD" And _
(Forms![foreclosure database screen]!TypeOfLoan = "FHLMC" Or Forms![foreclosure database screen]!TypeOfLoan = "FNMA") Then
!longsecured = Client()
Else
!longsecured = LSecured()
End If

!liberfolio = liberfolio()

If Forms![foreclosure database screen]!PropertyState = "VA" Then

!taxid = varTaxID()

ElseIf Forms![foreclosure database screen]!PropertyState = "dc" Then

If Forms![foreclosure database screen]!Client Like "Wells*" Then

!taxid = Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!lot & "/" & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!square
Else
!taxid = "Square: " & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!square & "/ Lot: " & Forms![foreclosure database screen]!ForeclosureSubFormDC.Form!lot

End If

Else
!taxid = varTaxID()
End If

!OrgAmount = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgAmount, "$###,###.00")

!DOTDate = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form!DOTDate, "mmmm dd, yyyy")
!dotrecorded = Format(Forms![foreclosure database screen]!ForeclosureSubForm.Form![dot recorded], "mmmm dd, yyyy")
!OrgLender = Forms![foreclosure database screen]!ForeclosureSubForm.Form!OrgLender
!orgtrustee = UCase(Forms![foreclosure database screen]!ForeclosureSubForm.Form!orgtrustee)
!doadate = Format(Forms![foreclosure database screen]![ForeclosureSubFormVA].Form![VASubAss].Form!doadate, "mmmm dd, yyyy")
!doaclerk = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form!DocsSentCourt, "mmmm dd, yyyy")
!DeedBook = Forms![foreclosure database screen]!ForeclosureSubForm.Form!Book
!VAPage = Forms![foreclosure database screen]!ForeclosureSubForm.Form!VAPage
!inst = Forms![foreclosure database screen]!ForeclosureSubForm.Form!inst
!OrgAmount = Format(Forms![foreclosure database screen]![ForeclosureSubForm].Form![OrgAmount], "$###,##0.00")
!Property = PROP()
!borrowersdns = debtorsOPENDNS()




!Propertycounty = County()

If Forms![foreclosure database screen]!Client Like "Wells*" Then
!Borrowers = debtorsFullNameCAPS()
Else
!Borrowers = debtorsFORE()
End If

If VTypeMerge = "SOTLost" Then
!LegalDescription = ""
Else

!LegalDescription = Forms![foreclosure database screen]!ForeclosureSubForm.Form!LegalDescription
End If

!ClientRefNumber = Forms![foreclosure database screen]!ClientRefNumber

Dim VWit2
Dim VWit3
Dim VDateYr

If Forms![foreclosure database screen]!PropertyState = "VA" Then
VDateYr = "_____"
!party1stpart = DOASecParty()

Else

If Client() Like "Seter*" Then
VarParty1 = "Federal National Mortgage Association (" & """" & "FNMA" & """" & ")"
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] Like "FHA*" Or _
Forms![foreclosure database screen]!fha = -1 Or Forms![foreclosure database screen]!fha = 1 Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
VarParty1 = LoanInvestor()
Else
VarParty1 = UCase(LSecured())
End If

If [Forms]![foreclosure database screen]![Client] = "washington mutual bank" Or _
Forms![foreclosure database screen]![Fmortgage] = -1 Or _
[Forms]![foreclosure database screen]![SPsigns] = -1 Then
VarParty2 = ""
ElseIf Forms![foreclosure database screen]![SecuredParty] = "" Or _
IsNull(Forms![foreclosure database screen]![SecuredParty]) Or Forms![foreclosure database screen]!PropertyState = "VA" Then
VarParty2 = ""
Else
VarParty2 = " (" & """" & Trim(UCase(Forms![foreclosure database screen]![SecuredParty])) & """" & ")"
End If

End If


If Forms![foreclosure database screen]!Client Like "Citi*" Then
!SOTLabel = UCase("Appointment of Substitute Trustee")
SOT = "Appointment of Substitute Trustee"
Else
!SOTLabel = UCase("Deed of Appointment of Substitute Trustee")
SOT = "Appointment of Substitute Trustee"
End If

!dateyear = VDateYr


If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Then
VWit2 = " by its duly authorized agent on ______ day of _____________, " & VDateYr
ElseIf Client() Like "HomEq*" Then
VWit2 = ", by Assistant Secretary of " & Forms![foreclosure database screen]![signature block] & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "Wells*" Then
VWit2 = ", by the authorized agent of " & Client() & " on ______ day of _____________, " & VDateYr
ElseIf Client() Like "One*" Then
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, ______"
Else
VWit2 = " by the authorized agent of " & servicer() & " on ______ day of _____________, " & VDateYr
End If


If Forms![foreclosure database screen]!PropertyState = "VA" Then
Dim VWit

If Forms![foreclosure database screen]![aitno_servicer] = -1 Or _
Forms![foreclosure database screen]![aitno_servicer] = 1 Then
VWit = Forms![foreclosure database screen]!servicer
ElseIf Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1 Then
VWit = Client()
Else
VWit = LSecured()
End If



If Forms![foreclosure database screen]!Client Like "Ocwen*" Then

If Forms![foreclosure database screen]!PropertyState = "MD" And Forms![foreclosure database screen]!prime_nonprime = 1 Then
Dim VOcwen
VOcwen = MsgBox("Did Ocwen Send NOI?", vbYesNo)
If VOcwen = vbYes Then
!signatureline = "Ocwen Loan Servicing, LLC"
Else
!signatureline = "Ocwen Loan Servicing, LLC, successor in interest to Homeward Residential, Inc."
End If
End If

!inwitness = VWit & " has caused this Appointment of Substitute Trustee to be executed on the date set forth above. "
Else
!inwitness = VWit & " has caused this Appointment of Substitute Trustee to be executed by its duly authorized agent on this ______ day of _____________, _____" & IIf((IsNull(Forms![foreclosure database screen]![SPsigns]) Or Forms![foreclosure database screen]![SPsigns] = 0) And (IsNull(Forms![foreclosure database screen]!aitno_servicer) Or Forms![foreclosure database screen]!aitno_servicer = 0) And (IsNull(Forms![foreclosure database screen]![aitno_client]) Or Forms![foreclosure database screen]![aitno_client] = 0), " by the authorized agent of " & Client() & ".", ".")
End If


If (IsNull(Forms![foreclosure database screen]![SPsigns]) Or _
Forms![foreclosure database screen]![SPsigns] = 0) And _
(IsNull(Forms![foreclosure database screen]![aitno_servicer]) Or _
Forms![foreclosure database screen]![aitno_servicer] = 0) Or _
(IsNull(Forms![foreclosure database screen]![aitno_client]) Or _
Forms![foreclosure database screen]![aitno_client] = 0) Then

If Client() Like "JP*" Then
!Signature2 = "By: JP Morgan Chase Bank, National Association, as attorney-in-fact"
Else
!Signature2 = ""
End If

ElseIf Client() Like "Seteru*" Then
!Signature2 = "By: Seterus, Inc., as Attorney-in-Fact"

ElseIf (Forms![foreclosure database screen]![aitno_servicer] = -1 Or _
Forms![foreclosure database screen]![aitno_servicer] = 1) Or _
((Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1) And Forms![foreclosure database screen]!PropertyState = "VA") Then

!Signature2 = ""
Else
!Signature2 = PartOneSignature2()
End If



If (Forms![foreclosure database screen]![aitno_servicer] = -1 Or _
Forms![foreclosure database screen]![aitno_servicer] = 1) Then
!signature = Forms![foreclosure database screen]!servicer

ElseIf (Client() Like "JP*" Or Forms![foreclosure database screen]!PropertyState = "VA") And (Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1) Then
!signature = Client()

ElseIf Client() Like "Seteru*" Then

!signature = "FEDERAL NATIONAL MORTGAGE ASSOCIATION (Fannie Mae), a corporation organized and existing under the laws of the United States of America, beneficiary, by  Seterus, Inc., its Attorney-in-Fact"

ElseIf Forms![foreclosure database screen]!PropertyState <> "MD" Then
!signature = PartOneSignature1()

Else
!signature = PartOneSignatureAff1()
End If

If Client() Like "Citi*" Then

!signatureline = "Name: _____________________"
!signatureline2 = "Its: Authorized Representative"

ElseIf Client() Like "Wells*" Then
If SPVar() = 0 Then
!signatureline = Client() & ", authorized agent of"

ElseIf Client() Like "Bank of Amer*" And Forms![foreclosure database screen]!PropertyState = "VA" Then
!signatureline = "________________________"

Else
!signatureline = ""
End If

End If


Else

!inwitness = IIf(Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "FHLMC", _
IIf(Client() Like "Seteru*", LoanInvestor(), Client() & ""), _
IIf((Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]) Or _
Forms![foreclosure database screen]![SPsigns] = 1), LSecured(), Client())) & _
" has caused this " & SOT & " to be executed " & VWit2 & "."
End If

If Forms![foreclosure database screen]!PropertyState = "MD" Then
!modification = modification()
Else
!modification = modificationVA()
End If

If Not IsNull(Forms![foreclosure database screen]![servicer]) And _
(Forms![foreclosure database screen]![aitno_servicer] = 1 Or Forms![foreclosure database screen]![aitno_servicer] = -1) Then
!SecuredParty = Forms![foreclosure database screen]![servicer]
ElseIf Forms![foreclosure database screen]![aitno_client] = -1 Or Forms![foreclosure database screen]![aitno_client] = 1 Then
!SecuredParty = UCase(Client())
Else
!SecuredParty = UCase(LSecured())
End If



!doasign = rsClient!doaSign1
!signatureblock = Forms![foreclosure database screen]![signature block]
!attSign2 = rsClient!attSign2
!Title = rsClient!Title1
!Title2 = rsClient!Title2



!Title = PartOneSignature4()
!ClientState = UCase(rsClient!State)

If Forms![foreclosure database screen]!Client Like "Sunt*" Then
!clientcounty = "CITY"
Else
!clientcounty = "COUNTY"
End If


If attorneysigns2() <> "" Then
!attorneysigns = attorneysigns() & ", " & attorneysigns2() & " and " & rs![Attorneys Company Name]
Else
!attorneysigns = attorneysigns() & " and " & rs![Attorneys Company Name]
End If

Dim VNotary1, VNotary2, VNotary3

If Forms![foreclosure database screen]!PropertyState = "VA" Then

If Client() Like "JP*" Then
!Notary = ChaseNotarySig()
ElseIf Client() Like "Ocwen*" Then
!Notary = "The foregoing instrument was acknowledged and sworn before me __________________________this _______ day of ________________, 2013, by ____________________ as a __________________________ of Ocwen Loan Servicing, LLC, who is personally known to me or who has produced ______________________ as identification."

Else
!Notary = IIf(Forms![foreclosure database screen]![aitno_servicer] = -1 Or _
Forms![foreclosure database screen]![aitno_servicer] = 1, Forms![foreclosure database screen]!servicer, IIf(Forms![foreclosure database screen]![aitno_client] = -1 Or _
Forms![foreclosure database screen]![aitno_client] = 1, _
UCase(Client()), UCase(LSecured()))) & " personally appeared before me in the jurisdiction aforesaid and executed the foregoing Appointment of Substitute Trustee."

End If

Else

If Client() Like "Seter*" Then
!Notary = "______________________________, authorized agent of " & Client() & ", as attorney-in-fact for Fannie Mae (" & """" & "Federal National Mortgage Association" & """" & "), personally appeared before me in the jurisdiction aforesaid and executed the foregoing " & SOT & "."
ElseIf Forms![foreclosure database screen]![TypeOfLoan] = "FNMA" Or _
Forms![foreclosure database screen]![TypeOfLoan] = "GNMA" Then
!Notary = "___________________ of " & servicer() & ", authorized servicer for " & LoanInvestor() & ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing " & SOT & "."
ElseIf Client() Like "HomEq*" Or Client() Like "Wells*" Then
!Notary = DOANotaryHomEq()
ElseIf Client() Like "Ocwen*" Then
!Notary = DOANotaryOcwen()
ElseIf Client() Like "MGC*" Then
!Notary = PartOneDOA1() & ", " & PartOneDOA2() & " "

Else

If Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary1 = " by "
Else
VNotary1 = " agent of "
End If


If Client() Like "JP*" Or _
(Client() Like "Ocwen*" And _
(Forms![foreclosure database screen]![SPsameasCl] = 0 Or _
IsNull(Forms![foreclosure database screen]![SPsameasCl]))) Then

If Forms![foreclosure database screen]![signature block] Like "*Attorney-in*" Then
VNotary2 = "as Attorney-in-Fact for " & LSecured()
Else
VNotary2 = "Authorized Servicer for " & LSecured()
End If

ElseIf Forms![foreclosure database screen]![SPsigns] = 1 Or _
Forms![foreclosure database screen]![SPsigns] = -1 Or _
Forms![foreclosure database screen]![SPsameasCl] = 1 Or _
Forms![foreclosure database screen]![SPsameasCl] = -1 Then
VNotary2 = LSecured()

Else
VNotary2 = servicer()

End If


VNotary3 = ", personally appeared before me in the jurisdiction aforesaid and executed the foregoing " & SOT & "."
!Notary = "_______________________________" & ", authorized" & VNotary1 & VNotary2 & VNotary3
End If

End If

If Forms![foreclosure database screen]!PropertyState = "VA" Then

Dim rsqc As RecordSet
Dim strsqlqc As String

strsqlqc = "select * from qc where filenum = " & GblFilenum & ";"
Set rsqc = CurrentDb.OpenRecordset(strsqlqc, dbOpenSnapshot)

If Not rsqc.EOF Then


If Not IsNull(rsqc!qc2_sot_initials) Then

Dim sot_processor As String: sot_processor = Trim(DLookup("qc2_sot_initials", "qc", "[filenum]=" & GblFilenum))
!sot_processor_initials = rsqc!qc2_sot_initials

!sot_processor = DLookup("FirstName", "Employees", "EmployeeID=" & """" & sot_processor & """") & " " & _
    DLookup("LastName", "Employees", "EmployeeID=" & """" & sot_processor & """")
!sot_proc_phone = "(301)-961-6555 ext." & DLookup("Extension", "Employees", "[EmployeeID] = " & """" & sot_processor & """")
!sot_comments = DLookup("qc2_va_Text", "qc", "[filenum]=" & GblFilenum)
!sot_proc_email = getEmployeeEmail(sot_processor)
rsqc.Close
Set rsqc = Nothing
Else
rsqc.Close
Set rsqc = Nothing
End If
End If


End If

.Update
End With


'If VTypeMerge = "GOVT" Or VTypeMerge = "AdVAMerge" Then

DoCmd.TransferText acExportDelim, , "Fcmerge", pathuser() & "fcmerge.txt", True
'Else
'DoCmd.TransferText acExportDelim, , "Fcmerge", PathUSER() & "fcmerge.txt", True
''DoCmd.RunMacro ("exportfcmerge")
'End If


End Function

Public Sub ExportFCMerge(fcmergeqry As String, rfcmergedoc As String, Optional fcmergepath As String)

fcmergedoc = fcmergedoc & ".txt"

If Len(fcmergepath) = 0 Then fcmergepath = pathuser

DoCmd.TransferText acExportDelim, , fcmergeqry, fcmergepath & fcmergedoc, True

DoCmd.RunMacro ("exportfcmerge")


End Sub

Sub WordMerge3PDF(oapp, Optional savefilepath As Variant)

If oapp.Version < 12 Then
    MsgBox "Word 2007 or above not detected."
    Exit Sub
End If
Dim savepath As String

oapp.Visible = False

'get save path----------
If Len(savefilepath) = 0 Then
Application.FileDialog(msoFileDialogSaveAs).Show

savepath = Application.FileDialog(msoFileDialogFilePicker).SelectedItems(1)
If Len(savepath) = 0 Then Exit Sub
savepath = savepath & ".pdf"
Else
savepath = savefilepath & ".pdf"
End If
oapp.ActiveDocument.SaveAs savepath, 17

'MsgBox "PDF Document saved to " & savepath
'FollowHyperlink (savepath)

oapp.Quit 0

End Sub

Sub WordMerge2PDF(oapp, Optional savefilepath As Variant)

If oapp.Version < 12 Then
    MsgBox "Word 2007 or above not detected."
    Exit Sub
End If
Dim savepath As String

oapp.Visible = False

'get save path----------
If IsMissing(savefilepath) Then
Application.FileDialog(msoFileDialogSaveAs).Show

savepath = Application.FileDialog(msoFileDialogFilePicker).SelectedItems(1)
If Len(savepath) = 0 Then Exit Sub
savepath = savepath & ".pdf"
Else
savepath = savefilepath & ".pdf"
End If
oapp.ActiveDocument.SaveAs savepath, 17

MsgBox "PDF Document saved to " & savepath
FollowHyperlink (savepath)

oapp.Quit 0

End Sub

Public Function servicer_addMerge() As Variant

Dim Attorney
Dim att_add1
Dim att_add2
Dim att_city
Dim att_state
Dim att_zip
Dim servicer_add
Dim Serve1: Dim serve2: Dim serve3: Dim serve4: Dim serve5
Dim rsAttServ As RecordSet
Dim rs As RecordSet

Set rsattserve = CurrentDb.OpenRecordset("select filenum, attorney,att_add1,att_add2,att_city,att_state,att_zip,serve1,serve2,serve3,serve4,serve5 from fctrackingdc where filenum = " & Forms![foreclosure database screen]![filenum], dbOpenSnapshot)


If Not rsattserve.EOF Then
    With rsattserve
        Attorney = !Attorney
        att_add1 = !att_add1
        att_add2 = !att_add2
        att_city = !att_city
        att_state = !att_state
        att_zip = !att_zip
        Serve1 = !Serve1
        serve2 = !serve2
        serve3 = !serve3
        serve4 = !serve4
        serve5 = !serve5
    End With
End If

If Len(Attorney) > 0 Then

servicer_add = Attorney & vbCrLf & IIf(IsNull(att_add2), att_add1 & vbCrLf & Nz(att_add2, ""), att_add1) & vbCrLf & _
    Nz(att_city, "") & ", " & Replace(Nz(att_state, ""), " ", "") & " " & Nz(att_zip, "")
    
'--- if servicer is not filled in..get prop or mailing add
Else

If Serve1 > 0 Then
    
    Select Case Serve1
    'prop add
        Case 1
            servicer_add = firstdebtor & vbCrLf & PROPFormatted
    'mail1
        Case 2
            servicer_add = firstdebtor & vbCrLf & MailAdd1Formatted
    'mail2
        Case 3
            servicer_add = firstdebtor & vbCrLf & MailAddBFormatted
        End Select
End If

If serve2 > 0 Then
    
    Select Case serve2
    'prop add
        Case 1
            servicer_add = servicer_add & vbCrLf & vbCrLf & secondDebtor & vbCrLf & PROPFormatted
    'mail1
        Case 2
            servicer_add = servicer_add & vbCrLf & vbCrLf & secondDebtor & vbCrLf & MailAdd1Formatted
    'mail2
        Case 3
            servicer_add = servicer_add & vbCrLf & vbCrLf & secondDebtor & vbCrLf & MailAddBFormatted
        End Select
End If

If serve3 > 0 Then
    
    Select Case serve3
    'prop add
        Case 1
            servicer_add = servicer_add & vbCrLf & vbCrLf & thirddebtor & vbCrLf & PROPFormatted
    'mail1
        Case 2
            servicer_add = servicer_add & vbCrLf & vbCrLf & thirddebtor & vbCrLf & MailAdd1Formatted
    'mail2
        Case 3
            servicer_add = servicer_add & vbCrLf & vbCrLf & thirddebtor & vbCrLf & MailAddBFormatted
        End Select
End If

If serve4 > 0 Then
    
    Select Case serve4
    'prop add
        Case 1
            servicer_add = servicer_add & vbCrLf & vbCrLf & fourthdebtor & vbCrLf & PROPFormatted
    'mail1
        Case 2
            servicer_add = servicer_add & vbCrLf & vbCrLf & fourthdebtor & vbCrLf & MailAdd1Formatted
    'mail2
        Case 3
            servicer_add = servicer_add & vbCrLf & vbCrLf & fourthdebtor & vbCrLf & MailAddBFormatted
        End Select
End If

If serve5 > 0 Then
    
    Select Case serve5
    'prop add
        Case 1
            servicer_add = servicer_add & vbCrLf & vbCrLf & fifthdebtor & vbCrLf & PROPFormatted
    'mail1
        Case 2
            servicer_add = servicer_add & vbCrLf & vbCrLf & fifthdebtor & vbCrLf & MailAdd1Formatted
    'mail2
        Case 3
            servicer_add = servicer_add & vbCrLf & vbCrLf & fifthdebtor & vbCrLf & MailAddBFormatted
        End Select
End If

If IsNull(Serve1) And IsNull(serve2) And IsNull(serve3) And IsNull(serve4) And IsNull(serve5) Then
    servicer_add = firstdebtor & vbCrLf & PROPFormatted
If Len(secondDebtor) > 0 Then servicer_add = servicer_add & vbCrLf & vbCrLf & secondDebtor & vbCrLf & PROPFormatted
If Len(thirddebtor) > 0 Then servicer_add = servicer_add & vbCrLf & vbCrLf & thirddebtor & vbCrLf & PROPFormatted
If Len(fourthdebtor) > 0 Then servicer_add = servicer_add & vbCrLf & vbCrLf & fourthdebtor & vbCrLf & PROPFormatted
If Len(fifthdebtor) > 0 Then servicer_add = servicer_add & vbCrLf & vbCrLf & fifthdebtor & vbCrLf & PROPFormatted
End If

End If

rsattserve.Close
Set rsattserve = Nothing

servicer_addMerge = servicer_add



End Function


